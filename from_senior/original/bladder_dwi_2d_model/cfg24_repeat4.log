Start training resnet50-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5711, Acc=0.7038, AUC=0.7760, TPR=0.7433, TNR=0.6643, J=0.4076, MCC=0.4089, ConfusionMatrix=
[[2422 1224]
 [ 938 2716]]
Epoch 0, Phase val, Loss=0.4665, Acc=0.8275, AUC=0.7670, TPR=0.4665, TNR=0.8919, J=0.3584, MCC=0.3484, ConfusionMatrix=
[[1939  235]
 [ 207  181]]
New Best AUC=0.7670. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4759, Acc=0.8463, AUC=0.7609, TPR=0.5134, TNR=0.9037, J=0.4171, MCC=0.4053, ConfusionMatrix=
[[1951  208]
 [ 181  191]]
Epoch 0 complete in 105.32

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4670, Acc=0.7844, AUC=0.8596, TPR=0.7341, TNR=0.8349, J=0.5690, MCC=0.5718, ConfusionMatrix=
[[3040  601]
 [ 973 2686]]
Epoch 1, Phase val, Loss=0.4506, Acc=0.8212, AUC=0.7896, TPR=0.5412, TNR=0.8712, J=0.4124, MCC=0.3759, ConfusionMatrix=
[[1894  280]
 [ 178  210]]
New Best AUC=0.7896. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4635, Acc=0.8242, AUC=0.7804, TPR=0.6022, TNR=0.8624, J=0.4646, MCC=0.4069, ConfusionMatrix=
[[1862  297]
 [ 148  224]]
Epoch 1 complete in 99.94

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4290, Acc=0.8085, AUC=0.8850, TPR=0.7688, TNR=0.8478, J=0.6166, MCC=0.6187, ConfusionMatrix=
[[3109  558]
 [ 840 2793]]
Epoch 2, Phase val, Loss=0.4848, Acc=0.7959, AUC=0.8029, TPR=0.6469, TNR=0.8224, J=0.4694, MCC=0.3893, ConfusionMatrix=
[[1788  386]
 [ 137  251]]
New Best AUC=0.8029. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5141, Acc=0.7851, AUC=0.7941, TPR=0.6882, TNR=0.8018, J=0.4899, MCC=0.3906, ConfusionMatrix=
[[1731  428]
 [ 116  256]]
Epoch 2 complete in 95.57

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3940, Acc=0.8267, AUC=0.9041, TPR=0.8098, TNR=0.8431, J=0.6529, MCC=0.6534, ConfusionMatrix=
[[3127  582]
 [ 683 2908]]
Epoch 3, Phase val, Loss=0.5147, Acc=0.7982, AUC=0.8129, TPR=0.7010, TNR=0.8155, J=0.5166, MCC=0.4208, ConfusionMatrix=
[[1773  401]
 [ 116  272]]
New Best AUC=0.8129. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5380, Acc=0.7898, AUC=0.7903, TPR=0.6774, TNR=0.8092, J=0.4866, MCC=0.3917, ConfusionMatrix=
[[1747  412]
 [ 120  252]]
Epoch 3 complete in 97.55

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3478, Acc=0.8551, AUC=0.9255, TPR=0.8491, TNR=0.8608, J=0.7099, MCC=0.7100, ConfusionMatrix=
[[3203  518]
 [ 540 3039]]
Epoch 4, Phase val, Loss=0.4852, Acc=0.7955, AUC=0.7453, TPR=0.5567, TNR=0.8381, J=0.3948, MCC=0.3407, ConfusionMatrix=
[[1822  352]
 [ 172  216]]
Epoch 4, Phase test, Loss=0.4967, Acc=0.7839, AUC=0.7493, TPR=0.6237, TNR=0.8115, J=0.4351, MCC=0.3547, ConfusionMatrix=
[[1752  407]
 [ 140  232]]
Epoch 4 complete in 95.51

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3388, Acc=0.8597, AUC=0.9290, TPR=0.8604, TNR=0.8591, J=0.7195, MCC=0.7194, ConfusionMatrix=
[[3200  525]
 [ 499 3076]]
Epoch 5, Phase val, Loss=0.4844, Acc=0.8123, AUC=0.7811, TPR=0.5387, TNR=0.8611, J=0.3997, MCC=0.3586, ConfusionMatrix=
[[1872  302]
 [ 179  209]]
Epoch 5, Phase test, Loss=0.5005, Acc=0.8186, AUC=0.7657, TPR=0.5538, TNR=0.8643, J=0.4181, MCC=0.3721, ConfusionMatrix=
[[1866  293]
 [ 166  206]]
Epoch 5 complete in 102.05

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3092, Acc=0.8768, AUC=0.9410, TPR=0.8802, TNR=0.8736, J=0.7538, MCC=0.7537, ConfusionMatrix=
[[3228  467]
 [ 432 3173]]
Epoch 6, Phase val, Loss=0.4836, Acc=0.8017, AUC=0.7701, TPR=0.5103, TNR=0.8537, J=0.3640, MCC=0.3254, ConfusionMatrix=
[[1856  318]
 [ 190  198]]
Epoch 6, Phase test, Loss=0.4918, Acc=0.8183, AUC=0.7554, TPR=0.5565, TNR=0.8634, J=0.4198, MCC=0.3728, ConfusionMatrix=
[[1864  295]
 [ 165  207]]
Epoch 6 complete in 94.31

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2874, Acc=0.8819, AUC=0.9487, TPR=0.8943, TNR=0.8699, J=0.7643, MCC=0.7642, ConfusionMatrix=
[[3230  483]
 [ 379 3208]]
Epoch 7, Phase val, Loss=0.5590, Acc=0.7689, AUC=0.7755, TPR=0.6521, TNR=0.7898, J=0.4419, MCC=0.3539, ConfusionMatrix=
[[1717  457]
 [ 135  253]]
Epoch 7, Phase test, Loss=0.5936, Acc=0.7396, AUC=0.7619, TPR=0.6747, TNR=0.7508, J=0.4255, MCC=0.3253, ConfusionMatrix=
[[1621  538]
 [ 121  251]]
Epoch 7 complete in 105.42

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2735, Acc=0.8907, AUC=0.9521, TPR=0.9121, TNR=0.8681, J=0.7802, MCC=0.7816, ConfusionMatrix=
[[3086  469]
 [ 329 3416]]
Epoch 8, Phase val, Loss=0.5017, Acc=0.8111, AUC=0.7921, TPR=0.5979, TNR=0.8491, J=0.4471, MCC=0.3878, ConfusionMatrix=
[[1846  328]
 [ 156  232]]
Epoch 8, Phase test, Loss=0.5399, Acc=0.8005, AUC=0.7749, TPR=0.6371, TNR=0.8286, J=0.4657, MCC=0.3862, ConfusionMatrix=
[[1789  370]
 [ 135  237]]
Epoch 8 complete in 101.62

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2480, Acc=0.9010, AUC=0.9614, TPR=0.9137, TNR=0.8881, J=0.8018, MCC=0.8021, ConfusionMatrix=
[[3230  407]
 [ 316 3347]]
Epoch 9, Phase val, Loss=0.5088, Acc=0.8048, AUC=0.7861, TPR=0.5490, TNR=0.8505, J=0.3995, MCC=0.3516, ConfusionMatrix=
[[1849  325]
 [ 175  213]]
Epoch 9, Phase test, Loss=0.4997, Acc=0.8246, AUC=0.7681, TPR=0.6102, TNR=0.8615, J=0.4717, MCC=0.4117, ConfusionMatrix=
[[1860  299]
 [ 145  227]]
Epoch 9 complete in 90.93

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2070, Acc=0.9214, AUC=0.9720, TPR=0.9419, TNR=0.9010, J=0.8429, MCC=0.8435, ConfusionMatrix=
[[3303  363]
 [ 211 3423]]
Epoch 10, Phase val, Loss=0.5108, Acc=0.8251, AUC=0.7729, TPR=0.4794, TNR=0.8868, J=0.3662, MCC=0.3506, ConfusionMatrix=
[[1928  246]
 [ 202  186]]
Epoch 10, Phase test, Loss=0.4924, Acc=0.8412, AUC=0.7635, TPR=0.5349, TNR=0.8939, J=0.4289, MCC=0.4051, ConfusionMatrix=
[[1930  229]
 [ 173  199]]
Epoch 10 complete in 95.58

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2037, Acc=0.9218, AUC=0.9731, TPR=0.9379, TNR=0.9057, J=0.8436, MCC=0.8440, ConfusionMatrix=
[[3315  345]
 [ 226 3414]]
Epoch 11, Phase val, Loss=0.5678, Acc=0.8431, AUC=0.7835, TPR=0.5052, TNR=0.9034, J=0.4086, MCC=0.4011, ConfusionMatrix=
[[1964  210]
 [ 192  196]]
Epoch 11, Phase test, Loss=0.5619, Acc=0.8558, AUC=0.7681, TPR=0.5403, TNR=0.9101, J=0.4505, MCC=0.4395, ConfusionMatrix=
[[1965  194]
 [ 171  201]]
Epoch 11 complete in 93.89

Early Stop!
Training complete in 19m 38s
The best model val AUC=0.812888257666, test AUC=0.790321335545.
Finish training resnet50-conv1x1ab-maxpool

Start training resnet50-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5801, Acc=0.6934, AUC=0.7677, TPR=0.7904, TNR=0.5919, J=0.3822, MCC=0.3906, ConfusionMatrix=
[[2110 1455]
 [ 783 2952]]
Epoch 0, Phase val, Loss=0.4923, Acc=0.8154, AUC=0.7934, TPR=0.5851, TNR=0.8565, J=0.4415, MCC=0.3883, ConfusionMatrix=
[[1862  312]
 [ 161  227]]
New Best AUC=0.7934. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5195, Acc=0.7910, AUC=0.7560, TPR=0.5780, TNR=0.8277, J=0.4057, MCC=0.3403, ConfusionMatrix=
[[1787  372]
 [ 157  215]]
Epoch 0 complete in 98.36

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4716, Acc=0.7803, AUC=0.8578, TPR=0.7326, TNR=0.8276, J=0.5603, MCC=0.5629, ConfusionMatrix=
[[3030  631]
 [ 973 2666]]
Epoch 1, Phase val, Loss=0.4494, Acc=0.8240, AUC=0.8070, TPR=0.6211, TNR=0.8602, J=0.4813, MCC=0.4216, ConfusionMatrix=
[[1870  304]
 [ 147  241]]
New Best AUC=0.8070. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4729, Acc=0.8159, AUC=0.7910, TPR=0.6532, TNR=0.8439, J=0.4971, MCC=0.4188, ConfusionMatrix=
[[1822  337]
 [ 129  243]]
Epoch 1 complete in 103.31

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4320, Acc=0.8066, AUC=0.8821, TPR=0.7921, TNR=0.8215, J=0.6136, MCC=0.6137, ConfusionMatrix=
[[2951  641]
 [ 771 2937]]
Epoch 2, Phase val, Loss=0.4882, Acc=0.7959, AUC=0.8085, TPR=0.6418, TNR=0.8234, J=0.4651, MCC=0.3866, ConfusionMatrix=
[[1790  384]
 [ 139  249]]
New Best AUC=0.8085. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5246, Acc=0.7795, AUC=0.7846, TPR=0.6774, TNR=0.7971, J=0.4745, MCC=0.3773, ConfusionMatrix=
[[1721  438]
 [ 120  252]]
Epoch 2 complete in 97.66

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3922, Acc=0.8308, AUC=0.9043, TPR=0.8034, TNR=0.8579, J=0.6613, MCC=0.6624, ConfusionMatrix=
[[3151  522]
 [ 713 2914]]
Epoch 3, Phase val, Loss=0.4094, Acc=0.8423, AUC=0.7526, TPR=0.4227, TNR=0.9172, J=0.3399, MCC=0.3574, ConfusionMatrix=
[[1994  180]
 [ 224  164]]
Epoch 3, Phase test, Loss=0.4177, Acc=0.8416, AUC=0.7382, TPR=0.4651, TNR=0.9064, J=0.3715, MCC=0.3703, ConfusionMatrix=
[[1957  202]
 [ 199  173]]
Epoch 3 complete in 96.36

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3696, Acc=0.8448, AUC=0.9153, TPR=0.8450, TNR=0.8446, J=0.6896, MCC=0.6896, ConfusionMatrix=
[[3092  569]
 [ 564 3075]]
Epoch 4, Phase val, Loss=0.5220, Acc=0.8126, AUC=0.8054, TPR=0.6443, TNR=0.8427, J=0.4870, MCC=0.4142, ConfusionMatrix=
[[1832  342]
 [ 138  250]]
Epoch 4, Phase test, Loss=0.5216, Acc=0.7997, AUC=0.7707, TPR=0.6371, TNR=0.8277, J=0.4648, MCC=0.3850, ConfusionMatrix=
[[1787  372]
 [ 135  237]]
Epoch 4 complete in 102.18

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3480, Acc=0.8547, AUC=0.9251, TPR=0.8518, TNR=0.8575, J=0.7093, MCC=0.7093, ConfusionMatrix=
[[3158  525]
 [ 536 3081]]
Epoch 5, Phase val, Loss=0.5137, Acc=0.7799, AUC=0.7813, TPR=0.6546, TNR=0.8022, J=0.4568, MCC=0.3702, ConfusionMatrix=
[[1744  430]
 [ 134  254]]
Epoch 5, Phase test, Loss=0.5637, Acc=0.7475, AUC=0.7553, TPR=0.6667, TNR=0.7615, J=0.4281, MCC=0.3303, ConfusionMatrix=
[[1644  515]
 [ 124  248]]
Epoch 5 complete in 91.60

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3178, Acc=0.8718, AUC=0.9379, TPR=0.8743, TNR=0.8693, J=0.7436, MCC=0.7436, ConfusionMatrix=
[[3178  478]
 [ 458 3186]]
Epoch 6, Phase val, Loss=0.5018, Acc=0.8271, AUC=0.7612, TPR=0.4768, TNR=0.8896, J=0.3664, MCC=0.3531, ConfusionMatrix=
[[1934  240]
 [ 203  185]]
Epoch 6, Phase test, Loss=0.4666, Acc=0.8471, AUC=0.7616, TPR=0.5672, TNR=0.8953, J=0.4625, MCC=0.4333, ConfusionMatrix=
[[1933  226]
 [ 161  211]]
Epoch 6 complete in 99.91

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2893, Acc=0.8797, AUC=0.9484, TPR=0.8865, TNR=0.8728, J=0.7593, MCC=0.7595, ConfusionMatrix=
[[3156  460]
 [ 418 3266]]
Epoch 7, Phase val, Loss=0.5690, Acc=0.7916, AUC=0.7510, TPR=0.5696, TNR=0.8312, J=0.4008, MCC=0.3417, ConfusionMatrix=
[[1807  367]
 [ 167  221]]
Epoch 7, Phase test, Loss=0.5124, Acc=0.8123, AUC=0.7665, TPR=0.6263, TNR=0.8444, J=0.4707, MCC=0.3993, ConfusionMatrix=
[[1823  336]
 [ 139  233]]
Epoch 7 complete in 96.57

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2594, Acc=0.8967, AUC=0.9581, TPR=0.9070, TNR=0.8860, J=0.7930, MCC=0.7934, ConfusionMatrix=
[[3172  408]
 [ 346 3374]]
Epoch 8, Phase val, Loss=0.5409, Acc=0.8013, AUC=0.7814, TPR=0.5825, TNR=0.8404, J=0.4229, MCC=0.3638, ConfusionMatrix=
[[1827  347]
 [ 162  226]]
Epoch 8, Phase test, Loss=0.5478, Acc=0.8072, AUC=0.7669, TPR=0.6586, TNR=0.8328, J=0.4914, MCC=0.4077, ConfusionMatrix=
[[1798  361]
 [ 127  245]]
Epoch 8 complete in 98.58

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2500, Acc=0.9021, AUC=0.9607, TPR=0.9161, TNR=0.8875, J=0.8036, MCC=0.8042, ConfusionMatrix=
[[3178  403]
 [ 312 3407]]
Epoch 9, Phase val, Loss=0.5154, Acc=0.7920, AUC=0.7321, TPR=0.4974, TNR=0.8445, J=0.3419, MCC=0.3024, ConfusionMatrix=
[[1836  338]
 [ 195  193]]
Epoch 9, Phase test, Loss=0.5265, Acc=0.7890, AUC=0.7356, TPR=0.5618, TNR=0.8282, J=0.3900, MCC=0.3286, ConfusionMatrix=
[[1788  371]
 [ 163  209]]
Epoch 9 complete in 96.65

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2398, Acc=0.9093, AUC=0.9631, TPR=0.9185, TNR=0.9001, J=0.8187, MCC=0.8188, ConfusionMatrix=
[[3289  365]
 [ 297 3349]]
Epoch 10, Phase val, Loss=0.6359, Acc=0.7740, AUC=0.7784, TPR=0.6546, TNR=0.7953, J=0.4499, MCC=0.3621, ConfusionMatrix=
[[1729  445]
 [ 134  254]]
Epoch 10, Phase test, Loss=0.6302, Acc=0.7645, AUC=0.7817, TPR=0.6935, TNR=0.7767, J=0.4703, MCC=0.3661, ConfusionMatrix=
[[1677  482]
 [ 114  258]]
Epoch 10 complete in 91.72

Early Stop!
Training complete in 17m 53s
The best model val AUC=0.808545106649, test AUC=0.784616907469.
Finish training resnet50-conv1x1ab-maxpool

Start training resnet50-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6493, Acc=0.6251, AUC=0.6716, TPR=0.6890, TNR=0.5641, J=0.2531, MCC=0.2549, ConfusionMatrix=
[[2108 1629]
 [1108 2455]]
Epoch 0, Phase val, Loss=0.7536, Acc=0.5304, AUC=0.7656, TPR=0.8479, TNR=0.4738, J=0.3217, MCC=0.2333, ConfusionMatrix=
[[1030 1144]
 [  59  329]]
New Best AUC=0.7656. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7897, Acc=0.4978, AUC=0.7176, TPR=0.8145, TNR=0.4433, J=0.2578, MCC=0.1859, ConfusionMatrix=
[[ 957 1202]
 [  69  303]]
Epoch 0 complete in 99.14

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5038, Acc=0.7542, AUC=0.8342, TPR=0.7226, TNR=0.7860, J=0.5086, MCC=0.5096, ConfusionMatrix=
[[2862  779]
 [1015 2644]]
Epoch 1, Phase val, Loss=0.4479, Acc=0.8220, AUC=0.7969, TPR=0.5954, TNR=0.8625, J=0.4578, MCC=0.4052, ConfusionMatrix=
[[1875  299]
 [ 157  231]]
New Best AUC=0.7969. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4710, Acc=0.8234, AUC=0.7771, TPR=0.6075, TNR=0.8606, J=0.4681, MCC=0.4082, ConfusionMatrix=
[[1858  301]
 [ 146  226]]
Epoch 1 complete in 107.87

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4316, Acc=0.8110, AUC=0.8821, TPR=0.7825, TNR=0.8391, J=0.6216, MCC=0.6227, ConfusionMatrix=
[[3081  591]
 [ 789 2839]]
Epoch 2, Phase val, Loss=0.6517, Acc=0.7057, AUC=0.7976, TPR=0.7448, TNR=0.6987, J=0.4436, MCC=0.3296, ConfusionMatrix=
[[1519  655]
 [  99  289]]
New Best AUC=0.7976. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.7045, Acc=0.6634, AUC=0.7746, TPR=0.7500, TNR=0.6484, J=0.3984, MCC=0.2868, ConfusionMatrix=
[[1400  759]
 [  93  279]]
Epoch 2 complete in 109.72

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4157, Acc=0.8181, AUC=0.8917, TPR=0.8150, TNR=0.8212, J=0.6362, MCC=0.6362, ConfusionMatrix=
[[2972  647]
 [ 681 3000]]
Epoch 3, Phase val, Loss=0.5059, Acc=0.8084, AUC=0.7853, TPR=0.6160, TNR=0.8427, J=0.4587, MCC=0.3927, ConfusionMatrix=
[[1832  342]
 [ 149  239]]
Epoch 3, Phase test, Loss=0.5218, Acc=0.8005, AUC=0.7824, TPR=0.6452, TNR=0.8272, J=0.4724, MCC=0.3904, ConfusionMatrix=
[[1786  373]
 [ 132  240]]
Epoch 3 complete in 96.95

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3647, Acc=0.8486, AUC=0.9178, TPR=0.8567, TNR=0.8406, J=0.6972, MCC=0.6973, ConfusionMatrix=
[[3063  581]
 [ 524 3132]]
Epoch 4, Phase val, Loss=0.4376, Acc=0.8169, AUC=0.7953, TPR=0.5979, TNR=0.8560, J=0.4540, MCC=0.3977, ConfusionMatrix=
[[1861  313]
 [ 156  232]]
Epoch 4, Phase test, Loss=0.4616, Acc=0.8072, AUC=0.7885, TPR=0.6505, TNR=0.8342, J=0.4847, MCC=0.4036, ConfusionMatrix=
[[1801  358]
 [ 130  242]]
Epoch 4 complete in 98.78

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3643, Acc=0.8468, AUC=0.9170, TPR=0.8631, TNR=0.8298, J=0.6928, MCC=0.6935, ConfusionMatrix=
[[2949  605]
 [ 513 3233]]
Epoch 5, Phase val, Loss=0.5361, Acc=0.7557, AUC=0.7723, TPR=0.6418, TNR=0.7760, J=0.4177, MCC=0.3310, ConfusionMatrix=
[[1687  487]
 [ 139  249]]
Epoch 5, Phase test, Loss=0.5759, Acc=0.7416, AUC=0.7560, TPR=0.6667, TNR=0.7545, J=0.4212, MCC=0.3232, ConfusionMatrix=
[[1629  530]
 [ 124  248]]
Epoch 5 complete in 102.75

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3125, Acc=0.8738, AUC=0.9387, TPR=0.8941, TNR=0.8536, J=0.7476, MCC=0.7483, ConfusionMatrix=
[[3113  534]
 [ 387 3266]]
Epoch 6, Phase val, Loss=0.6503, Acc=0.7564, AUC=0.7898, TPR=0.7088, TNR=0.7649, J=0.4737, MCC=0.3682, ConfusionMatrix=
[[1663  511]
 [ 113  275]]
Epoch 6, Phase test, Loss=0.6514, Acc=0.7618, AUC=0.7719, TPR=0.7177, TNR=0.7693, J=0.4871, MCC=0.3756, ConfusionMatrix=
[[1661  498]
 [ 105  267]]
Epoch 6 complete in 94.21

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3007, Acc=0.8715, AUC=0.9433, TPR=0.8914, TNR=0.8518, J=0.7432, MCC=0.7437, ConfusionMatrix=
[[3121  543]
 [ 395 3241]]
Epoch 7, Phase val, Loss=0.4628, Acc=0.8193, AUC=0.7891, TPR=0.5799, TNR=0.8620, J=0.4419, MCC=0.3925, ConfusionMatrix=
[[1874  300]
 [ 163  225]]
Epoch 7, Phase test, Loss=0.4885, Acc=0.8127, AUC=0.7665, TPR=0.5806, TNR=0.8527, J=0.4334, MCC=0.3761, ConfusionMatrix=
[[1841  318]
 [ 156  216]]
Epoch 7 complete in 96.88

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2893, Acc=0.8832, AUC=0.9472, TPR=0.9038, TNR=0.8629, J=0.7668, MCC=0.7671, ConfusionMatrix=
[[3186  506]
 [ 347 3261]]
Epoch 8, Phase val, Loss=0.5012, Acc=0.7920, AUC=0.7502, TPR=0.5258, TNR=0.8395, J=0.3652, MCC=0.3183, ConfusionMatrix=
[[1825  349]
 [ 184  204]]
Epoch 8, Phase test, Loss=0.5038, Acc=0.7878, AUC=0.7488, TPR=0.5457, TNR=0.8296, J=0.3752, MCC=0.3179, ConfusionMatrix=
[[1791  368]
 [ 169  203]]
Epoch 8 complete in 88.24

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2661, Acc=0.8966, AUC=0.9553, TPR=0.9178, TNR=0.8765, J=0.7943, MCC=0.7941, ConfusionMatrix=
[[3285  463]
 [ 292 3260]]
Epoch 9, Phase val, Loss=0.5018, Acc=0.8095, AUC=0.7889, TPR=0.6237, TNR=0.8427, J=0.4664, MCC=0.3985, ConfusionMatrix=
[[1832  342]
 [ 146  242]]
Epoch 9, Phase test, Loss=0.5123, Acc=0.7997, AUC=0.7891, TPR=0.6694, TNR=0.8221, J=0.4915, MCC=0.4019, ConfusionMatrix=
[[1775  384]
 [ 123  249]]
Epoch 9 complete in 102.57

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2335, Acc=0.9108, AUC=0.9651, TPR=0.9304, TNR=0.8911, J=0.8215, MCC=0.8222, ConfusionMatrix=
[[3239  396]
 [ 255 3410]]
Epoch 10, Phase val, Loss=0.4942, Acc=0.8298, AUC=0.7868, TPR=0.5335, TNR=0.8827, J=0.4162, MCC=0.3881, ConfusionMatrix=
[[1919  255]
 [ 181  207]]
Epoch 10, Phase test, Loss=0.4870, Acc=0.8368, AUC=0.7715, TPR=0.5403, TNR=0.8879, J=0.4282, MCC=0.3990, ConfusionMatrix=
[[1917  242]
 [ 171  201]]
Epoch 10 complete in 97.08

Early Stop!
Training complete in 18m 14s
The best model val AUC=0.797565416971, test AUC=0.77459945116.
Finish training resnet50-conv1x1ab-maxpool

Start training resnet50-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6217, Acc=0.6574, AUC=0.7164, TPR=0.7545, TNR=0.5612, J=0.3157, MCC=0.3217, ConfusionMatrix=
[[2058 1609]
 [ 892 2741]]
Epoch 0, Phase val, Loss=0.6268, Acc=0.7440, AUC=0.7918, TPR=0.7088, TNR=0.7502, J=0.4590, MCC=0.3529, ConfusionMatrix=
[[1631  543]
 [ 113  275]]
New Best AUC=0.7918. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6434, Acc=0.7266, AUC=0.7882, TPR=0.7339, TNR=0.7253, J=0.4592, MCC=0.3427, ConfusionMatrix=
[[1566  593]
 [  99  273]]
Epoch 0 complete in 90.34

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4785, Acc=0.7768, AUC=0.8517, TPR=0.7234, TNR=0.8299, J=0.5533, MCC=0.5566, ConfusionMatrix=
[[3040  623]
 [1006 2631]]
Epoch 1, Phase val, Loss=0.5771, Acc=0.7529, AUC=0.7890, TPR=0.7139, TNR=0.7599, J=0.4738, MCC=0.3666, ConfusionMatrix=
[[1652  522]
 [ 111  277]]
Epoch 1, Phase test, Loss=0.5975, Acc=0.7329, AUC=0.7901, TPR=0.7124, TNR=0.7365, J=0.4488, MCC=0.3381, ConfusionMatrix=
[[1590  569]
 [ 107  265]]
Epoch 1 complete in 99.61

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4234, Acc=0.8110, AUC=0.8879, TPR=0.7673, TNR=0.8540, J=0.6213, MCC=0.6239, ConfusionMatrix=
[[3140  537]
 [ 843 2780]]
Epoch 2, Phase val, Loss=0.4437, Acc=0.8220, AUC=0.7973, TPR=0.6005, TNR=0.8615, J=0.4621, MCC=0.4078, ConfusionMatrix=
[[1873  301]
 [ 155  233]]
New Best AUC=0.7973. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4529, Acc=0.8293, AUC=0.7953, TPR=0.6371, TNR=0.8624, J=0.4995, MCC=0.4335, ConfusionMatrix=
[[1862  297]
 [ 135  237]]
Epoch 2 complete in 90.20

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3919, Acc=0.8268, AUC=0.9047, TPR=0.8078, TNR=0.8462, J=0.6541, MCC=0.6544, ConfusionMatrix=
[[3060  556]
 [ 708 2976]]
Epoch 3, Phase val, Loss=0.3947, Acc=0.8404, AUC=0.7947, TPR=0.5129, TNR=0.8988, J=0.4117, MCC=0.3990, ConfusionMatrix=
[[1954  220]
 [ 189  199]]
Epoch 3, Phase test, Loss=0.4153, Acc=0.8447, AUC=0.7572, TPR=0.5161, TNR=0.9013, J=0.4175, MCC=0.4032, ConfusionMatrix=
[[1946  213]
 [ 180  192]]
Epoch 3 complete in 92.10

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3819, Acc=0.8310, AUC=0.9093, TPR=0.8225, TNR=0.8391, J=0.6616, MCC=0.6618, ConfusionMatrix=
[[3114  597]
 [ 637 2952]]
Epoch 4, Phase val, Loss=0.4764, Acc=0.7916, AUC=0.8152, TPR=0.6753, TNR=0.8123, J=0.4876, MCC=0.3977, ConfusionMatrix=
[[1766  408]
 [ 126  262]]
New Best AUC=0.8152. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5104, Acc=0.7768, AUC=0.7879, TPR=0.6667, TNR=0.7957, J=0.4624, MCC=0.3678, ConfusionMatrix=
[[1718  441]
 [ 124  248]]
Epoch 4 complete in 89.43

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3448, Acc=0.8534, AUC=0.9262, TPR=0.8641, TNR=0.8424, J=0.7065, MCC=0.7068, ConfusionMatrix=
[[3025  566]
 [ 504 3205]]
Epoch 5, Phase val, Loss=0.4144, Acc=0.8123, AUC=0.8024, TPR=0.5876, TNR=0.8523, J=0.4400, MCC=0.3844, ConfusionMatrix=
[[1853  321]
 [ 160  228]]
Epoch 5, Phase test, Loss=0.4487, Acc=0.8222, AUC=0.7752, TPR=0.6210, TNR=0.8569, J=0.4778, MCC=0.4130, ConfusionMatrix=
[[1850  309]
 [ 141  231]]
Epoch 5 complete in 102.09

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3233, Acc=0.8640, AUC=0.9349, TPR=0.8809, TNR=0.8466, J=0.7275, MCC=0.7281, ConfusionMatrix=
[[3052  553]
 [ 440 3255]]
Epoch 6, Phase val, Loss=0.5109, Acc=0.7912, AUC=0.7904, TPR=0.6418, TNR=0.8178, J=0.4596, MCC=0.3796, ConfusionMatrix=
[[1778  396]
 [ 139  249]]
Epoch 6, Phase test, Loss=0.5594, Acc=0.7697, AUC=0.7801, TPR=0.6586, TNR=0.7888, J=0.4474, MCC=0.3540, ConfusionMatrix=
[[1703  456]
 [ 127  245]]
Epoch 6 complete in 97.17

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2768, Acc=0.8858, AUC=0.9528, TPR=0.8979, TNR=0.8742, J=0.7721, MCC=0.7719, ConfusionMatrix=
[[3265  470]
 [ 364 3201]]
Epoch 7, Phase val, Loss=0.4970, Acc=0.7939, AUC=0.8035, TPR=0.6263, TNR=0.8238, J=0.4501, MCC=0.3755, ConfusionMatrix=
[[1791  383]
 [ 145  243]]
Epoch 7, Phase test, Loss=0.5505, Acc=0.7886, AUC=0.7695, TPR=0.5833, TNR=0.8240, J=0.4073, MCC=0.3397, ConfusionMatrix=
[[1779  380]
 [ 155  217]]
Epoch 7 complete in 88.99

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2784, Acc=0.8908, AUC=0.9513, TPR=0.9092, TNR=0.8722, J=0.7815, MCC=0.7821, ConfusionMatrix=
[[3167  464]
 [ 333 3336]]
Epoch 8, Phase val, Loss=0.4923, Acc=0.8427, AUC=0.8177, TPR=0.5876, TNR=0.8882, J=0.4759, MCC=0.4404, ConfusionMatrix=
[[1931  243]
 [ 160  228]]
New Best AUC=0.8177. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.5354, Acc=0.8463, AUC=0.7844, TPR=0.5833, TNR=0.8916, J=0.4749, MCC=0.4395, ConfusionMatrix=
[[1925  234]
 [ 155  217]]
Epoch 8 complete in 99.57

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2723, Acc=0.8953, AUC=0.9529, TPR=0.9189, TNR=0.8709, J=0.7897, MCC=0.7912, ConfusionMatrix=
[[3116  462]
 [ 302 3420]]
Epoch 9, Phase val, Loss=0.4490, Acc=0.8130, AUC=0.7843, TPR=0.4871, TNR=0.8712, J=0.3583, MCC=0.3322, ConfusionMatrix=
[[1894  280]
 [ 199  189]]
Epoch 9, Phase test, Loss=0.5210, Acc=0.8005, AUC=0.7425, TPR=0.5403, TNR=0.8453, J=0.3856, MCC=0.3344, ConfusionMatrix=
[[1825  334]
 [ 171  201]]
Epoch 9 complete in 89.08

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2494, Acc=0.9005, AUC=0.9611, TPR=0.9171, TNR=0.8839, J=0.8010, MCC=0.8015, ConfusionMatrix=
[[3213  422]
 [ 304 3361]]
Epoch 10, Phase val, Loss=0.4299, Acc=0.8525, AUC=0.7775, TPR=0.4149, TNR=0.9305, J=0.3455, MCC=0.3787, ConfusionMatrix=
[[2023  151]
 [ 227  161]]
Epoch 10, Phase test, Loss=0.4548, Acc=0.8538, AUC=0.7546, TPR=0.4274, TNR=0.9273, J=0.3547, MCC=0.3800, ConfusionMatrix=
[[2002  157]
 [ 213  159]]
Epoch 10 complete in 104.06

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2192, Acc=0.9149, AUC=0.9683, TPR=0.9316, TNR=0.8981, J=0.8297, MCC=0.8303, ConfusionMatrix=
[[3262  370]
 [ 251 3417]]
Epoch 11, Phase val, Loss=0.4851, Acc=0.8048, AUC=0.7876, TPR=0.5696, TNR=0.8468, J=0.4164, MCC=0.3626, ConfusionMatrix=
[[1841  333]
 [ 167  221]]
Epoch 11, Phase test, Loss=0.5208, Acc=0.8060, AUC=0.7661, TPR=0.5645, TNR=0.8476, J=0.4121, MCC=0.3564, ConfusionMatrix=
[[1830  329]
 [ 162  210]]
Epoch 11 complete in 93.80

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.2028, Acc=0.9211, AUC=0.9738, TPR=0.9410, TNR=0.9014, J=0.8424, MCC=0.8429, ConfusionMatrix=
[[3311  362]
 [ 214 3413]]
Epoch 12, Phase val, Loss=0.4818, Acc=0.8240, AUC=0.7983, TPR=0.5335, TNR=0.8758, J=0.4093, MCC=0.3770, ConfusionMatrix=
[[1904  270]
 [ 181  207]]
Epoch 12, Phase test, Loss=0.5234, Acc=0.8123, AUC=0.7655, TPR=0.5027, TNR=0.8657, J=0.3684, MCC=0.3335, ConfusionMatrix=
[[1869  290]
 [ 185  187]]
Epoch 12 complete in 89.76

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.1694, Acc=0.9381, AUC=0.9805, TPR=0.9522, TNR=0.9241, J=0.8763, MCC=0.8765, ConfusionMatrix=
[[3384  278]
 [ 174 3464]]
Epoch 13, Phase val, Loss=0.5352, Acc=0.8302, AUC=0.7926, TPR=0.4794, TNR=0.8928, J=0.3722, MCC=0.3608, ConfusionMatrix=
[[1941  233]
 [ 202  186]]
Epoch 13, Phase test, Loss=0.5701, Acc=0.8352, AUC=0.7633, TPR=0.5081, TNR=0.8916, J=0.3997, MCC=0.3793, ConfusionMatrix=
[[1925  234]
 [ 183  189]]
Epoch 13 complete in 98.17

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.1739, Acc=0.9337, AUC=0.9799, TPR=0.9516, TNR=0.9152, J=0.8667, MCC=0.8678, ConfusionMatrix=
[[3279  304]
 [ 180 3537]]
Epoch 14, Phase val, Loss=0.5819, Acc=0.8236, AUC=0.8035, TPR=0.6237, TNR=0.8592, J=0.4830, MCC=0.4222, ConfusionMatrix=
[[1868  306]
 [ 146  242]]
Epoch 14, Phase test, Loss=0.6114, Acc=0.8206, AUC=0.7811, TPR=0.6156, TNR=0.8560, J=0.4715, MCC=0.4076, ConfusionMatrix=
[[1848  311]
 [ 143  229]]
Epoch 14 complete in 88.98

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.1512, Acc=0.9436, AUC=0.9839, TPR=0.9606, TNR=0.9260, J=0.8866, MCC=0.8875, ConfusionMatrix=
[[3328  266]
 [ 146 3560]]
Epoch 15, Phase val, Loss=0.5979, Acc=0.8111, AUC=0.7945, TPR=0.4923, TNR=0.8680, J=0.3603, MCC=0.3315, ConfusionMatrix=
[[1887  287]
 [ 197  191]]
Epoch 15, Phase test, Loss=0.6304, Acc=0.8289, AUC=0.7671, TPR=0.5753, TNR=0.8726, J=0.4479, MCC=0.4017, ConfusionMatrix=
[[1884  275]
 [ 158  214]]
Epoch 15 complete in 99.25

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.1429, Acc=0.9486, AUC=0.9861, TPR=0.9621, TNR=0.9353, J=0.8974, MCC=0.8976, ConfusionMatrix=
[[3426  237]
 [ 138 3499]]
Epoch 16, Phase val, Loss=0.5805, Acc=0.8228, AUC=0.7653, TPR=0.4381, TNR=0.8914, J=0.3296, MCC=0.3235, ConfusionMatrix=
[[1938  236]
 [ 218  170]]
Epoch 16, Phase test, Loss=0.5952, Acc=0.8427, AUC=0.7516, TPR=0.5081, TNR=0.9004, J=0.4085, MCC=0.3949, ConfusionMatrix=
[[1944  215]
 [ 183  189]]
Epoch 16 complete in 89.84

Early Stop!
Training complete in 26m 42s
The best model val AUC=0.817658788494, test AUC=0.784410843331.
Finish training resnet50-conv1x1ab-maxpool

Start training resnet50-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6099, Acc=0.6766, AUC=0.7419, TPR=0.8172, TNR=0.5344, J=0.3516, MCC=0.3668, ConfusionMatrix=
[[1940 1690]
 [ 671 2999]]
Epoch 0, Phase val, Loss=0.5107, Acc=0.7838, AUC=0.7540, TPR=0.5619, TNR=0.8234, J=0.3852, MCC=0.3257, ConfusionMatrix=
[[1790  384]
 [ 170  218]]
New Best AUC=0.7540. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5440, Acc=0.7396, AUC=0.7580, TPR=0.6290, TNR=0.7587, J=0.3877, MCC=0.3001, ConfusionMatrix=
[[1638  521]
 [ 138  234]]
Epoch 0 complete in 103.25

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4459, Acc=0.7916, AUC=0.8745, TPR=0.7628, TNR=0.8204, J=0.5832, MCC=0.5842, ConfusionMatrix=
[[2997  656]
 [ 865 2782]]
Epoch 1, Phase val, Loss=0.5954, Acc=0.7490, AUC=0.7839, TPR=0.7113, TNR=0.7557, J=0.4671, MCC=0.3605, ConfusionMatrix=
[[1643  531]
 [ 112  276]]
New Best AUC=0.7839. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6418, Acc=0.6875, AUC=0.7788, TPR=0.7016, TNR=0.6850, J=0.3867, MCC=0.2833, ConfusionMatrix=
[[1479  680]
 [ 111  261]]
Epoch 1 complete in 97.56

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4057, Acc=0.8219, AUC=0.8975, TPR=0.8142, TNR=0.8296, J=0.6437, MCC=0.6438, ConfusionMatrix=
[[3047  626]
 [ 674 2953]]
Epoch 2, Phase val, Loss=0.5246, Acc=0.7635, AUC=0.7894, TPR=0.6753, TNR=0.7792, J=0.4545, MCC=0.3592, ConfusionMatrix=
[[1694  480]
 [ 126  262]]
New Best AUC=0.7894. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5663, Acc=0.7396, AUC=0.7744, TPR=0.6935, TNR=0.7476, J=0.4411, MCC=0.3356, ConfusionMatrix=
[[1614  545]
 [ 114  258]]
Epoch 2 complete in 90.08

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3453, Acc=0.8547, AUC=0.9257, TPR=0.8584, TNR=0.8511, J=0.7095, MCC=0.7093, ConfusionMatrix=
[[3195  559]
 [ 502 3044]]
Epoch 3, Phase val, Loss=0.5041, Acc=0.7763, AUC=0.7767, TPR=0.5747, TNR=0.8123, J=0.3871, MCC=0.3221, ConfusionMatrix=
[[1766  408]
 [ 165  223]]
Epoch 3, Phase test, Loss=0.5151, Acc=0.7831, AUC=0.7602, TPR=0.6102, TNR=0.8129, J=0.4231, MCC=0.3463, ConfusionMatrix=
[[1755  404]
 [ 145  227]]
Epoch 3 complete in 100.08

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.2935, Acc=0.8807, AUC=0.9459, TPR=0.8966, TNR=0.8649, J=0.7616, MCC=0.7618, ConfusionMatrix=
[[3176  496]
 [ 375 3253]]
Epoch 4, Phase val, Loss=0.4827, Acc=0.8372, AUC=0.7777, TPR=0.4562, TNR=0.9052, J=0.3614, MCC=0.3634, ConfusionMatrix=
[[1968  206]
 [ 211  177]]
Epoch 4, Phase test, Loss=0.4900, Acc=0.8483, AUC=0.7606, TPR=0.4839, TNR=0.9111, J=0.3949, MCC=0.3949, ConfusionMatrix=
[[1967  192]
 [ 192  180]]
Epoch 4 complete in 89.34

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2486, Acc=0.9007, AUC=0.9613, TPR=0.9168, TNR=0.8841, J=0.8009, MCC=0.8016, ConfusionMatrix=
[[3180  417]
 [ 308 3395]]
Epoch 5, Phase val, Loss=0.5422, Acc=0.7959, AUC=0.7902, TPR=0.6211, TNR=0.8270, J=0.4482, MCC=0.3757, ConfusionMatrix=
[[1798  376]
 [ 147  241]]
New Best AUC=0.7902. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5882, Acc=0.7934, AUC=0.7667, TPR=0.6210, TNR=0.8231, J=0.4440, MCC=0.3670, ConfusionMatrix=
[[1777  382]
 [ 141  231]]
Epoch 5 complete in 98.74

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2354, Acc=0.9084, AUC=0.9642, TPR=0.9309, TNR=0.8851, J=0.8160, MCC=0.8173, ConfusionMatrix=
[[3182  413]
 [ 256 3449]]
Epoch 6, Phase val, Loss=0.5688, Acc=0.8513, AUC=0.7815, TPR=0.3686, TNR=0.9374, J=0.3060, MCC=0.3521, ConfusionMatrix=
[[2038  136]
 [ 245  143]]
Epoch 6, Phase test, Loss=0.5673, Acc=0.8692, AUC=0.7611, TPR=0.4005, TNR=0.9500, J=0.3505, MCC=0.4109, ConfusionMatrix=
[[2051  108]
 [ 223  149]]
Epoch 6 complete in 92.67

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2090, Acc=0.9226, AUC=0.9716, TPR=0.9385, TNR=0.9058, J=0.8443, MCC=0.8453, ConfusionMatrix=
[[3211  334]
 [ 231 3524]]
Epoch 7, Phase val, Loss=0.5707, Acc=0.8138, AUC=0.7942, TPR=0.5593, TNR=0.8592, J=0.4185, MCC=0.3722, ConfusionMatrix=
[[1868  306]
 [ 171  217]]
New Best AUC=0.7942. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5967, Acc=0.8159, AUC=0.7663, TPR=0.5565, TNR=0.8606, J=0.4170, MCC=0.3687, ConfusionMatrix=
[[1858  301]
 [ 165  207]]
Epoch 7 complete in 91.51

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1755, Acc=0.9333, AUC=0.9793, TPR=0.9487, TNR=0.9177, J=0.8664, MCC=0.8670, ConfusionMatrix=
[[3333  299]
 [ 188 3480]]
Epoch 8, Phase val, Loss=0.5545, Acc=0.8197, AUC=0.7895, TPR=0.5361, TNR=0.8703, J=0.4064, MCC=0.3704, ConfusionMatrix=
[[1892  282]
 [ 180  208]]
Epoch 8, Phase test, Loss=0.5432, Acc=0.8262, AUC=0.7751, TPR=0.5457, TNR=0.8745, J=0.4202, MCC=0.3814, ConfusionMatrix=
[[1888  271]
 [ 169  203]]
Epoch 8 complete in 96.54

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1846, Acc=0.9299, AUC=0.9776, TPR=0.9480, TNR=0.9121, J=0.8601, MCC=0.8604, ConfusionMatrix=
[[3361  324]
 [ 188 3427]]
Epoch 9, Phase val, Loss=0.6259, Acc=0.8439, AUC=0.7406, TPR=0.3454, TNR=0.9328, J=0.2782, MCC=0.3196, ConfusionMatrix=
[[2028  146]
 [ 254  134]]
Epoch 9, Phase test, Loss=0.5611, Acc=0.8514, AUC=0.7500, TPR=0.3683, TNR=0.9347, J=0.3030, MCC=0.3431, ConfusionMatrix=
[[2018  141]
 [ 235  137]]
Epoch 9 complete in 89.47

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.1516, Acc=0.9464, AUC=0.9842, TPR=0.9555, TNR=0.9375, J=0.8930, MCC=0.8930, ConfusionMatrix=
[[3452  230]
 [ 161 3457]]
Epoch 10, Phase val, Loss=0.6006, Acc=0.8497, AUC=0.7751, TPR=0.4021, TNR=0.9296, J=0.3317, MCC=0.3651, ConfusionMatrix=
[[2021  153]
 [ 232  156]]
Epoch 10, Phase test, Loss=0.5870, Acc=0.8578, AUC=0.7569, TPR=0.4328, TNR=0.9310, J=0.3638, MCC=0.3929, ConfusionMatrix=
[[2010  149]
 [ 211  161]]
Epoch 10 complete in 97.71

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.1410, Acc=0.9493, AUC=0.9864, TPR=0.9597, TNR=0.9387, J=0.8985, MCC=0.8988, ConfusionMatrix=
[[3402  222]
 [ 148 3528]]
Epoch 11, Phase val, Loss=0.6003, Acc=0.8107, AUC=0.7604, TPR=0.4820, TNR=0.8694, J=0.3513, MCC=0.3251, ConfusionMatrix=
[[1890  284]
 [ 201  187]]
Epoch 11, Phase test, Loss=0.6187, Acc=0.8171, AUC=0.7478, TPR=0.5484, TNR=0.8634, J=0.4117, MCC=0.3665, ConfusionMatrix=
[[1864  295]
 [ 168  204]]
Epoch 11 complete in 93.15

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.1268, Acc=0.9545, AUC=0.9886, TPR=0.9621, TNR=0.9472, J=0.9093, MCC=0.9092, ConfusionMatrix=
[[3514  196]
 [ 136 3454]]
Epoch 12, Phase val, Loss=0.6734, Acc=0.8154, AUC=0.7913, TPR=0.5541, TNR=0.8620, J=0.4161, MCC=0.3722, ConfusionMatrix=
[[1874  300]
 [ 173  215]]
Epoch 12, Phase test, Loss=0.6650, Acc=0.8297, AUC=0.7766, TPR=0.5565, TNR=0.8768, J=0.4332, MCC=0.3935, ConfusionMatrix=
[[1893  266]
 [ 165  207]]
Epoch 12 complete in 92.32

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.1056, Acc=0.9638, AUC=0.9918, TPR=0.9718, TNR=0.9558, J=0.9276, MCC=0.9278, ConfusionMatrix=
[[3482  161]
 [ 103 3554]]
Epoch 13, Phase val, Loss=0.6275, Acc=0.8251, AUC=0.7841, TPR=0.4356, TNR=0.8947, J=0.3302, MCC=0.3268, ConfusionMatrix=
[[1945  229]
 [ 219  169]]
Epoch 13, Phase test, Loss=0.6746, Acc=0.8333, AUC=0.7535, TPR=0.4758, TNR=0.8949, J=0.3707, MCC=0.3583, ConfusionMatrix=
[[1932  227]
 [ 195  177]]
Epoch 13 complete in 88.60

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.1079, Acc=0.9592, AUC=0.9920, TPR=0.9660, TNR=0.9521, J=0.9181, MCC=0.9184, ConfusionMatrix=
[[3419  172]
 [ 126 3583]]
Epoch 14, Phase val, Loss=0.6524, Acc=0.8158, AUC=0.7673, TPR=0.3686, TNR=0.8956, J=0.2641, MCC=0.2694, ConfusionMatrix=
[[1947  227]
 [ 245  143]]
Epoch 14, Phase test, Loss=0.6134, Acc=0.8380, AUC=0.7618, TPR=0.4866, TNR=0.8986, J=0.3851, MCC=0.3738, ConfusionMatrix=
[[1940  219]
 [ 191  181]]
Epoch 14 complete in 94.48

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.0931, Acc=0.9662, AUC=0.9938, TPR=0.9734, TNR=0.9589, J=0.9323, MCC=0.9324, ConfusionMatrix=
[[3503  150]
 [  97 3550]]
Epoch 15, Phase val, Loss=0.6402, Acc=0.8384, AUC=0.7997, TPR=0.4278, TNR=0.9117, J=0.3395, MCC=0.3510, ConfusionMatrix=
[[1982  192]
 [ 222  166]]
New Best AUC=0.7997. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 15, Phase test, Loss=0.7031, Acc=0.8455, AUC=0.7554, TPR=0.5027, TNR=0.9046, J=0.4073, MCC=0.3982, ConfusionMatrix=
[[1953  206]
 [ 185  187]]
Epoch 15 complete in 89.90

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.0897, Acc=0.9679, AUC=0.9939, TPR=0.9746, TNR=0.9614, J=0.9360, MCC=0.9360, ConfusionMatrix=
[[3534  142]
 [  92 3532]]
Epoch 16, Phase val, Loss=0.7247, Acc=0.8501, AUC=0.7881, TPR=0.4175, TNR=0.9273, J=0.3448, MCC=0.3739, ConfusionMatrix=
[[2016  158]
 [ 226  162]]
Epoch 16, Phase test, Loss=0.7060, Acc=0.8613, AUC=0.7690, TPR=0.4597, TNR=0.9305, J=0.3902, MCC=0.4152, ConfusionMatrix=
[[2009  150]
 [ 201  171]]
Epoch 16 complete in 98.31

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.0811, Acc=0.9729, AUC=0.9948, TPR=0.9800, TNR=0.9657, J=0.9457, MCC=0.9458, ConfusionMatrix=
[[3519  125]
 [  73 3583]]
Epoch 17, Phase val, Loss=0.6575, Acc=0.8290, AUC=0.8004, TPR=0.4923, TNR=0.8891, J=0.3814, MCC=0.3652, ConfusionMatrix=
[[1933  241]
 [ 197  191]]
New Best AUC=0.8004. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 17, Phase test, Loss=0.7059, Acc=0.8352, AUC=0.7661, TPR=0.5296, TNR=0.8879, J=0.4175, MCC=0.3904, ConfusionMatrix=
[[1917  242]
 [ 175  197]]
Epoch 17 complete in 102.94

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.0825, Acc=0.9734, AUC=0.9944, TPR=0.9802, TNR=0.9665, J=0.9467, MCC=0.9469, ConfusionMatrix=
[[3490  121]
 [  73 3616]]
Epoch 18, Phase val, Loss=0.6533, Acc=0.8419, AUC=0.7961, TPR=0.4510, TNR=0.9117, J=0.3627, MCC=0.3712, ConfusionMatrix=
[[1982  192]
 [ 213  175]]
Epoch 18, Phase test, Loss=0.6231, Acc=0.8589, AUC=0.7754, TPR=0.4570, TNR=0.9282, J=0.3852, MCC=0.4077, ConfusionMatrix=
[[2004  155]
 [ 202  170]]
Epoch 18 complete in 89.87

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.0791, Acc=0.9715, AUC=0.9955, TPR=0.9784, TNR=0.9647, J=0.9431, MCC=0.9431, ConfusionMatrix=
[[3555  130]
 [  78 3537]]
Epoch 19, Phase val, Loss=0.7215, Acc=0.8341, AUC=0.7614, TPR=0.3479, TNR=0.9209, J=0.2688, MCC=0.2967, ConfusionMatrix=
[[2002  172]
 [ 253  135]]
Epoch 19, Phase test, Loss=0.7034, Acc=0.8329, AUC=0.7494, TPR=0.4435, TNR=0.9000, J=0.3435, MCC=0.3401, ConfusionMatrix=
[[1943  216]
 [ 207  165]]
Epoch 19 complete in 100.26

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.0583, Acc=0.9808, AUC=0.9971, TPR=0.9850, TNR=0.9767, J=0.9616, MCC=0.9617, ConfusionMatrix=
[[3557   85]
 [  55 3603]]
Epoch 20, Phase val, Loss=0.7083, Acc=0.8341, AUC=0.7965, TPR=0.4407, TNR=0.9043, J=0.3450, MCC=0.3484, ConfusionMatrix=
[[1966  208]
 [ 217  171]]
Epoch 20, Phase test, Loss=0.7276, Acc=0.8364, AUC=0.7561, TPR=0.4839, TNR=0.8972, J=0.3810, MCC=0.3691, ConfusionMatrix=
[[1937  222]
 [ 192  180]]
Epoch 20 complete in 88.55

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.0585, Acc=0.9799, AUC=0.9974, TPR=0.9828, TNR=0.9769, J=0.9597, MCC=0.9597, ConfusionMatrix=
[[3557   84]
 [  63 3596]]
Epoch 21, Phase val, Loss=0.7553, Acc=0.8396, AUC=0.7919, TPR=0.4407, TNR=0.9108, J=0.3515, MCC=0.3605, ConfusionMatrix=
[[1980  194]
 [ 217  171]]
Epoch 21, Phase test, Loss=0.7969, Acc=0.8503, AUC=0.7565, TPR=0.4651, TNR=0.9166, J=0.3817, MCC=0.3901, ConfusionMatrix=
[[1979  180]
 [ 199  173]]
Epoch 21 complete in 96.14

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.0673, Acc=0.9781, AUC=0.9964, TPR=0.9845, TNR=0.9717, J=0.9563, MCC=0.9562, ConfusionMatrix=
[[3577  104]
 [  56 3563]]
Epoch 22, Phase val, Loss=0.6756, Acc=0.8345, AUC=0.8038, TPR=0.4381, TNR=0.9052, J=0.3434, MCC=0.3479, ConfusionMatrix=
[[1968  206]
 [ 218  170]]
New Best AUC=0.8038. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 22, Phase test, Loss=0.7116, Acc=0.8514, AUC=0.7749, TPR=0.5000, TNR=0.9120, J=0.4120, MCC=0.4102, ConfusionMatrix=
[[1969  190]
 [ 186  186]]
Epoch 22 complete in 97.53

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.0541, Acc=0.9833, AUC=0.9974, TPR=0.9883, TNR=0.9781, J=0.9665, MCC=0.9666, ConfusionMatrix=
[[3533   79]
 [  43 3645]]
Epoch 23, Phase val, Loss=0.7784, Acc=0.8404, AUC=0.7949, TPR=0.3840, TNR=0.9218, J=0.3058, MCC=0.3321, ConfusionMatrix=
[[2004  170]
 [ 239  149]]
Epoch 23, Phase test, Loss=0.8155, Acc=0.8582, AUC=0.7674, TPR=0.4382, TNR=0.9305, J=0.3687, MCC=0.3966, ConfusionMatrix=
[[2009  150]
 [ 209  163]]
Epoch 23 complete in 92.62

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.0583, Acc=0.9812, AUC=0.9971, TPR=0.9858, TNR=0.9768, J=0.9626, MCC=0.9625, ConfusionMatrix=
[[3613   86]
 [  51 3550]]
Epoch 24, Phase val, Loss=0.9254, Acc=0.8575, AUC=0.7843, TPR=0.3196, TNR=0.9535, J=0.2731, MCC=0.3459, ConfusionMatrix=
[[2073  101]
 [ 264  124]]
Epoch 24, Phase test, Loss=0.8847, Acc=0.8661, AUC=0.7605, TPR=0.3763, TNR=0.9504, J=0.3268, MCC=0.3899, ConfusionMatrix=
[[2052  107]
 [ 232  140]]
Epoch 24 complete in 94.36

Epoch 25 starting with learning_rate: [0.005]
Epoch 25, Phase train, Loss=0.0616, Acc=0.9795, AUC=0.9971, TPR=0.9837, TNR=0.9751, J=0.9588, MCC=0.9589, ConfusionMatrix=
[[3522   90]
 [  60 3628]]
Epoch 25, Phase val, Loss=0.7430, Acc=0.8536, AUC=0.7927, TPR=0.4098, TNR=0.9328, J=0.3426, MCC=0.3793, ConfusionMatrix=
[[2028  146]
 [ 229  159]]
Epoch 25, Phase test, Loss=0.7468, Acc=0.8542, AUC=0.7692, TPR=0.4059, TNR=0.9314, J=0.3374, MCC=0.3701, ConfusionMatrix=
[[2011  148]
 [ 221  151]]
Epoch 25 complete in 92.03

Epoch 26 starting with learning_rate: [0.005]
Epoch 26, Phase train, Loss=0.0519, Acc=0.9814, AUC=0.9979, TPR=0.9841, TNR=0.9786, J=0.9627, MCC=0.9627, ConfusionMatrix=
[[3519   77]
 [  59 3645]]
Epoch 26, Phase val, Loss=0.7874, Acc=0.8392, AUC=0.7930, TPR=0.4253, TNR=0.9131, J=0.3383, MCC=0.3515, ConfusionMatrix=
[[1985  189]
 [ 223  165]]
Epoch 26, Phase test, Loss=0.7925, Acc=0.8558, AUC=0.7676, TPR=0.4946, TNR=0.9180, J=0.4126, MCC=0.4178, ConfusionMatrix=
[[1982  177]
 [ 188  184]]
Epoch 26 complete in 100.57

Epoch 27 starting with learning_rate: [0.005]
Epoch 27, Phase train, Loss=0.0391, Acc=0.9886, AUC=0.9985, TPR=0.9925, TNR=0.9848, J=0.9773, MCC=0.9773, ConfusionMatrix=
[[3631   56]
 [  27 3586]]
Epoch 27, Phase val, Loss=0.9904, Acc=0.8552, AUC=0.7622, TPR=0.2448, TNR=0.9641, J=0.2090, MCC=0.2985, ConfusionMatrix=
[[2096   78]
 [ 293   95]]
Epoch 27, Phase test, Loss=0.9020, Acc=0.8736, AUC=0.7562, TPR=0.3602, TNR=0.9620, J=0.3222, MCC=0.4084, ConfusionMatrix=
[[2077   82]
 [ 238  134]]
Epoch 27 complete in 88.22

Epoch 28 starting with learning_rate: [0.005]
Epoch 28, Phase train, Loss=0.0486, Acc=0.9851, AUC=0.9982, TPR=0.9871, TNR=0.9831, J=0.9702, MCC=0.9701, ConfusionMatrix=
[[3602   62]
 [  47 3589]]
Epoch 28, Phase val, Loss=0.7621, Acc=0.8493, AUC=0.7978, TPR=0.4639, TNR=0.9181, J=0.3820, MCC=0.3950, ConfusionMatrix=
[[1996  178]
 [ 208  180]]
Epoch 28, Phase test, Loss=0.7868, Acc=0.8495, AUC=0.7828, TPR=0.4812, TNR=0.9129, J=0.3941, MCC=0.3963, ConfusionMatrix=
[[1971  188]
 [ 193  179]]
Epoch 28 complete in 106.81

Epoch 29 starting with learning_rate: [0.005]
Epoch 29, Phase train, Loss=0.0394, Acc=0.9867, AUC=0.9988, TPR=0.9898, TNR=0.9836, J=0.9735, MCC=0.9734, ConfusionMatrix=
[[3607   60]
 [  37 3596]]
Epoch 29, Phase val, Loss=0.8662, Acc=0.8470, AUC=0.7624, TPR=0.3273, TNR=0.9397, J=0.2671, MCC=0.3181, ConfusionMatrix=
[[2043  131]
 [ 261  127]]
Epoch 29, Phase test, Loss=0.8839, Acc=0.8550, AUC=0.7421, TPR=0.3548, TNR=0.9412, J=0.2960, MCC=0.3458, ConfusionMatrix=
[[2032  127]
 [ 240  132]]
Epoch 29 complete in 100.75

Epoch 30 starting with learning_rate: [0.005]
Epoch 30, Phase train, Loss=0.0480, Acc=0.9858, AUC=0.9977, TPR=0.9893, TNR=0.9820, J=0.9713, MCC=0.9715, ConfusionMatrix=
[[3500   64]
 [  40 3696]]
Epoch 30, Phase val, Loss=0.8070, Acc=0.8419, AUC=0.7902, TPR=0.4459, TNR=0.9126, J=0.3585, MCC=0.3685, ConfusionMatrix=
[[1984  190]
 [ 215  173]]
Epoch 30, Phase test, Loss=0.8157, Acc=0.8459, AUC=0.7697, TPR=0.4785, TNR=0.9092, J=0.3877, MCC=0.3869, ConfusionMatrix=
[[1963  196]
 [ 194  178]]
Epoch 30 complete in 88.91

Early Stop!
Training complete in 49m 3s
The best model val AUC=0.803833259041, test AUC=0.77488208898.
Finish training resnet50-conv1x1ab-avgpool

Start training resnet50-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6078, Acc=0.6860, AUC=0.7492, TPR=0.8058, TNR=0.5688, J=0.3747, MCC=0.3852, ConfusionMatrix=
[[2099 1591]
 [ 701 2909]]
Epoch 0, Phase val, Loss=0.5601, Acc=0.7685, AUC=0.7426, TPR=0.6108, TNR=0.7967, J=0.4075, MCC=0.3310, ConfusionMatrix=
[[1732  442]
 [ 151  237]]
New Best AUC=0.7426. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5723, Acc=0.7290, AUC=0.7521, TPR=0.6559, TNR=0.7415, J=0.3975, MCC=0.3025, ConfusionMatrix=
[[1601  558]
 [ 128  244]]
Epoch 0 complete in 94.64

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4666, Acc=0.7836, AUC=0.8601, TPR=0.7359, TNR=0.8292, J=0.5651, MCC=0.5681, ConfusionMatrix=
[[3092  637]
 [ 943 2628]]
Epoch 1, Phase val, Loss=0.5149, Acc=0.7795, AUC=0.8109, TPR=0.6881, TNR=0.7958, J=0.4839, MCC=0.3874, ConfusionMatrix=
[[1730  444]
 [ 121  267]]
New Best AUC=0.8109. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5445, Acc=0.7507, AUC=0.7853, TPR=0.6935, TNR=0.7605, J=0.4541, MCC=0.3488, ConfusionMatrix=
[[1642  517]
 [ 114  258]]
Epoch 1 complete in 89.63

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4083, Acc=0.8162, AUC=0.8958, TPR=0.8066, TNR=0.8257, J=0.6323, MCC=0.6324, ConfusionMatrix=
[[3017  637]
 [ 705 2941]]
Epoch 2, Phase val, Loss=0.4866, Acc=0.7756, AUC=0.8015, TPR=0.6753, TNR=0.7935, J=0.4687, MCC=0.3753, ConfusionMatrix=
[[1725  449]
 [ 126  262]]
Epoch 2, Phase test, Loss=0.5104, Acc=0.7610, AUC=0.7853, TPR=0.6935, TNR=0.7726, J=0.4661, MCC=0.3616, ConfusionMatrix=
[[1668  491]
 [ 114  258]]
Epoch 2 complete in 96.64

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3352, Acc=0.8579, AUC=0.9299, TPR=0.8737, TNR=0.8422, J=0.7158, MCC=0.7162, ConfusionMatrix=
[[3068  575]
 [ 462 3195]]
Epoch 3, Phase val, Loss=0.6169, Acc=0.7639, AUC=0.7884, TPR=0.6804, TNR=0.7787, J=0.4592, MCC=0.3625, ConfusionMatrix=
[[1693  481]
 [ 124  264]]
Epoch 3, Phase test, Loss=0.6407, Acc=0.7479, AUC=0.7838, TPR=0.7070, TNR=0.7550, J=0.4620, MCC=0.3528, ConfusionMatrix=
[[1630  529]
 [ 109  263]]
Epoch 3 complete in 98.22

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3050, Acc=0.8751, AUC=0.9417, TPR=0.8904, TNR=0.8597, J=0.7501, MCC=0.7505, ConfusionMatrix=
[[3138  512]
 [ 400 3250]]
Epoch 4, Phase val, Loss=0.4948, Acc=0.8244, AUC=0.7953, TPR=0.6057, TNR=0.8634, J=0.4691, MCC=0.4145, ConfusionMatrix=
[[1877  297]
 [ 153  235]]
Epoch 4, Phase test, Loss=0.5435, Acc=0.7910, AUC=0.7580, TPR=0.5833, TNR=0.8268, J=0.4101, MCC=0.3432, ConfusionMatrix=
[[1785  374]
 [ 155  217]]
Epoch 4 complete in 91.18

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2806, Acc=0.8863, AUC=0.9498, TPR=0.9057, TNR=0.8670, J=0.7727, MCC=0.7732, ConfusionMatrix=
[[3175  487]
 [ 343 3295]]
Epoch 5, Phase val, Loss=0.5359, Acc=0.7904, AUC=0.7610, TPR=0.5387, TNR=0.8353, J=0.3740, MCC=0.3230, ConfusionMatrix=
[[1816  358]
 [ 179  209]]
Epoch 5, Phase test, Loss=0.5373, Acc=0.7886, AUC=0.7572, TPR=0.6075, TNR=0.8198, J=0.4274, MCC=0.3528, ConfusionMatrix=
[[1770  389]
 [ 146  226]]
Epoch 5 complete in 94.50

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2299, Acc=0.9115, AUC=0.9655, TPR=0.9317, TNR=0.8912, J=0.8229, MCC=0.8237, ConfusionMatrix=
[[3244  396]
 [ 250 3410]]
Epoch 6, Phase val, Loss=0.5601, Acc=0.8263, AUC=0.7733, TPR=0.4974, TNR=0.8850, J=0.3824, MCC=0.3625, ConfusionMatrix=
[[1924  250]
 [ 195  193]]
Epoch 6, Phase test, Loss=0.5406, Acc=0.8372, AUC=0.7704, TPR=0.5376, TNR=0.8888, J=0.4265, MCC=0.3985, ConfusionMatrix=
[[1919  240]
 [ 172  200]]
Epoch 6 complete in 88.70

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2211, Acc=0.9119, AUC=0.9689, TPR=0.9272, TNR=0.8969, J=0.8241, MCC=0.8243, ConfusionMatrix=
[[3306  380]
 [ 263 3351]]
Epoch 7, Phase val, Loss=0.5118, Acc=0.8388, AUC=0.7856, TPR=0.4948, TNR=0.9002, J=0.3950, MCC=0.3866, ConfusionMatrix=
[[1957  217]
 [ 196  192]]
Epoch 7, Phase test, Loss=0.5174, Acc=0.8471, AUC=0.7548, TPR=0.5215, TNR=0.9032, J=0.4247, MCC=0.4110, ConfusionMatrix=
[[1950  209]
 [ 178  194]]
Epoch 7 complete in 99.55

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1793, Acc=0.9332, AUC=0.9785, TPR=0.9475, TNR=0.9189, J=0.8664, MCC=0.8667, ConfusionMatrix=
[[3364  297]
 [ 191 3448]]
Epoch 8, Phase val, Loss=0.6075, Acc=0.8173, AUC=0.8002, TPR=0.5799, TNR=0.8597, J=0.4396, MCC=0.3891, ConfusionMatrix=
[[1869  305]
 [ 163  225]]
Epoch 8, Phase test, Loss=0.6382, Acc=0.8186, AUC=0.7657, TPR=0.5914, TNR=0.8578, J=0.4492, MCC=0.3917, ConfusionMatrix=
[[1852  307]
 [ 152  220]]
Epoch 8 complete in 89.43

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1639, Acc=0.9378, AUC=0.9823, TPR=0.9493, TNR=0.9264, J=0.8757, MCC=0.8759, ConfusionMatrix=
[[3400  270]
 [ 184 3446]]
Epoch 9, Phase val, Loss=0.5770, Acc=0.8322, AUC=0.7973, TPR=0.5232, TNR=0.8873, J=0.4105, MCC=0.3874, ConfusionMatrix=
[[1929  245]
 [ 185  203]]
Epoch 9, Phase test, Loss=0.6060, Acc=0.8495, AUC=0.7612, TPR=0.4892, TNR=0.9115, J=0.4008, MCC=0.4003, ConfusionMatrix=
[[1968  191]
 [ 190  182]]
Epoch 9 complete in 99.61

Early Stop!
Training complete in 15m 42s
The best model val AUC=0.810887100598, test AUC=0.785307938263.
Finish training resnet50-conv1x1ab-avgpool

Start training resnet50-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6006, Acc=0.6800, AUC=0.7498, TPR=0.7583, TNR=0.6039, J=0.3622, MCC=0.3662, ConfusionMatrix=
[[2235 1466]
 [ 870 2729]]
Epoch 0, Phase val, Loss=0.5802, Acc=0.7322, AUC=0.7837, TPR=0.7165, TNR=0.7351, J=0.4515, MCC=0.3434, ConfusionMatrix=
[[1598  576]
 [ 110  278]]
New Best AUC=0.7837. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6309, Acc=0.6914, AUC=0.7609, TPR=0.7070, TNR=0.6887, J=0.3957, MCC=0.2903, ConfusionMatrix=
[[1487  672]
 [ 109  263]]
Epoch 0 complete in 101.99

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4634, Acc=0.7852, AUC=0.8625, TPR=0.7558, TNR=0.8147, J=0.5704, MCC=0.5714, ConfusionMatrix=
[[2972  676]
 [ 892 2760]]
Epoch 1, Phase val, Loss=0.5544, Acc=0.7463, AUC=0.7912, TPR=0.7113, TNR=0.7525, J=0.4639, MCC=0.3572, ConfusionMatrix=
[[1636  538]
 [ 112  276]]
New Best AUC=0.7912. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5828, Acc=0.7294, AUC=0.7922, TPR=0.7473, TNR=0.7263, J=0.4736, MCC=0.3532, ConfusionMatrix=
[[1568  591]
 [  94  278]]
Epoch 1 complete in 90.44

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.3980, Acc=0.8219, AUC=0.9010, TPR=0.8088, TNR=0.8349, J=0.6436, MCC=0.6439, ConfusionMatrix=
[[3069  607]
 [ 693 2931]]
Epoch 2, Phase val, Loss=0.4801, Acc=0.8044, AUC=0.7852, TPR=0.6057, TNR=0.8399, J=0.4456, MCC=0.3810, ConfusionMatrix=
[[1826  348]
 [ 153  235]]
Epoch 2, Phase test, Loss=0.4861, Acc=0.8017, AUC=0.7876, TPR=0.6344, TNR=0.8305, J=0.4649, MCC=0.3866, ConfusionMatrix=
[[1793  366]
 [ 136  236]]
Epoch 2 complete in 100.17

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3313, Acc=0.8621, AUC=0.9322, TPR=0.8665, TNR=0.8576, J=0.7241, MCC=0.7241, ConfusionMatrix=
[[3119  518]
 [ 489 3174]]
Epoch 3, Phase val, Loss=0.5215, Acc=0.7920, AUC=0.7826, TPR=0.6057, TNR=0.8252, J=0.4309, MCC=0.3616, ConfusionMatrix=
[[1794  380]
 [ 153  235]]
Epoch 3, Phase test, Loss=0.5521, Acc=0.7807, AUC=0.7631, TPR=0.6237, TNR=0.8078, J=0.4314, MCC=0.3502, ConfusionMatrix=
[[1744  415]
 [ 140  232]]
Epoch 3 complete in 88.62

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.2925, Acc=0.8797, AUC=0.9469, TPR=0.8923, TNR=0.8670, J=0.7593, MCC=0.7596, ConfusionMatrix=
[[3149  483]
 [ 395 3273]]
Epoch 4, Phase val, Loss=0.5256, Acc=0.8232, AUC=0.7679, TPR=0.4562, TNR=0.8887, J=0.3449, MCC=0.3343, ConfusionMatrix=
[[1932  242]
 [ 211  177]]
Epoch 4, Phase test, Loss=0.5038, Acc=0.8360, AUC=0.7734, TPR=0.5376, TNR=0.8874, J=0.4251, MCC=0.3961, ConfusionMatrix=
[[1916  243]
 [ 172  200]]
Epoch 4 complete in 92.24

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2803, Acc=0.8851, AUC=0.9505, TPR=0.8986, TNR=0.8716, J=0.7702, MCC=0.7704, ConfusionMatrix=
[[3190  470]
 [ 369 3271]]
Epoch 5, Phase val, Loss=0.5146, Acc=0.8158, AUC=0.7829, TPR=0.5593, TNR=0.8615, J=0.4208, MCC=0.3756, ConfusionMatrix=
[[1873  301]
 [ 171  217]]
Epoch 5, Phase test, Loss=0.5270, Acc=0.8202, AUC=0.7674, TPR=0.6156, TNR=0.8555, J=0.4711, MCC=0.4069, ConfusionMatrix=
[[1847  312]
 [ 143  229]]
Epoch 5 complete in 88.41

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2310, Acc=0.9081, AUC=0.9657, TPR=0.9266, TNR=0.8893, J=0.8159, MCC=0.8166, ConfusionMatrix=
[[3221  401]
 [ 270 3408]]
Epoch 6, Phase val, Loss=0.5940, Acc=0.7931, AUC=0.7710, TPR=0.5876, TNR=0.8298, J=0.4174, MCC=0.3538, ConfusionMatrix=
[[1804  370]
 [ 160  228]]
Epoch 6, Phase test, Loss=0.5867, Acc=0.8151, AUC=0.7742, TPR=0.6237, TNR=0.8481, J=0.4717, MCC=0.4024, ConfusionMatrix=
[[1831  328]
 [ 140  232]]
Epoch 6 complete in 97.15

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2194, Acc=0.9158, AUC=0.9686, TPR=0.9291, TNR=0.9022, J=0.8313, MCC=0.8317, ConfusionMatrix=
[[3265  354]
 [ 261 3420]]
Epoch 7, Phase val, Loss=0.5770, Acc=0.8450, AUC=0.7573, TPR=0.4021, TNR=0.9241, J=0.3262, MCC=0.3532, ConfusionMatrix=
[[2009  165]
 [ 232  156]]
Epoch 7, Phase test, Loss=0.5248, Acc=0.8625, AUC=0.7711, TPR=0.4677, TNR=0.9305, J=0.3983, MCC=0.4221, ConfusionMatrix=
[[2009  150]
 [ 198  174]]
Epoch 7 complete in 91.81

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1754, Acc=0.9330, AUC=0.9797, TPR=0.9464, TNR=0.9195, J=0.8660, MCC=0.8663, ConfusionMatrix=
[[3347  293]
 [ 196 3464]]
Epoch 8, Phase val, Loss=0.6120, Acc=0.8201, AUC=0.7728, TPR=0.4897, TNR=0.8790, J=0.3687, MCC=0.3465, ConfusionMatrix=
[[1911  263]
 [ 198  190]]
Epoch 8, Phase test, Loss=0.6106, Acc=0.8337, AUC=0.7642, TPR=0.5215, TNR=0.8874, J=0.4090, MCC=0.3831, ConfusionMatrix=
[[1916  243]
 [ 178  194]]
Epoch 8 complete in 89.35

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1739, Acc=0.9311, AUC=0.9799, TPR=0.9437, TNR=0.9188, J=0.8625, MCC=0.8625, ConfusionMatrix=
[[3395  300]
 [ 203 3402]]
Epoch 9, Phase val, Loss=0.6002, Acc=0.8072, AUC=0.8087, TPR=0.6160, TNR=0.8413, J=0.4573, MCC=0.3908, ConfusionMatrix=
[[1829  345]
 [ 149  239]]
New Best AUC=0.8087. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.6091, Acc=0.8159, AUC=0.7820, TPR=0.6478, TNR=0.8448, J=0.4927, MCC=0.4161, ConfusionMatrix=
[[1824  335]
 [ 131  241]]
Epoch 9 complete in 95.32

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.1594, Acc=0.9436, AUC=0.9825, TPR=0.9582, TNR=0.9286, J=0.8868, MCC=0.8874, ConfusionMatrix=
[[3357  258]
 [ 154 3531]]
Epoch 10, Phase val, Loss=0.6552, Acc=0.8185, AUC=0.7624, TPR=0.4485, TNR=0.8845, J=0.3330, MCC=0.3209, ConfusionMatrix=
[[1923  251]
 [ 214  174]]
Epoch 10, Phase test, Loss=0.6259, Acc=0.8305, AUC=0.7672, TPR=0.5161, TNR=0.8847, J=0.4008, MCC=0.3741, ConfusionMatrix=
[[1910  249]
 [ 180  192]]
Epoch 10 complete in 89.22

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.1415, Acc=0.9463, AUC=0.9868, TPR=0.9575, TNR=0.9350, J=0.8925, MCC=0.8928, ConfusionMatrix=
[[3392  236]
 [ 156 3516]]
Epoch 11, Phase val, Loss=0.6432, Acc=0.8294, AUC=0.7563, TPR=0.4562, TNR=0.8960, J=0.3522, MCC=0.3468, ConfusionMatrix=
[[1948  226]
 [ 211  177]]
Epoch 11, Phase test, Loss=0.5907, Acc=0.8530, AUC=0.7739, TPR=0.5188, TNR=0.9106, J=0.4294, MCC=0.4229, ConfusionMatrix=
[[1966  193]
 [ 179  193]]
Epoch 11 complete in 102.00

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.1122, Acc=0.9582, AUC=0.9915, TPR=0.9674, TNR=0.9487, J=0.9161, MCC=0.9165, ConfusionMatrix=
[[3400  184]
 [ 121 3595]]
Epoch 12, Phase val, Loss=0.6996, Acc=0.8357, AUC=0.7797, TPR=0.4691, TNR=0.9011, J=0.3702, MCC=0.3667, ConfusionMatrix=
[[1959  215]
 [ 206  182]]
Epoch 12, Phase test, Loss=0.7138, Acc=0.8447, AUC=0.7671, TPR=0.5215, TNR=0.9004, J=0.4219, MCC=0.4059, ConfusionMatrix=
[[1944  215]
 [ 178  194]]
Epoch 12 complete in 92.54

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.1300, Acc=0.9534, AUC=0.9887, TPR=0.9613, TNR=0.9453, J=0.9065, MCC=0.9069, ConfusionMatrix=
[[3384  196]
 [ 144 3576]]
Epoch 13, Phase val, Loss=0.5796, Acc=0.8368, AUC=0.7887, TPR=0.4021, TNR=0.9144, J=0.3165, MCC=0.3336, ConfusionMatrix=
[[1988  186]
 [ 232  156]]
Epoch 13, Phase test, Loss=0.6215, Acc=0.8503, AUC=0.7618, TPR=0.4677, TNR=0.9162, J=0.3839, MCC=0.3915, ConfusionMatrix=
[[1978  181]
 [ 198  174]]
Epoch 13 complete in 98.01

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.1224, Acc=0.9551, AUC=0.9896, TPR=0.9636, TNR=0.9467, J=0.9103, MCC=0.9103, ConfusionMatrix=
[[3479  196]
 [ 132 3493]]
Epoch 14, Phase val, Loss=0.6815, Acc=0.8423, AUC=0.7404, TPR=0.3273, TNR=0.9342, J=0.2615, MCC=0.3054, ConfusionMatrix=
[[2031  143]
 [ 261  127]]
Epoch 14, Phase test, Loss=0.6084, Acc=0.8589, AUC=0.7600, TPR=0.4086, TNR=0.9365, J=0.3451, MCC=0.3843, ConfusionMatrix=
[[2022  137]
 [ 220  152]]
Epoch 14 complete in 88.25

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.0865, Acc=0.9701, AUC=0.9943, TPR=0.9767, TNR=0.9633, J=0.9400, MCC=0.9403, ConfusionMatrix=
[[3443  131]
 [  87 3639]]
Epoch 15, Phase val, Loss=0.6843, Acc=0.8384, AUC=0.7656, TPR=0.3479, TNR=0.9259, J=0.2739, MCC=0.3071, ConfusionMatrix=
[[2013  161]
 [ 253  135]]
Epoch 15, Phase test, Loss=0.6577, Acc=0.8526, AUC=0.7585, TPR=0.4274, TNR=0.9259, J=0.3533, MCC=0.3769, ConfusionMatrix=
[[1999  160]
 [ 213  159]]
Epoch 15 complete in 98.49

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.0954, Acc=0.9674, AUC=0.9931, TPR=0.9739, TNR=0.9608, J=0.9347, MCC=0.9349, ConfusionMatrix=
[[3480  142]
 [  96 3582]]
Epoch 16, Phase val, Loss=0.7477, Acc=0.8521, AUC=0.7659, TPR=0.3557, TNR=0.9407, J=0.2963, MCC=0.3477, ConfusionMatrix=
[[2045  129]
 [ 250  138]]
Epoch 16, Phase test, Loss=0.7354, Acc=0.8593, AUC=0.7506, TPR=0.4301, TNR=0.9333, J=0.3634, MCC=0.3958, ConfusionMatrix=
[[2015  144]
 [ 212  160]]
Epoch 16 complete in 95.45

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.0771, Acc=0.9744, AUC=0.9952, TPR=0.9808, TNR=0.9682, J=0.9490, MCC=0.9489, ConfusionMatrix=
[[3587  118]
 [  69 3526]]
Epoch 17, Phase val, Loss=0.7490, Acc=0.8267, AUC=0.7746, TPR=0.4021, TNR=0.9025, J=0.3045, MCC=0.3113, ConfusionMatrix=
[[1962  212]
 [ 232  156]]
Epoch 17, Phase test, Loss=0.6729, Acc=0.8597, AUC=0.7759, TPR=0.5188, TNR=0.9185, J=0.4373, MCC=0.4388, ConfusionMatrix=
[[1983  176]
 [ 179  193]]
Epoch 17 complete in 90.67

Early Stop!
Training complete in 28m 10s
The best model val AUC=0.808701002475, test AUC=0.782033946421.
Finish training resnet50-conv1x1ab-avgpool

Start training resnet50-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6122, Acc=0.6568, AUC=0.7297, TPR=0.7792, TNR=0.5355, J=0.3146, MCC=0.3243, ConfusionMatrix=
[[1962 1702]
 [ 803 2833]]
Epoch 0, Phase val, Loss=0.8621, Acc=0.5472, AUC=0.7764, TPR=0.8531, TNR=0.4926, J=0.3457, MCC=0.2497, ConfusionMatrix=
[[1071 1103]
 [  57  331]]
New Best AUC=0.7764. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.9005, Acc=0.5069, AUC=0.7588, TPR=0.8441, TNR=0.4488, J=0.2929, MCC=0.2112, ConfusionMatrix=
[[ 969 1190]
 [  58  314]]
Epoch 0 complete in 103.88

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4750, Acc=0.7836, AUC=0.8549, TPR=0.7417, TNR=0.8241, J=0.5658, MCC=0.5681, ConfusionMatrix=
[[3055  652]
 [ 928 2665]]
Epoch 1, Phase val, Loss=0.4352, Acc=0.8255, AUC=0.7913, TPR=0.5103, TNR=0.8818, J=0.3921, MCC=0.3678, ConfusionMatrix=
[[1917  257]
 [ 190  198]]
New Best AUC=0.7913. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4455, Acc=0.8190, AUC=0.7833, TPR=0.5538, TNR=0.8648, J=0.4185, MCC=0.3728, ConfusionMatrix=
[[1867  292]
 [ 166  206]]
Epoch 1 complete in 90.10

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4049, Acc=0.8221, AUC=0.8977, TPR=0.7997, TNR=0.8438, J=0.6434, MCC=0.6443, ConfusionMatrix=
[[3127  579]
 [ 720 2874]]
Epoch 2, Phase val, Loss=0.5161, Acc=0.7881, AUC=0.8078, TPR=0.6933, TNR=0.8050, J=0.4983, MCC=0.4021, ConfusionMatrix=
[[1750  424]
 [ 119  269]]
New Best AUC=0.8078. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5287, Acc=0.7783, AUC=0.7929, TPR=0.6747, TNR=0.7962, J=0.4709, MCC=0.3743, ConfusionMatrix=
[[1719  440]
 [ 121  251]]
Epoch 2 complete in 97.49

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3493, Acc=0.8540, AUC=0.9246, TPR=0.8580, TNR=0.8499, J=0.7078, MCC=0.7079, ConfusionMatrix=
[[3057  540]
 [ 526 3177]]
Epoch 3, Phase val, Loss=0.6501, Acc=0.7162, AUC=0.7690, TPR=0.6959, TNR=0.7199, J=0.4157, MCC=0.3139, ConfusionMatrix=
[[1565  609]
 [ 118  270]]
Epoch 3, Phase test, Loss=0.6993, Acc=0.6875, AUC=0.7492, TPR=0.6801, TNR=0.6887, J=0.3689, MCC=0.2712, ConfusionMatrix=
[[1487  672]
 [ 119  253]]
Epoch 3 complete in 92.60

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3096, Acc=0.8733, AUC=0.9410, TPR=0.8803, TNR=0.8665, J=0.7469, MCC=0.7467, ConfusionMatrix=
[[3226  497]
 [ 428 3149]]
Epoch 4, Phase val, Loss=0.4794, Acc=0.8228, AUC=0.7469, TPR=0.4407, TNR=0.8910, J=0.3317, MCC=0.3250, ConfusionMatrix=
[[1937  237]
 [ 217  171]]
Epoch 4, Phase test, Loss=0.4637, Acc=0.8218, AUC=0.7416, TPR=0.4866, TNR=0.8796, J=0.3661, MCC=0.3418, ConfusionMatrix=
[[1899  260]
 [ 191  181]]
Epoch 4 complete in 89.43

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2677, Acc=0.8899, AUC=0.9552, TPR=0.9008, TNR=0.8791, J=0.7799, MCC=0.7800, ConfusionMatrix=
[[3236  445]
 [ 359 3260]]
Epoch 5, Phase val, Loss=0.5092, Acc=0.8048, AUC=0.7705, TPR=0.5696, TNR=0.8468, J=0.4164, MCC=0.3626, ConfusionMatrix=
[[1841  333]
 [ 167  221]]
Epoch 5, Phase test, Loss=0.5234, Acc=0.7961, AUC=0.7669, TPR=0.5860, TNR=0.8323, J=0.4184, MCC=0.3524, ConfusionMatrix=
[[1797  362]
 [ 154  218]]
Epoch 5 complete in 99.52

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2390, Acc=0.9058, AUC=0.9642, TPR=0.9195, TNR=0.8920, J=0.8115, MCC=0.8118, ConfusionMatrix=
[[3254  394]
 [ 294 3358]]
Epoch 6, Phase val, Loss=0.5043, Acc=0.8400, AUC=0.7975, TPR=0.4742, TNR=0.9052, J=0.3795, MCC=0.3787, ConfusionMatrix=
[[1968  206]
 [ 204  184]]
Epoch 6, Phase test, Loss=0.5072, Acc=0.8483, AUC=0.7705, TPR=0.4973, TNR=0.9088, J=0.4061, MCC=0.4016, ConfusionMatrix=
[[1962  197]
 [ 187  185]]
Epoch 6 complete in 91.84

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2122, Acc=0.9185, AUC=0.9714, TPR=0.9280, TNR=0.9088, J=0.8368, MCC=0.8371, ConfusionMatrix=
[[3278  329]
 [ 266 3427]]
Epoch 7, Phase val, Loss=0.5716, Acc=0.8286, AUC=0.7769, TPR=0.4742, TNR=0.8919, J=0.3661, MCC=0.3549, ConfusionMatrix=
[[1939  235]
 [ 204  184]]
Epoch 7, Phase test, Loss=0.5844, Acc=0.8289, AUC=0.7525, TPR=0.5108, TNR=0.8837, J=0.3945, MCC=0.3683, ConfusionMatrix=
[[1908  251]
 [ 182  190]]
Epoch 7 complete in 98.02

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1860, Acc=0.9292, AUC=0.9774, TPR=0.9412, TNR=0.9172, J=0.8584, MCC=0.8586, ConfusionMatrix=
[[3357  303]
 [ 214 3426]]
Epoch 8, Phase val, Loss=0.7470, Acc=0.7884, AUC=0.7928, TPR=0.6495, TNR=0.8132, J=0.4627, MCC=0.3797, ConfusionMatrix=
[[1768  406]
 [ 136  252]]
Epoch 8, Phase test, Loss=0.7363, Acc=0.7855, AUC=0.7723, TPR=0.6290, TNR=0.8124, J=0.4414, MCC=0.3598, ConfusionMatrix=
[[1754  405]
 [ 138  234]]
Epoch 8 complete in 89.04

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1630, Acc=0.9386, AUC=0.9821, TPR=0.9530, TNR=0.9242, J=0.8772, MCC=0.8776, ConfusionMatrix=
[[3366  276]
 [ 172 3486]]
Epoch 9, Phase val, Loss=0.6658, Acc=0.7974, AUC=0.7730, TPR=0.5619, TNR=0.8395, J=0.4013, MCC=0.3466, ConfusionMatrix=
[[1825  349]
 [ 170  218]]
Epoch 9, Phase test, Loss=0.6810, Acc=0.7930, AUC=0.7523, TPR=0.5565, TNR=0.8337, J=0.3902, MCC=0.3316, ConfusionMatrix=
[[1800  359]
 [ 165  207]]
Epoch 9 complete in 96.25

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.1589, Acc=0.9410, AUC=0.9825, TPR=0.9516, TNR=0.9303, J=0.8819, MCC=0.8821, ConfusionMatrix=
[[3388  254]
 [ 177 3481]]
Epoch 10, Phase val, Loss=0.5924, Acc=0.8146, AUC=0.7632, TPR=0.4072, TNR=0.8873, J=0.2945, MCC=0.2900, ConfusionMatrix=
[[1929  245]
 [ 230  158]]
Epoch 10, Phase test, Loss=0.5841, Acc=0.8289, AUC=0.7593, TPR=0.4758, TNR=0.8898, J=0.3656, MCC=0.3496, ConfusionMatrix=
[[1921  238]
 [ 195  177]]
Epoch 10 complete in 88.63

Early Stop!
Training complete in 17m 17s
The best model val AUC=0.807753772323, test AUC=0.792864453376.
Finish training resnet50-conv1x1ab-avgpool

Start training resnet50-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5925, Acc=0.6842, AUC=0.7502, TPR=0.6825, TNR=0.6860, J=0.3685, MCC=0.3685, ConfusionMatrix=
[[2495 1142]
 [1163 2500]]
Epoch 0, Phase val, Loss=0.5465, Acc=0.7603, AUC=0.7805, TPR=0.6804, TNR=0.7746, J=0.4550, MCC=0.3579, ConfusionMatrix=
[[1684  490]
 [ 124  264]]
New Best AUC=0.7805. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5751, Acc=0.7384, AUC=0.7586, TPR=0.6962, TNR=0.7457, J=0.4420, MCC=0.3357, ConfusionMatrix=
[[1610  549]
 [ 113  259]]
Epoch 0 complete in 95.22

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4925, Acc=0.7710, AUC=0.8429, TPR=0.7302, TNR=0.8105, J=0.5407, MCC=0.5428, ConfusionMatrix=
[[3003  702]
 [ 970 2625]]
Epoch 1, Phase val, Loss=0.5620, Acc=0.7389, AUC=0.8066, TPR=0.7397, TNR=0.7387, J=0.4784, MCC=0.3637, ConfusionMatrix=
[[1606  568]
 [ 101  287]]
New Best AUC=0.8066. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5947, Acc=0.7108, AUC=0.7950, TPR=0.7285, TNR=0.7077, J=0.4362, MCC=0.3225, ConfusionMatrix=
[[1528  631]
 [ 101  271]]
Epoch 1 complete in 100.32

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4453, Acc=0.8022, AUC=0.8740, TPR=0.7964, TNR=0.8079, J=0.6044, MCC=0.6044, ConfusionMatrix=
[[2957  703]
 [ 741 2899]]
Epoch 2, Phase val, Loss=0.4279, Acc=0.8224, AUC=0.7868, TPR=0.5799, TNR=0.8657, J=0.4456, MCC=0.3980, ConfusionMatrix=
[[1882  292]
 [ 163  225]]
Epoch 2, Phase test, Loss=0.4425, Acc=0.8210, AUC=0.7740, TPR=0.6317, TNR=0.8536, J=0.4854, MCC=0.4164, ConfusionMatrix=
[[1843  316]
 [ 137  235]]
Epoch 2 complete in 88.35

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4304, Acc=0.8152, AUC=0.8836, TPR=0.8086, TNR=0.8218, J=0.6304, MCC=0.6305, ConfusionMatrix=
[[2993  649]
 [ 700 2958]]
Epoch 3, Phase val, Loss=0.4061, Acc=0.8236, AUC=0.8001, TPR=0.5464, TNR=0.8730, J=0.4194, MCC=0.3829, ConfusionMatrix=
[[1898  276]
 [ 176  212]]
Epoch 3, Phase test, Loss=0.4044, Acc=0.8376, AUC=0.7875, TPR=0.5995, TNR=0.8786, J=0.4781, MCC=0.4301, ConfusionMatrix=
[[1897  262]
 [ 149  223]]
Epoch 3 complete in 99.51

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4057, Acc=0.8290, AUC=0.8973, TPR=0.8394, TNR=0.8189, J=0.6584, MCC=0.6583, ConfusionMatrix=
[[3030  670]
 [ 578 3022]]
Epoch 4, Phase val, Loss=0.4441, Acc=0.8119, AUC=0.8169, TPR=0.6134, TNR=0.8473, J=0.4607, MCC=0.3971, ConfusionMatrix=
[[1842  332]
 [ 150  238]]
New Best AUC=0.8169. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4640, Acc=0.8080, AUC=0.7925, TPR=0.6532, TNR=0.8346, J=0.4879, MCC=0.4062, ConfusionMatrix=
[[1802  357]
 [ 129  243]]
Epoch 4 complete in 89.22

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3851, Acc=0.8347, AUC=0.9075, TPR=0.8378, TNR=0.8316, J=0.6694, MCC=0.6693, ConfusionMatrix=
[[3067  621]
 [ 586 3026]]
Epoch 5, Phase val, Loss=0.4083, Acc=0.8220, AUC=0.7882, TPR=0.4948, TNR=0.8804, J=0.3753, MCC=0.3529, ConfusionMatrix=
[[1914  260]
 [ 196  192]]
Epoch 5, Phase test, Loss=0.4267, Acc=0.8297, AUC=0.7633, TPR=0.5484, TNR=0.8782, J=0.4266, MCC=0.3894, ConfusionMatrix=
[[1896  263]
 [ 168  204]]
Epoch 5 complete in 91.88

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3564, Acc=0.8537, AUC=0.9209, TPR=0.8638, TNR=0.8436, J=0.7074, MCC=0.7075, ConfusionMatrix=
[[3080  571]
 [ 497 3152]]
Epoch 6, Phase val, Loss=0.4596, Acc=0.8275, AUC=0.7786, TPR=0.5567, TNR=0.8758, J=0.4325, MCC=0.3955, ConfusionMatrix=
[[1904  270]
 [ 172  216]]
Epoch 6, Phase test, Loss=0.4783, Acc=0.8214, AUC=0.7652, TPR=0.5968, TNR=0.8601, J=0.4569, MCC=0.3993, ConfusionMatrix=
[[1857  302]
 [ 150  222]]
Epoch 6 complete in 87.54

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3265, Acc=0.8660, AUC=0.9327, TPR=0.8932, TNR=0.8377, J=0.7309, MCC=0.7326, ConfusionMatrix=
[[2993  580]
 [ 398 3329]]
Epoch 7, Phase val, Loss=0.5778, Acc=0.7479, AUC=0.7913, TPR=0.6649, TNR=0.7626, J=0.4276, MCC=0.3338, ConfusionMatrix=
[[1658  516]
 [ 130  258]]
Epoch 7, Phase test, Loss=0.6329, Acc=0.7290, AUC=0.7732, TPR=0.6962, TNR=0.7346, J=0.4308, MCC=0.3248, ConfusionMatrix=
[[1586  573]
 [ 113  259]]
Epoch 7 complete in 97.39

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3263, Acc=0.8688, AUC=0.9331, TPR=0.8924, TNR=0.8446, J=0.7370, MCC=0.7381, ConfusionMatrix=
[[3049  561]
 [ 397 3293]]
Epoch 8, Phase val, Loss=0.4596, Acc=0.8095, AUC=0.7965, TPR=0.6082, TNR=0.8454, J=0.4537, MCC=0.3906, ConfusionMatrix=
[[1838  336]
 [ 152  236]]
Epoch 8, Phase test, Loss=0.4718, Acc=0.8080, AUC=0.7756, TPR=0.6290, TNR=0.8388, J=0.4678, MCC=0.3937, ConfusionMatrix=
[[1811  348]
 [ 138  234]]
Epoch 8 complete in 87.58

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2934, Acc=0.8868, AUC=0.9456, TPR=0.9121, TNR=0.8617, J=0.7738, MCC=0.7747, ConfusionMatrix=
[[3153  506]
 [ 320 3321]]
Epoch 9, Phase val, Loss=0.6004, Acc=0.7806, AUC=0.7834, TPR=0.6340, TNR=0.8068, J=0.4408, MCC=0.3603, ConfusionMatrix=
[[1754  420]
 [ 142  246]]
Epoch 9, Phase test, Loss=0.6211, Acc=0.7704, AUC=0.7909, TPR=0.6613, TNR=0.7893, J=0.4505, MCC=0.3565, ConfusionMatrix=
[[1704  455]
 [ 126  246]]
Epoch 9 complete in 92.94

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2854, Acc=0.8845, AUC=0.9478, TPR=0.8998, TNR=0.8700, J=0.7698, MCC=0.7696, ConfusionMatrix=
[[3260  487]
 [ 356 3197]]
Epoch 10, Phase val, Loss=0.5096, Acc=0.7978, AUC=0.7885, TPR=0.6057, TNR=0.8321, J=0.4378, MCC=0.3706, ConfusionMatrix=
[[1809  365]
 [ 153  235]]
Epoch 10, Phase test, Loss=0.5581, Acc=0.7839, AUC=0.7693, TPR=0.6398, TNR=0.8087, J=0.4485, MCC=0.3633, ConfusionMatrix=
[[1746  413]
 [ 134  238]]
Epoch 10 complete in 87.77

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2716, Acc=0.8938, AUC=0.9529, TPR=0.9201, TNR=0.8669, J=0.7870, MCC=0.7885, ConfusionMatrix=
[[3126  480]
 [ 295 3399]]
Epoch 11, Phase val, Loss=0.6218, Acc=0.7553, AUC=0.7842, TPR=0.6856, TNR=0.7677, J=0.4533, MCC=0.3543, ConfusionMatrix=
[[1669  505]
 [ 122  266]]
Epoch 11, Phase test, Loss=0.6644, Acc=0.7420, AUC=0.7735, TPR=0.6962, TNR=0.7499, J=0.4461, MCC=0.3399, ConfusionMatrix=
[[1619  540]
 [ 113  259]]
Epoch 11 complete in 93.97

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.2523, Acc=0.9042, AUC=0.9585, TPR=0.9279, TNR=0.8812, J=0.8091, MCC=0.8096, ConfusionMatrix=
[[3256  439]
 [ 260 3345]]
Epoch 12, Phase val, Loss=0.5066, Acc=0.8177, AUC=0.7183, TPR=0.3789, TNR=0.8960, J=0.2749, MCC=0.2794, ConfusionMatrix=
[[1948  226]
 [ 241  147]]
Epoch 12, Phase test, Loss=0.4996, Acc=0.8301, AUC=0.7262, TPR=0.4355, TNR=0.8981, J=0.3336, MCC=0.3300, ConfusionMatrix=
[[1939  220]
 [ 210  162]]
Epoch 12 complete in 95.56

Early Stop!
Training complete in 20m 7s
The best model val AUC=0.816881087643, test AUC=0.792469133958.
Finish training resnet50-conv1x1-maxpool

Start training resnet50-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6011, Acc=0.6607, AUC=0.7315, TPR=0.6720, TNR=0.6496, J=0.3217, MCC=0.3217, ConfusionMatrix=
[[2401 1295]
 [1182 2422]]
Epoch 0, Phase val, Loss=0.5591, Acc=0.7100, AUC=0.7876, TPR=0.6985, TNR=0.7121, J=0.4105, MCC=0.3085, ConfusionMatrix=
[[1548  626]
 [ 117  271]]
New Best AUC=0.7876. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5847, Acc=0.6922, AUC=0.7712, TPR=0.7016, TNR=0.6906, J=0.3922, MCC=0.2881, ConfusionMatrix=
[[1491  668]
 [ 111  261]]
Epoch 0 complete in 94.19

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4752, Acc=0.7748, AUC=0.8536, TPR=0.7191, TNR=0.8294, J=0.5485, MCC=0.5522, ConfusionMatrix=
[[3058  629]
 [1015 2598]]
Epoch 1, Phase val, Loss=0.4507, Acc=0.8333, AUC=0.7846, TPR=0.5232, TNR=0.8887, J=0.4119, MCC=0.3897, ConfusionMatrix=
[[1932  242]
 [ 185  203]]
Epoch 1, Phase test, Loss=0.4528, Acc=0.8309, AUC=0.7800, TPR=0.5968, TNR=0.8712, J=0.4680, MCC=0.4162, ConfusionMatrix=
[[1881  278]
 [ 150  222]]
Epoch 1 complete in 94.58

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4461, Acc=0.8005, AUC=0.8747, TPR=0.7889, TNR=0.8124, J=0.6013, MCC=0.6014, ConfusionMatrix=
[[2940  679]
 [ 777 2904]]
Epoch 2, Phase val, Loss=0.4511, Acc=0.8044, AUC=0.7913, TPR=0.6031, TNR=0.8404, J=0.4435, MCC=0.3797, ConfusionMatrix=
[[1827  347]
 [ 154  234]]
New Best AUC=0.7913. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4617, Acc=0.8072, AUC=0.7786, TPR=0.6129, TNR=0.8407, J=0.4536, MCC=0.3840, ConfusionMatrix=
[[1815  344]
 [ 144  228]]
Epoch 2 complete in 91.63

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4217, Acc=0.8185, AUC=0.8885, TPR=0.8169, TNR=0.8201, J=0.6370, MCC=0.6370, ConfusionMatrix=
[[2977  653]
 [ 672 2998]]
Epoch 3, Phase val, Loss=0.4620, Acc=0.8173, AUC=0.7894, TPR=0.5412, TNR=0.8666, J=0.4078, MCC=0.3689, ConfusionMatrix=
[[1884  290]
 [ 178  210]]
Epoch 3, Phase test, Loss=0.4899, Acc=0.8202, AUC=0.7834, TPR=0.6129, TNR=0.8560, J=0.4689, MCC=0.4055, ConfusionMatrix=
[[1848  311]
 [ 144  228]]
Epoch 3 complete in 98.16

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3882, Acc=0.8374, AUC=0.9066, TPR=0.8342, TNR=0.8405, J=0.6748, MCC=0.6748, ConfusionMatrix=
[[3073  583]
 [ 604 3040]]
Epoch 4, Phase val, Loss=0.5625, Acc=0.7931, AUC=0.7705, TPR=0.6521, TNR=0.8183, J=0.4704, MCC=0.3879, ConfusionMatrix=
[[1779  395]
 [ 135  253]]
Epoch 4, Phase test, Loss=0.5860, Acc=0.7843, AUC=0.7911, TPR=0.6855, TNR=0.8013, J=0.4868, MCC=0.3881, ConfusionMatrix=
[[1730  429]
 [ 117  255]]
Epoch 4 complete in 87.60

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3685, Acc=0.8466, AUC=0.9164, TPR=0.8436, TNR=0.8495, J=0.6931, MCC=0.6931, ConfusionMatrix=
[[3122  553]
 [ 567 3058]]
Epoch 5, Phase val, Loss=0.4667, Acc=0.7978, AUC=0.7684, TPR=0.6082, TNR=0.8316, J=0.4399, MCC=0.3719, ConfusionMatrix=
[[1808  366]
 [ 152  236]]
Epoch 5, Phase test, Loss=0.5103, Acc=0.7701, AUC=0.7573, TPR=0.5995, TNR=0.7994, J=0.3989, MCC=0.3223, ConfusionMatrix=
[[1726  433]
 [ 149  223]]
Epoch 5 complete in 98.57

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3423, Acc=0.8604, AUC=0.9280, TPR=0.8709, TNR=0.8498, J=0.7207, MCC=0.7209, ConfusionMatrix=
[[3084  545]
 [ 474 3197]]
Epoch 6, Phase val, Loss=0.5106, Acc=0.8013, AUC=0.7915, TPR=0.6418, TNR=0.8298, J=0.4716, MCC=0.3949, ConfusionMatrix=
[[1804  370]
 [ 139  249]]
New Best AUC=0.7915. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5363, Acc=0.7977, AUC=0.7906, TPR=0.6452, TNR=0.8240, J=0.4692, MCC=0.3863, ConfusionMatrix=
[[1779  380]
 [ 132  240]]
Epoch 6 complete in 102.01

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3319, Acc=0.8655, AUC=0.9307, TPR=0.8800, TNR=0.8508, J=0.7308, MCC=0.7312, ConfusionMatrix=
[[3084  541]
 [ 441 3234]]
Epoch 7, Phase val, Loss=0.4890, Acc=0.8228, AUC=0.7439, TPR=0.5284, TNR=0.8753, J=0.4037, MCC=0.3721, ConfusionMatrix=
[[1903  271]
 [ 183  205]]
Epoch 7, Phase test, Loss=0.4854, Acc=0.8100, AUC=0.7709, TPR=0.6048, TNR=0.8453, J=0.4501, MCC=0.3842, ConfusionMatrix=
[[1825  334]
 [ 147  225]]
Epoch 7 complete in 88.52

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3093, Acc=0.8734, AUC=0.9410, TPR=0.8895, TNR=0.8580, J=0.7475, MCC=0.7474, ConfusionMatrix=
[[3197  529]
 [ 395 3179]]
Epoch 8, Phase val, Loss=0.4812, Acc=0.8314, AUC=0.7473, TPR=0.4510, TNR=0.8993, J=0.3503, MCC=0.3481, ConfusionMatrix=
[[1955  219]
 [ 213  175]]
Epoch 8, Phase test, Loss=0.4440, Acc=0.8384, AUC=0.7778, TPR=0.5699, TNR=0.8847, J=0.4546, MCC=0.4170, ConfusionMatrix=
[[1910  249]
 [ 160  212]]
Epoch 8 complete in 97.67

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2833, Acc=0.8855, AUC=0.9498, TPR=0.8988, TNR=0.8722, J=0.7709, MCC=0.7712, ConfusionMatrix=
[[3179  466]
 [ 370 3285]]
Epoch 9, Phase val, Loss=0.4709, Acc=0.8173, AUC=0.7828, TPR=0.6211, TNR=0.8523, J=0.4735, MCC=0.4102, ConfusionMatrix=
[[1853  321]
 [ 147  241]]
Epoch 9, Phase test, Loss=0.5312, Acc=0.7870, AUC=0.7624, TPR=0.5941, TNR=0.8203, J=0.4144, MCC=0.3432, ConfusionMatrix=
[[1771  388]
 [ 151  221]]
Epoch 9 complete in 88.26

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2740, Acc=0.8890, AUC=0.9535, TPR=0.9058, TNR=0.8720, J=0.7779, MCC=0.7784, ConfusionMatrix=
[[3162  464]
 [ 346 3328]]
Epoch 10, Phase val, Loss=0.4704, Acc=0.8255, AUC=0.7475, TPR=0.4046, TNR=0.9006, J=0.3053, MCC=0.3103, ConfusionMatrix=
[[1958  216]
 [ 231  157]]
Epoch 10, Phase test, Loss=0.4523, Acc=0.8325, AUC=0.7605, TPR=0.5161, TNR=0.8870, J=0.4031, MCC=0.3780, ConfusionMatrix=
[[1915  244]
 [ 180  192]]
Epoch 10 complete in 98.91

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2525, Acc=0.9005, AUC=0.9597, TPR=0.9157, TNR=0.8855, J=0.8012, MCC=0.8015, ConfusionMatrix=
[[3240  419]
 [ 307 3334]]
Epoch 11, Phase val, Loss=0.4939, Acc=0.8201, AUC=0.7880, TPR=0.5258, TNR=0.8726, J=0.3984, MCC=0.3657, ConfusionMatrix=
[[1897  277]
 [ 184  204]]
Epoch 11, Phase test, Loss=0.5271, Acc=0.8230, AUC=0.7692, TPR=0.5806, TNR=0.8648, J=0.4454, MCC=0.3937, ConfusionMatrix=
[[1867  292]
 [ 156  216]]
Epoch 11 complete in 87.86

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.2232, Acc=0.9141, AUC=0.9678, TPR=0.9320, TNR=0.8966, J=0.8285, MCC=0.8288, ConfusionMatrix=
[[3303  381]
 [ 246 3370]]
Epoch 12, Phase val, Loss=0.4995, Acc=0.8493, AUC=0.7865, TPR=0.4149, TNR=0.9269, J=0.3418, MCC=0.3706, ConfusionMatrix=
[[2015  159]
 [ 227  161]]
Epoch 12, Phase test, Loss=0.5312, Acc=0.8554, AUC=0.7474, TPR=0.4758, TNR=0.9208, J=0.3966, MCC=0.4078, ConfusionMatrix=
[[1988  171]
 [ 195  177]]
Epoch 12 complete in 97.69

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.2199, Acc=0.9142, AUC=0.9696, TPR=0.9267, TNR=0.9018, J=0.8285, MCC=0.8288, ConfusionMatrix=
[[3297  359]
 [ 267 3377]]
Epoch 13, Phase val, Loss=0.5106, Acc=0.8251, AUC=0.7755, TPR=0.4381, TNR=0.8942, J=0.3323, MCC=0.3282, ConfusionMatrix=
[[1944  230]
 [ 218  170]]
Epoch 13, Phase test, Loss=0.5160, Acc=0.8404, AUC=0.7576, TPR=0.5403, TNR=0.8921, J=0.4324, MCC=0.4062, ConfusionMatrix=
[[1926  233]
 [ 171  201]]
Epoch 13 complete in 87.61

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.2159, Acc=0.9166, AUC=0.9701, TPR=0.9350, TNR=0.8986, J=0.8336, MCC=0.8338, ConfusionMatrix=
[[3324  375]
 [ 234 3367]]
Epoch 14, Phase val, Loss=0.5121, Acc=0.8244, AUC=0.7663, TPR=0.4536, TNR=0.8905, J=0.3441, MCC=0.3352, ConfusionMatrix=
[[1936  238]
 [ 212  176]]
Epoch 14, Phase test, Loss=0.5108, Acc=0.8293, AUC=0.7627, TPR=0.5538, TNR=0.8768, J=0.4306, MCC=0.3914, ConfusionMatrix=
[[1893  266]
 [ 166  206]]
Epoch 14 complete in 93.01

Early Stop!
Training complete in 23m 26s
The best model val AUC=0.79147540284, test AUC=0.790635100878.
Finish training resnet50-conv1x1-maxpool

Start training resnet50-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5558, Acc=0.7193, AUC=0.7896, TPR=0.6716, TNR=0.7674, J=0.4390, MCC=0.4409, ConfusionMatrix=
[[2791  846]
 [1203 2460]]
Epoch 0, Phase val, Loss=0.4991, Acc=0.8302, AUC=0.7833, TPR=0.5799, TNR=0.8749, J=0.4548, MCC=0.4123, ConfusionMatrix=
[[1902  272]
 [ 163  225]]
New Best AUC=0.7833. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5100, Acc=0.8269, AUC=0.7711, TPR=0.5699, TNR=0.8712, J=0.4411, MCC=0.3953, ConfusionMatrix=
[[1881  278]
 [ 160  212]]
Epoch 0 complete in 96.81

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5035, Acc=0.7667, AUC=0.8349, TPR=0.7232, TNR=0.8109, J=0.5342, MCC=0.5360, ConfusionMatrix=
[[2934  684]
 [1019 2663]]
Epoch 1, Phase val, Loss=0.4764, Acc=0.8353, AUC=0.7993, TPR=0.6495, TNR=0.8684, J=0.5179, MCC=0.4558, ConfusionMatrix=
[[1888  286]
 [ 136  252]]
New Best AUC=0.7993. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4758, Acc=0.8119, AUC=0.7749, TPR=0.6048, TNR=0.8476, J=0.4525, MCC=0.3874, ConfusionMatrix=
[[1830  329]
 [ 147  225]]
Epoch 1 complete in 92.71

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4629, Acc=0.7910, AUC=0.8620, TPR=0.7588, TNR=0.8221, J=0.5810, MCC=0.5824, ConfusionMatrix=
[[3046  659]
 [ 867 2728]]
Epoch 2, Phase val, Loss=0.4256, Acc=0.8326, AUC=0.7987, TPR=0.5928, TNR=0.8753, J=0.4681, MCC=0.4231, ConfusionMatrix=
[[1903  271]
 [ 158  230]]
Epoch 2, Phase test, Loss=0.4422, Acc=0.8321, AUC=0.7707, TPR=0.5968, TNR=0.8726, J=0.4694, MCC=0.4184, ConfusionMatrix=
[[1884  275]
 [ 150  222]]
Epoch 2 complete in 103.35

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4161, Acc=0.8153, AUC=0.8920, TPR=0.8042, TNR=0.8265, J=0.6306, MCC=0.6308, ConfusionMatrix=
[[3024  635]
 [ 713 2928]]
Epoch 3, Phase val, Loss=0.5946, Acc=0.7311, AUC=0.8112, TPR=0.7655, TNR=0.7249, J=0.4904, MCC=0.3687, ConfusionMatrix=
[[1576  598]
 [  91  297]]
New Best AUC=0.8112. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6707, Acc=0.6946, AUC=0.7791, TPR=0.7392, TNR=0.6869, J=0.4261, MCC=0.3116, ConfusionMatrix=
[[1483  676]
 [  97  275]]
Epoch 3 complete in 93.16

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4061, Acc=0.8237, AUC=0.8972, TPR=0.8226, TNR=0.8248, J=0.6474, MCC=0.6474, ConfusionMatrix=
[[3023  642]
 [ 645 2990]]
Epoch 4, Phase val, Loss=0.4099, Acc=0.8310, AUC=0.8037, TPR=0.6418, TNR=0.8648, J=0.5065, MCC=0.4443, ConfusionMatrix=
[[1880  294]
 [ 139  249]]
Epoch 4, Phase test, Loss=0.4279, Acc=0.8147, AUC=0.7967, TPR=0.6425, TNR=0.8444, J=0.4868, MCC=0.4114, ConfusionMatrix=
[[1823  336]
 [ 133  239]]
Epoch 4 complete in 91.43

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3714, Acc=0.8525, AUC=0.9144, TPR=0.8568, TNR=0.8480, J=0.7048, MCC=0.7048, ConfusionMatrix=
[[3047  546]
 [ 531 3176]]
Epoch 5, Phase val, Loss=0.4456, Acc=0.8095, AUC=0.7887, TPR=0.5876, TNR=0.8491, J=0.4368, MCC=0.3798, ConfusionMatrix=
[[1846  328]
 [ 160  228]]
Epoch 5, Phase test, Loss=0.4796, Acc=0.7997, AUC=0.7691, TPR=0.6237, TNR=0.8300, J=0.4537, MCC=0.3779, ConfusionMatrix=
[[1792  367]
 [ 140  232]]
Epoch 5 complete in 87.56

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3352, Acc=0.8666, AUC=0.9301, TPR=0.8794, TNR=0.8535, J=0.7329, MCC=0.7332, ConfusionMatrix=
[[3081  529]
 [ 445 3245]]
Epoch 6, Phase val, Loss=0.4500, Acc=0.8290, AUC=0.7776, TPR=0.4897, TNR=0.8896, J=0.3793, MCC=0.3638, ConfusionMatrix=
[[1934  240]
 [ 198  190]]
Epoch 6, Phase test, Loss=0.4529, Acc=0.8348, AUC=0.7776, TPR=0.5349, TNR=0.8865, J=0.4215, MCC=0.3924, ConfusionMatrix=
[[1914  245]
 [ 173  199]]
Epoch 6 complete in 94.53

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3363, Acc=0.8616, AUC=0.9299, TPR=0.8648, TNR=0.8585, J=0.7233, MCC=0.7233, ConfusionMatrix=
[[3149  519]
 [ 491 3141]]
Epoch 7, Phase val, Loss=0.4776, Acc=0.8232, AUC=0.7918, TPR=0.6418, TNR=0.8556, J=0.4973, MCC=0.4305, ConfusionMatrix=
[[1860  314]
 [ 139  249]]
Epoch 7, Phase test, Loss=0.4816, Acc=0.8115, AUC=0.7848, TPR=0.6210, TNR=0.8444, J=0.4653, MCC=0.3952, ConfusionMatrix=
[[1823  336]
 [ 141  231]]
Epoch 7 complete in 87.52

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3121, Acc=0.8749, AUC=0.9397, TPR=0.8905, TNR=0.8593, J=0.7498, MCC=0.7502, ConfusionMatrix=
[[3127  512]
 [ 401 3260]]
Epoch 8, Phase val, Loss=0.4721, Acc=0.8333, AUC=0.7838, TPR=0.5670, TNR=0.8809, J=0.4479, MCC=0.4118, ConfusionMatrix=
[[1915  259]
 [ 168  220]]
Epoch 8, Phase test, Loss=0.4753, Acc=0.8341, AUC=0.7815, TPR=0.5968, TNR=0.8749, J=0.4717, MCC=0.4221, ConfusionMatrix=
[[1889  270]
 [ 150  222]]
Epoch 8 complete in 95.84

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2864, Acc=0.8888, AUC=0.9485, TPR=0.9061, TNR=0.8711, J=0.7772, MCC=0.7779, ConfusionMatrix=
[[3148  466]
 [ 346 3340]]
Epoch 9, Phase val, Loss=0.4677, Acc=0.8216, AUC=0.7781, TPR=0.5000, TNR=0.8790, J=0.3790, MCC=0.3549, ConfusionMatrix=
[[1911  263]
 [ 194  194]]
Epoch 9, Phase test, Loss=0.4335, Acc=0.8364, AUC=0.7828, TPR=0.5296, TNR=0.8893, J=0.4189, MCC=0.3928, ConfusionMatrix=
[[1920  239]
 [ 175  197]]
Epoch 9 complete in 102.01

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2584, Acc=0.8984, AUC=0.9579, TPR=0.9135, TNR=0.8841, J=0.7976, MCC=0.7972, ConfusionMatrix=
[[3326  436]
 [ 306 3232]]
Epoch 10, Phase val, Loss=0.4833, Acc=0.8365, AUC=0.7624, TPR=0.4046, TNR=0.9135, J=0.3182, MCC=0.3341, ConfusionMatrix=
[[1986  188]
 [ 231  157]]
Epoch 10, Phase test, Loss=0.4925, Acc=0.8459, AUC=0.7261, TPR=0.3817, TNR=0.9259, J=0.3076, MCC=0.3360, ConfusionMatrix=
[[1999  160]
 [ 230  142]]
Epoch 10 complete in 88.77

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2463, Acc=0.9062, AUC=0.9615, TPR=0.9226, TNR=0.8896, J=0.8122, MCC=0.8127, ConfusionMatrix=
[[3232  401]
 [ 284 3383]]
Epoch 11, Phase val, Loss=0.4491, Acc=0.8314, AUC=0.7777, TPR=0.4742, TNR=0.8951, J=0.3694, MCC=0.3604, ConfusionMatrix=
[[1946  228]
 [ 204  184]]
Epoch 11, Phase test, Loss=0.4374, Acc=0.8384, AUC=0.7733, TPR=0.5242, TNR=0.8925, J=0.4167, MCC=0.3940, ConfusionMatrix=
[[1927  232]
 [ 177  195]]
Epoch 11 complete in 96.81

Early Stop!
Training complete in 18m 50s
The best model val AUC=0.811169254261, test AUC=0.779059401256.
Finish training resnet50-conv1x1-maxpool

Start training resnet50-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5804, Acc=0.6907, AUC=0.7622, TPR=0.7294, TNR=0.6505, J=0.3798, MCC=0.3812, ConfusionMatrix=
[[2328 1251]
 [1007 2714]]
Epoch 0, Phase val, Loss=0.4523, Acc=0.8189, AUC=0.8043, TPR=0.6340, TNR=0.8519, J=0.4859, MCC=0.4193, ConfusionMatrix=
[[1852  322]
 [ 142  246]]
New Best AUC=0.8043. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4725, Acc=0.8064, AUC=0.7768, TPR=0.6075, TNR=0.8407, J=0.4482, MCC=0.3799, ConfusionMatrix=
[[1815  344]
 [ 146  226]]
Epoch 0 complete in 89.25

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4991, Acc=0.7649, AUC=0.8373, TPR=0.7280, TNR=0.8018, J=0.5298, MCC=0.5313, ConfusionMatrix=
[[2929  724]
 [ 992 2655]]
Epoch 1, Phase val, Loss=0.4828, Acc=0.7838, AUC=0.7883, TPR=0.6057, TNR=0.8155, J=0.4212, MCC=0.3495, ConfusionMatrix=
[[1773  401]
 [ 153  235]]
Epoch 1, Phase test, Loss=0.4914, Acc=0.7673, AUC=0.7815, TPR=0.6237, TNR=0.7920, J=0.4157, MCC=0.3319, ConfusionMatrix=
[[1710  449]
 [ 140  232]]
Epoch 1 complete in 94.23

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4465, Acc=0.8060, AUC=0.8714, TPR=0.7744, TNR=0.8369, J=0.6113, MCC=0.6127, ConfusionMatrix=
[[3093  603]
 [ 813 2791]]
Epoch 2, Phase val, Loss=0.4963, Acc=0.7877, AUC=0.7843, TPR=0.6314, TNR=0.8155, J=0.4470, MCC=0.3690, ConfusionMatrix=
[[1773  401]
 [ 143  245]]
Epoch 2, Phase test, Loss=0.5513, Acc=0.7408, AUC=0.7609, TPR=0.6667, TNR=0.7536, J=0.4203, MCC=0.3223, ConfusionMatrix=
[[1627  532]
 [ 124  248]]
Epoch 2 complete in 88.08

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4292, Acc=0.8121, AUC=0.8833, TPR=0.7993, TNR=0.8247, J=0.6240, MCC=0.6243, ConfusionMatrix=
[[3020  642]
 [ 730 2908]]
Epoch 3, Phase val, Loss=0.3769, Acc=0.8478, AUC=0.7822, TPR=0.4588, TNR=0.9172, J=0.3760, MCC=0.3887, ConfusionMatrix=
[[1994  180]
 [ 210  178]]
Epoch 3, Phase test, Loss=0.3955, Acc=0.8578, AUC=0.7503, TPR=0.5081, TNR=0.9180, J=0.4261, MCC=0.4290, ConfusionMatrix=
[[1982  177]
 [ 183  189]]
Epoch 3 complete in 97.42

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4045, Acc=0.8286, AUC=0.8977, TPR=0.8225, TNR=0.8349, J=0.6574, MCC=0.6574, ConfusionMatrix=
[[3004  594]
 [ 657 3045]]
Epoch 4, Phase val, Loss=0.4467, Acc=0.8134, AUC=0.7759, TPR=0.5928, TNR=0.8528, J=0.4456, MCC=0.3890, ConfusionMatrix=
[[1854  320]
 [ 158  230]]
Epoch 4, Phase test, Loss=0.4703, Acc=0.8068, AUC=0.7546, TPR=0.5995, TNR=0.8425, J=0.4420, MCC=0.3763, ConfusionMatrix=
[[1819  340]
 [ 149  223]]
Epoch 4 complete in 87.60

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3718, Acc=0.8442, AUC=0.9134, TPR=0.8424, TNR=0.8461, J=0.6884, MCC=0.6884, ConfusionMatrix=
[[3128  569]
 [ 568 3035]]
Epoch 5, Phase val, Loss=0.5215, Acc=0.7670, AUC=0.7882, TPR=0.6804, TNR=0.7824, J=0.4628, MCC=0.3665, ConfusionMatrix=
[[1701  473]
 [ 124  264]]
Epoch 5, Phase test, Loss=0.5634, Acc=0.7507, AUC=0.7679, TPR=0.6774, TNR=0.7633, J=0.4407, MCC=0.3401, ConfusionMatrix=
[[1648  511]
 [ 120  252]]
Epoch 5 complete in 92.19

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3440, Acc=0.8636, AUC=0.9261, TPR=0.8641, TNR=0.8630, J=0.7271, MCC=0.7271, ConfusionMatrix=
[[3194  507]
 [ 489 3110]]
Epoch 6, Phase val, Loss=0.5874, Acc=0.8123, AUC=0.7803, TPR=0.6443, TNR=0.8422, J=0.4866, MCC=0.4136, ConfusionMatrix=
[[1831  343]
 [ 138  250]]
Epoch 6, Phase test, Loss=0.5971, Acc=0.8068, AUC=0.7672, TPR=0.6263, TNR=0.8379, J=0.4642, MCC=0.3904, ConfusionMatrix=
[[1809  350]
 [ 139  233]]
Epoch 6 complete in 87.55

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3437, Acc=0.8596, AUC=0.9268, TPR=0.8622, TNR=0.8570, J=0.7192, MCC=0.7192, ConfusionMatrix=
[[3122  521]
 [ 504 3153]]
Epoch 7, Phase val, Loss=0.5181, Acc=0.8126, AUC=0.7815, TPR=0.6263, TNR=0.8459, J=0.4722, MCC=0.4050, ConfusionMatrix=
[[1839  335]
 [ 145  243]]
Epoch 7, Phase test, Loss=0.5401, Acc=0.7930, AUC=0.7713, TPR=0.6129, TNR=0.8240, J=0.4369, MCC=0.3621, ConfusionMatrix=
[[1779  380]
 [ 144  228]]
Epoch 7 complete in 94.30

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3185, Acc=0.8741, AUC=0.9371, TPR=0.8778, TNR=0.8705, J=0.7483, MCC=0.7482, ConfusionMatrix=
[[3227  480]
 [ 439 3154]]
Epoch 8, Phase val, Loss=0.4260, Acc=0.8478, AUC=0.7741, TPR=0.4845, TNR=0.9126, J=0.3971, MCC=0.4014, ConfusionMatrix=
[[1984  190]
 [ 200  188]]
Epoch 8, Phase test, Loss=0.4603, Acc=0.8483, AUC=0.7457, TPR=0.5000, TNR=0.9083, J=0.4083, MCC=0.4030, ConfusionMatrix=
[[1961  198]
 [ 186  186]]
Epoch 8 complete in 94.96

Early Stop!
Training complete in 13m 46s
The best model val AUC=0.804335919347, test AUC=0.776824445806.
Finish training resnet50-conv1x1-maxpool

Start training resnet50-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5384, Acc=0.7258, AUC=0.8047, TPR=0.7439, TNR=0.7069, J=0.4508, MCC=0.4512, ConfusionMatrix=
[[2530 1049]
 [ 953 2768]]
Epoch 0, Phase val, Loss=0.4995, Acc=0.7947, AUC=0.8094, TPR=0.6804, TNR=0.8151, J=0.4955, MCC=0.4050, ConfusionMatrix=
[[1772  402]
 [ 124  264]]
New Best AUC=0.8094. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5293, Acc=0.7693, AUC=0.7936, TPR=0.6909, TNR=0.7828, J=0.4736, MCC=0.3708, ConfusionMatrix=
[[1690  469]
 [ 115  257]]
Epoch 0 complete in 92.84

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4513, Acc=0.7886, AUC=0.8707, TPR=0.7668, TNR=0.8090, J=0.5758, MCC=0.5765, ConfusionMatrix=
[[3058  722]
 [ 821 2699]]
Epoch 1, Phase val, Loss=0.4882, Acc=0.8064, AUC=0.8047, TPR=0.6495, TNR=0.8344, J=0.4839, MCC=0.4068, ConfusionMatrix=
[[1814  360]
 [ 136  252]]
Epoch 1, Phase test, Loss=0.5281, Acc=0.7898, AUC=0.7799, TPR=0.6210, TNR=0.8189, J=0.4399, MCC=0.3618, ConfusionMatrix=
[[1768  391]
 [ 141  231]]
Epoch 1 complete in 93.10

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.3800, Acc=0.8353, AUC=0.9108, TPR=0.8368, TNR=0.8339, J=0.6707, MCC=0.6707, ConfusionMatrix=
[[3038  605]
 [ 597 3060]]
Epoch 2, Phase val, Loss=0.5307, Acc=0.7588, AUC=0.7867, TPR=0.6521, TNR=0.7778, J=0.4299, MCC=0.3406, ConfusionMatrix=
[[1691  483]
 [ 135  253]]
Epoch 2, Phase test, Loss=0.5702, Acc=0.7542, AUC=0.7684, TPR=0.6640, TNR=0.7698, J=0.4338, MCC=0.3371, ConfusionMatrix=
[[1662  497]
 [ 125  247]]
Epoch 2 complete in 88.25

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3377, Acc=0.8551, AUC=0.9288, TPR=0.8731, TNR=0.8364, J=0.7094, MCC=0.7102, ConfusionMatrix=
[[2995  586]
 [ 472 3247]]
Epoch 3, Phase val, Loss=0.4613, Acc=0.7943, AUC=0.7818, TPR=0.5026, TNR=0.8464, J=0.3489, MCC=0.3090, ConfusionMatrix=
[[1840  334]
 [ 193  195]]
Epoch 3, Phase test, Loss=0.4735, Acc=0.8111, AUC=0.7755, TPR=0.5753, TNR=0.8518, J=0.4271, MCC=0.3706, ConfusionMatrix=
[[1839  320]
 [ 158  214]]
Epoch 3 complete in 97.05

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.2779, Acc=0.8878, AUC=0.9511, TPR=0.9064, TNR=0.8692, J=0.7757, MCC=0.7762, ConfusionMatrix=
[[3177  478]
 [ 341 3304]]
Epoch 4, Phase val, Loss=0.5323, Acc=0.8392, AUC=0.7294, TPR=0.3402, TNR=0.9282, J=0.2684, MCC=0.3047, ConfusionMatrix=
[[2018  156]
 [ 256  132]]
Epoch 4, Phase test, Loss=0.5126, Acc=0.8554, AUC=0.7403, TPR=0.4274, TNR=0.9291, J=0.3566, MCC=0.3840, ConfusionMatrix=
[[2006  153]
 [ 213  159]]
Epoch 4 complete in 88.19

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2523, Acc=0.9005, AUC=0.9601, TPR=0.9181, TNR=0.8830, J=0.8011, MCC=0.8016, ConfusionMatrix=
[[3222  427]
 [ 299 3352]]
Epoch 5, Phase val, Loss=0.5413, Acc=0.8333, AUC=0.7770, TPR=0.4845, TNR=0.8956, J=0.3801, MCC=0.3699, ConfusionMatrix=
[[1947  227]
 [ 200  188]]
Epoch 5, Phase test, Loss=0.5111, Acc=0.8589, AUC=0.7739, TPR=0.4973, TNR=0.9213, J=0.4186, MCC=0.4268, ConfusionMatrix=
[[1989  170]
 [ 187  185]]
Epoch 5 complete in 102.77

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2160, Acc=0.9142, AUC=0.9699, TPR=0.9255, TNR=0.9029, J=0.8284, MCC=0.8287, ConfusionMatrix=
[[3284  353]
 [ 273 3390]]
Epoch 6, Phase val, Loss=0.5470, Acc=0.8251, AUC=0.7866, TPR=0.5129, TNR=0.8809, J=0.3938, MCC=0.3684, ConfusionMatrix=
[[1915  259]
 [ 189  199]]
Epoch 6, Phase test, Loss=0.5358, Acc=0.8518, AUC=0.7712, TPR=0.5430, TNR=0.9050, J=0.4481, MCC=0.4319, ConfusionMatrix=
[[1954  205]
 [ 170  202]]
Epoch 6 complete in 87.56

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.1711, Acc=0.9385, AUC=0.9800, TPR=0.9522, TNR=0.9242, J=0.8764, MCC=0.8772, ConfusionMatrix=
[[3306  271]
 [ 178 3545]]
Epoch 7, Phase val, Loss=0.5710, Acc=0.8185, AUC=0.7750, TPR=0.5258, TNR=0.8707, J=0.3965, MCC=0.3628, ConfusionMatrix=
[[1893  281]
 [ 184  204]]
Epoch 7, Phase test, Loss=0.5731, Acc=0.8277, AUC=0.7661, TPR=0.5430, TNR=0.8768, J=0.4198, MCC=0.3829, ConfusionMatrix=
[[1893  266]
 [ 170  202]]
Epoch 7 complete in 101.63

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1688, Acc=0.9370, AUC=0.9810, TPR=0.9493, TNR=0.9246, J=0.8739, MCC=0.8742, ConfusionMatrix=
[[3358  274]
 [ 186 3482]]
Epoch 8, Phase val, Loss=0.6742, Acc=0.8247, AUC=0.7977, TPR=0.5825, TNR=0.8680, J=0.4505, MCC=0.4035, ConfusionMatrix=
[[1887  287]
 [ 162  226]]
Epoch 8, Phase test, Loss=0.6593, Acc=0.8356, AUC=0.7816, TPR=0.5833, TNR=0.8791, J=0.4624, MCC=0.4184, ConfusionMatrix=
[[1898  261]
 [ 155  217]]
Epoch 8 complete in 95.71

Early Stop!
Training complete in 14m 7s
The best model val AUC=0.809357780328, test AUC=0.793636415704.
Finish training resnet50-conv1x1-avgpool

Start training resnet50-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5267, Acc=0.7381, AUC=0.8153, TPR=0.7470, TNR=0.7290, J=0.4760, MCC=0.4761, ConfusionMatrix=
[[2642  982]
 [ 930 2746]]
Epoch 0, Phase val, Loss=0.4433, Acc=0.8130, AUC=0.7685, TPR=0.5052, TNR=0.8680, J=0.3731, MCC=0.3420, ConfusionMatrix=
[[1887  287]
 [ 192  196]]
New Best AUC=0.7685. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4652, Acc=0.8159, AUC=0.7711, TPR=0.5565, TNR=0.8606, J=0.4170, MCC=0.3687, ConfusionMatrix=
[[1858  301]
 [ 165  207]]
Epoch 0 complete in 90.98

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4321, Acc=0.8015, AUC=0.8835, TPR=0.7790, TNR=0.8241, J=0.6030, MCC=0.6036, ConfusionMatrix=
[[3007  642]
 [ 807 2844]]
Epoch 1, Phase val, Loss=0.5825, Acc=0.7299, AUC=0.7973, TPR=0.7345, TNR=0.7291, J=0.4636, MCC=0.3506, ConfusionMatrix=
[[1585  589]
 [ 103  285]]
New Best AUC=0.7973. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6250, Acc=0.6851, AUC=0.7692, TPR=0.7043, TNR=0.6818, J=0.3861, MCC=0.2824, ConfusionMatrix=
[[1472  687]
 [ 110  262]]
Epoch 1 complete in 100.96

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.3613, Acc=0.8463, AUC=0.9195, TPR=0.8477, TNR=0.8449, J=0.6927, MCC=0.6926, ConfusionMatrix=
[[3138  576]
 [ 546 3040]]
Epoch 2, Phase val, Loss=0.4588, Acc=0.8419, AUC=0.7730, TPR=0.4768, TNR=0.9071, J=0.3839, MCC=0.3843, ConfusionMatrix=
[[1972  202]
 [ 203  185]]
Epoch 2, Phase test, Loss=0.4359, Acc=0.8514, AUC=0.7692, TPR=0.5000, TNR=0.9120, J=0.4120, MCC=0.4102, ConfusionMatrix=
[[1969  190]
 [ 186  186]]
Epoch 2 complete in 88.56

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3251, Acc=0.8632, AUC=0.9342, TPR=0.8735, TNR=0.8527, J=0.7262, MCC=0.7264, ConfusionMatrix=
[[3097  535]
 [ 464 3204]]
Epoch 3, Phase val, Loss=0.4441, Acc=0.8493, AUC=0.7940, TPR=0.4639, TNR=0.9181, J=0.3820, MCC=0.3950, ConfusionMatrix=
[[1996  178]
 [ 208  180]]
Epoch 3, Phase test, Loss=0.4574, Acc=0.8649, AUC=0.7764, TPR=0.5188, TNR=0.9245, J=0.4433, MCC=0.4515, ConfusionMatrix=
[[1996  163]
 [ 179  193]]
Epoch 3 complete in 101.15

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.2744, Acc=0.8922, AUC=0.9529, TPR=0.9065, TNR=0.8780, J=0.7845, MCC=0.7847, ConfusionMatrix=
[[3218  447]
 [ 340 3295]]
Epoch 4, Phase val, Loss=0.5046, Acc=0.8240, AUC=0.7606, TPR=0.4253, TNR=0.8951, J=0.3204, MCC=0.3187, ConfusionMatrix=
[[1946  228]
 [ 223  165]]
Epoch 4, Phase test, Loss=0.5302, Acc=0.8420, AUC=0.7473, TPR=0.5349, TNR=0.8949, J=0.4298, MCC=0.4068, ConfusionMatrix=
[[1932  227]
 [ 173  199]]
Epoch 4 complete in 94.25

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2475, Acc=0.8982, AUC=0.9614, TPR=0.9114, TNR=0.8848, J=0.7962, MCC=0.7966, ConfusionMatrix=
[[3203  417]
 [ 326 3354]]
Epoch 5, Phase val, Loss=0.6133, Acc=0.7814, AUC=0.7904, TPR=0.6753, TNR=0.8004, J=0.4756, MCC=0.3833, ConfusionMatrix=
[[1740  434]
 [ 126  262]]
Epoch 5, Phase test, Loss=0.6634, Acc=0.7570, AUC=0.7640, TPR=0.6613, TNR=0.7735, J=0.4348, MCC=0.3391, ConfusionMatrix=
[[1670  489]
 [ 126  246]]
Epoch 5 complete in 89.01

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2091, Acc=0.9197, AUC=0.9717, TPR=0.9385, TNR=0.9005, J=0.8390, MCC=0.8399, ConfusionMatrix=
[[3250  359]
 [ 227 3464]]
Epoch 6, Phase val, Loss=0.6078, Acc=0.8013, AUC=0.7831, TPR=0.6186, TNR=0.8339, J=0.4525, MCC=0.3828, ConfusionMatrix=
[[1813  361]
 [ 148  240]]
Epoch 6, Phase test, Loss=0.6558, Acc=0.7768, AUC=0.7626, TPR=0.5995, TNR=0.8073, J=0.4068, MCC=0.3315, ConfusionMatrix=
[[1743  416]
 [ 149  223]]
Epoch 6 complete in 114.97

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.1918, Acc=0.9270, AUC=0.9765, TPR=0.9392, TNR=0.9143, J=0.8534, MCC=0.8540, ConfusionMatrix=
[[3263  306]
 [ 227 3504]]
Epoch 7, Phase val, Loss=0.6285, Acc=0.8443, AUC=0.7710, TPR=0.3557, TNR=0.9315, J=0.2871, MCC=0.3264, ConfusionMatrix=
[[2025  149]
 [ 250  138]]
Epoch 7, Phase test, Loss=0.5700, Acc=0.8653, AUC=0.7692, TPR=0.4409, TNR=0.9384, J=0.3793, MCC=0.4173, ConfusionMatrix=
[[2026  133]
 [ 208  164]]
Epoch 7 complete in 98.96

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1978, Acc=0.9263, AUC=0.9746, TPR=0.9402, TNR=0.9120, J=0.8521, MCC=0.8528, ConfusionMatrix=
[[3274  316]
 [ 222 3488]]
Epoch 8, Phase val, Loss=0.7776, Acc=0.8431, AUC=0.7519, TPR=0.2397, TNR=0.9508, J=0.1905, MCC=0.2545, ConfusionMatrix=
[[2067  107]
 [ 295   93]]
Epoch 8, Phase test, Loss=0.7263, Acc=0.8680, AUC=0.7491, TPR=0.3172, TNR=0.9629, J=0.2802, MCC=0.3694, ConfusionMatrix=
[[2079   80]
 [ 254  118]]
Epoch 8 complete in 96.67

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1532, Acc=0.9441, AUC=0.9843, TPR=0.9579, TNR=0.9301, J=0.8880, MCC=0.8885, ConfusionMatrix=
[[3367  253]
 [ 155 3525]]
Epoch 9, Phase val, Loss=0.6126, Acc=0.8396, AUC=0.7629, TPR=0.4201, TNR=0.9144, J=0.3345, MCC=0.3496, ConfusionMatrix=
[[1988  186]
 [ 225  163]]
Epoch 9, Phase test, Loss=0.6180, Acc=0.8447, AUC=0.7576, TPR=0.4409, TNR=0.9143, J=0.3552, MCC=0.3648, ConfusionMatrix=
[[1974  185]
 [ 208  164]]
Epoch 9 complete in 102.17

Early Stop!
Training complete in 16m 18s
The best model val AUC=0.797344910327, test AUC=0.769175793254.
Finish training resnet50-conv1x1-avgpool

Start training resnet50-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5571, Acc=0.7110, AUC=0.7901, TPR=0.6822, TNR=0.7383, J=0.4204, MCC=0.4212, ConfusionMatrix=
[[2767  981]
 [1129 2423]]
Epoch 0, Phase val, Loss=0.5851, Acc=0.7697, AUC=0.7986, TPR=0.7036, TNR=0.7815, J=0.4851, MCC=0.3825, ConfusionMatrix=
[[1699  475]
 [ 115  273]]
New Best AUC=0.7986. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6097, Acc=0.7408, AUC=0.7972, TPR=0.7258, TNR=0.7434, J=0.4692, MCC=0.3546, ConfusionMatrix=
[[1605  554]
 [ 102  270]]
Epoch 0 complete in 100.63

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4109, Acc=0.8138, AUC=0.8943, TPR=0.7989, TNR=0.8289, J=0.6278, MCC=0.6280, ConfusionMatrix=
[[3013  622]
 [ 737 2928]]
Epoch 1, Phase val, Loss=0.5025, Acc=0.8005, AUC=0.7935, TPR=0.6366, TNR=0.8298, J=0.4664, MCC=0.3910, ConfusionMatrix=
[[1804  370]
 [ 141  247]]
Epoch 1, Phase test, Loss=0.5230, Acc=0.7981, AUC=0.7833, TPR=0.6237, TNR=0.8282, J=0.4518, MCC=0.3755, ConfusionMatrix=
[[1788  371]
 [ 140  232]]
Epoch 1 complete in 89.31

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.3786, Acc=0.8370, AUC=0.9111, TPR=0.8492, TNR=0.8248, J=0.6740, MCC=0.6742, ConfusionMatrix=
[[3013  640]
 [ 550 3097]]
Epoch 2, Phase val, Loss=0.4469, Acc=0.8376, AUC=0.7832, TPR=0.5361, TNR=0.8914, J=0.4275, MCC=0.4049, ConfusionMatrix=
[[1938  236]
 [ 180  208]]
Epoch 2, Phase test, Loss=0.4476, Acc=0.8384, AUC=0.7714, TPR=0.5430, TNR=0.8893, J=0.4323, MCC=0.4036, ConfusionMatrix=
[[1920  239]
 [ 170  202]]
Epoch 2 complete in 97.36

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3133, Acc=0.8740, AUC=0.9390, TPR=0.8892, TNR=0.8585, J=0.7477, MCC=0.7482, ConfusionMatrix=
[[3107  512]
 [ 408 3273]]
Epoch 3, Phase val, Loss=0.4909, Acc=0.8302, AUC=0.7946, TPR=0.5722, TNR=0.8763, J=0.4484, MCC=0.4084, ConfusionMatrix=
[[1905  269]
 [ 166  222]]
Epoch 3, Phase test, Loss=0.5000, Acc=0.8194, AUC=0.7735, TPR=0.5941, TNR=0.8583, J=0.4524, MCC=0.3945, ConfusionMatrix=
[[1853  306]
 [ 151  221]]
Epoch 3 complete in 96.70

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.2744, Acc=0.8886, AUC=0.9530, TPR=0.8963, TNR=0.8811, J=0.7775, MCC=0.7774, ConfusionMatrix=
[[3262  440]
 [ 373 3225]]
Epoch 4, Phase val, Loss=0.6424, Acc=0.7966, AUC=0.8005, TPR=0.6598, TNR=0.8211, J=0.4809, MCC=0.3972, ConfusionMatrix=
[[1785  389]
 [ 132  256]]
New Best AUC=0.8005. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.6574, Acc=0.7874, AUC=0.7644, TPR=0.6398, TNR=0.8129, J=0.4527, MCC=0.3684, ConfusionMatrix=
[[1755  404]
 [ 134  238]]
Epoch 4 complete in 118.23

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2356, Acc=0.9078, AUC=0.9644, TPR=0.9269, TNR=0.8885, J=0.8154, MCC=0.8162, ConfusionMatrix=
[[3227  405]
 [ 268 3400]]
Epoch 5, Phase val, Loss=0.5889, Acc=0.8236, AUC=0.7503, TPR=0.5052, TNR=0.8804, J=0.3856, MCC=0.3613, ConfusionMatrix=
[[1914  260]
 [ 192  196]]
Epoch 5, Phase test, Loss=0.5420, Acc=0.8210, AUC=0.7620, TPR=0.5430, TNR=0.8689, J=0.4119, MCC=0.3706, ConfusionMatrix=
[[1876  283]
 [ 170  202]]
Epoch 5 complete in 112.13

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2174, Acc=0.9125, AUC=0.9693, TPR=0.9298, TNR=0.8945, J=0.8243, MCC=0.8252, ConfusionMatrix=
[[3206  378]
 [ 261 3455]]
Epoch 6, Phase val, Loss=0.5307, Acc=0.8087, AUC=0.7812, TPR=0.5180, TNR=0.8606, J=0.3787, MCC=0.3415, ConfusionMatrix=
[[1871  303]
 [ 187  201]]
Epoch 6, Phase test, Loss=0.5750, Acc=0.7977, AUC=0.7477, TPR=0.5457, TNR=0.8411, J=0.3868, MCC=0.3330, ConfusionMatrix=
[[1816  343]
 [ 169  203]]
Epoch 6 complete in 102.43

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.1969, Acc=0.9273, AUC=0.9746, TPR=0.9401, TNR=0.9143, J=0.8545, MCC=0.8548, ConfusionMatrix=
[[3329  312]
 [ 219 3440]]
Epoch 7, Phase val, Loss=0.5753, Acc=0.8509, AUC=0.7957, TPR=0.3969, TNR=0.9319, J=0.3288, MCC=0.3656, ConfusionMatrix=
[[2026  148]
 [ 234  154]]
Epoch 7, Phase test, Loss=0.5647, Acc=0.8601, AUC=0.7720, TPR=0.4167, TNR=0.9365, J=0.3532, MCC=0.3915, ConfusionMatrix=
[[2022  137]
 [ 217  155]]
Epoch 7 complete in 88.62

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1688, Acc=0.9349, AUC=0.9813, TPR=0.9460, TNR=0.9242, J=0.8701, MCC=0.8701, ConfusionMatrix=
[[3412  280]
 [ 195 3413]]
Epoch 8, Phase val, Loss=0.6611, Acc=0.8099, AUC=0.7694, TPR=0.5052, TNR=0.8643, J=0.3695, MCC=0.3365, ConfusionMatrix=
[[1879  295]
 [ 192  196]]
Epoch 8, Phase test, Loss=0.6643, Acc=0.8076, AUC=0.7632, TPR=0.5833, TNR=0.8462, J=0.4296, MCC=0.3690, ConfusionMatrix=
[[1827  332]
 [ 155  217]]
Epoch 8 complete in 97.68

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1530, Acc=0.9440, AUC=0.9839, TPR=0.9579, TNR=0.9303, J=0.8882, MCC=0.8883, ConfusionMatrix=
[[3431  257]
 [ 152 3460]]
Epoch 9, Phase val, Loss=0.7151, Acc=0.8154, AUC=0.7874, TPR=0.5773, TNR=0.8579, J=0.4352, MCC=0.3843, ConfusionMatrix=
[[1865  309]
 [ 164  224]]
Epoch 9, Phase test, Loss=0.7266, Acc=0.7863, AUC=0.7755, TPR=0.6237, TNR=0.8143, J=0.4379, MCC=0.3581, ConfusionMatrix=
[[1758  401]
 [ 140  232]]
Epoch 9 complete in 100.84

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.1438, Acc=0.9453, AUC=0.9858, TPR=0.9541, TNR=0.9368, J=0.8909, MCC=0.8909, ConfusionMatrix=
[[3470  234]
 [ 165 3431]]
Epoch 10, Phase val, Loss=0.6700, Acc=0.8224, AUC=0.7571, TPR=0.4381, TNR=0.8910, J=0.3291, MCC=0.3228, ConfusionMatrix=
[[1937  237]
 [ 218  170]]
Epoch 10, Phase test, Loss=0.6616, Acc=0.8238, AUC=0.7598, TPR=0.4973, TNR=0.8800, J=0.3773, MCC=0.3513, ConfusionMatrix=
[[1900  259]
 [ 187  185]]
Epoch 10 complete in 92.06

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.1303, Acc=0.9523, AUC=0.9884, TPR=0.9616, TNR=0.9429, J=0.9045, MCC=0.9048, ConfusionMatrix=
[[3419  207]
 [ 141 3533]]
Epoch 11, Phase val, Loss=0.7319, Acc=0.8474, AUC=0.7731, TPR=0.3557, TNR=0.9351, J=0.2908, MCC=0.3347, ConfusionMatrix=
[[2033  141]
 [ 250  138]]
Epoch 11, Phase test, Loss=0.6787, Acc=0.8597, AUC=0.7539, TPR=0.4005, TNR=0.9389, J=0.3394, MCC=0.3825, ConfusionMatrix=
[[2027  132]
 [ 223  149]]
Epoch 11 complete in 97.88

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.1067, Acc=0.9622, AUC=0.9921, TPR=0.9704, TNR=0.9539, J=0.9242, MCC=0.9245, ConfusionMatrix=
[[3453  167]
 [ 109 3571]]
Epoch 12, Phase val, Loss=0.7078, Acc=0.8154, AUC=0.7628, TPR=0.4433, TNR=0.8818, J=0.3251, MCC=0.3121, ConfusionMatrix=
[[1917  257]
 [ 216  172]]
Epoch 12, Phase test, Loss=0.7050, Acc=0.8325, AUC=0.7605, TPR=0.5457, TNR=0.8819, J=0.4276, MCC=0.3933, ConfusionMatrix=
[[1904  255]
 [ 169  203]]
Epoch 12 complete in 89.11

Early Stop!
Training complete in 21m 23s
The best model val AUC=0.800454528211, test AUC=0.764434450438.
Finish training resnet50-conv1x1-avgpool

Start training resnet50-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5335, Acc=0.7273, AUC=0.8080, TPR=0.7527, TNR=0.7018, J=0.4545, MCC=0.4551, ConfusionMatrix=
[[2560 1088]
 [ 903 2749]]
Epoch 0, Phase val, Loss=0.3728, Acc=0.8439, AUC=0.7855, TPR=0.3995, TNR=0.9232, J=0.3227, MCC=0.3489, ConfusionMatrix=
[[2007  167]
 [ 233  155]]
New Best AUC=0.7855. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.3743, Acc=0.8522, AUC=0.7703, TPR=0.4677, TNR=0.9185, J=0.3862, MCC=0.3962, ConfusionMatrix=
[[1983  176]
 [ 198  174]]
Epoch 0 complete in 94.00

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4726, Acc=0.7849, AUC=0.8603, TPR=0.7687, TNR=0.8012, J=0.5699, MCC=0.5702, ConfusionMatrix=
[[2921  725]
 [ 845 2809]]
Epoch 1, Phase val, Loss=0.5122, Acc=0.7877, AUC=0.7903, TPR=0.6830, TNR=0.8063, J=0.4893, MCC=0.3962, ConfusionMatrix=
[[1753  421]
 [ 123  265]]
New Best AUC=0.7903. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5176, Acc=0.7570, AUC=0.7813, TPR=0.6371, TNR=0.7777, J=0.4148, MCC=0.3259, ConfusionMatrix=
[[1679  480]
 [ 135  237]]
Epoch 1 complete in 89.60

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.3837, Acc=0.8337, AUC=0.9090, TPR=0.8408, TNR=0.8265, J=0.6673, MCC=0.6674, ConfusionMatrix=
[[3002  630]
 [ 584 3084]]
Epoch 2, Phase val, Loss=0.5606, Acc=0.7877, AUC=0.7770, TPR=0.6366, TNR=0.8146, J=0.4512, MCC=0.3717, ConfusionMatrix=
[[1771  403]
 [ 141  247]]
Epoch 2, Phase test, Loss=0.5703, Acc=0.7546, AUC=0.7778, TPR=0.6694, TNR=0.7693, J=0.4387, MCC=0.3406, ConfusionMatrix=
[[1661  498]
 [ 123  249]]
Epoch 2 complete in 95.46

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3082, Acc=0.8704, AUC=0.9415, TPR=0.8780, TNR=0.8629, J=0.7409, MCC=0.7409, ConfusionMatrix=
[[3165  503]
 [ 443 3189]]
Epoch 3, Phase val, Loss=0.4862, Acc=0.8279, AUC=0.7483, TPR=0.4304, TNR=0.8988, J=0.3292, MCC=0.3296, ConfusionMatrix=
[[1954  220]
 [ 221  167]]
Epoch 3, Phase test, Loss=0.4807, Acc=0.8246, AUC=0.7466, TPR=0.5027, TNR=0.8800, J=0.3827, MCC=0.3557, ConfusionMatrix=
[[1900  259]
 [ 185  187]]
Epoch 3 complete in 98.75

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.2868, Acc=0.8853, AUC=0.9488, TPR=0.8922, TNR=0.8787, J=0.7708, MCC=0.7708, ConfusionMatrix=
[[3245  448]
 [ 389 3218]]
Epoch 4, Phase val, Loss=0.5153, Acc=0.8208, AUC=0.7707, TPR=0.5129, TNR=0.8758, J=0.3887, MCC=0.3603, ConfusionMatrix=
[[1904  270]
 [ 189  199]]
Epoch 4, Phase test, Loss=0.4964, Acc=0.8258, AUC=0.7696, TPR=0.5753, TNR=0.8689, J=0.4442, MCC=0.3959, ConfusionMatrix=
[[1876  283]
 [ 158  214]]
Epoch 4 complete in 88.14

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2409, Acc=0.9004, AUC=0.9632, TPR=0.9201, TNR=0.8801, J=0.8002, MCC=0.8012, ConfusionMatrix=
[[3164  431]
 [ 296 3409]]
Epoch 5, Phase val, Loss=0.5615, Acc=0.8150, AUC=0.7777, TPR=0.5155, TNR=0.8684, J=0.3839, MCC=0.3510, ConfusionMatrix=
[[1888  286]
 [ 188  200]]
Epoch 5, Phase test, Loss=0.5762, Acc=0.8167, AUC=0.7593, TPR=0.5753, TNR=0.8583, J=0.4335, MCC=0.3799, ConfusionMatrix=
[[1853  306]
 [ 158  214]]
Epoch 5 complete in 96.24

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2054, Acc=0.9225, AUC=0.9728, TPR=0.9330, TNR=0.9121, J=0.8451, MCC=0.8452, ConfusionMatrix=
[[3351  323]
 [ 243 3383]]
Epoch 6, Phase val, Loss=0.5160, Acc=0.8376, AUC=0.7690, TPR=0.2990, TNR=0.9338, J=0.2327, MCC=0.2763, ConfusionMatrix=
[[2030  144]
 [ 272  116]]
Epoch 6, Phase test, Loss=0.5035, Acc=0.8439, AUC=0.7540, TPR=0.4113, TNR=0.9185, J=0.3298, MCC=0.3472, ConfusionMatrix=
[[1983  176]
 [ 219  153]]
Epoch 6 complete in 89.63

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.1951, Acc=0.9233, AUC=0.9755, TPR=0.9391, TNR=0.9075, J=0.8466, MCC=0.8470, ConfusionMatrix=
[[3317  338]
 [ 222 3423]]
Epoch 7, Phase val, Loss=0.5958, Acc=0.8216, AUC=0.7521, TPR=0.4407, TNR=0.8896, J=0.3303, MCC=0.3227, ConfusionMatrix=
[[1934  240]
 [ 217  171]]
Epoch 7, Phase test, Loss=0.5610, Acc=0.8210, AUC=0.7655, TPR=0.5134, TNR=0.8740, J=0.3875, MCC=0.3549, ConfusionMatrix=
[[1887  272]
 [ 181  191]]
Epoch 7 complete in 97.54

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1893, Acc=0.9275, AUC=0.9763, TPR=0.9405, TNR=0.9147, J=0.8552, MCC=0.8554, ConfusionMatrix=
[[3358  313]
 [ 216 3413]]
Epoch 8, Phase val, Loss=0.6203, Acc=0.8501, AUC=0.7376, TPR=0.3247, TNR=0.9439, J=0.2686, MCC=0.3257, ConfusionMatrix=
[[2052  122]
 [ 262  126]]
Epoch 8, Phase test, Loss=0.5636, Acc=0.8562, AUC=0.7519, TPR=0.3710, TNR=0.9398, J=0.3108, MCC=0.3576, ConfusionMatrix=
[[2029  130]
 [ 234  138]]
Epoch 8 complete in 89.20

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1509, Acc=0.9456, AUC=0.9847, TPR=0.9551, TNR=0.9364, J=0.8915, MCC=0.8914, ConfusionMatrix=
[[3460  235]
 [ 162 3443]]
Epoch 9, Phase val, Loss=0.7689, Acc=0.8025, AUC=0.7713, TPR=0.5619, TNR=0.8454, J=0.4073, MCC=0.3547, ConfusionMatrix=
[[1838  336]
 [ 170  218]]
Epoch 9, Phase test, Loss=0.7794, Acc=0.7886, AUC=0.7714, TPR=0.6048, TNR=0.8203, J=0.4251, MCC=0.3514, ConfusionMatrix=
[[1771  388]
 [ 147  225]]
Epoch 9 complete in 89.10

Early Stop!
Training complete in 15m 28s
The best model val AUC=0.7902596525, test AUC=0.7812794155.
Finish training resnet50-conv1x1-avgpool

Start training resnet50fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6671, Acc=0.6066, AUC=0.6480, TPR=0.7412, TNR=0.4694, J=0.2107, MCC=0.2190, ConfusionMatrix=
[[1698 1919]
 [ 953 2730]]
Epoch 0, Phase val, Loss=0.6672, Acc=0.5710, AUC=0.7009, TPR=0.7887, TNR=0.5322, J=0.3209, MCC=0.2302, ConfusionMatrix=
[[1157 1017]
 [  82  306]]
New Best AUC=0.7009. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6736, Acc=0.5646, AUC=0.6471, TPR=0.7043, TNR=0.5405, J=0.2448, MCC=0.1734, ConfusionMatrix=
[[1167  992]
 [ 110  262]]
Epoch 0 complete in 55.27

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.6127, Acc=0.6677, AUC=0.7278, TPR=0.7027, TNR=0.6331, J=0.3357, MCC=0.3365, ConfusionMatrix=
[[2324 1347]
 [1079 2550]]
Epoch 1, Phase val, Loss=0.5364, Acc=0.7588, AUC=0.7686, TPR=0.6005, TNR=0.7870, J=0.3875, MCC=0.3123, ConfusionMatrix=
[[1711  463]
 [ 155  233]]
New Best AUC=0.7686. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5594, Acc=0.7420, AUC=0.7450, TPR=0.5995, TNR=0.7666, J=0.3660, MCC=0.2864, ConfusionMatrix=
[[1655  504]
 [ 149  223]]
Epoch 1 complete in 83.25

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5522, Acc=0.7132, AUC=0.7883, TPR=0.6732, TNR=0.7531, J=0.4263, MCC=0.4277, ConfusionMatrix=
[[2748  901]
 [1193 2458]]
Epoch 2, Phase val, Loss=0.5528, Acc=0.7525, AUC=0.7787, TPR=0.6237, TNR=0.7755, J=0.3992, MCC=0.3171, ConfusionMatrix=
[[1686  488]
 [ 146  242]]
New Best AUC=0.7787. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5802, Acc=0.7373, AUC=0.7553, TPR=0.6237, TNR=0.7568, J=0.3805, MCC=0.2942, ConfusionMatrix=
[[1634  525]
 [ 140  232]]
Epoch 2 complete in 92.88

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5275, Acc=0.7468, AUC=0.8146, TPR=0.7086, TNR=0.7855, J=0.4941, MCC=0.4954, ConfusionMatrix=
[[2853  779]
 [1069 2599]]
Epoch 3, Phase val, Loss=0.5937, Acc=0.7256, AUC=0.7793, TPR=0.6881, TNR=0.7323, J=0.4204, MCC=0.3202, ConfusionMatrix=
[[1592  582]
 [ 121  267]]
New Best AUC=0.7793. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6228, Acc=0.7029, AUC=0.7667, TPR=0.6855, TNR=0.7059, J=0.3914, MCC=0.2902, ConfusionMatrix=
[[1524  635]
 [ 117  255]]
Epoch 3 complete in 55.42

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5253, Acc=0.7449, AUC=0.8128, TPR=0.6914, TNR=0.7956, J=0.4871, MCC=0.4903, ConfusionMatrix=
[[2982  766]
 [1096 2456]]
Epoch 4, Phase val, Loss=0.5282, Acc=0.7685, AUC=0.7790, TPR=0.5825, TNR=0.8017, J=0.3842, MCC=0.3154, ConfusionMatrix=
[[1743  431]
 [ 162  226]]
Epoch 4, Phase test, Loss=0.5554, Acc=0.7732, AUC=0.7694, TPR=0.6263, TNR=0.7985, J=0.4249, MCC=0.3413, ConfusionMatrix=
[[1724  435]
 [ 139  233]]
Epoch 4 complete in 78.80

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5198, Acc=0.7505, AUC=0.8207, TPR=0.7123, TNR=0.7893, J=0.5017, MCC=0.5030, ConfusionMatrix=
[[2859  763]
 [1058 2620]]
Epoch 5, Phase val, Loss=0.4990, Acc=0.7849, AUC=0.7858, TPR=0.5670, TNR=0.8238, J=0.3908, MCC=0.3303, ConfusionMatrix=
[[1791  383]
 [ 168  220]]
New Best AUC=0.7858. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5216, Acc=0.7957, AUC=0.7643, TPR=0.5699, TNR=0.8346, J=0.4045, MCC=0.3431, ConfusionMatrix=
[[1802  357]
 [ 160  212]]
Epoch 5 complete in 74.54

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5120, Acc=0.7548, AUC=0.8274, TPR=0.7331, TNR=0.7772, J=0.5103, MCC=0.5105, ConfusionMatrix=
[[2794  801]
 [ 989 2716]]
Epoch 6, Phase val, Loss=0.5111, Acc=0.7779, AUC=0.7878, TPR=0.5902, TNR=0.8114, J=0.4016, MCC=0.3327, ConfusionMatrix=
[[1764  410]
 [ 159  229]]
New Best AUC=0.7878. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5455, Acc=0.7681, AUC=0.7732, TPR=0.6102, TNR=0.7953, J=0.4055, MCC=0.3256, ConfusionMatrix=
[[1717  442]
 [ 145  227]]
Epoch 6 complete in 56.65

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5158, Acc=0.7504, AUC=0.8231, TPR=0.7137, TNR=0.7862, J=0.4998, MCC=0.5014, ConfusionMatrix=
[[2908  791]
 [1031 2570]]
Epoch 7, Phase val, Loss=0.5789, Acc=0.7404, AUC=0.7846, TPR=0.6856, TNR=0.7502, J=0.4358, MCC=0.3361, ConfusionMatrix=
[[1631  543]
 [ 122  266]]
Epoch 7, Phase test, Loss=0.6079, Acc=0.7270, AUC=0.7732, TPR=0.7070, TNR=0.7304, J=0.4374, MCC=0.3284, ConfusionMatrix=
[[1577  582]
 [ 109  263]]
Epoch 7 complete in 76.44

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5040, Acc=0.7556, AUC=0.8326, TPR=0.7378, TNR=0.7738, J=0.5116, MCC=0.5118, ConfusionMatrix=
[[2792  816]
 [ 968 2724]]
Epoch 8, Phase val, Loss=0.5226, Acc=0.7744, AUC=0.7815, TPR=0.6314, TNR=0.7999, J=0.4314, MCC=0.3502, ConfusionMatrix=
[[1739  435]
 [ 143  245]]
Epoch 8, Phase test, Loss=0.5455, Acc=0.7689, AUC=0.7666, TPR=0.6183, TNR=0.7948, J=0.4131, MCC=0.3311, ConfusionMatrix=
[[1716  443]
 [ 142  230]]
Epoch 8 complete in 53.72

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5159, Acc=0.7533, AUC=0.8244, TPR=0.7108, TNR=0.7939, J=0.5047, MCC=0.5069, ConfusionMatrix=
[[2962  769]
 [1032 2537]]
Epoch 9, Phase val, Loss=0.4698, Acc=0.8091, AUC=0.7813, TPR=0.5155, TNR=0.8615, J=0.3770, MCC=0.3408, ConfusionMatrix=
[[1873  301]
 [ 188  200]]
Epoch 9, Phase test, Loss=0.4878, Acc=0.8139, AUC=0.7649, TPR=0.5457, TNR=0.8601, J=0.4058, MCC=0.3596, ConfusionMatrix=
[[1857  302]
 [ 169  203]]
Epoch 9 complete in 79.51

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5149, Acc=0.7556, AUC=0.8248, TPR=0.7301, TNR=0.7811, J=0.5112, MCC=0.5119, ConfusionMatrix=
[[2854  800]
 [ 984 2662]]
Epoch 10, Phase val, Loss=0.4340, Acc=0.8361, AUC=0.7778, TPR=0.5103, TNR=0.8942, J=0.4045, MCC=0.3887, ConfusionMatrix=
[[1944  230]
 [ 190  198]]
Epoch 10, Phase test, Loss=0.4621, Acc=0.8360, AUC=0.7629, TPR=0.5054, TNR=0.8930, J=0.3984, MCC=0.3795, ConfusionMatrix=
[[1928  231]
 [ 184  188]]
Epoch 10 complete in 77.01

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5098, Acc=0.7542, AUC=0.8295, TPR=0.7250, TNR=0.7833, J=0.5083, MCC=0.5092, ConfusionMatrix=
[[2870  794]
 [1000 2636]]
Epoch 11, Phase val, Loss=0.6142, Acc=0.7287, AUC=0.7796, TPR=0.7036, TNR=0.7332, J=0.4368, MCC=0.3323, ConfusionMatrix=
[[1594  580]
 [ 115  273]]
Epoch 11, Phase test, Loss=0.6450, Acc=0.7072, AUC=0.7722, TPR=0.6989, TNR=0.7087, J=0.4076, MCC=0.3023, ConfusionMatrix=
[[1530  629]
 [ 112  260]]
Epoch 11 complete in 61.36

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5056, Acc=0.7642, AUC=0.8323, TPR=0.7208, TNR=0.8060, J=0.5267, MCC=0.5291, ConfusionMatrix=
[[3003  723]
 [ 998 2576]]
Epoch 12, Phase val, Loss=0.4649, Acc=0.8142, AUC=0.7902, TPR=0.5619, TNR=0.8592, J=0.4211, MCC=0.3743, ConfusionMatrix=
[[1868  306]
 [ 170  218]]
New Best AUC=0.7902. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 12, Phase test, Loss=0.4950, Acc=0.8104, AUC=0.7702, TPR=0.5726, TNR=0.8513, J=0.4239, MCC=0.3679, ConfusionMatrix=
[[1838  321]
 [ 159  213]]
Epoch 12 complete in 73.73

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5118, Acc=0.7551, AUC=0.8274, TPR=0.7218, TNR=0.7878, J=0.5096, MCC=0.5108, ConfusionMatrix=
[[2899  781]
 [1007 2613]]
Epoch 13, Phase val, Loss=0.4892, Acc=0.8002, AUC=0.7819, TPR=0.5722, TNR=0.8408, J=0.4130, MCC=0.3564, ConfusionMatrix=
[[1828  346]
 [ 166  222]]
Epoch 13, Phase test, Loss=0.5078, Acc=0.8072, AUC=0.7706, TPR=0.5995, TNR=0.8430, J=0.4424, MCC=0.3769, ConfusionMatrix=
[[1820  339]
 [ 149  223]]
Epoch 13 complete in 74.38

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5040, Acc=0.7623, AUC=0.8341, TPR=0.7240, TNR=0.7991, J=0.5231, MCC=0.5249, ConfusionMatrix=
[[2979  749]
 [ 986 2586]]
Epoch 14, Phase val, Loss=0.5166, Acc=0.7830, AUC=0.7832, TPR=0.6031, TNR=0.8151, J=0.4182, MCC=0.3470, ConfusionMatrix=
[[1772  402]
 [ 154  234]]
Epoch 14, Phase test, Loss=0.5417, Acc=0.7732, AUC=0.7719, TPR=0.6290, TNR=0.7981, J=0.4271, MCC=0.3428, ConfusionMatrix=
[[1723  436]
 [ 138  234]]
Epoch 14 complete in 61.83

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5076, Acc=0.7595, AUC=0.8311, TPR=0.7299, TNR=0.7894, J=0.5193, MCC=0.5201, ConfusionMatrix=
[[2863  764]
 [ 992 2681]]
Epoch 15, Phase val, Loss=0.5890, Acc=0.7514, AUC=0.7798, TPR=0.6856, TNR=0.7631, J=0.4487, MCC=0.3494, ConfusionMatrix=
[[1659  515]
 [ 122  266]]
Epoch 15, Phase test, Loss=0.6155, Acc=0.7211, AUC=0.7665, TPR=0.6935, TNR=0.7258, J=0.4193, MCC=0.3144, ConfusionMatrix=
[[1567  592]
 [ 114  258]]
Epoch 15 complete in 93.76

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5045, Acc=0.7595, AUC=0.8344, TPR=0.7362, TNR=0.7834, J=0.5197, MCC=0.5200, ConfusionMatrix=
[[2814  778]
 [ 978 2730]]
Epoch 16, Phase val, Loss=0.5736, Acc=0.7525, AUC=0.7801, TPR=0.6753, TNR=0.7663, J=0.4416, MCC=0.3453, ConfusionMatrix=
[[1666  508]
 [ 126  262]]
Epoch 16, Phase test, Loss=0.5937, Acc=0.7373, AUC=0.7798, TPR=0.6774, TNR=0.7476, J=0.4250, MCC=0.3240, ConfusionMatrix=
[[1614  545]
 [ 120  252]]
Epoch 16 complete in 79.29

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5017, Acc=0.7636, AUC=0.8385, TPR=0.7431, TNR=0.7843, J=0.5274, MCC=0.5278, ConfusionMatrix=
[[2844  782]
 [ 944 2730]]
Epoch 17, Phase val, Loss=0.6181, Acc=0.7221, AUC=0.7827, TPR=0.7191, TNR=0.7226, J=0.4417, MCC=0.3333, ConfusionMatrix=
[[1571  603]
 [ 109  279]]
Epoch 17, Phase test, Loss=0.6494, Acc=0.6819, AUC=0.7739, TPR=0.7285, TNR=0.6739, J=0.4024, MCC=0.2928, ConfusionMatrix=
[[1455  704]
 [ 101  271]]
Epoch 17 complete in 64.48

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5002, Acc=0.7629, AUC=0.8379, TPR=0.7334, TNR=0.7923, J=0.5258, MCC=0.5267, ConfusionMatrix=
[[2892  758]
 [ 973 2677]]
Epoch 18, Phase val, Loss=0.6131, Acc=0.7182, AUC=0.7841, TPR=0.6933, TNR=0.7226, J=0.4159, MCC=0.3147, ConfusionMatrix=
[[1571  603]
 [ 119  269]]
Epoch 18, Phase test, Loss=0.6441, Acc=0.6930, AUC=0.7761, TPR=0.7124, TNR=0.6897, J=0.4020, MCC=0.2949, ConfusionMatrix=
[[1489  670]
 [ 107  265]]
Epoch 18 complete in 54.52

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4923, Acc=0.7656, AUC=0.8417, TPR=0.7287, TNR=0.8020, J=0.5307, MCC=0.5323, ConfusionMatrix=
[[2949  728]
 [ 983 2640]]
Epoch 19, Phase val, Loss=0.5159, Acc=0.7861, AUC=0.7789, TPR=0.6005, TNR=0.8192, J=0.4197, MCC=0.3502, ConfusionMatrix=
[[1781  393]
 [ 155  233]]
Epoch 19, Phase test, Loss=0.5396, Acc=0.7811, AUC=0.7732, TPR=0.5995, TNR=0.8124, J=0.4119, MCC=0.3376, ConfusionMatrix=
[[1754  405]
 [ 149  223]]
Epoch 19 complete in 68.56

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4933, Acc=0.7741, AUC=0.8426, TPR=0.7402, TNR=0.8075, J=0.5477, MCC=0.5491, ConfusionMatrix=
[[2970  708]
 [ 941 2681]]
Epoch 20, Phase val, Loss=0.5393, Acc=0.7670, AUC=0.7798, TPR=0.6186, TNR=0.7935, J=0.4120, MCC=0.3331, ConfusionMatrix=
[[1725  449]
 [ 148  240]]
Epoch 20, Phase test, Loss=0.5617, Acc=0.7625, AUC=0.7730, TPR=0.6398, TNR=0.7837, J=0.4235, MCC=0.3345, ConfusionMatrix=
[[1692  467]
 [ 134  238]]
Epoch 20 complete in 59.66

Early Stop!
Training complete in 24m 35s
The best model val AUC=0.790209267918, test AUC=0.770171873677.
Finish training resnet50fixed-conv1x1ab-maxpool

Start training resnet50fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6512, Acc=0.6371, AUC=0.6828, TPR=0.7830, TNR=0.4891, J=0.2721, MCC=0.2848, ConfusionMatrix=
[[1772 1851]
 [ 798 2879]]
Epoch 0, Phase val, Loss=0.5350, Acc=0.7865, AUC=0.7588, TPR=0.5052, TNR=0.8367, J=0.3419, MCC=0.2983, ConfusionMatrix=
[[1819  355]
 [ 192  196]]
New Best AUC=0.7588. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5523, Acc=0.7582, AUC=0.7363, TPR=0.5349, TNR=0.7967, J=0.3316, MCC=0.2704, ConfusionMatrix=
[[1720  439]
 [ 173  199]]
Epoch 0 complete in 96.23

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5527, Acc=0.7218, AUC=0.7904, TPR=0.6842, TNR=0.7603, J=0.4444, MCC=0.4455, ConfusionMatrix=
[[2743  865]
 [1166 2526]]
Epoch 1, Phase val, Loss=0.4992, Acc=0.7970, AUC=0.7701, TPR=0.5412, TNR=0.8427, J=0.3839, MCC=0.3348, ConfusionMatrix=
[[1832  342]
 [ 178  210]]
New Best AUC=0.7701. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5269, Acc=0.7863, AUC=0.7436, TPR=0.5618, TNR=0.8249, J=0.3867, MCC=0.3245, ConfusionMatrix=
[[1781  378]
 [ 163  209]]
Epoch 1 complete in 65.57

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5419, Acc=0.7273, AUC=0.8016, TPR=0.6848, TNR=0.7702, J=0.4550, MCC=0.4566, ConfusionMatrix=
[[2795  834]
 [1157 2514]]
Epoch 2, Phase val, Loss=0.5900, Acc=0.7322, AUC=0.7764, TPR=0.6830, TNR=0.7410, J=0.4240, MCC=0.3250, ConfusionMatrix=
[[1611  563]
 [ 123  265]]
New Best AUC=0.7764. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6250, Acc=0.7005, AUC=0.7605, TPR=0.6801, TNR=0.7040, J=0.3841, MCC=0.2847, ConfusionMatrix=
[[1520  639]
 [ 119  253]]
Epoch 2 complete in 46.43

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5262, Acc=0.7400, AUC=0.8150, TPR=0.7105, TNR=0.7690, J=0.4795, MCC=0.4804, ConfusionMatrix=
[[2830  850]
 [1048 2572]]
Epoch 3, Phase val, Loss=0.4690, Acc=0.8084, AUC=0.7720, TPR=0.5077, TNR=0.8620, J=0.3697, MCC=0.3352, ConfusionMatrix=
[[1874  300]
 [ 191  197]]
Epoch 3, Phase test, Loss=0.4991, Acc=0.8107, AUC=0.7586, TPR=0.5591, TNR=0.8541, J=0.4132, MCC=0.3614, ConfusionMatrix=
[[1844  315]
 [ 164  208]]
Epoch 3 complete in 69.07

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5246, Acc=0.7442, AUC=0.8176, TPR=0.7265, TNR=0.7633, J=0.4898, MCC=0.4896, ConfusionMatrix=
[[2689  834]
 [1033 2744]]
Epoch 4, Phase val, Loss=0.5614, Acc=0.7510, AUC=0.7800, TPR=0.6701, TNR=0.7654, J=0.4355, MCC=0.3405, ConfusionMatrix=
[[1664  510]
 [ 128  260]]
New Best AUC=0.7800. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5909, Acc=0.7305, AUC=0.7774, TPR=0.6640, TNR=0.7420, J=0.4060, MCC=0.3088, ConfusionMatrix=
[[1602  557]
 [ 125  247]]
Epoch 4 complete in 54.44

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5218, Acc=0.7482, AUC=0.8190, TPR=0.7286, TNR=0.7684, J=0.4971, MCC=0.4973, ConfusionMatrix=
[[2761  832]
 [1006 2701]]
Epoch 5, Phase val, Loss=0.5165, Acc=0.7814, AUC=0.7767, TPR=0.5928, TNR=0.8151, J=0.4079, MCC=0.3392, ConfusionMatrix=
[[1772  402]
 [ 158  230]]
Epoch 5, Phase test, Loss=0.5396, Acc=0.7764, AUC=0.7632, TPR=0.6183, TNR=0.8036, J=0.4219, MCC=0.3413, ConfusionMatrix=
[[1735  424]
 [ 142  230]]
Epoch 5 complete in 73.63

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5253, Acc=0.7458, AUC=0.8161, TPR=0.7115, TNR=0.7806, J=0.4921, MCC=0.4931, ConfusionMatrix=
[[2825  794]
 [1062 2619]]
Epoch 6, Phase val, Loss=0.5266, Acc=0.7830, AUC=0.7656, TPR=0.5825, TNR=0.8188, J=0.4012, MCC=0.3358, ConfusionMatrix=
[[1780  394]
 [ 162  226]]
Epoch 6, Phase test, Loss=0.5502, Acc=0.7637, AUC=0.7650, TPR=0.6156, TNR=0.7893, J=0.4048, MCC=0.3228, ConfusionMatrix=
[[1704  455]
 [ 143  229]]
Epoch 6 complete in 49.45

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5120, Acc=0.7512, AUC=0.8256, TPR=0.7178, TNR=0.7845, J=0.5023, MCC=0.5035, ConfusionMatrix=
[[2869  788]
 [1028 2615]]
Epoch 7, Phase val, Loss=0.5748, Acc=0.7518, AUC=0.7774, TPR=0.6598, TNR=0.7682, J=0.4280, MCC=0.3359, ConfusionMatrix=
[[1670  504]
 [ 132  256]]
Epoch 7, Phase test, Loss=0.6043, Acc=0.7278, AUC=0.7704, TPR=0.6694, TNR=0.7378, J=0.4072, MCC=0.3086, ConfusionMatrix=
[[1593  566]
 [ 123  249]]
Epoch 7 complete in 85.64

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5056, Acc=0.7590, AUC=0.8328, TPR=0.7331, TNR=0.7842, J=0.5173, MCC=0.5182, ConfusionMatrix=
[[2904  799]
 [ 960 2637]]
Epoch 8, Phase val, Loss=0.5040, Acc=0.7861, AUC=0.7721, TPR=0.5799, TNR=0.8229, J=0.4028, MCC=0.3390, ConfusionMatrix=
[[1789  385]
 [ 163  225]]
Epoch 8, Phase test, Loss=0.5175, Acc=0.7783, AUC=0.7640, TPR=0.5806, TNR=0.8124, J=0.3931, MCC=0.3234, ConfusionMatrix=
[[1754  405]
 [ 156  216]]
Epoch 8 complete in 116.46

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5158, Acc=0.7482, AUC=0.8239, TPR=0.7234, TNR=0.7736, J=0.4971, MCC=0.4975, ConfusionMatrix=
[[2789  816]
 [1022 2673]]
Epoch 9, Phase val, Loss=0.5130, Acc=0.7822, AUC=0.7754, TPR=0.5979, TNR=0.8151, J=0.4130, MCC=0.3431, ConfusionMatrix=
[[1772  402]
 [ 156  232]]
Epoch 9, Phase test, Loss=0.5288, Acc=0.7732, AUC=0.7745, TPR=0.6048, TNR=0.8022, J=0.4071, MCC=0.3296, ConfusionMatrix=
[[1732  427]
 [ 147  225]]
Epoch 9 complete in 155.39

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4947, Acc=0.7645, AUC=0.8418, TPR=0.7399, TNR=0.7897, J=0.5296, MCC=0.5301, ConfusionMatrix=
[[2850  759]
 [ 960 2731]]
Epoch 10, Phase val, Loss=0.5357, Acc=0.7822, AUC=0.7743, TPR=0.6134, TNR=0.8123, J=0.4257, MCC=0.3515, ConfusionMatrix=
[[1766  408]
 [ 150  238]]
Epoch 10, Phase test, Loss=0.5560, Acc=0.7657, AUC=0.7689, TPR=0.6237, TNR=0.7902, J=0.4138, MCC=0.3298, ConfusionMatrix=
[[1706  453]
 [ 140  232]]
Epoch 10 complete in 128.14

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5037, Acc=0.7611, AUC=0.8352, TPR=0.7360, TNR=0.7870, J=0.5229, MCC=0.5234, ConfusionMatrix=
[[2830  766]
 [ 978 2726]]
Epoch 11, Phase val, Loss=0.5947, Acc=0.7299, AUC=0.7756, TPR=0.6753, TNR=0.7397, J=0.4149, MCC=0.3180, ConfusionMatrix=
[[1608  566]
 [ 126  262]]
Epoch 11, Phase test, Loss=0.6217, Acc=0.7092, AUC=0.7780, TPR=0.7124, TNR=0.7087, J=0.4210, MCC=0.3119, ConfusionMatrix=
[[1530  629]
 [ 107  265]]
Epoch 11 complete in 125.38

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5007, Acc=0.7651, AUC=0.8357, TPR=0.7325, TNR=0.7974, J=0.5298, MCC=0.5310, ConfusionMatrix=
[[2924  743]
 [ 972 2661]]
Epoch 12, Phase val, Loss=0.6209, Acc=0.7178, AUC=0.7688, TPR=0.6753, TNR=0.7254, J=0.4006, MCC=0.3042, ConfusionMatrix=
[[1577  597]
 [ 126  262]]
Epoch 12, Phase test, Loss=0.6570, Acc=0.6843, AUC=0.7732, TPR=0.7177, TNR=0.6786, J=0.3963, MCC=0.2891, ConfusionMatrix=
[[1465  694]
 [ 105  267]]
Epoch 12 complete in 126.00

Early Stop!
Training complete in 19m 52s
The best model val AUC=0.779988903537, test AUC=0.777366064536.
Finish training resnet50fixed-conv1x1ab-maxpool

Start training resnet50fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6173, Acc=0.6573, AUC=0.7325, TPR=0.7946, TNR=0.5145, J=0.3091, MCC=0.3226, ConfusionMatrix=
[[1842 1738]
 [ 764 2956]]
Epoch 0, Phase val, Loss=0.6234, Acc=0.6952, AUC=0.7581, TPR=0.6856, TNR=0.6969, J=0.3824, MCC=0.2854, ConfusionMatrix=
[[1515  659]
 [ 122  266]]
New Best AUC=0.7581. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6568, Acc=0.6685, AUC=0.7601, TPR=0.7204, TNR=0.6596, J=0.3800, MCC=0.2751, ConfusionMatrix=
[[1424  735]
 [ 104  268]]
Epoch 0 complete in 111.22

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5382, Acc=0.7311, AUC=0.8049, TPR=0.7083, TNR=0.7551, J=0.4634, MCC=0.4635, ConfusionMatrix=
[[2686  871]
 [1092 2651]]
Epoch 1, Phase val, Loss=0.6673, Acc=0.6725, AUC=0.7668, TPR=0.7294, TNR=0.6624, J=0.3918, MCC=0.2870, ConfusionMatrix=
[[1440  734]
 [ 105  283]]
New Best AUC=0.7668. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7038, Acc=0.6488, AUC=0.7705, TPR=0.7608, TNR=0.6295, J=0.3902, MCC=0.2793, ConfusionMatrix=
[[1359  800]
 [  89  283]]
Epoch 1 complete in 127.03

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5394, Acc=0.7308, AUC=0.8030, TPR=0.7101, TNR=0.7520, J=0.4621, MCC=0.4624, ConfusionMatrix=
[[2714  895]
 [1070 2621]]
Epoch 2, Phase val, Loss=0.4642, Acc=0.8173, AUC=0.7765, TPR=0.5103, TNR=0.8721, J=0.3824, MCC=0.3525, ConfusionMatrix=
[[1896  278]
 [ 190  198]]
New Best AUC=0.7765. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4855, Acc=0.8230, AUC=0.7556, TPR=0.5242, TNR=0.8745, J=0.3987, MCC=0.3642, ConfusionMatrix=
[[1888  271]
 [ 177  195]]
Epoch 2 complete in 148.84

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5277, Acc=0.7345, AUC=0.8140, TPR=0.7015, TNR=0.7684, J=0.4699, MCC=0.4708, ConfusionMatrix=
[[2767  834]
 [1104 2595]]
Epoch 3, Phase val, Loss=0.6100, Acc=0.7147, AUC=0.7733, TPR=0.6778, TNR=0.7213, J=0.3991, MCC=0.3022, ConfusionMatrix=
[[1568  606]
 [ 125  263]]
Epoch 3, Phase test, Loss=0.6410, Acc=0.6906, AUC=0.7734, TPR=0.7097, TNR=0.6874, J=0.3970, MCC=0.2910, ConfusionMatrix=
[[1484  675]
 [ 108  264]]
Epoch 3 complete in 128.04

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5234, Acc=0.7452, AUC=0.8174, TPR=0.7145, TNR=0.7760, J=0.4905, MCC=0.4914, ConfusionMatrix=
[[2830  817]
 [1043 2610]]
Epoch 4, Phase val, Loss=0.5042, Acc=0.7869, AUC=0.7742, TPR=0.5464, TNR=0.8298, J=0.3762, MCC=0.3219, ConfusionMatrix=
[[1804  370]
 [ 176  212]]
Epoch 4, Phase test, Loss=0.5243, Acc=0.7859, AUC=0.7673, TPR=0.5753, TNR=0.8221, J=0.3974, MCC=0.3313, ConfusionMatrix=
[[1775  384]
 [ 158  214]]
Epoch 4 complete in 127.25

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5090, Acc=0.7492, AUC=0.8275, TPR=0.7014, TNR=0.7948, J=0.4962, MCC=0.4988, ConfusionMatrix=
[[2967  766]
 [1065 2502]]
Epoch 5, Phase val, Loss=0.4491, Acc=0.8205, AUC=0.7827, TPR=0.5155, TNR=0.8749, J=0.3903, MCC=0.3610, ConfusionMatrix=
[[1902  272]
 [ 188  200]]
New Best AUC=0.7827. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.4719, Acc=0.8238, AUC=0.7684, TPR=0.5323, TNR=0.8740, J=0.4063, MCC=0.3699, ConfusionMatrix=
[[1887  272]
 [ 174  198]]
Epoch 5 complete in 129.75

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5189, Acc=0.7437, AUC=0.8212, TPR=0.7167, TNR=0.7712, J=0.4879, MCC=0.4885, ConfusionMatrix=
[[2788  827]
 [1044 2641]]
Epoch 6, Phase val, Loss=0.4447, Acc=0.8298, AUC=0.7738, TPR=0.5000, TNR=0.8887, J=0.3887, MCC=0.3708, ConfusionMatrix=
[[1932  242]
 [ 194  194]]
Epoch 6, Phase test, Loss=0.4642, Acc=0.8313, AUC=0.7695, TPR=0.4973, TNR=0.8888, J=0.3861, MCC=0.3658, ConfusionMatrix=
[[1919  240]
 [ 187  185]]
Epoch 6 complete in 129.47

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5172, Acc=0.7507, AUC=0.8228, TPR=0.7245, TNR=0.7777, J=0.5022, MCC=0.5027, ConfusionMatrix=
[[2792  798]
 [1022 2688]]
Epoch 7, Phase val, Loss=0.5430, Acc=0.7728, AUC=0.7814, TPR=0.6366, TNR=0.7971, J=0.4337, MCC=0.3508, ConfusionMatrix=
[[1733  441]
 [ 141  247]]
Epoch 7, Phase test, Loss=0.5643, Acc=0.7499, AUC=0.7740, TPR=0.6425, TNR=0.7684, J=0.4109, MCC=0.3200, ConfusionMatrix=
[[1659  500]
 [ 133  239]]
Epoch 7 complete in 156.25

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5120, Acc=0.7492, AUC=0.8248, TPR=0.7097, TNR=0.7885, J=0.4982, MCC=0.4998, ConfusionMatrix=
[[2882  773]
 [1058 2587]]
Epoch 8, Phase val, Loss=0.5971, Acc=0.7420, AUC=0.7726, TPR=0.6624, TNR=0.7562, J=0.4186, MCC=0.3253, ConfusionMatrix=
[[1644  530]
 [ 131  257]]
Epoch 8, Phase test, Loss=0.6224, Acc=0.7203, AUC=0.7753, TPR=0.6935, TNR=0.7249, J=0.4184, MCC=0.3135, ConfusionMatrix=
[[1565  594]
 [ 114  258]]
Epoch 8 complete in 124.72

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5095, Acc=0.7518, AUC=0.8284, TPR=0.7234, TNR=0.7806, J=0.5040, MCC=0.5047, ConfusionMatrix=
[[2828  795]
 [1017 2660]]
Epoch 9, Phase val, Loss=0.5371, Acc=0.7779, AUC=0.7761, TPR=0.6160, TNR=0.8068, J=0.4228, MCC=0.3467, ConfusionMatrix=
[[1754  420]
 [ 149  239]]
Epoch 9, Phase test, Loss=0.5654, Acc=0.7653, AUC=0.7775, TPR=0.6532, TNR=0.7846, J=0.4378, MCC=0.3454, ConfusionMatrix=
[[1694  465]
 [ 129  243]]
Epoch 9 complete in 126.52

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5103, Acc=0.7508, AUC=0.8283, TPR=0.7181, TNR=0.7832, J=0.5013, MCC=0.5024, ConfusionMatrix=
[[2875  796]
 [1023 2606]]
Epoch 10, Phase val, Loss=0.5418, Acc=0.7740, AUC=0.7762, TPR=0.6289, TNR=0.7999, J=0.4288, MCC=0.3483, ConfusionMatrix=
[[1739  435]
 [ 144  244]]
Epoch 10, Phase test, Loss=0.5660, Acc=0.7527, AUC=0.7791, TPR=0.6747, TNR=0.7661, J=0.4408, MCC=0.3410, ConfusionMatrix=
[[1654  505]
 [ 121  251]]
Epoch 10 complete in 125.07

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5030, Acc=0.7582, AUC=0.8331, TPR=0.7379, TNR=0.7789, J=0.5168, MCC=0.5171, ConfusionMatrix=
[[2818  800]
 [ 965 2717]]
Epoch 11, Phase val, Loss=0.5435, Acc=0.7724, AUC=0.7782, TPR=0.6263, TNR=0.7985, J=0.4248, MCC=0.3447, ConfusionMatrix=
[[1736  438]
 [ 145  243]]
Epoch 11, Phase test, Loss=0.5727, Acc=0.7507, AUC=0.7792, TPR=0.6640, TNR=0.7656, J=0.4296, MCC=0.3327, ConfusionMatrix=
[[1653  506]
 [ 125  247]]
Epoch 11 complete in 127.68

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5040, Acc=0.7629, AUC=0.8352, TPR=0.7317, TNR=0.7938, J=0.5255, MCC=0.5266, ConfusionMatrix=
[[2910  756]
 [ 975 2659]]
Epoch 12, Phase val, Loss=0.5215, Acc=0.7763, AUC=0.7790, TPR=0.5876, TNR=0.8100, J=0.3977, MCC=0.3291, ConfusionMatrix=
[[1761  413]
 [ 160  228]]
Epoch 12, Phase test, Loss=0.5450, Acc=0.7783, AUC=0.7823, TPR=0.6452, TNR=0.8013, J=0.4465, MCC=0.3585, ConfusionMatrix=
[[1730  429]
 [ 132  240]]
Epoch 12 complete in 130.37

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5079, Acc=0.7592, AUC=0.8318, TPR=0.7184, TNR=0.7992, J=0.5176, MCC=0.5195, ConfusionMatrix=
[[2945  740]
 [1018 2597]]
Epoch 13, Phase val, Loss=0.6253, Acc=0.7264, AUC=0.7734, TPR=0.6985, TNR=0.7314, J=0.4298, MCC=0.3268, ConfusionMatrix=
[[1590  584]
 [ 117  271]]
Epoch 13, Phase test, Loss=0.6612, Acc=0.6898, AUC=0.7823, TPR=0.7285, TNR=0.6832, J=0.4117, MCC=0.3007, ConfusionMatrix=
[[1475  684]
 [ 101  271]]
Epoch 13 complete in 149.53

Early Stop!
Training complete in 30m 42s
The best model val AUC=0.78272271171, test AUC=0.768352781804.
Finish training resnet50fixed-conv1x1ab-maxpool

Start training resnet50fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6525, Acc=0.6341, AUC=0.6815, TPR=0.7765, TNR=0.4930, J=0.2695, MCC=0.2810, ConfusionMatrix=
[[1808 1859]
 [ 812 2821]]
Epoch 0, Phase val, Loss=0.7263, Acc=0.5648, AUC=0.7281, TPR=0.8067, TNR=0.5216, J=0.3283, MCC=0.2358, ConfusionMatrix=
[[1134 1040]
 [  75  313]]
New Best AUC=0.7281. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7500, Acc=0.5527, AUC=0.7352, TPR=0.8091, TNR=0.5086, J=0.3177, MCC=0.2256, ConfusionMatrix=
[[1098 1061]
 [  71  301]]
Epoch 0 complete in 127.22

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5662, Acc=0.7190, AUC=0.7791, TPR=0.6949, TNR=0.7435, J=0.4384, MCC=0.4388, ConfusionMatrix=
[[2698  931]
 [1120 2551]]
Epoch 1, Phase val, Loss=0.4322, Acc=0.8310, AUC=0.7648, TPR=0.3582, TNR=0.9154, J=0.2736, MCC=0.2955, ConfusionMatrix=
[[1990  184]
 [ 249  139]]
New Best AUC=0.7648. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4521, Acc=0.8317, AUC=0.7355, TPR=0.4328, TNR=0.9004, J=0.3332, MCC=0.3317, ConfusionMatrix=
[[1944  215]
 [ 211  161]]
Epoch 1 complete in 125.89

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5487, Acc=0.7226, AUC=0.7943, TPR=0.7018, TNR=0.7449, J=0.4467, MCC=0.4466, ConfusionMatrix=
[[2625  899]
 [1126 2650]]
Epoch 2, Phase val, Loss=0.7378, Acc=0.6319, AUC=0.7674, TPR=0.7809, TNR=0.6053, J=0.3863, MCC=0.2782, ConfusionMatrix=
[[1316  858]
 [  85  303]]
New Best AUC=0.7674. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.7860, Acc=0.5812, AUC=0.7694, TPR=0.8145, TNR=0.5410, J=0.3555, MCC=0.2518, ConfusionMatrix=
[[1168  991]
 [  69  303]]
Epoch 2 complete in 130.07

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5222, Acc=0.7415, AUC=0.8172, TPR=0.7098, TNR=0.7733, J=0.4831, MCC=0.4841, ConfusionMatrix=
[[2818  826]
 [1061 2595]]
Epoch 3, Phase val, Loss=0.6063, Acc=0.7264, AUC=0.7735, TPR=0.6701, TNR=0.7364, J=0.4065, MCC=0.3111, ConfusionMatrix=
[[1601  573]
 [ 128  260]]
New Best AUC=0.7735. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6462, Acc=0.6974, AUC=0.7720, TPR=0.6962, TNR=0.6975, J=0.3938, MCC=0.2904, ConfusionMatrix=
[[1506  653]
 [ 113  259]]
Epoch 3 complete in 141.33

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5312, Acc=0.7371, AUC=0.8120, TPR=0.7164, TNR=0.7587, J=0.4751, MCC=0.4752, ConfusionMatrix=
[[2716  864]
 [1055 2665]]
Epoch 4, Phase val, Loss=0.5336, Acc=0.7674, AUC=0.7776, TPR=0.6160, TNR=0.7944, J=0.4104, MCC=0.3322, ConfusionMatrix=
[[1727  447]
 [ 149  239]]
New Best AUC=0.7776. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5608, Acc=0.7574, AUC=0.7651, TPR=0.6317, TNR=0.7791, J=0.4108, MCC=0.3235, ConfusionMatrix=
[[1682  477]
 [ 137  235]]
Epoch 4 complete in 144.39

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5156, Acc=0.7514, AUC=0.8243, TPR=0.7251, TNR=0.7781, J=0.5032, MCC=0.5038, ConfusionMatrix=
[[2816  803]
 [1012 2669]]
Epoch 5, Phase val, Loss=0.5317, Acc=0.7705, AUC=0.7777, TPR=0.6211, TNR=0.7971, J=0.4183, MCC=0.3393, ConfusionMatrix=
[[1733  441]
 [ 147  241]]
New Best AUC=0.7777. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5494, Acc=0.7732, AUC=0.7765, TPR=0.6237, TNR=0.7990, J=0.4226, MCC=0.3399, ConfusionMatrix=
[[1725  434]
 [ 140  232]]
Epoch 5 complete in 124.51

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5162, Acc=0.7529, AUC=0.8253, TPR=0.7167, TNR=0.7884, J=0.5050, MCC=0.5065, ConfusionMatrix=
[[2906  780]
 [1024 2590]]
Epoch 6, Phase val, Loss=0.4981, Acc=0.7931, AUC=0.7784, TPR=0.5619, TNR=0.8344, J=0.3963, MCC=0.3399, ConfusionMatrix=
[[1814  360]
 [ 170  218]]
New Best AUC=0.7784. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5211, Acc=0.7866, AUC=0.7704, TPR=0.5833, TNR=0.8217, J=0.4050, MCC=0.3368, ConfusionMatrix=
[[1774  385]
 [ 155  217]]
Epoch 6 complete in 123.80

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5085, Acc=0.7570, AUC=0.8307, TPR=0.7179, TNR=0.7961, J=0.5140, MCC=0.5156, ConfusionMatrix=
[[2905  744]
 [1030 2621]]
Epoch 7, Phase val, Loss=0.5148, Acc=0.7802, AUC=0.7757, TPR=0.5799, TNR=0.8160, J=0.3959, MCC=0.3305, ConfusionMatrix=
[[1774  400]
 [ 163  225]]
Epoch 7, Phase test, Loss=0.5335, Acc=0.7756, AUC=0.7730, TPR=0.6048, TNR=0.8050, J=0.4098, MCC=0.3328, ConfusionMatrix=
[[1738  421]
 [ 147  225]]
Epoch 7 complete in 124.90

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5021, Acc=0.7638, AUC=0.8352, TPR=0.7299, TNR=0.7967, J=0.5266, MCC=0.5280, ConfusionMatrix=
[[2955  754]
 [ 970 2621]]
Epoch 8, Phase val, Loss=0.5339, Acc=0.7642, AUC=0.7717, TPR=0.5979, TNR=0.7939, J=0.3919, MCC=0.3181, ConfusionMatrix=
[[1726  448]
 [ 156  232]]
Epoch 8, Phase test, Loss=0.5601, Acc=0.7542, AUC=0.7757, TPR=0.6290, TNR=0.7758, J=0.4049, MCC=0.3180, ConfusionMatrix=
[[1675  484]
 [ 138  234]]
Epoch 8 complete in 127.70

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5003, Acc=0.7616, AUC=0.8367, TPR=0.7366, TNR=0.7866, J=0.5233, MCC=0.5239, ConfusionMatrix=
[[2872  779]
 [ 961 2688]]
Epoch 9, Phase val, Loss=0.5698, Acc=0.7525, AUC=0.7754, TPR=0.6418, TNR=0.7723, J=0.4141, MCC=0.3270, ConfusionMatrix=
[[1679  495]
 [ 139  249]]
Epoch 9, Phase test, Loss=0.5904, Acc=0.7408, AUC=0.7818, TPR=0.6855, TNR=0.7503, J=0.4358, MCC=0.3326, ConfusionMatrix=
[[1620  539]
 [ 117  255]]
Epoch 9 complete in 140.37

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5015, Acc=0.7599, AUC=0.8349, TPR=0.7321, TNR=0.7888, J=0.5209, MCC=0.5213, ConfusionMatrix=
[[2820  755]
 [ 998 2727]]
Epoch 10, Phase val, Loss=0.5407, Acc=0.7627, AUC=0.7754, TPR=0.6082, TNR=0.7902, J=0.3985, MCC=0.3217, ConfusionMatrix=
[[1718  456]
 [ 152  236]]
Epoch 10, Phase test, Loss=0.5670, Acc=0.7574, AUC=0.7896, TPR=0.6720, TNR=0.7721, J=0.4442, MCC=0.3455, ConfusionMatrix=
[[1667  492]
 [ 122  250]]
Epoch 10 complete in 142.69

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5021, Acc=0.7589, AUC=0.8352, TPR=0.7390, TNR=0.7788, J=0.5177, MCC=0.5182, ConfusionMatrix=
[[2848  809]
 [ 951 2692]]
Epoch 11, Phase val, Loss=0.5283, Acc=0.7795, AUC=0.7772, TPR=0.6031, TNR=0.8109, J=0.4140, MCC=0.3420, ConfusionMatrix=
[[1763  411]
 [ 154  234]]
Epoch 11, Phase test, Loss=0.5497, Acc=0.7740, AUC=0.7785, TPR=0.6398, TNR=0.7971, J=0.4369, MCC=0.3497, ConfusionMatrix=
[[1721  438]
 [ 134  238]]
Epoch 11 complete in 121.75

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4996, Acc=0.7637, AUC=0.8384, TPR=0.7324, TNR=0.7946, J=0.5270, MCC=0.5281, ConfusionMatrix=
[[2920  755]
 [ 970 2655]]
Epoch 12, Phase val, Loss=0.5159, Acc=0.7849, AUC=0.7780, TPR=0.6057, TNR=0.8169, J=0.4226, MCC=0.3512, ConfusionMatrix=
[[1776  398]
 [ 153  235]]
Epoch 12, Phase test, Loss=0.5331, Acc=0.7835, AUC=0.7830, TPR=0.6371, TNR=0.8087, J=0.4458, MCC=0.3613, ConfusionMatrix=
[[1746  413]
 [ 135  237]]
Epoch 12 complete in 124.91

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5042, Acc=0.7589, AUC=0.8326, TPR=0.7055, TNR=0.8106, J=0.5162, MCC=0.5194, ConfusionMatrix=
[[3005  702]
 [1058 2535]]
Epoch 13, Phase val, Loss=0.5077, Acc=0.7830, AUC=0.7818, TPR=0.5876, TNR=0.8178, J=0.4055, MCC=0.3386, ConfusionMatrix=
[[1778  396]
 [ 160  228]]
New Best AUC=0.7818. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 13, Phase test, Loss=0.5272, Acc=0.7827, AUC=0.7825, TPR=0.6344, TNR=0.8082, J=0.4427, MCC=0.3588, ConfusionMatrix=
[[1745  414]
 [ 136  236]]
Epoch 13 complete in 131.02

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5068, Acc=0.7564, AUC=0.8305, TPR=0.7302, TNR=0.7824, J=0.5126, MCC=0.5134, ConfusionMatrix=
[[2870  798]
 [ 980 2652]]
Epoch 14, Phase val, Loss=0.4788, Acc=0.8009, AUC=0.7817, TPR=0.5464, TNR=0.8464, J=0.3928, MCC=0.3438, ConfusionMatrix=
[[1840  334]
 [ 176  212]]
Epoch 14, Phase test, Loss=0.4948, Acc=0.8119, AUC=0.7825, TPR=0.5914, TNR=0.8499, J=0.4413, MCC=0.3804, ConfusionMatrix=
[[1835  324]
 [ 152  220]]
Epoch 14 complete in 141.67

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4977, Acc=0.7629, AUC=0.8399, TPR=0.7336, TNR=0.7922, J=0.5258, MCC=0.5267, ConfusionMatrix=
[[2890  758]
 [ 973 2679]]
Epoch 15, Phase val, Loss=0.5214, Acc=0.7814, AUC=0.7814, TPR=0.6031, TNR=0.8132, J=0.4163, MCC=0.3448, ConfusionMatrix=
[[1768  406]
 [ 154  234]]
Epoch 15, Phase test, Loss=0.5492, Acc=0.7685, AUC=0.7766, TPR=0.6371, TNR=0.7911, J=0.4282, MCC=0.3408, ConfusionMatrix=
[[1708  451]
 [ 135  237]]
Epoch 15 complete in 131.95

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4966, Acc=0.7652, AUC=0.8391, TPR=0.7447, TNR=0.7861, J=0.5309, MCC=0.5312, ConfusionMatrix=
[[2838  772]
 [ 942 2748]]
Epoch 16, Phase val, Loss=0.5458, Acc=0.7717, AUC=0.7829, TPR=0.6211, TNR=0.7985, J=0.4197, MCC=0.3409, ConfusionMatrix=
[[1736  438]
 [ 147  241]]
New Best AUC=0.7829. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 16, Phase test, Loss=0.5686, Acc=0.7578, AUC=0.7830, TPR=0.6425, TNR=0.7777, J=0.4201, MCC=0.3299, ConfusionMatrix=
[[1679  480]
 [ 133  239]]
Epoch 16 complete in 135.18

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4995, Acc=0.7651, AUC=0.8379, TPR=0.7337, TNR=0.7966, J=0.5303, MCC=0.5313, ConfusionMatrix=
[[2902  741]
 [ 974 2683]]
Epoch 17, Phase val, Loss=0.6092, Acc=0.7291, AUC=0.7677, TPR=0.6546, TNR=0.7424, J=0.3970, MCC=0.3057, ConfusionMatrix=
[[1614  560]
 [ 134  254]]
Epoch 17, Phase test, Loss=0.6304, Acc=0.7096, AUC=0.7853, TPR=0.7151, TNR=0.7087, J=0.4237, MCC=0.3138, ConfusionMatrix=
[[1530  629]
 [ 106  266]]
Epoch 17 complete in 111.21

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4946, Acc=0.7726, AUC=0.8394, TPR=0.7279, TNR=0.8156, J=0.5435, MCC=0.5460, ConfusionMatrix=
[[3035  686]
 [ 974 2605]]
Epoch 18, Phase val, Loss=0.4792, Acc=0.8072, AUC=0.7785, TPR=0.5567, TNR=0.8519, J=0.4086, MCC=0.3596, ConfusionMatrix=
[[1852  322]
 [ 172  216]]
Epoch 18, Phase test, Loss=0.4987, Acc=0.8052, AUC=0.7783, TPR=0.5941, TNR=0.8416, J=0.4357, MCC=0.3709, ConfusionMatrix=
[[1817  342]
 [ 151  221]]
Epoch 18 complete in 122.15

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4957, Acc=0.7649, AUC=0.8394, TPR=0.7352, TNR=0.7951, J=0.5303, MCC=0.5311, ConfusionMatrix=
[[2883  743]
 [ 973 2701]]
Epoch 19, Phase val, Loss=0.4919, Acc=0.7970, AUC=0.7740, TPR=0.5747, TNR=0.8367, J=0.4114, MCC=0.3529, ConfusionMatrix=
[[1819  355]
 [ 165  223]]
Epoch 19, Phase test, Loss=0.5133, Acc=0.7930, AUC=0.7783, TPR=0.5860, TNR=0.8286, J=0.4146, MCC=0.3477, ConfusionMatrix=
[[1789  370]
 [ 154  218]]
Epoch 19 complete in 125.35

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4982, Acc=0.7637, AUC=0.8394, TPR=0.7406, TNR=0.7867, J=0.5273, MCC=0.5279, ConfusionMatrix=
[[2880  781]
 [ 944 2695]]
Epoch 20, Phase val, Loss=0.5543, Acc=0.7576, AUC=0.7767, TPR=0.6521, TNR=0.7764, J=0.4285, MCC=0.3391, ConfusionMatrix=
[[1688  486]
 [ 135  253]]
Epoch 20, Phase test, Loss=0.5777, Acc=0.7479, AUC=0.7798, TPR=0.6613, TNR=0.7629, J=0.4241, MCC=0.3279, ConfusionMatrix=
[[1647  512]
 [ 126  246]]
Epoch 20 complete in 122.98

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.5005, Acc=0.7610, AUC=0.8361, TPR=0.7451, TNR=0.7777, J=0.5228, MCC=0.5227, ConfusionMatrix=
[[2761  789]
 [ 956 2794]]
Epoch 21, Phase val, Loss=0.5447, Acc=0.7670, AUC=0.7783, TPR=0.6418, TNR=0.7893, J=0.4311, MCC=0.3457, ConfusionMatrix=
[[1716  458]
 [ 139  249]]
Epoch 21, Phase test, Loss=0.5691, Acc=0.7515, AUC=0.7804, TPR=0.6640, TNR=0.7666, J=0.4305, MCC=0.3337, ConfusionMatrix=
[[1655  504]
 [ 125  247]]
Epoch 21 complete in 128.28

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4847, Acc=0.7737, AUC=0.8497, TPR=0.7504, TNR=0.7975, J=0.5479, MCC=0.5483, ConfusionMatrix=
[[2879  731]
 [ 921 2769]]
Epoch 22, Phase val, Loss=0.5283, Acc=0.7783, AUC=0.7759, TPR=0.6031, TNR=0.8096, J=0.4127, MCC=0.3403, ConfusionMatrix=
[[1760  414]
 [ 154  234]]
Epoch 22, Phase test, Loss=0.5471, Acc=0.7701, AUC=0.7786, TPR=0.6317, TNR=0.7939, J=0.4256, MCC=0.3400, ConfusionMatrix=
[[1714  445]
 [ 137  235]]
Epoch 22 complete in 145.75

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.4843, Acc=0.7727, AUC=0.8487, TPR=0.7411, TNR=0.8036, J=0.5448, MCC=0.5460, ConfusionMatrix=
[[2967  725]
 [ 934 2674]]
Epoch 23, Phase val, Loss=0.5191, Acc=0.7822, AUC=0.7728, TPR=0.6005, TNR=0.8146, J=0.4151, MCC=0.3445, ConfusionMatrix=
[[1771  403]
 [ 155  233]]
Epoch 23, Phase test, Loss=0.5381, Acc=0.7736, AUC=0.7736, TPR=0.6102, TNR=0.8018, J=0.4120, MCC=0.3331, ConfusionMatrix=
[[1731  428]
 [ 145  227]]
Epoch 23 complete in 126.04

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.4972, Acc=0.7599, AUC=0.8387, TPR=0.7296, TNR=0.7908, J=0.5204, MCC=0.5212, ConfusionMatrix=
[[2854  755]
 [ 998 2693]]
Epoch 24, Phase val, Loss=0.5238, Acc=0.7795, AUC=0.7790, TPR=0.6160, TNR=0.8086, J=0.4246, MCC=0.3489, ConfusionMatrix=
[[1758  416]
 [ 149  239]]
Epoch 24, Phase test, Loss=0.5446, Acc=0.7768, AUC=0.7720, TPR=0.6398, TNR=0.8004, J=0.4402, MCC=0.3534, ConfusionMatrix=
[[1728  431]
 [ 134  238]]
Epoch 24 complete in 127.57

Early Stop!
Training complete in 54m 9s
The best model val AUC=0.782900539649, test AUC=0.78302006604.
Finish training resnet50fixed-conv1x1ab-maxpool

Start training resnet50fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6526, Acc=0.6221, AUC=0.6800, TPR=0.7038, TNR=0.5401, J=0.2438, MCC=0.2472, ConfusionMatrix=
[[1968 1676]
 [1083 2573]]
Epoch 0, Phase val, Loss=0.6768, Acc=0.5472, AUC=0.7138, TPR=0.8119, TNR=0.5000, J=0.3119, MCC=0.2246, ConfusionMatrix=
[[1087 1087]
 [  73  315]]
New Best AUC=0.7138. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6817, Acc=0.5444, AUC=0.6969, TPR=0.7823, TNR=0.5035, J=0.2857, MCC=0.2029, ConfusionMatrix=
[[1087 1072]
 [  81  291]]
Epoch 0 complete in 108.08

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5975, Acc=0.6838, AUC=0.7481, TPR=0.7363, TNR=0.6314, J=0.3677, MCC=0.3698, ConfusionMatrix=
[[2306 1346]
 [ 962 2686]]
Epoch 1, Phase val, Loss=0.5471, Acc=0.7198, AUC=0.7345, TPR=0.6057, TNR=0.7401, J=0.3458, MCC=0.2675, ConfusionMatrix=
[[1609  565]
 [ 153  235]]
New Best AUC=0.7345. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5636, Acc=0.6910, AUC=0.7307, TPR=0.6425, TNR=0.6994, J=0.3419, MCC=0.2536, ConfusionMatrix=
[[1510  649]
 [ 133  239]]
Epoch 1 complete in 97.44

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5649, Acc=0.7086, AUC=0.7797, TPR=0.7283, TNR=0.6886, J=0.4169, MCC=0.4173, ConfusionMatrix=
[[2492 1127]
 [1000 2681]]
Epoch 2, Phase val, Loss=0.5525, Acc=0.7186, AUC=0.7409, TPR=0.6186, TNR=0.7364, J=0.3550, MCC=0.2734, ConfusionMatrix=
[[1601  573]
 [ 148  240]]
New Best AUC=0.7409. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5782, Acc=0.6898, AUC=0.7379, TPR=0.6613, TNR=0.6948, J=0.3561, MCC=0.2630, ConfusionMatrix=
[[1500  659]
 [ 126  246]]
Epoch 2 complete in 112.35

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5649, Acc=0.7085, AUC=0.7805, TPR=0.6985, TNR=0.7180, J=0.4165, MCC=0.4166, ConfusionMatrix=
[[2684 1054]
 [1074 2488]]
Epoch 3, Phase val, Loss=0.6762, Acc=0.6233, AUC=0.7511, TPR=0.7835, TNR=0.5948, J=0.3783, MCC=0.2720, ConfusionMatrix=
[[1293  881]
 [  84  304]]
New Best AUC=0.7511. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.7106, Acc=0.5863, AUC=0.7393, TPR=0.7796, TNR=0.5530, J=0.3326, MCC=0.2355, ConfusionMatrix=
[[1194  965]
 [  82  290]]
Epoch 3 complete in 153.12

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5505, Acc=0.7215, AUC=0.7942, TPR=0.7217, TNR=0.7213, J=0.4430, MCC=0.4430, ConfusionMatrix=
[[2671 1032]
 [1001 2596]]
Epoch 4, Phase val, Loss=0.7104, Acc=0.6023, AUC=0.7543, TPR=0.8093, TNR=0.5653, J=0.3746, MCC=0.2686, ConfusionMatrix=
[[1229  945]
 [  74  314]]
New Best AUC=0.7543. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.7489, Acc=0.5666, AUC=0.7451, TPR=0.8065, TNR=0.5252, J=0.3317, MCC=0.2352, ConfusionMatrix=
[[1134 1025]
 [  72  300]]
Epoch 4 complete in 129.10

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5380, Acc=0.7292, AUC=0.8055, TPR=0.7436, TNR=0.7146, J=0.4583, MCC=0.4585, ConfusionMatrix=
[[2602 1039]
 [ 938 2721]]
Epoch 5, Phase val, Loss=0.5019, Acc=0.7592, AUC=0.7599, TPR=0.5799, TNR=0.7912, J=0.3711, MCC=0.3014, ConfusionMatrix=
[[1720  454]
 [ 163  225]]
New Best AUC=0.7599. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5211, Acc=0.7392, AUC=0.7492, TPR=0.6183, TNR=0.7601, J=0.3784, MCC=0.2936, ConfusionMatrix=
[[1641  518]
 [ 142  230]]
Epoch 5 complete in 125.34

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5483, Acc=0.7289, AUC=0.7966, TPR=0.7355, TNR=0.7223, J=0.4577, MCC=0.4578, ConfusionMatrix=
[[2616 1006]
 [ 973 2705]]
Epoch 6, Phase val, Loss=0.4427, Acc=0.7998, AUC=0.7470, TPR=0.3995, TNR=0.8712, J=0.2707, MCC=0.2585, ConfusionMatrix=
[[1894  280]
 [ 233  155]]
Epoch 6, Phase test, Loss=0.4508, Acc=0.7993, AUC=0.7421, TPR=0.4677, TNR=0.8564, J=0.3242, MCC=0.2919, ConfusionMatrix=
[[1849  310]
 [ 198  174]]
Epoch 6 complete in 125.41

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5458, Acc=0.7200, AUC=0.7965, TPR=0.7209, TNR=0.7191, J=0.4400, MCC=0.4400, ConfusionMatrix=
[[2647 1034]
 [1010 2609]]
Epoch 7, Phase val, Loss=0.5987, Acc=0.6874, AUC=0.7550, TPR=0.7345, TNR=0.6789, J=0.4135, MCC=0.3048, ConfusionMatrix=
[[1476  698]
 [ 103  285]]
Epoch 7, Phase test, Loss=0.6248, Acc=0.6606, AUC=0.7504, TPR=0.7124, TNR=0.6517, J=0.3641, MCC=0.2629, ConfusionMatrix=
[[1407  752]
 [ 107  265]]
Epoch 7 complete in 125.18

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5494, Acc=0.7218, AUC=0.7955, TPR=0.7304, TNR=0.7132, J=0.4436, MCC=0.4436, ConfusionMatrix=
[[2606 1048]
 [ 983 2663]]
Epoch 8, Phase val, Loss=0.5709, Acc=0.7092, AUC=0.7476, TPR=0.6521, TNR=0.7194, J=0.3715, MCC=0.2818, ConfusionMatrix=
[[1564  610]
 [ 135  253]]
Epoch 8, Phase test, Loss=0.5872, Acc=0.6898, AUC=0.7496, TPR=0.6667, TNR=0.6938, J=0.3605, MCC=0.2661, ConfusionMatrix=
[[1498  661]
 [ 124  248]]
Epoch 8 complete in 128.75

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5358, Acc=0.7332, AUC=0.8080, TPR=0.7385, TNR=0.7279, J=0.4664, MCC=0.4664, ConfusionMatrix=
[[2681 1002]
 [ 946 2671]]
Epoch 9, Phase val, Loss=0.6360, Acc=0.6616, AUC=0.7551, TPR=0.7397, TNR=0.6477, J=0.3873, MCC=0.2822, ConfusionMatrix=
[[1408  766]
 [ 101  287]]
Epoch 9, Phase test, Loss=0.6523, Acc=0.6416, AUC=0.7563, TPR=0.7581, TNR=0.6216, J=0.3796, MCC=0.2712, ConfusionMatrix=
[[1342  817]
 [  90  282]]
Epoch 9 complete in 145.83

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5306, Acc=0.7503, AUC=0.8133, TPR=0.7569, TNR=0.7435, J=0.5004, MCC=0.5005, ConfusionMatrix=
[[2693  929]
 [ 894 2784]]
Epoch 10, Phase val, Loss=0.6983, Acc=0.6230, AUC=0.7496, TPR=0.7732, TNR=0.5961, J=0.3693, MCC=0.2657, ConfusionMatrix=
[[1296  878]
 [  88  300]]
Epoch 10, Phase test, Loss=0.7215, Acc=0.6002, AUC=0.7521, TPR=0.7930, TNR=0.5669, J=0.3599, MCC=0.2550, ConfusionMatrix=
[[1224  935]
 [  77  295]]
Epoch 10 complete in 133.56

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5280, Acc=0.7451, AUC=0.8156, TPR=0.7453, TNR=0.7449, J=0.4901, MCC=0.4901, ConfusionMatrix=
[[2759  945]
 [ 916 2680]]
Epoch 11, Phase val, Loss=0.5299, Acc=0.7529, AUC=0.7525, TPR=0.6108, TNR=0.7783, J=0.3891, MCC=0.3105, ConfusionMatrix=
[[1692  482]
 [ 151  237]]
Epoch 11, Phase test, Loss=0.5410, Acc=0.7266, AUC=0.7540, TPR=0.6290, TNR=0.7434, J=0.3724, MCC=0.2848, ConfusionMatrix=
[[1605  554]
 [ 138  234]]
Epoch 11 complete in 126.71

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5430, Acc=0.7336, AUC=0.8018, TPR=0.7379, TNR=0.7292, J=0.4671, MCC=0.4671, ConfusionMatrix=
[[2663  989]
 [ 956 2692]]
Epoch 12, Phase val, Loss=0.5998, Acc=0.6979, AUC=0.7505, TPR=0.6959, TNR=0.6983, J=0.3941, MCC=0.2941, ConfusionMatrix=
[[1518  656]
 [ 118  270]]
Epoch 12, Phase test, Loss=0.6259, Acc=0.6685, AUC=0.7514, TPR=0.6935, TNR=0.6642, J=0.3577, MCC=0.2599, ConfusionMatrix=
[[1434  725]
 [ 114  258]]
Epoch 12 complete in 125.37

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5337, Acc=0.7396, AUC=0.8098, TPR=0.7477, TNR=0.7314, J=0.4791, MCC=0.4792, ConfusionMatrix=
[[2660  977]
 [ 924 2739]]
Epoch 13, Phase val, Loss=0.5425, Acc=0.7342, AUC=0.7547, TPR=0.6186, TNR=0.7548, J=0.3734, MCC=0.2916, ConfusionMatrix=
[[1641  533]
 [ 148  240]]
Epoch 13, Phase test, Loss=0.5553, Acc=0.7175, AUC=0.7555, TPR=0.6505, TNR=0.7290, J=0.3796, MCC=0.2866, ConfusionMatrix=
[[1574  585]
 [ 130  242]]
Epoch 13 complete in 126.26

Early Stop!
Training complete in 29m 23s
The best model val AUC=0.75993583968, test AUC=0.74924671418.
Finish training resnet50fixed-conv1x1ab-avgpool

Start training resnet50fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6553, Acc=0.6252, AUC=0.6721, TPR=0.6886, TNR=0.5628, J=0.2514, MCC=0.2533, ConfusionMatrix=
[[2070 1608]
 [1128 2494]]
Epoch 0, Phase val, Loss=0.6544, Acc=0.5710, AUC=0.7155, TPR=0.7912, TNR=0.5317, J=0.3230, MCC=0.2317, ConfusionMatrix=
[[1156 1018]
 [  81  307]]
New Best AUC=0.7155. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6621, Acc=0.5646, AUC=0.6987, TPR=0.7688, TNR=0.5294, J=0.2982, MCC=0.2113, ConfusionMatrix=
[[1143 1016]
 [  86  286]]
Epoch 0 complete in 128.54

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5941, Acc=0.6942, AUC=0.7556, TPR=0.7392, TNR=0.6497, J=0.3889, MCC=0.3904, ConfusionMatrix=
[[2381 1284]
 [ 948 2687]]
Epoch 1, Phase val, Loss=0.5673, Acc=0.7026, AUC=0.7419, TPR=0.6804, TNR=0.7065, J=0.3869, MCC=0.2904, ConfusionMatrix=
[[1536  638]
 [ 124  264]]
New Best AUC=0.7419. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5898, Acc=0.6669, AUC=0.7298, TPR=0.6909, TNR=0.6628, J=0.3537, MCC=0.2568, ConfusionMatrix=
[[1431  728]
 [ 115  257]]
Epoch 1 complete in 143.61

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5573, Acc=0.7248, AUC=0.7911, TPR=0.7374, TNR=0.7125, J=0.4499, MCC=0.4500, ConfusionMatrix=
[[2634 1063]
 [ 946 2657]]
Epoch 2, Phase val, Loss=0.4501, Acc=0.7951, AUC=0.7545, TPR=0.4381, TNR=0.8588, J=0.2969, MCC=0.2735, ConfusionMatrix=
[[1867  307]
 [ 218  170]]
New Best AUC=0.7545. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4631, Acc=0.7949, AUC=0.7404, TPR=0.4892, TNR=0.8476, J=0.3369, MCC=0.2971, ConfusionMatrix=
[[1830  329]
 [ 190  182]]
Epoch 2 complete in 126.52

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5569, Acc=0.7178, AUC=0.7893, TPR=0.7128, TNR=0.7227, J=0.4354, MCC=0.4354, ConfusionMatrix=
[[2684 1030]
 [1030 2556]]
Epoch 3, Phase val, Loss=0.5550, Acc=0.7264, AUC=0.7514, TPR=0.6495, TNR=0.7401, J=0.3896, MCC=0.2997, ConfusionMatrix=
[[1609  565]
 [ 136  252]]
Epoch 3, Phase test, Loss=0.5773, Acc=0.6914, AUC=0.7433, TPR=0.6586, TNR=0.6971, J=0.3557, MCC=0.2632, ConfusionMatrix=
[[1505  654]
 [ 127  245]]
Epoch 3 complete in 126.17

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5519, Acc=0.7218, AUC=0.7937, TPR=0.7216, TNR=0.7219, J=0.4436, MCC=0.4435, ConfusionMatrix=
[[2674 1030]
 [1001 2595]]
Epoch 4, Phase val, Loss=0.5356, Acc=0.7354, AUC=0.7408, TPR=0.5954, TNR=0.7603, J=0.3557, MCC=0.2800, ConfusionMatrix=
[[1653  521]
 [ 157  231]]
Epoch 4, Phase test, Loss=0.5519, Acc=0.7234, AUC=0.7398, TPR=0.6290, TNR=0.7397, J=0.3687, MCC=0.2812, ConfusionMatrix=
[[1597  562]
 [ 138  234]]
Epoch 4 complete in 125.87

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5566, Acc=0.7147, AUC=0.7879, TPR=0.7268, TNR=0.7021, J=0.4288, MCC=0.4290, ConfusionMatrix=
[[2512 1066]
 [1017 2705]]
Epoch 5, Phase val, Loss=0.6648, Acc=0.6393, AUC=0.7535, TPR=0.7758, TNR=0.6150, J=0.3908, MCC=0.2819, ConfusionMatrix=
[[1337  837]
 [  87  301]]
Epoch 5, Phase test, Loss=0.6927, Acc=0.6013, AUC=0.7495, TPR=0.7581, TNR=0.5743, J=0.3324, MCC=0.2357, ConfusionMatrix=
[[1240  919]
 [  90  282]]
Epoch 5 complete in 124.73

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5504, Acc=0.7259, AUC=0.7956, TPR=0.7305, TNR=0.7212, J=0.4518, MCC=0.4518, ConfusionMatrix=
[[2626 1015]
 [ 986 2673]]
Epoch 6, Phase val, Loss=0.5219, Acc=0.7572, AUC=0.7510, TPR=0.6082, TNR=0.7838, J=0.3921, MCC=0.3146, ConfusionMatrix=
[[1704  470]
 [ 152  236]]
Epoch 6, Phase test, Loss=0.5353, Acc=0.7325, AUC=0.7492, TPR=0.6317, TNR=0.7499, J=0.3816, MCC=0.2932, ConfusionMatrix=
[[1619  540]
 [ 137  235]]
Epoch 6 complete in 153.56

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5461, Acc=0.7207, AUC=0.7979, TPR=0.7269, TNR=0.7144, J=0.4413, MCC=0.4414, ConfusionMatrix=
[[2597 1038]
 [1001 2664]]
Epoch 7, Phase val, Loss=0.4458, Acc=0.8060, AUC=0.7451, TPR=0.4072, TNR=0.8772, J=0.2844, MCC=0.2741, ConfusionMatrix=
[[1907  267]
 [ 230  158]]
Epoch 7, Phase test, Loss=0.4520, Acc=0.7997, AUC=0.7418, TPR=0.4704, TNR=0.8564, J=0.3268, MCC=0.2940, ConfusionMatrix=
[[1849  310]
 [ 197  175]]
Epoch 7 complete in 129.76

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5370, Acc=0.7310, AUC=0.8060, TPR=0.7358, TNR=0.7261, J=0.4619, MCC=0.4619, ConfusionMatrix=
[[2638  995]
 [ 969 2698]]
Epoch 8, Phase val, Loss=0.5520, Acc=0.7303, AUC=0.7538, TPR=0.6546, TNR=0.7438, J=0.3984, MCC=0.3071, ConfusionMatrix=
[[1617  557]
 [ 134  254]]
Epoch 8, Phase test, Loss=0.5678, Acc=0.7112, AUC=0.7470, TPR=0.6613, TNR=0.7198, J=0.3811, MCC=0.2856, ConfusionMatrix=
[[1554  605]
 [ 126  246]]
Epoch 8 complete in 126.25

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5373, Acc=0.7340, AUC=0.8063, TPR=0.7345, TNR=0.7335, J=0.4680, MCC=0.4679, ConfusionMatrix=
[[2694  979]
 [ 963 2664]]
Epoch 9, Phase val, Loss=0.5465, Acc=0.7404, AUC=0.7543, TPR=0.6546, TNR=0.7557, J=0.4104, MCC=0.3191, ConfusionMatrix=
[[1643  531]
 [ 134  254]]
Epoch 9, Phase test, Loss=0.5614, Acc=0.7100, AUC=0.7523, TPR=0.6452, TNR=0.7212, J=0.3663, MCC=0.2753, ConfusionMatrix=
[[1557  602]
 [ 132  240]]
Epoch 9 complete in 125.99

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5347, Acc=0.7292, AUC=0.8078, TPR=0.7271, TNR=0.7312, J=0.4583, MCC=0.4583, ConfusionMatrix=
[[2698  992]
 [ 985 2625]]
Epoch 10, Phase val, Loss=0.5337, Acc=0.7467, AUC=0.7418, TPR=0.5928, TNR=0.7741, J=0.3669, MCC=0.2925, ConfusionMatrix=
[[1683  491]
 [ 158  230]]
Epoch 10, Phase test, Loss=0.5462, Acc=0.7187, AUC=0.7419, TPR=0.6075, TNR=0.7378, J=0.3454, MCC=0.2637, ConfusionMatrix=
[[1593  566]
 [ 146  226]]
Epoch 10 complete in 126.69

Early Stop!
Training complete in 23m 58s
The best model val AUC=0.75450497444, test AUC=0.740361054252.
Finish training resnet50fixed-conv1x1ab-avgpool

Start training resnet50fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6537, Acc=0.6336, AUC=0.6778, TPR=0.7051, TNR=0.5622, J=0.2673, MCC=0.2701, ConfusionMatrix=
[[2055 1600]
 [1075 2570]]
Epoch 0, Phase val, Loss=0.5594, Acc=0.6983, AUC=0.7186, TPR=0.5773, TNR=0.7199, J=0.2972, MCC=0.2274, ConfusionMatrix=
[[1565  609]
 [ 164  224]]
New Best AUC=0.7186. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5612, Acc=0.6934, AUC=0.6992, TPR=0.5699, TNR=0.7147, J=0.2846, MCC=0.2148, ConfusionMatrix=
[[1543  616]
 [ 160  212]]
Epoch 0 complete in 118.07

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5956, Acc=0.6844, AUC=0.7495, TPR=0.7397, TNR=0.6265, J=0.3662, MCC=0.3688, ConfusionMatrix=
[[2234 1332]
 [ 972 2762]]
Epoch 1, Phase val, Loss=0.5399, Acc=0.7248, AUC=0.7417, TPR=0.6082, TNR=0.7456, J=0.3539, MCC=0.2748, ConfusionMatrix=
[[1621  553]
 [ 152  236]]
New Best AUC=0.7417. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5537, Acc=0.7021, AUC=0.7305, TPR=0.6183, TNR=0.7165, J=0.3348, MCC=0.2516, ConfusionMatrix=
[[1547  612]
 [ 142  230]]
Epoch 1 complete in 146.25

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5728, Acc=0.7144, AUC=0.7764, TPR=0.7284, TNR=0.7006, J=0.4289, MCC=0.4291, ConfusionMatrix=
[[2574 1100]
 [ 985 2641]]
Epoch 2, Phase val, Loss=0.4659, Acc=0.7923, AUC=0.7489, TPR=0.4201, TNR=0.8588, J=0.2789, MCC=0.2583, ConfusionMatrix=
[[1867  307]
 [ 225  163]]
New Best AUC=0.7489. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4798, Acc=0.7811, AUC=0.7392, TPR=0.4785, TNR=0.8333, J=0.3118, MCC=0.2698, ConfusionMatrix=
[[1799  360]
 [ 194  178]]
Epoch 2 complete in 129.03

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5743, Acc=0.7077, AUC=0.7713, TPR=0.7087, TNR=0.7067, J=0.4154, MCC=0.4153, ConfusionMatrix=
[[2592 1076]
 [1058 2574]]
Epoch 3, Phase val, Loss=0.5411, Acc=0.7358, AUC=0.7533, TPR=0.6314, TNR=0.7544, J=0.3858, MCC=0.3007, ConfusionMatrix=
[[1640  534]
 [ 143  245]]
New Best AUC=0.7533. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5593, Acc=0.7037, AUC=0.7427, TPR=0.6344, TNR=0.7156, J=0.3500, MCC=0.2624, ConfusionMatrix=
[[1545  614]
 [ 136  236]]
Epoch 3 complete in 128.06

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5433, Acc=0.7284, AUC=0.8008, TPR=0.7481, TNR=0.7077, J=0.4558, MCC=0.4562, ConfusionMatrix=
[[2523 1042]
 [ 941 2794]]
Epoch 4, Phase val, Loss=0.5055, Acc=0.7603, AUC=0.7546, TPR=0.5670, TNR=0.7948, J=0.3619, MCC=0.2958, ConfusionMatrix=
[[1728  446]
 [ 168  220]]
New Best AUC=0.7546. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5200, Acc=0.7392, AUC=0.7440, TPR=0.6048, TNR=0.7624, J=0.3672, MCC=0.2861, ConfusionMatrix=
[[1646  513]
 [ 147  225]]
Epoch 4 complete in 125.05

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5548, Acc=0.7196, AUC=0.7908, TPR=0.7227, TNR=0.7165, J=0.4392, MCC=0.4392, ConfusionMatrix=
[[2621 1037]
 [1010 2632]]
Epoch 5, Phase val, Loss=0.5193, Acc=0.7564, AUC=0.7522, TPR=0.5851, TNR=0.7870, J=0.3721, MCC=0.3007, ConfusionMatrix=
[[1711  463]
 [ 161  227]]
Epoch 5, Phase test, Loss=0.5339, Acc=0.7282, AUC=0.7461, TPR=0.6129, TNR=0.7480, J=0.3609, MCC=0.2776, ConfusionMatrix=
[[1615  544]
 [ 144  228]]
Epoch 5 complete in 127.08

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5442, Acc=0.7314, AUC=0.8017, TPR=0.7233, TNR=0.7391, J=0.4623, MCC=0.4623, ConfusionMatrix=
[[2770  978]
 [ 983 2569]]
Epoch 6, Phase val, Loss=0.6126, Acc=0.6792, AUC=0.7559, TPR=0.7216, TNR=0.6716, J=0.3932, MCC=0.2893, ConfusionMatrix=
[[1460  714]
 [ 108  280]]
New Best AUC=0.7559. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.6403, Acc=0.6582, AUC=0.7506, TPR=0.7366, TNR=0.6447, J=0.3813, MCC=0.2744, ConfusionMatrix=
[[1392  767]
 [  98  274]]
Epoch 6 complete in 123.03

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5393, Acc=0.7356, AUC=0.8064, TPR=0.7410, TNR=0.7302, J=0.4712, MCC=0.4713, ConfusionMatrix=
[[2666  985]
 [ 945 2704]]
Epoch 7, Phase val, Loss=0.5295, Acc=0.7447, AUC=0.7550, TPR=0.6160, TNR=0.7677, J=0.3837, MCC=0.3030, ConfusionMatrix=
[[1669  505]
 [ 149  239]]
Epoch 7, Phase test, Loss=0.5425, Acc=0.7262, AUC=0.7503, TPR=0.6371, TNR=0.7415, J=0.3786, MCC=0.2888, ConfusionMatrix=
[[1601  558]
 [ 135  237]]
Epoch 7 complete in 113.40

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5354, Acc=0.7310, AUC=0.8082, TPR=0.7381, TNR=0.7239, J=0.4619, MCC=0.4620, ConfusionMatrix=
[[2645 1009]
 [ 955 2691]]
Epoch 8, Phase val, Loss=0.5424, Acc=0.7311, AUC=0.7460, TPR=0.6031, TNR=0.7539, J=0.3570, MCC=0.2792, ConfusionMatrix=
[[1639  535]
 [ 154  234]]
Epoch 8, Phase test, Loss=0.5578, Acc=0.7151, AUC=0.7447, TPR=0.6317, TNR=0.7295, J=0.3612, MCC=0.2734, ConfusionMatrix=
[[1575  584]
 [ 137  235]]
Epoch 8 complete in 76.27

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5359, Acc=0.7312, AUC=0.8074, TPR=0.7362, TNR=0.7263, J=0.4625, MCC=0.4625, ConfusionMatrix=
[[2651  999]
 [ 963 2687]]
Epoch 9, Phase val, Loss=0.4456, Acc=0.8025, AUC=0.7479, TPR=0.4253, TNR=0.8698, J=0.2951, MCC=0.2785, ConfusionMatrix=
[[1891  283]
 [ 223  165]]
Epoch 9, Phase test, Loss=0.4495, Acc=0.8040, AUC=0.7476, TPR=0.5054, TNR=0.8555, J=0.3609, MCC=0.3209, ConfusionMatrix=
[[1847  312]
 [ 184  188]]
Epoch 9 complete in 64.52

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5417, Acc=0.7234, AUC=0.8026, TPR=0.7085, TNR=0.7377, J=0.4462, MCC=0.4464, ConfusionMatrix=
[[2751  978]
 [1041 2530]]
Epoch 10, Phase val, Loss=0.6969, Acc=0.6296, AUC=0.7516, TPR=0.7861, TNR=0.6017, J=0.3877, MCC=0.2790, ConfusionMatrix=
[[1308  866]
 [  83  305]]
Epoch 10, Phase test, Loss=0.7287, Acc=0.5800, AUC=0.7490, TPR=0.7849, TNR=0.5447, J=0.3296, MCC=0.2334, ConfusionMatrix=
[[1176  983]
 [  80  292]]
Epoch 10 complete in 105.14

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5215, Acc=0.7434, AUC=0.8201, TPR=0.7559, TNR=0.7306, J=0.4865, MCC=0.4867, ConfusionMatrix=
[[2630  970]
 [ 903 2797]]
Epoch 11, Phase val, Loss=0.5108, Acc=0.7678, AUC=0.7486, TPR=0.5644, TNR=0.8040, J=0.3685, MCC=0.3043, ConfusionMatrix=
[[1748  426]
 [ 169  219]]
Epoch 11, Phase test, Loss=0.5290, Acc=0.7424, AUC=0.7430, TPR=0.5887, TNR=0.7689, J=0.3576, MCC=0.2809, ConfusionMatrix=
[[1660  499]
 [ 153  219]]
Epoch 11 complete in 87.46

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5368, Acc=0.7355, AUC=0.8072, TPR=0.7355, TNR=0.7355, J=0.4710, MCC=0.4710, ConfusionMatrix=
[[2697  970]
 [ 961 2672]]
Epoch 12, Phase val, Loss=0.5217, Acc=0.7494, AUC=0.7618, TPR=0.6108, TNR=0.7741, J=0.3850, MCC=0.3060, ConfusionMatrix=
[[1683  491]
 [ 151  237]]
New Best AUC=0.7618. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 12, Phase test, Loss=0.5359, Acc=0.7282, AUC=0.7534, TPR=0.6237, TNR=0.7462, J=0.3698, MCC=0.2836, ConfusionMatrix=
[[1611  548]
 [ 140  232]]
Epoch 12 complete in 72.18

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5322, Acc=0.7310, AUC=0.8105, TPR=0.7225, TNR=0.7391, J=0.4617, MCC=0.4618, ConfusionMatrix=
[[2737  966]
 [ 998 2599]]
Epoch 13, Phase val, Loss=0.6566, Acc=0.6503, AUC=0.7560, TPR=0.7655, TNR=0.6297, J=0.3952, MCC=0.2861, ConfusionMatrix=
[[1369  805]
 [  91  297]]
Epoch 13, Phase test, Loss=0.6878, Acc=0.6168, AUC=0.7512, TPR=0.7527, TNR=0.5933, J=0.3460, MCC=0.2459, ConfusionMatrix=
[[1281  878]
 [  92  280]]
Epoch 13 complete in 56.05

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5402, Acc=0.7289, AUC=0.8031, TPR=0.7364, TNR=0.7213, J=0.4577, MCC=0.4578, ConfusionMatrix=
[[2622 1013]
 [ 966 2699]]
Epoch 14, Phase val, Loss=0.5671, Acc=0.7213, AUC=0.7520, TPR=0.6469, TNR=0.7346, J=0.3815, MCC=0.2924, ConfusionMatrix=
[[1597  577]
 [ 137  251]]
Epoch 14, Phase test, Loss=0.5865, Acc=0.6910, AUC=0.7486, TPR=0.6613, TNR=0.6962, J=0.3574, MCC=0.2643, ConfusionMatrix=
[[1503  656]
 [ 126  246]]
Epoch 14 complete in 89.41

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5262, Acc=0.7384, AUC=0.8162, TPR=0.7430, TNR=0.7337, J=0.4767, MCC=0.4767, ConfusionMatrix=
[[2681  973]
 [ 937 2709]]
Epoch 15, Phase val, Loss=0.5038, Acc=0.7674, AUC=0.7484, TPR=0.5490, TNR=0.8063, J=0.3553, MCC=0.2952, ConfusionMatrix=
[[1753  421]
 [ 175  213]]
Epoch 15, Phase test, Loss=0.5086, Acc=0.7456, AUC=0.7506, TPR=0.5780, TNR=0.7744, J=0.3524, MCC=0.2787, ConfusionMatrix=
[[1672  487]
 [ 157  215]]
Epoch 15 complete in 59.98

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5142, Acc=0.7477, AUC=0.8263, TPR=0.7475, TNR=0.7479, J=0.4953, MCC=0.4953, ConfusionMatrix=
[[2741  924]
 [ 918 2717]]
Epoch 16, Phase val, Loss=0.5793, Acc=0.7201, AUC=0.7561, TPR=0.6804, TNR=0.7272, J=0.4076, MCC=0.3097, ConfusionMatrix=
[[1581  593]
 [ 124  264]]
Epoch 16, Phase test, Loss=0.5980, Acc=0.6926, AUC=0.7547, TPR=0.6855, TNR=0.6938, J=0.3793, MCC=0.2795, ConfusionMatrix=
[[1498  661]
 [ 117  255]]
Epoch 16 complete in 74.28

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5220, Acc=0.7473, AUC=0.8203, TPR=0.7599, TNR=0.7342, J=0.4942, MCC=0.4944, ConfusionMatrix=
[[2644  957]
 [ 888 2811]]
Epoch 17, Phase val, Loss=0.4843, Acc=0.7783, AUC=0.7530, TPR=0.5258, TNR=0.8234, J=0.3491, MCC=0.2976, ConfusionMatrix=
[[1790  384]
 [ 184  204]]
Epoch 17, Phase test, Loss=0.4920, Acc=0.7661, AUC=0.7495, TPR=0.5645, TNR=0.8008, J=0.3653, MCC=0.2976, ConfusionMatrix=
[[1729  430]
 [ 162  210]]
Epoch 17 complete in 82.30

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5197, Acc=0.7451, AUC=0.8222, TPR=0.7369, TNR=0.7531, J=0.4900, MCC=0.4901, ConfusionMatrix=
[[2773  909]
 [ 952 2666]]
Epoch 18, Phase val, Loss=0.6008, Acc=0.6959, AUC=0.7515, TPR=0.6701, TNR=0.7006, J=0.3707, MCC=0.2776, ConfusionMatrix=
[[1523  651]
 [ 128  260]]
Epoch 18, Phase test, Loss=0.6192, Acc=0.6681, AUC=0.7534, TPR=0.6801, TNR=0.6660, J=0.3462, MCC=0.2519, ConfusionMatrix=
[[1438  721]
 [ 119  253]]
Epoch 18 complete in 57.69

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.5520, Acc=0.7196, AUC=0.7939, TPR=0.7281, TNR=0.7108, J=0.4389, MCC=0.4390, ConfusionMatrix=
[[2556 1040]
 [1007 2697]]
Epoch 19, Phase val, Loss=0.6086, Acc=0.6874, AUC=0.7605, TPR=0.7191, TNR=0.6817, J=0.4008, MCC=0.2961, ConfusionMatrix=
[[1482  692]
 [ 109  279]]
Epoch 19, Phase test, Loss=0.6196, Acc=0.6705, AUC=0.7552, TPR=0.7231, TNR=0.6614, J=0.3845, MCC=0.2785, ConfusionMatrix=
[[1428  731]
 [ 103  269]]
Epoch 19 complete in 79.89

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.5270, Acc=0.7385, AUC=0.8153, TPR=0.7517, TNR=0.7252, J=0.4769, MCC=0.4771, ConfusionMatrix=
[[2636  999]
 [ 910 2755]]
Epoch 20, Phase val, Loss=0.8121, Acc=0.5453, AUC=0.7487, TPR=0.8299, TNR=0.4945, J=0.3244, MCC=0.2340, ConfusionMatrix=
[[1075 1099]
 [  66  322]]
Epoch 20, Phase test, Loss=0.8484, Acc=0.5109, AUC=0.7527, TPR=0.8548, TNR=0.4516, J=0.3064, MCC=0.2209, ConfusionMatrix=
[[ 975 1184]
 [  54  318]]
Epoch 20 complete in 58.72

Early Stop!
Training complete in 32m 54s
The best model val AUC=0.761759168809, test AUC=0.753352433175.
Finish training resnet50fixed-conv1x1ab-avgpool

Start training resnet50fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6509, Acc=0.6399, AUC=0.6906, TPR=0.6627, TNR=0.6173, J=0.2800, MCC=0.2803, ConfusionMatrix=
[[2268 1406]
 [1223 2403]]
Epoch 0, Phase val, Loss=0.6918, Acc=0.5390, AUC=0.7179, TPR=0.8325, TNR=0.4867, J=0.3191, MCC=0.2306, ConfusionMatrix=
[[1058 1116]
 [  65  323]]
New Best AUC=0.7179. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6990, Acc=0.5405, AUC=0.6998, TPR=0.7930, TNR=0.4970, J=0.2900, MCC=0.2062, ConfusionMatrix=
[[1073 1086]
 [  77  295]]
Epoch 0 complete in 53.76

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5926, Acc=0.6860, AUC=0.7521, TPR=0.7396, TNR=0.6327, J=0.3723, MCC=0.3744, ConfusionMatrix=
[[2315 1344]
 [ 948 2693]]
Epoch 1, Phase val, Loss=0.5656, Acc=0.6998, AUC=0.7427, TPR=0.6546, TNR=0.7079, J=0.3626, MCC=0.2730, ConfusionMatrix=
[[1539  635]
 [ 134  254]]
New Best AUC=0.7427. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5855, Acc=0.6709, AUC=0.7321, TPR=0.6667, TNR=0.6716, J=0.3383, MCC=0.2470, ConfusionMatrix=
[[1450  709]
 [ 124  248]]
Epoch 1 complete in 75.45

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5643, Acc=0.7207, AUC=0.7848, TPR=0.7485, TNR=0.6926, J=0.4411, MCC=0.4418, ConfusionMatrix=
[[2514 1116]
 [ 923 2747]]
Epoch 2, Phase val, Loss=0.5630, Acc=0.7198, AUC=0.7496, TPR=0.6881, TNR=0.7254, J=0.4135, MCC=0.3136, ConfusionMatrix=
[[1577  597]
 [ 121  267]]
New Best AUC=0.7496. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5836, Acc=0.6796, AUC=0.7394, TPR=0.6667, TNR=0.6818, J=0.3485, MCC=0.2556, ConfusionMatrix=
[[1472  687]
 [ 124  248]]
Epoch 2 complete in 66.31

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5530, Acc=0.7186, AUC=0.7919, TPR=0.7338, TNR=0.7033, J=0.4371, MCC=0.4373, ConfusionMatrix=
[[2555 1078]
 [ 976 2691]]
Epoch 3, Phase val, Loss=0.6768, Acc=0.6257, AUC=0.7507, TPR=0.7732, TNR=0.5994, J=0.3726, MCC=0.2681, ConfusionMatrix=
[[1303  871]
 [  88  300]]
New Best AUC=0.7507. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.7109, Acc=0.5907, AUC=0.7421, TPR=0.7715, TNR=0.5595, J=0.3310, MCC=0.2345, ConfusionMatrix=
[[1208  951]
 [  85  287]]
Epoch 3 complete in 108.61

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5474, Acc=0.7262, AUC=0.7974, TPR=0.7285, TNR=0.7239, J=0.4523, MCC=0.4523, ConfusionMatrix=
[[2645 1009]
 [ 990 2656]]
Epoch 4, Phase val, Loss=0.5019, Acc=0.7623, AUC=0.7424, TPR=0.5180, TNR=0.8059, J=0.3239, MCC=0.2707, ConfusionMatrix=
[[1752  422]
 [ 187  201]]
Epoch 4, Phase test, Loss=0.5207, Acc=0.7491, AUC=0.7399, TPR=0.5887, TNR=0.7767, J=0.3655, MCC=0.2892, ConfusionMatrix=
[[1677  482]
 [ 153  219]]
Epoch 4 complete in 109.34

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5615, Acc=0.7126, AUC=0.7849, TPR=0.7256, TNR=0.6996, J=0.4252, MCC=0.4253, ConfusionMatrix=
[[2550 1095]
 [1003 2652]]
Epoch 5, Phase val, Loss=0.5337, Acc=0.7432, AUC=0.7412, TPR=0.5928, TNR=0.7700, J=0.3628, MCC=0.2881, ConfusionMatrix=
[[1674  500]
 [ 158  230]]
Epoch 5, Phase test, Loss=0.5481, Acc=0.7238, AUC=0.7409, TPR=0.6237, TNR=0.7411, J=0.3647, MCC=0.2786, ConfusionMatrix=
[[1600  559]
 [ 140  232]]
Epoch 5 complete in 79.44

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5413, Acc=0.7256, AUC=0.8033, TPR=0.7412, TNR=0.7095, J=0.4507, MCC=0.4509, ConfusionMatrix=
[[2542 1041]
 [ 962 2755]]
Epoch 6, Phase val, Loss=0.5844, Acc=0.7053, AUC=0.7532, TPR=0.7268, TNR=0.7015, J=0.4283, MCC=0.3192, ConfusionMatrix=
[[1525  649]
 [ 106  282]]
New Best AUC=0.7532. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.6075, Acc=0.6701, AUC=0.7450, TPR=0.6774, TNR=0.6688, J=0.3462, MCC=0.2523, ConfusionMatrix=
[[1444  715]
 [ 120  252]]
Epoch 6 complete in 57.26

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5411, Acc=0.7308, AUC=0.8026, TPR=0.7343, TNR=0.7274, J=0.4617, MCC=0.4617, ConfusionMatrix=
[[2690 1008]
 [ 957 2645]]
Epoch 7, Phase val, Loss=0.5748, Acc=0.7112, AUC=0.7491, TPR=0.6907, TNR=0.7148, J=0.4055, MCC=0.3055, ConfusionMatrix=
[[1554  620]
 [ 120  268]]
Epoch 7, Phase test, Loss=0.5893, Acc=0.6855, AUC=0.7450, TPR=0.6532, TNR=0.6911, J=0.3443, MCC=0.2540, ConfusionMatrix=
[[1492  667]
 [ 129  243]]
Epoch 7 complete in 80.80

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5400, Acc=0.7295, AUC=0.8040, TPR=0.7187, TNR=0.7397, J=0.4584, MCC=0.4585, ConfusionMatrix=
[[2768  974]
 [1001 2557]]
Epoch 8, Phase val, Loss=0.6276, Acc=0.6717, AUC=0.7514, TPR=0.7371, TNR=0.6601, J=0.3972, MCC=0.2906, ConfusionMatrix=
[[1435  739]
 [ 102  286]]
Epoch 8, Phase test, Loss=0.6533, Acc=0.6397, AUC=0.7464, TPR=0.7204, TNR=0.6258, J=0.3462, MCC=0.2480, ConfusionMatrix=
[[1351  808]
 [ 104  268]]
Epoch 8 complete in 61.77

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5382, Acc=0.7366, AUC=0.8061, TPR=0.7333, TNR=0.7397, J=0.4731, MCC=0.4731, ConfusionMatrix=
[[2737  963]
 [ 960 2640]]
Epoch 9, Phase val, Loss=0.6214, Acc=0.6784, AUC=0.7597, TPR=0.7345, TNR=0.6684, J=0.4029, MCC=0.2958, ConfusionMatrix=
[[1453  721]
 [ 103  285]]
New Best AUC=0.7597. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.6494, Acc=0.6464, AUC=0.7513, TPR=0.7204, TNR=0.6336, J=0.3541, MCC=0.2541, ConfusionMatrix=
[[1368  791]
 [ 104  268]]
Epoch 9 complete in 45.40

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5300, Acc=0.7432, AUC=0.8137, TPR=0.7323, TNR=0.7538, J=0.4861, MCC=0.4862, ConfusionMatrix=
[[2780  908]
 [ 967 2645]]
Epoch 10, Phase val, Loss=0.5736, Acc=0.7166, AUC=0.7515, TPR=0.6701, TNR=0.7249, J=0.3950, MCC=0.3001, ConfusionMatrix=
[[1576  598]
 [ 128  260]]
Epoch 10, Phase test, Loss=0.5885, Acc=0.6918, AUC=0.7500, TPR=0.6586, TNR=0.6975, J=0.3561, MCC=0.2636, ConfusionMatrix=
[[1506  653]
 [ 127  245]]
Epoch 10 complete in 77.25

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5397, Acc=0.7303, AUC=0.8054, TPR=0.7209, TNR=0.7392, J=0.4601, MCC=0.4602, ConfusionMatrix=
[[2761  974]
 [ 995 2570]]
Epoch 11, Phase val, Loss=0.5061, Acc=0.7635, AUC=0.7493, TPR=0.5567, TNR=0.8004, J=0.3571, MCC=0.2942, ConfusionMatrix=
[[1740  434]
 [ 172  216]]
Epoch 11, Phase test, Loss=0.5123, Acc=0.7507, AUC=0.7490, TPR=0.5780, TNR=0.7805, J=0.3584, MCC=0.2851, ConfusionMatrix=
[[1685  474]
 [ 157  215]]
Epoch 11 complete in 81.05

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5262, Acc=0.7400, AUC=0.8157, TPR=0.7486, TNR=0.7314, J=0.4800, MCC=0.4800, ConfusionMatrix=
[[2663  978]
 [ 920 2739]]
Epoch 12, Phase val, Loss=0.5611, Acc=0.7276, AUC=0.7585, TPR=0.6675, TNR=0.7383, J=0.4058, MCC=0.3110, ConfusionMatrix=
[[1605  569]
 [ 129  259]]
Epoch 12, Phase test, Loss=0.5776, Acc=0.6958, AUC=0.7522, TPR=0.6559, TNR=0.7026, J=0.3586, MCC=0.2662, ConfusionMatrix=
[[1517  642]
 [ 128  244]]
Epoch 12 complete in 86.29

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5383, Acc=0.7330, AUC=0.8060, TPR=0.7304, TNR=0.7356, J=0.4660, MCC=0.4660, ConfusionMatrix=
[[2710  974]
 [ 975 2641]]
Epoch 13, Phase val, Loss=0.5226, Acc=0.7564, AUC=0.7390, TPR=0.5464, TNR=0.7939, J=0.3403, MCC=0.2790, ConfusionMatrix=
[[1726  448]
 [ 176  212]]
Epoch 13, Phase test, Loss=0.5309, Acc=0.7373, AUC=0.7412, TPR=0.5995, TNR=0.7610, J=0.3605, MCC=0.2807, ConfusionMatrix=
[[1643  516]
 [ 149  223]]
Epoch 13 complete in 78.96

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5347, Acc=0.7386, AUC=0.8102, TPR=0.7410, TNR=0.7362, J=0.4772, MCC=0.4772, ConfusionMatrix=
[[2668  956]
 [ 952 2724]]
Epoch 14, Phase val, Loss=0.5927, Acc=0.7077, AUC=0.7446, TPR=0.6856, TNR=0.7116, J=0.3972, MCC=0.2988, ConfusionMatrix=
[[1547  627]
 [ 122  266]]
Epoch 14, Phase test, Loss=0.6079, Acc=0.6736, AUC=0.7473, TPR=0.6774, TNR=0.6730, J=0.3504, MCC=0.2558, ConfusionMatrix=
[[1453  706]
 [ 120  252]]
Epoch 14 complete in 55.73

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5252, Acc=0.7453, AUC=0.8175, TPR=0.7522, TNR=0.7384, J=0.4906, MCC=0.4907, ConfusionMatrix=
[[2679  949]
 [ 910 2762]]
Epoch 15, Phase val, Loss=0.6603, Acc=0.6596, AUC=0.7509, TPR=0.7500, TNR=0.6435, J=0.3935, MCC=0.2862, ConfusionMatrix=
[[1399  775]
 [  97  291]]
Epoch 15, Phase test, Loss=0.6748, Acc=0.6318, AUC=0.7556, TPR=0.7392, TNR=0.6132, J=0.3525, MCC=0.2515, ConfusionMatrix=
[[1324  835]
 [  97  275]]
Epoch 15 complete in 108.23

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5315, Acc=0.7381, AUC=0.8116, TPR=0.7420, TNR=0.7341, J=0.4761, MCC=0.4761, ConfusionMatrix=
[[2647  959]
 [ 953 2741]]
Epoch 16, Phase val, Loss=0.6936, Acc=0.6323, AUC=0.7552, TPR=0.7809, TNR=0.6058, J=0.3867, MCC=0.2785, ConfusionMatrix=
[[1317  857]
 [  85  303]]
Epoch 16, Phase test, Loss=0.7152, Acc=0.5970, AUC=0.7578, TPR=0.7796, TNR=0.5655, J=0.3451, MCC=0.2445, ConfusionMatrix=
[[1221  938]
 [  82  290]]
Epoch 16 complete in 119.08

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5266, Acc=0.7370, AUC=0.8149, TPR=0.7460, TNR=0.7278, J=0.4738, MCC=0.4739, ConfusionMatrix=
[[2628  983]
 [ 937 2752]]
Epoch 17, Phase val, Loss=0.6395, Acc=0.6698, AUC=0.7521, TPR=0.7242, TNR=0.6601, J=0.3843, MCC=0.2814, ConfusionMatrix=
[[1435  739]
 [ 107  281]]
Epoch 17, Phase test, Loss=0.6588, Acc=0.6476, AUC=0.7536, TPR=0.7231, TNR=0.6346, J=0.3577, MCC=0.2568, ConfusionMatrix=
[[1370  789]
 [ 103  269]]
Epoch 17 complete in 145.08

Early Stop!
Training complete in 24m 50s
The best model val AUC=0.759670876052, test AUC=0.75131731636.
Finish training resnet50fixed-conv1x1ab-avgpool

Start training resnet50fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6287, Acc=0.6440, AUC=0.7020, TPR=0.6231, TNR=0.6643, J=0.2874, MCC=0.2877, ConfusionMatrix=
[[2454 1240]
 [1359 2247]]
Epoch 0, Phase val, Loss=0.5246, Acc=0.7728, AUC=0.7697, TPR=0.5902, TNR=0.8054, J=0.3956, MCC=0.3256, ConfusionMatrix=
[[1751  423]
 [ 159  229]]
New Best AUC=0.7697. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5571, Acc=0.7531, AUC=0.7360, TPR=0.5753, TNR=0.7837, J=0.3590, MCC=0.2866, ConfusionMatrix=
[[1692  467]
 [ 158  214]]
Epoch 0 complete in 152.91

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5504, Acc=0.7244, AUC=0.7960, TPR=0.6794, TNR=0.7699, J=0.4493, MCC=0.4510, ConfusionMatrix=
[[2794  835]
 [1177 2494]]
Epoch 1, Phase val, Loss=0.5542, Acc=0.7603, AUC=0.7694, TPR=0.6237, TNR=0.7847, J=0.4084, MCC=0.3271, ConfusionMatrix=
[[1706  468]
 [ 146  242]]
Epoch 1, Phase test, Loss=0.6016, Acc=0.7404, AUC=0.7577, TPR=0.6371, TNR=0.7582, J=0.3953, MCC=0.3055, ConfusionMatrix=
[[1637  522]
 [ 135  237]]
Epoch 1 complete in 156.20

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5586, Acc=0.7221, AUC=0.7928, TPR=0.6800, TNR=0.7651, J=0.4451, MCC=0.4465, ConfusionMatrix=
[[2759  847]
 [1182 2512]]
Epoch 2, Phase val, Loss=0.5868, Acc=0.7525, AUC=0.7598, TPR=0.6263, TNR=0.7751, J=0.4014, MCC=0.3185, ConfusionMatrix=
[[1685  489]
 [ 145  243]]
Epoch 2, Phase test, Loss=0.6241, Acc=0.7222, AUC=0.7588, TPR=0.6559, TNR=0.7337, J=0.3896, MCC=0.2949, ConfusionMatrix=
[[1584  575]
 [ 128  244]]
Epoch 2 complete in 141.43

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5521, Acc=0.7292, AUC=0.7988, TPR=0.6938, TNR=0.7643, J=0.4581, MCC=0.4593, ConfusionMatrix=
[[2801  864]
 [1113 2522]]
Epoch 3, Phase val, Loss=0.5441, Acc=0.7779, AUC=0.7778, TPR=0.5851, TNR=0.8123, J=0.3974, MCC=0.3299, ConfusionMatrix=
[[1766  408]
 [ 161  227]]
New Best AUC=0.7778. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5800, Acc=0.7704, AUC=0.7564, TPR=0.6075, TNR=0.7985, J=0.4060, MCC=0.3273, ConfusionMatrix=
[[1724  435]
 [ 146  226]]
Epoch 3 complete in 148.73

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5379, Acc=0.7389, AUC=0.8103, TPR=0.7068, TNR=0.7716, J=0.4784, MCC=0.4793, ConfusionMatrix=
[[2790  826]
 [1080 2604]]
Epoch 4, Phase val, Loss=0.5859, Acc=0.7584, AUC=0.7819, TPR=0.6598, TNR=0.7760, J=0.4358, MCC=0.3443, ConfusionMatrix=
[[1687  487]
 [ 132  256]]
New Best AUC=0.7819. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.6508, Acc=0.7183, AUC=0.7541, TPR=0.6452, TNR=0.7309, J=0.3761, MCC=0.2844, ConfusionMatrix=
[[1578  581]
 [ 132  240]]
Epoch 4 complete in 154.96

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5434, Acc=0.7338, AUC=0.8035, TPR=0.6842, TNR=0.7844, J=0.4687, MCC=0.4708, ConfusionMatrix=
[[2835  779]
 [1164 2522]]
Epoch 5, Phase val, Loss=0.4847, Acc=0.8037, AUC=0.7726, TPR=0.5258, TNR=0.8533, J=0.3790, MCC=0.3371, ConfusionMatrix=
[[1855  319]
 [ 184  204]]
Epoch 5, Phase test, Loss=0.5205, Acc=0.7969, AUC=0.7594, TPR=0.5565, TNR=0.8384, J=0.3948, MCC=0.3376, ConfusionMatrix=
[[1810  349]
 [ 165  207]]
Epoch 5 complete in 147.35

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5411, Acc=0.7364, AUC=0.8060, TPR=0.6939, TNR=0.7816, J=0.4755, MCC=0.4766, ConfusionMatrix=
[[2767  773]
 [1151 2609]]
Epoch 6, Phase val, Loss=0.5691, Acc=0.7787, AUC=0.7671, TPR=0.5876, TNR=0.8128, J=0.4004, MCC=0.3325, ConfusionMatrix=
[[1767  407]
 [ 160  228]]
Epoch 6, Phase test, Loss=0.6124, Acc=0.7629, AUC=0.7702, TPR=0.6237, TNR=0.7869, J=0.4106, MCC=0.3262, ConfusionMatrix=
[[1699  460]
 [ 140  232]]
Epoch 6 complete in 136.64

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5159, Acc=0.7547, AUC=0.8273, TPR=0.7218, TNR=0.7876, J=0.5094, MCC=0.5105, ConfusionMatrix=
[[2870  774]
 [1017 2639]]
Epoch 7, Phase val, Loss=0.5377, Acc=0.7783, AUC=0.7743, TPR=0.5851, TNR=0.8128, J=0.3978, MCC=0.3305, ConfusionMatrix=
[[1767  407]
 [ 161  227]]
Epoch 7, Phase test, Loss=0.5828, Acc=0.7621, AUC=0.7683, TPR=0.6156, TNR=0.7874, J=0.4030, MCC=0.3207, ConfusionMatrix=
[[1700  459]
 [ 143  229]]
Epoch 7 complete in 136.40

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5053, Acc=0.7592, AUC=0.8315, TPR=0.7211, TNR=0.7978, J=0.5190, MCC=0.5203, ConfusionMatrix=
[[2889  732]
 [1026 2653]]
Epoch 8, Phase val, Loss=0.4660, Acc=0.8169, AUC=0.7664, TPR=0.4923, TNR=0.8749, J=0.3672, MCC=0.3421, ConfusionMatrix=
[[1902  272]
 [ 197  191]]
Epoch 8, Phase test, Loss=0.4970, Acc=0.8163, AUC=0.7644, TPR=0.5538, TNR=0.8615, J=0.4153, MCC=0.3679, ConfusionMatrix=
[[1860  299]
 [ 166  206]]
Epoch 8 complete in 143.70

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5247, Acc=0.7495, AUC=0.8202, TPR=0.7084, TNR=0.7906, J=0.4990, MCC=0.5007, ConfusionMatrix=
[[2881  763]
 [1066 2590]]
Epoch 9, Phase val, Loss=0.6538, Acc=0.7147, AUC=0.7774, TPR=0.6985, TNR=0.7176, J=0.4160, MCC=0.3136, ConfusionMatrix=
[[1560  614]
 [ 117  271]]
Epoch 9, Phase test, Loss=0.6981, Acc=0.6883, AUC=0.7767, TPR=0.7312, TNR=0.6809, J=0.4121, MCC=0.3006, ConfusionMatrix=
[[1470  689]
 [ 100  272]]
Epoch 9 complete in 153.36

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5387, Acc=0.7393, AUC=0.8119, TPR=0.6919, TNR=0.7857, J=0.4776, MCC=0.4799, ConfusionMatrix=
[[2900  791]
 [1112 2497]]
Epoch 10, Phase val, Loss=0.5581, Acc=0.7611, AUC=0.7653, TPR=0.5979, TNR=0.7902, J=0.3882, MCC=0.3140, ConfusionMatrix=
[[1718  456]
 [ 156  232]]
Epoch 10, Phase test, Loss=0.5911, Acc=0.7499, AUC=0.7614, TPR=0.6371, TNR=0.7693, J=0.4064, MCC=0.3170, ConfusionMatrix=
[[1661  498]
 [ 135  237]]
Epoch 10 complete in 151.32

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5194, Acc=0.7526, AUC=0.8215, TPR=0.7087, TNR=0.7976, J=0.5063, MCC=0.5080, ConfusionMatrix=
[[2876  730]
 [1076 2618]]
Epoch 11, Phase val, Loss=0.4676, Acc=0.8084, AUC=0.7671, TPR=0.5026, TNR=0.8629, J=0.3655, MCC=0.3324, ConfusionMatrix=
[[1876  298]
 [ 193  195]]
Epoch 11, Phase test, Loss=0.5132, Acc=0.8013, AUC=0.7468, TPR=0.5188, TNR=0.8499, J=0.3687, MCC=0.3239, ConfusionMatrix=
[[1835  324]
 [ 179  193]]
Epoch 11 complete in 148.05

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5066, Acc=0.7611, AUC=0.8329, TPR=0.7329, TNR=0.7901, J=0.5230, MCC=0.5236, ConfusionMatrix=
[[2842  755]
 [ 989 2714]]
Epoch 12, Phase val, Loss=0.5605, Acc=0.7619, AUC=0.7764, TPR=0.6057, TNR=0.7898, J=0.3955, MCC=0.3193, ConfusionMatrix=
[[1717  457]
 [ 153  235]]
Epoch 12, Phase test, Loss=0.6113, Acc=0.7503, AUC=0.7614, TPR=0.6263, TNR=0.7717, J=0.3980, MCC=0.3116, ConfusionMatrix=
[[1666  493]
 [ 139  233]]
Epoch 12 complete in 154.51

Early Stop!
Training complete in 32m 6s
The best model val AUC=0.781864395527, test AUC=0.754076459133.
Finish training resnet50fixed-conv1x1-maxpool

Start training resnet50fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6300, Acc=0.6370, AUC=0.6960, TPR=0.6612, TNR=0.6127, J=0.2739, MCC=0.2742, ConfusionMatrix=
[[2234 1412]
 [1238 2416]]
Epoch 0, Phase val, Loss=0.7487, Acc=0.6093, AUC=0.7754, TPR=0.7964, TNR=0.5759, J=0.3723, MCC=0.2671, ConfusionMatrix=
[[1252  922]
 [  79  309]]
New Best AUC=0.7754. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.8028, Acc=0.5903, AUC=0.7580, TPR=0.8011, TNR=0.5540, J=0.3550, MCC=0.2514, ConfusionMatrix=
[[1196  963]
 [  74  298]]
Epoch 0 complete in 145.90

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5563, Acc=0.7214, AUC=0.7915, TPR=0.6585, TNR=0.7841, J=0.4426, MCC=0.4462, ConfusionMatrix=
[[2865  789]
 [1245 2401]]
Epoch 1, Phase val, Loss=0.5969, Acc=0.7385, AUC=0.7717, TPR=0.6598, TNR=0.7525, J=0.4123, MCC=0.3196, ConfusionMatrix=
[[1636  538]
 [ 132  256]]
Epoch 1, Phase test, Loss=0.6400, Acc=0.7163, AUC=0.7538, TPR=0.6747, TNR=0.7235, J=0.3982, MCC=0.2987, ConfusionMatrix=
[[1562  597]
 [ 121  251]]
Epoch 1 complete in 160.03

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5343, Acc=0.7329, AUC=0.8090, TPR=0.6883, TNR=0.7771, J=0.4654, MCC=0.4673, ConfusionMatrix=
[[2848  817]
 [1133 2502]]
Epoch 2, Phase val, Loss=0.4969, Acc=0.7990, AUC=0.7678, TPR=0.4897, TNR=0.8542, J=0.3439, MCC=0.3094, ConfusionMatrix=
[[1857  317]
 [ 198  190]]
Epoch 2, Phase test, Loss=0.5269, Acc=0.7977, AUC=0.7415, TPR=0.5054, TNR=0.8481, J=0.3535, MCC=0.3106, ConfusionMatrix=
[[1831  328]
 [ 184  188]]
Epoch 2 complete in 157.13

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5362, Acc=0.7355, AUC=0.8091, TPR=0.7030, TNR=0.7690, J=0.4721, MCC=0.4728, ConfusionMatrix=
[[2760  829]
 [1102 2609]]
Epoch 3, Phase val, Loss=0.5888, Acc=0.7451, AUC=0.7821, TPR=0.6727, TNR=0.7580, J=0.4307, MCC=0.3347, ConfusionMatrix=
[[1648  526]
 [ 127  261]]
New Best AUC=0.7821. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6366, Acc=0.7211, AUC=0.7692, TPR=0.6720, TNR=0.7295, J=0.4015, MCC=0.3025, ConfusionMatrix=
[[1575  584]
 [ 122  250]]
Epoch 3 complete in 147.01

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5347, Acc=0.7384, AUC=0.8095, TPR=0.6965, TNR=0.7787, J=0.4752, MCC=0.4771, ConfusionMatrix=
[[2896  823]
 [1087 2494]]
Epoch 4, Phase val, Loss=0.3865, Acc=0.8419, AUC=0.7549, TPR=0.2758, TNR=0.9430, J=0.2187, MCC=0.2738, ConfusionMatrix=
[[2050  124]
 [ 281  107]]
Epoch 4, Phase test, Loss=0.4126, Acc=0.8609, AUC=0.7296, TPR=0.3280, TNR=0.9528, J=0.2807, MCC=0.3500, ConfusionMatrix=
[[2057  102]
 [ 250  122]]
Epoch 4 complete in 142.45

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5314, Acc=0.7426, AUC=0.8140, TPR=0.6934, TNR=0.7920, J=0.4855, MCC=0.4878, ConfusionMatrix=
[[2883  757]
 [1122 2538]]
Epoch 5, Phase val, Loss=0.5892, Acc=0.7572, AUC=0.7770, TPR=0.6443, TNR=0.7774, J=0.4217, MCC=0.3344, ConfusionMatrix=
[[1690  484]
 [ 138  250]]
Epoch 5, Phase test, Loss=0.6364, Acc=0.7246, AUC=0.7689, TPR=0.6747, TNR=0.7332, J=0.4079, MCC=0.3080, ConfusionMatrix=
[[1583  576]
 [ 121  251]]
Epoch 5 complete in 154.08

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5246, Acc=0.7471, AUC=0.8188, TPR=0.7116, TNR=0.7831, J=0.4947, MCC=0.4958, ConfusionMatrix=
[[2841  787]
 [1059 2613]]
Epoch 6, Phase val, Loss=0.7202, Acc=0.6807, AUC=0.7772, TPR=0.7268, TNR=0.6725, J=0.3993, MCC=0.2937, ConfusionMatrix=
[[1462  712]
 [ 106  282]]
Epoch 6, Phase test, Loss=0.7578, Acc=0.6571, AUC=0.7834, TPR=0.7876, TNR=0.6346, J=0.4222, MCC=0.3022, ConfusionMatrix=
[[1370  789]
 [  79  293]]
Epoch 6 complete in 165.80

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5484, Acc=0.7336, AUC=0.8038, TPR=0.6857, TNR=0.7824, J=0.4681, MCC=0.4701, ConfusionMatrix=
[[2826  786]
 [1159 2529]]
Epoch 7, Phase val, Loss=0.6905, Acc=0.7143, AUC=0.7787, TPR=0.7010, TNR=0.7167, J=0.4177, MCC=0.3146, ConfusionMatrix=
[[1558  616]
 [ 116  272]]
Epoch 7, Phase test, Loss=0.7277, Acc=0.6887, AUC=0.7770, TPR=0.7473, TNR=0.6786, J=0.4259, MCC=0.3100, ConfusionMatrix=
[[1465  694]
 [  94  278]]
Epoch 7 complete in 143.01

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5234, Acc=0.7441, AUC=0.8213, TPR=0.7157, TNR=0.7729, J=0.4886, MCC=0.4893, ConfusionMatrix=
[[2804  824]
 [1044 2628]]
Epoch 8, Phase val, Loss=0.4047, Acc=0.8400, AUC=0.7658, TPR=0.3686, TNR=0.9241, J=0.2927, MCC=0.3226, ConfusionMatrix=
[[2009  165]
 [ 245  143]]
Epoch 8, Phase test, Loss=0.4289, Acc=0.8483, AUC=0.7443, TPR=0.3871, TNR=0.9277, J=0.3148, MCC=0.3449, ConfusionMatrix=
[[2003  156]
 [ 228  144]]
Epoch 8 complete in 152.41

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5269, Acc=0.7397, AUC=0.8184, TPR=0.6962, TNR=0.7837, J=0.4799, MCC=0.4817, ConfusionMatrix=
[[2845  785]
 [1115 2555]]
Epoch 9, Phase val, Loss=0.4044, Acc=0.8407, AUC=0.7438, TPR=0.3119, TNR=0.9351, J=0.2470, MCC=0.2922, ConfusionMatrix=
[[2033  141]
 [ 267  121]]
Epoch 9, Phase test, Loss=0.4211, Acc=0.8542, AUC=0.7328, TPR=0.3145, TNR=0.9472, J=0.2617, MCC=0.3218, ConfusionMatrix=
[[2045  114]
 [ 255  117]]
Epoch 9 complete in 141.89

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5232, Acc=0.7507, AUC=0.8255, TPR=0.7120, TNR=0.7887, J=0.5006, MCC=0.5023, ConfusionMatrix=
[[2907  779]
 [1041 2573]]
Epoch 10, Phase val, Loss=0.4487, Acc=0.8244, AUC=0.7622, TPR=0.4794, TNR=0.8859, J=0.3653, MCC=0.3491, ConfusionMatrix=
[[1926  248]
 [ 202  186]]
Epoch 10, Phase test, Loss=0.4806, Acc=0.8281, AUC=0.7405, TPR=0.4973, TNR=0.8851, J=0.3824, MCC=0.3596, ConfusionMatrix=
[[1911  248]
 [ 187  185]]
Epoch 10 complete in 160.82

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5315, Acc=0.7410, AUC=0.8145, TPR=0.6976, TNR=0.7866, J=0.4842, MCC=0.4855, ConfusionMatrix=
[[2798  759]
 [1132 2611]]
Epoch 11, Phase val, Loss=0.5171, Acc=0.7896, AUC=0.7638, TPR=0.5593, TNR=0.8307, J=0.3900, MCC=0.3331, ConfusionMatrix=
[[1806  368]
 [ 171  217]]
Epoch 11, Phase test, Loss=0.5313, Acc=0.7910, AUC=0.7650, TPR=0.5806, TNR=0.8272, J=0.4079, MCC=0.3418, ConfusionMatrix=
[[1786  373]
 [ 156  216]]
Epoch 11 complete in 155.67

Early Stop!
Training complete in 30m 26s
The best model val AUC=0.782126395357, test AUC=0.769178283455.
Finish training resnet50fixed-conv1x1-maxpool

Start training resnet50fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6222, Acc=0.6440, AUC=0.7085, TPR=0.6576, TNR=0.6304, J=0.2880, MCC=0.2881, ConfusionMatrix=
[[2304 1351]
 [1248 2397]]
Epoch 0, Phase val, Loss=0.4445, Acc=0.8290, AUC=0.7583, TPR=0.3943, TNR=0.9066, J=0.3010, MCC=0.3119, ConfusionMatrix=
[[1971  203]
 [ 235  153]]
New Best AUC=0.7583. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4788, Acc=0.8333, AUC=0.7216, TPR=0.4274, TNR=0.9032, J=0.3306, MCC=0.3321, ConfusionMatrix=
[[1950  209]
 [ 213  159]]
Epoch 0 complete in 158.42

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5665, Acc=0.7156, AUC=0.7828, TPR=0.6464, TNR=0.7833, J=0.4297, MCC=0.4340, ConfusionMatrix=
[[2891  800]
 [1276 2333]]
Epoch 1, Phase val, Loss=0.5556, Acc=0.7775, AUC=0.7724, TPR=0.5979, TNR=0.8096, J=0.4075, MCC=0.3364, ConfusionMatrix=
[[1760  414]
 [ 156  232]]
New Best AUC=0.7724. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5975, Acc=0.7558, AUC=0.7532, TPR=0.6156, TNR=0.7800, J=0.3956, MCC=0.3126, ConfusionMatrix=
[[1684  475]
 [ 143  229]]
Epoch 1 complete in 164.69

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5676, Acc=0.7186, AUC=0.7851, TPR=0.6661, TNR=0.7692, J=0.4353, MCC=0.4380, ConfusionMatrix=
[[2860  858]
 [1196 2386]]
Epoch 2, Phase val, Loss=0.4156, Acc=0.8404, AUC=0.7774, TPR=0.4072, TNR=0.9177, J=0.3249, MCC=0.3446, ConfusionMatrix=
[[1995  179]
 [ 230  158]]
New Best AUC=0.7774. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4596, Acc=0.8467, AUC=0.7406, TPR=0.4435, TNR=0.9162, J=0.3597, MCC=0.3708, ConfusionMatrix=
[[1978  181]
 [ 207  165]]
Epoch 2 complete in 157.92

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5390, Acc=0.7352, AUC=0.8064, TPR=0.6935, TNR=0.7788, J=0.4723, MCC=0.4735, ConfusionMatrix=
[[2778  789]
 [1144 2589]]
Epoch 3, Phase val, Loss=0.7985, Acc=0.6148, AUC=0.7803, TPR=0.8015, TNR=0.5814, J=0.3830, MCC=0.2749, ConfusionMatrix=
[[1264  910]
 [  77  311]]
New Best AUC=0.7803. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.8748, Acc=0.5816, AUC=0.7695, TPR=0.8199, TNR=0.5405, J=0.3604, MCC=0.2553, ConfusionMatrix=
[[1167  992]
 [  67  305]]
Epoch 3 complete in 166.95

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5309, Acc=0.7341, AUC=0.8109, TPR=0.6936, TNR=0.7755, J=0.4691, MCC=0.4704, ConfusionMatrix=
[[2801  811]
 [1130 2558]]
Epoch 4, Phase val, Loss=0.5212, Acc=0.7927, AUC=0.7841, TPR=0.5696, TNR=0.8326, J=0.4022, MCC=0.3434, ConfusionMatrix=
[[1810  364]
 [ 167  221]]
New Best AUC=0.7841. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5769, Acc=0.7677, AUC=0.7557, TPR=0.5833, TNR=0.7994, J=0.3828, MCC=0.3102, ConfusionMatrix=
[[1726  433]
 [ 155  217]]
Epoch 4 complete in 155.14

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5289, Acc=0.7441, AUC=0.8141, TPR=0.6950, TNR=0.7920, J=0.4870, MCC=0.4895, ConfusionMatrix=
[[2928  769]
 [1099 2504]]
Epoch 5, Phase val, Loss=0.5173, Acc=0.7884, AUC=0.7836, TPR=0.6160, TNR=0.8192, J=0.4352, MCC=0.3619, ConfusionMatrix=
[[1781  393]
 [ 149  239]]
Epoch 5, Phase test, Loss=0.5548, Acc=0.7693, AUC=0.7585, TPR=0.6022, TNR=0.7981, J=0.4002, MCC=0.3228, ConfusionMatrix=
[[1723  436]
 [ 148  224]]
Epoch 5 complete in 146.75

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5265, Acc=0.7463, AUC=0.8152, TPR=0.7018, TNR=0.7907, J=0.4926, MCC=0.4945, ConfusionMatrix=
[[2887  764]
 [1088 2561]]
Epoch 6, Phase val, Loss=0.5203, Acc=0.7810, AUC=0.7780, TPR=0.5696, TNR=0.8188, J=0.3884, MCC=0.3260, ConfusionMatrix=
[[1780  394]
 [ 167  221]]
Epoch 6, Phase test, Loss=0.5676, Acc=0.7803, AUC=0.7760, TPR=0.6102, TNR=0.8096, J=0.4198, MCC=0.3424, ConfusionMatrix=
[[1748  411]
 [ 145  227]]
Epoch 6 complete in 158.55

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5274, Acc=0.7479, AUC=0.8190, TPR=0.7101, TNR=0.7857, J=0.4958, MCC=0.4973, ConfusionMatrix=
[[2871  783]
 [1057 2589]]
Epoch 7, Phase val, Loss=0.4271, Acc=0.8302, AUC=0.7686, TPR=0.4227, TNR=0.9029, J=0.3256, MCC=0.3302, ConfusionMatrix=
[[1963  211]
 [ 224  164]]
Epoch 7, Phase test, Loss=0.4558, Acc=0.8388, AUC=0.7554, TPR=0.4597, TNR=0.9041, J=0.3638, MCC=0.3614, ConfusionMatrix=
[[1952  207]
 [ 201  171]]
Epoch 7 complete in 147.25

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5212, Acc=0.7488, AUC=0.8211, TPR=0.6988, TNR=0.7994, J=0.4982, MCC=0.5006, ConfusionMatrix=
[[2898  727]
 [1107 2568]]
Epoch 8, Phase val, Loss=0.6190, Acc=0.7389, AUC=0.7846, TPR=0.6830, TNR=0.7489, J=0.4318, MCC=0.3328, ConfusionMatrix=
[[1628  546]
 [ 123  265]]
New Best AUC=0.7846. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.6729, Acc=0.7013, AUC=0.7762, TPR=0.7177, TNR=0.6985, J=0.4162, MCC=0.3065, ConfusionMatrix=
[[1508  651]
 [ 105  267]]
Epoch 8 complete in 161.04

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5215, Acc=0.7478, AUC=0.8198, TPR=0.7077, TNR=0.7877, J=0.4955, MCC=0.4971, ConfusionMatrix=
[[2880  776]
 [1065 2579]]
Epoch 9, Phase val, Loss=0.4218, Acc=0.8306, AUC=0.7815, TPR=0.4330, TNR=0.9016, J=0.3346, MCC=0.3367, ConfusionMatrix=
[[1960  214]
 [ 220  168]]
Epoch 9, Phase test, Loss=0.4405, Acc=0.8439, AUC=0.7684, TPR=0.5000, TNR=0.9032, J=0.4032, MCC=0.3934, ConfusionMatrix=
[[1950  209]
 [ 186  186]]
Epoch 9 complete in 131.95

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5291, Acc=0.7462, AUC=0.8191, TPR=0.7027, TNR=0.7899, J=0.4925, MCC=0.4944, ConfusionMatrix=
[[2876  765]
 [1088 2571]]
Epoch 10, Phase val, Loss=0.5060, Acc=0.7931, AUC=0.7749, TPR=0.5258, TNR=0.8408, J=0.3666, MCC=0.3201, ConfusionMatrix=
[[1828  346]
 [ 184  204]]
Epoch 10, Phase test, Loss=0.5221, Acc=0.8068, AUC=0.7623, TPR=0.5914, TNR=0.8439, J=0.4353, MCC=0.3720, ConfusionMatrix=
[[1822  337]
 [ 152  220]]
Epoch 10 complete in 111.36

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5316, Acc=0.7429, AUC=0.8122, TPR=0.6993, TNR=0.7860, J=0.4853, MCC=0.4872, ConfusionMatrix=
[[2884  785]
 [1092 2539]]
Epoch 11, Phase val, Loss=0.4803, Acc=0.8154, AUC=0.7705, TPR=0.5000, TNR=0.8717, J=0.3717, MCC=0.3434, ConfusionMatrix=
[[1895  279]
 [ 194  194]]
Epoch 11, Phase test, Loss=0.5081, Acc=0.8076, AUC=0.7624, TPR=0.5296, TNR=0.8555, J=0.3851, MCC=0.3402, ConfusionMatrix=
[[1847  312]
 [ 175  197]]
Epoch 11 complete in 85.00

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5213, Acc=0.7497, AUC=0.8234, TPR=0.7087, TNR=0.7906, J=0.4994, MCC=0.5011, ConfusionMatrix=
[[2889  765]
 [1062 2584]]
Epoch 12, Phase val, Loss=0.5304, Acc=0.7873, AUC=0.7690, TPR=0.5464, TNR=0.8303, J=0.3767, MCC=0.3225, ConfusionMatrix=
[[1805  369]
 [ 176  212]]
Epoch 12, Phase test, Loss=0.5615, Acc=0.7724, AUC=0.7662, TPR=0.6317, TNR=0.7967, J=0.4284, MCC=0.3432, ConfusionMatrix=
[[1720  439]
 [ 137  235]]
Epoch 12 complete in 66.00

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5111, Acc=0.7577, AUC=0.8307, TPR=0.7042, TNR=0.8093, J=0.5135, MCC=0.5168, ConfusionMatrix=
[[3005  708]
 [1061 2526]]
Epoch 13, Phase val, Loss=0.5926, Acc=0.7639, AUC=0.7750, TPR=0.6495, TNR=0.7843, J=0.4338, MCC=0.3458, ConfusionMatrix=
[[1705  469]
 [ 136  252]]
Epoch 13, Phase test, Loss=0.6462, Acc=0.7333, AUC=0.7661, TPR=0.6989, TNR=0.7392, J=0.4382, MCC=0.3312, ConfusionMatrix=
[[1596  563]
 [ 112  260]]
Epoch 13 complete in 142.15

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5044, Acc=0.7595, AUC=0.8341, TPR=0.7313, TNR=0.7890, J=0.5203, MCC=0.5207, ConfusionMatrix=
[[2809  751]
 [1005 2735]]
Epoch 14, Phase val, Loss=0.4734, Acc=0.8103, AUC=0.7823, TPR=0.5464, TNR=0.8574, J=0.4038, MCC=0.3594, ConfusionMatrix=
[[1864  310]
 [ 176  212]]
Epoch 14, Phase test, Loss=0.5198, Acc=0.8013, AUC=0.7579, TPR=0.5538, TNR=0.8439, J=0.3977, MCC=0.3430, ConfusionMatrix=
[[1822  337]
 [ 166  206]]
Epoch 14 complete in 112.78

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5254, Acc=0.7482, AUC=0.8215, TPR=0.7044, TNR=0.7914, J=0.4958, MCC=0.4978, ConfusionMatrix=
[[2910  767]
 [1071 2552]]
Epoch 15, Phase val, Loss=0.4493, Acc=0.8189, AUC=0.7782, TPR=0.4588, TNR=0.8832, J=0.3419, MCC=0.3274, ConfusionMatrix=
[[1920  254]
 [ 210  178]]
Epoch 15, Phase test, Loss=0.4707, Acc=0.8277, AUC=0.7558, TPR=0.5027, TNR=0.8837, J=0.3864, MCC=0.3617, ConfusionMatrix=
[[1908  251]
 [ 185  187]]
Epoch 15 complete in 92.57

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5229, Acc=0.7532, AUC=0.8228, TPR=0.6947, TNR=0.8091, J=0.5038, MCC=0.5077, ConfusionMatrix=
[[3018  712]
 [1090 2480]]
Epoch 16, Phase val, Loss=0.5937, Acc=0.7619, AUC=0.7761, TPR=0.6598, TNR=0.7801, J=0.4399, MCC=0.3488, ConfusionMatrix=
[[1696  478]
 [ 132  256]]
Epoch 16, Phase test, Loss=0.6297, Acc=0.7554, AUC=0.7646, TPR=0.6640, TNR=0.7712, J=0.4352, MCC=0.3386, ConfusionMatrix=
[[1665  494]
 [ 125  247]]
Epoch 16 complete in 81.67

Early Stop!
Training complete in 37m 20s
The best model val AUC=0.784556710515, test AUC=0.776241738758.
Finish training resnet50fixed-conv1x1-maxpool

Start training resnet50fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6238, Acc=0.6527, AUC=0.7082, TPR=0.6598, TNR=0.6456, J=0.3054, MCC=0.3055, ConfusionMatrix=
[[2348 1289]
 [1246 2417]]
Epoch 0, Phase val, Loss=0.5549, Acc=0.7361, AUC=0.7649, TPR=0.6108, TNR=0.7585, J=0.3693, MCC=0.2896, ConfusionMatrix=
[[1649  525]
 [ 151  237]]
New Best AUC=0.7649. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5955, Acc=0.7357, AUC=0.7510, TPR=0.6237, TNR=0.7550, J=0.3786, MCC=0.2924, ConfusionMatrix=
[[1630  529]
 [ 140  232]]
Epoch 0 complete in 49.34

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5515, Acc=0.7189, AUC=0.7961, TPR=0.6638, TNR=0.7733, J=0.4371, MCC=0.4399, ConfusionMatrix=
[[2841  833]
 [1219 2407]]
Epoch 1, Phase val, Loss=0.6843, Acc=0.6835, AUC=0.7681, TPR=0.7113, TNR=0.6785, J=0.3898, MCC=0.2878, ConfusionMatrix=
[[1475  699]
 [ 112  276]]
New Best AUC=0.7681. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7503, Acc=0.6507, AUC=0.7579, TPR=0.7339, TNR=0.6364, J=0.3703, MCC=0.2658, ConfusionMatrix=
[[1374  785]
 [  99  273]]
Epoch 1 complete in 114.39

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5422, Acc=0.7342, AUC=0.8048, TPR=0.6926, TNR=0.7768, J=0.4694, MCC=0.4708, ConfusionMatrix=
[[2805  806]
 [1134 2555]]
Epoch 2, Phase val, Loss=0.4496, Acc=0.8290, AUC=0.7743, TPR=0.4820, TNR=0.8910, J=0.3729, MCC=0.3598, ConfusionMatrix=
[[1937  237]
 [ 201  187]]
New Best AUC=0.7743. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4671, Acc=0.8234, AUC=0.7566, TPR=0.4973, TNR=0.8796, J=0.3769, MCC=0.3506, ConfusionMatrix=
[[1899  260]
 [ 187  185]]
Epoch 2 complete in 126.08

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5461, Acc=0.7264, AUC=0.8008, TPR=0.6795, TNR=0.7735, J=0.4530, MCC=0.4550, ConfusionMatrix=
[[2820  826]
 [1171 2483]]
Epoch 3, Phase val, Loss=0.6457, Acc=0.7100, AUC=0.7865, TPR=0.7139, TNR=0.7093, J=0.4232, MCC=0.3171, ConfusionMatrix=
[[1542  632]
 [ 111  277]]
New Best AUC=0.7865. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6799, Acc=0.6855, AUC=0.7741, TPR=0.7204, TNR=0.6795, J=0.3999, MCC=0.2918, ConfusionMatrix=
[[1467  692]
 [ 104  268]]
Epoch 3 complete in 113.99

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5321, Acc=0.7401, AUC=0.8127, TPR=0.7021, TNR=0.7790, J=0.4812, MCC=0.4824, ConfusionMatrix=
[[2810  797]
 [1100 2593]]
Epoch 4, Phase val, Loss=0.4443, Acc=0.8205, AUC=0.7649, TPR=0.4201, TNR=0.8919, J=0.3120, MCC=0.3088, ConfusionMatrix=
[[1939  235]
 [ 225  163]]
Epoch 4, Phase test, Loss=0.4610, Acc=0.8301, AUC=0.7481, TPR=0.4839, TNR=0.8898, J=0.3736, MCC=0.3563, ConfusionMatrix=
[[1921  238]
 [ 192  180]]
Epoch 4 complete in 65.99

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5442, Acc=0.7340, AUC=0.8007, TPR=0.6840, TNR=0.7846, J=0.4686, MCC=0.4708, ConfusionMatrix=
[[2845  781]
 [1161 2513]]
Epoch 5, Phase val, Loss=0.5219, Acc=0.7959, AUC=0.7718, TPR=0.5722, TNR=0.8358, J=0.4080, MCC=0.3497, ConfusionMatrix=
[[1817  357]
 [ 166  222]]
Epoch 5, Phase test, Loss=0.5570, Acc=0.7859, AUC=0.7640, TPR=0.6048, TNR=0.8170, J=0.4219, MCC=0.3473, ConfusionMatrix=
[[1764  395]
 [ 147  225]]
Epoch 5 complete in 91.22

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5179, Acc=0.7590, AUC=0.8269, TPR=0.7108, TNR=0.8062, J=0.5169, MCC=0.5196, ConfusionMatrix=
[[2978  716]
 [1043 2563]]
Epoch 6, Phase val, Loss=0.4661, Acc=0.8107, AUC=0.7695, TPR=0.5026, TNR=0.8657, J=0.3683, MCC=0.3365, ConfusionMatrix=
[[1882  292]
 [ 193  195]]
Epoch 6, Phase test, Loss=0.4818, Acc=0.8238, AUC=0.7726, TPR=0.5376, TNR=0.8731, J=0.4107, MCC=0.3728, ConfusionMatrix=
[[1885  274]
 [ 172  200]]
Epoch 6 complete in 85.73

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5438, Acc=0.7382, AUC=0.8073, TPR=0.6774, TNR=0.7978, J=0.4752, MCC=0.4789, ConfusionMatrix=
[[2943  746]
 [1165 2446]]
Epoch 7, Phase val, Loss=0.5842, Acc=0.7639, AUC=0.7631, TPR=0.5954, TNR=0.7939, J=0.3893, MCC=0.3162, ConfusionMatrix=
[[1726  448]
 [ 157  231]]
Epoch 7, Phase test, Loss=0.6068, Acc=0.7531, AUC=0.7727, TPR=0.6694, TNR=0.7675, J=0.4368, MCC=0.3386, ConfusionMatrix=
[[1657  502]
 [ 123  249]]
Epoch 7 complete in 80.27

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5498, Acc=0.7344, AUC=0.8001, TPR=0.6794, TNR=0.7874, J=0.4668, MCC=0.4699, ConfusionMatrix=
[[2926  790]
 [1149 2435]]
Epoch 8, Phase val, Loss=0.4467, Acc=0.8236, AUC=0.7795, TPR=0.4639, TNR=0.8878, J=0.3517, MCC=0.3392, ConfusionMatrix=
[[1930  244]
 [ 208  180]]
Epoch 8, Phase test, Loss=0.4712, Acc=0.8388, AUC=0.7708, TPR=0.5161, TNR=0.8944, J=0.4105, MCC=0.3907, ConfusionMatrix=
[[1931  228]
 [ 180  192]]
Epoch 8 complete in 55.06

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5226, Acc=0.7473, AUC=0.8214, TPR=0.7015, TNR=0.7947, J=0.4962, MCC=0.4979, ConfusionMatrix=
[[2849  736]
 [1109 2606]]
Epoch 9, Phase val, Loss=0.4366, Acc=0.8290, AUC=0.7652, TPR=0.4253, TNR=0.9011, J=0.3264, MCC=0.3292, ConfusionMatrix=
[[1959  215]
 [ 223  165]]
Epoch 9, Phase test, Loss=0.4472, Acc=0.8443, AUC=0.7648, TPR=0.5000, TNR=0.9037, J=0.4037, MCC=0.3942, ConfusionMatrix=
[[1951  208]
 [ 186  186]]
Epoch 9 complete in 100.37

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5178, Acc=0.7418, AUC=0.8221, TPR=0.6944, TNR=0.7893, J=0.4837, MCC=0.4859, ConfusionMatrix=
[[2877  768]
 [1117 2538]]
Epoch 10, Phase val, Loss=0.6275, Acc=0.7334, AUC=0.7652, TPR=0.6649, TNR=0.7456, J=0.4106, MCC=0.3164, ConfusionMatrix=
[[1621  553]
 [ 130  258]]
Epoch 10, Phase test, Loss=0.6460, Acc=0.7278, AUC=0.7702, TPR=0.7016, TNR=0.7323, J=0.4339, MCC=0.3264, ConfusionMatrix=
[[1581  578]
 [ 111  261]]
Epoch 10 complete in 104.53

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5053, Acc=0.7595, AUC=0.8327, TPR=0.7293, TNR=0.7909, J=0.5201, MCC=0.5207, ConfusionMatrix=
[[2829  748]
 [1008 2715]]
Epoch 11, Phase val, Loss=0.6487, Acc=0.7209, AUC=0.7713, TPR=0.6778, TNR=0.7286, J=0.4064, MCC=0.3092, ConfusionMatrix=
[[1584  590]
 [ 125  263]]
Epoch 11, Phase test, Loss=0.6770, Acc=0.7033, AUC=0.7792, TPR=0.7124, TNR=0.7017, J=0.4141, MCC=0.3056, ConfusionMatrix=
[[1515  644]
 [ 107  265]]
Epoch 11 complete in 66.38

Early Stop!
Training complete in 17m 33s
The best model val AUC=0.786523487514, test AUC=0.774067793234.
Finish training resnet50fixed-conv1x1-maxpool

Start training resnet50fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6129, Acc=0.6593, AUC=0.7216, TPR=0.6680, TNR=0.6508, J=0.3188, MCC=0.3188, ConfusionMatrix=
[[2399 1287]
 [1200 2414]]
Epoch 0, Phase val, Loss=0.5801, Acc=0.6995, AUC=0.7264, TPR=0.6263, TNR=0.7125, J=0.3388, MCC=0.2566, ConfusionMatrix=
[[1549  625]
 [ 145  243]]
New Best AUC=0.7264. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6116, Acc=0.6610, AUC=0.7213, TPR=0.6774, TNR=0.6582, J=0.3356, MCC=0.2435, ConfusionMatrix=
[[1421  738]
 [ 120  252]]
Epoch 0 complete in 61.11

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5656, Acc=0.7137, AUC=0.7796, TPR=0.7074, TNR=0.7198, J=0.4272, MCC=0.4272, ConfusionMatrix=
[[2674 1041]
 [1049 2536]]
Epoch 1, Phase val, Loss=0.5283, Acc=0.7420, AUC=0.7597, TPR=0.6418, TNR=0.7599, J=0.4016, MCC=0.3139, ConfusionMatrix=
[[1652  522]
 [ 139  249]]
New Best AUC=0.7597. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5523, Acc=0.7112, AUC=0.7444, TPR=0.6559, TNR=0.7207, J=0.3766, MCC=0.2826, ConfusionMatrix=
[[1556  603]
 [ 128  244]]
Epoch 1 complete in 77.82

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5680, Acc=0.7064, AUC=0.7784, TPR=0.6987, TNR=0.7139, J=0.4125, MCC=0.4125, ConfusionMatrix=
[[2667 1069]
 [1074 2490]]
Epoch 2, Phase val, Loss=0.3824, Acc=0.8353, AUC=0.7428, TPR=0.1649, TNR=0.9549, J=0.1199, MCC=0.1766, ConfusionMatrix=
[[2076   98]
 [ 324   64]]
Epoch 2, Phase test, Loss=0.3776, Acc=0.8526, AUC=0.7377, TPR=0.2285, TNR=0.9602, J=0.1887, MCC=0.2662, ConfusionMatrix=
[[2073   86]
 [ 287   85]]
Epoch 2 complete in 75.24

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5750, Acc=0.7048, AUC=0.7734, TPR=0.7067, TNR=0.7029, J=0.4096, MCC=0.4096, ConfusionMatrix=
[[2569 1086]
 [1069 2576]]
Epoch 3, Phase val, Loss=0.5135, Acc=0.7611, AUC=0.7422, TPR=0.5644, TNR=0.7962, J=0.3607, MCC=0.2954, ConfusionMatrix=
[[1731  443]
 [ 169  219]]
Epoch 3, Phase test, Loss=0.5364, Acc=0.7313, AUC=0.7381, TPR=0.5995, TNR=0.7541, J=0.3535, MCC=0.2737, ConfusionMatrix=
[[1628  531]
 [ 149  223]]
Epoch 3 complete in 51.89

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5456, Acc=0.7278, AUC=0.7983, TPR=0.7275, TNR=0.7281, J=0.4556, MCC=0.4556, ConfusionMatrix=
[[2664  995]
 [ 992 2649]]
Epoch 4, Phase val, Loss=0.6029, Acc=0.6956, AUC=0.7513, TPR=0.7139, TNR=0.6923, J=0.4062, MCC=0.3017, ConfusionMatrix=
[[1505  669]
 [ 111  277]]
Epoch 4, Phase test, Loss=0.6265, Acc=0.6657, AUC=0.7488, TPR=0.7151, TNR=0.6572, J=0.3723, MCC=0.2694, ConfusionMatrix=
[[1419  740]
 [ 106  266]]
Epoch 4 complete in 130.34

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5350, Acc=0.7374, AUC=0.8093, TPR=0.7400, TNR=0.7347, J=0.4747, MCC=0.4748, ConfusionMatrix=
[[2659  960]
 [ 957 2724]]
Epoch 5, Phase val, Loss=0.6151, Acc=0.6881, AUC=0.7542, TPR=0.7320, TNR=0.6803, J=0.4123, MCC=0.3042, ConfusionMatrix=
[[1479  695]
 [ 104  284]]
Epoch 5, Phase test, Loss=0.6408, Acc=0.6574, AUC=0.7504, TPR=0.7204, TNR=0.6466, J=0.3670, MCC=0.2645, ConfusionMatrix=
[[1396  763]
 [ 104  268]]
Epoch 5 complete in 268.56

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5385, Acc=0.7274, AUC=0.8043, TPR=0.7199, TNR=0.7347, J=0.4546, MCC=0.4547, ConfusionMatrix=
[[2714  980]
 [1010 2596]]
Epoch 6, Phase val, Loss=0.5801, Acc=0.7045, AUC=0.7536, TPR=0.6856, TNR=0.7079, J=0.3935, MCC=0.2954, ConfusionMatrix=
[[1539  635]
 [ 122  266]]
Epoch 6, Phase test, Loss=0.5980, Acc=0.6859, AUC=0.7503, TPR=0.7016, TNR=0.6832, J=0.3848, MCC=0.2817, ConfusionMatrix=
[[1475  684]
 [ 111  261]]
Epoch 6 complete in 304.54

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5361, Acc=0.7353, AUC=0.8080, TPR=0.7380, TNR=0.7327, J=0.4707, MCC=0.4707, ConfusionMatrix=
[[2703  986]
 [ 946 2665]]
Epoch 7, Phase val, Loss=0.6385, Acc=0.6756, AUC=0.7562, TPR=0.7577, TNR=0.6610, J=0.4187, MCC=0.3061, ConfusionMatrix=
[[1437  737]
 [  94  294]]
Epoch 7, Phase test, Loss=0.6595, Acc=0.6456, AUC=0.7501, TPR=0.7204, TNR=0.6327, J=0.3531, MCC=0.2534, ConfusionMatrix=
[[1366  793]
 [ 104  268]]
Epoch 7 complete in 177.02

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5395, Acc=0.7355, AUC=0.8056, TPR=0.7428, TNR=0.7281, J=0.4709, MCC=0.4710, ConfusionMatrix=
[[2649  989]
 [ 942 2720]]
Epoch 8, Phase val, Loss=0.5409, Acc=0.7365, AUC=0.7449, TPR=0.5928, TNR=0.7622, J=0.3550, MCC=0.2800, ConfusionMatrix=
[[1657  517]
 [ 158  230]]
Epoch 8, Phase test, Loss=0.5580, Acc=0.7199, AUC=0.7439, TPR=0.6478, TNR=0.7323, J=0.3801, MCC=0.2877, ConfusionMatrix=
[[1581  578]
 [ 131  241]]
Epoch 8 complete in 132.61

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5263, Acc=0.7441, AUC=0.8161, TPR=0.7440, TNR=0.7442, J=0.4882, MCC=0.4882, ConfusionMatrix=
[[2700  928]
 [ 940 2732]]
Epoch 9, Phase val, Loss=0.5471, Acc=0.7400, AUC=0.7494, TPR=0.6186, TNR=0.7617, J=0.3803, MCC=0.2987, ConfusionMatrix=
[[1656  518]
 [ 148  240]]
Epoch 9, Phase test, Loss=0.5612, Acc=0.7092, AUC=0.7484, TPR=0.6398, TNR=0.7212, J=0.3610, MCC=0.2714, ConfusionMatrix=
[[1557  602]
 [ 134  238]]
Epoch 9 complete in 113.91

Early Stop!
Training complete in 23m 13s
The best model val AUC=0.759693993684, test AUC=0.744375880909.
Finish training resnet50fixed-conv1x1-avgpool

Start training resnet50fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6208, Acc=0.6571, AUC=0.7144, TPR=0.6841, TNR=0.6309, J=0.3150, MCC=0.3154, ConfusionMatrix=
[[2337 1367]
 [1136 2460]]
Epoch 0, Phase val, Loss=0.7018, Acc=0.5824, AUC=0.7252, TPR=0.7680, TNR=0.5492, J=0.3173, MCC=0.2275, ConfusionMatrix=
[[1194  980]
 [  90  298]]
New Best AUC=0.7252. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7252, Acc=0.5603, AUC=0.7323, TPR=0.7984, TNR=0.5192, J=0.3176, MCC=0.2253, ConfusionMatrix=
[[1121 1038]
 [  75  297]]
Epoch 0 complete in 124.53

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5488, Acc=0.7253, AUC=0.7992, TPR=0.7501, TNR=0.7006, J=0.4506, MCC=0.4512, ConfusionMatrix=
[[2555 1092]
 [ 913 2740]]
Epoch 1, Phase val, Loss=0.4673, Acc=0.7802, AUC=0.7452, TPR=0.4742, TNR=0.8349, J=0.3091, MCC=0.2711, ConfusionMatrix=
[[1815  359]
 [ 204  184]]
New Best AUC=0.7452. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4775, Acc=0.7693, AUC=0.7436, TPR=0.5188, TNR=0.8124, J=0.3312, MCC=0.2761, ConfusionMatrix=
[[1754  405]
 [ 179  193]]
Epoch 1 complete in 118.37

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5603, Acc=0.7179, AUC=0.7869, TPR=0.7138, TNR=0.7220, J=0.4357, MCC=0.4357, ConfusionMatrix=
[[2685 1034]
 [1025 2556]]
Epoch 2, Phase val, Loss=0.6798, Acc=0.6272, AUC=0.7474, TPR=0.7784, TNR=0.6003, J=0.3786, MCC=0.2725, ConfusionMatrix=
[[1305  869]
 [  86  302]]
New Best AUC=0.7474. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.7217, Acc=0.5934, AUC=0.7448, TPR=0.7876, TNR=0.5600, J=0.3476, MCC=0.2462, ConfusionMatrix=
[[1209  950]
 [  79  293]]
Epoch 2 complete in 116.47

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5442, Acc=0.7305, AUC=0.8008, TPR=0.7225, TNR=0.7384, J=0.4608, MCC=0.4609, ConfusionMatrix=
[[2743  972]
 [ 995 2590]]
Epoch 3, Phase val, Loss=0.5447, Acc=0.7307, AUC=0.7397, TPR=0.5928, TNR=0.7553, J=0.3481, MCC=0.2730, ConfusionMatrix=
[[1642  532]
 [ 158  230]]
Epoch 3, Phase test, Loss=0.5672, Acc=0.7029, AUC=0.7438, TPR=0.6344, TNR=0.7147, J=0.3491, MCC=0.2616, ConfusionMatrix=
[[1543  616]
 [ 136  236]]
Epoch 3 complete in 124.79

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5469, Acc=0.7232, AUC=0.7971, TPR=0.7259, TNR=0.7204, J=0.4463, MCC=0.4463, ConfusionMatrix=
[[2625 1019]
 [1002 2654]]
Epoch 4, Phase val, Loss=0.5457, Acc=0.7334, AUC=0.7541, TPR=0.6572, TNR=0.7470, J=0.4042, MCC=0.3122, ConfusionMatrix=
[[1624  550]
 [ 133  255]]
New Best AUC=0.7541. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5597, Acc=0.7072, AUC=0.7541, TPR=0.6586, TNR=0.7156, J=0.3742, MCC=0.2798, ConfusionMatrix=
[[1545  614]
 [ 127  245]]
Epoch 4 complete in 114.19

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5412, Acc=0.7321, AUC=0.8031, TPR=0.7288, TNR=0.7353, J=0.4641, MCC=0.4641, ConfusionMatrix=
[[2694  970]
 [ 986 2650]]
Epoch 5, Phase val, Loss=0.4188, Acc=0.8181, AUC=0.7404, TPR=0.3144, TNR=0.9080, J=0.2224, MCC=0.2405, ConfusionMatrix=
[[1974  200]
 [ 266  122]]
Epoch 5, Phase test, Loss=0.4165, Acc=0.8281, AUC=0.7411, TPR=0.3844, TNR=0.9046, J=0.2890, MCC=0.2968, ConfusionMatrix=
[[1953  206]
 [ 229  143]]
Epoch 5 complete in 118.37

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5437, Acc=0.7326, AUC=0.8025, TPR=0.7407, TNR=0.7245, J=0.4652, MCC=0.4652, ConfusionMatrix=
[[2637 1003]
 [ 949 2711]]
Epoch 6, Phase val, Loss=0.6357, Acc=0.6710, AUC=0.7461, TPR=0.7216, TNR=0.6619, J=0.3836, MCC=0.2811, ConfusionMatrix=
[[1439  735]
 [ 108  280]]
Epoch 6, Phase test, Loss=0.6667, Acc=0.6464, AUC=0.7480, TPR=0.7419, TNR=0.6299, J=0.3719, MCC=0.2664, ConfusionMatrix=
[[1360  799]
 [  96  276]]
Epoch 6 complete in 122.32

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5390, Acc=0.7304, AUC=0.8056, TPR=0.7303, TNR=0.7305, J=0.4608, MCC=0.4608, ConfusionMatrix=
[[2670  985]
 [ 983 2662]]
Epoch 7, Phase val, Loss=0.4745, Acc=0.7877, AUC=0.7409, TPR=0.4716, TNR=0.8441, J=0.3157, MCC=0.2810, ConfusionMatrix=
[[1835  339]
 [ 205  183]]
Epoch 7, Phase test, Loss=0.4818, Acc=0.7756, AUC=0.7419, TPR=0.5323, TNR=0.8175, J=0.3498, MCC=0.2926, ConfusionMatrix=
[[1765  394]
 [ 174  198]]
Epoch 7 complete in 142.43

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5188, Acc=0.7430, AUC=0.8213, TPR=0.7384, TNR=0.7476, J=0.4860, MCC=0.4860, ConfusionMatrix=
[[2743  926]
 [ 950 2681]]
Epoch 8, Phase val, Loss=0.4788, Acc=0.7783, AUC=0.7485, TPR=0.4948, TNR=0.8289, J=0.3237, MCC=0.2801, ConfusionMatrix=
[[1802  372]
 [ 196  192]]
Epoch 8, Phase test, Loss=0.4852, Acc=0.7720, AUC=0.7487, TPR=0.5565, TNR=0.8092, J=0.3656, MCC=0.3012, ConfusionMatrix=
[[1747  412]
 [ 165  207]]
Epoch 8 complete in 141.89

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5472, Acc=0.7259, AUC=0.7982, TPR=0.7289, TNR=0.7229, J=0.4518, MCC=0.4518, ConfusionMatrix=
[[2650 1016]
 [ 985 2649]]
Epoch 9, Phase val, Loss=0.5689, Acc=0.7233, AUC=0.7508, TPR=0.6675, TNR=0.7332, J=0.4007, MCC=0.3061, ConfusionMatrix=
[[1594  580]
 [ 129  259]]
Epoch 9, Phase test, Loss=0.5846, Acc=0.7013, AUC=0.7503, TPR=0.6586, TNR=0.7087, J=0.3673, MCC=0.2735, ConfusionMatrix=
[[1530  629]
 [ 127  245]]
Epoch 9 complete in 169.61

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5176, Acc=0.7477, AUC=0.8227, TPR=0.7685, TNR=0.7261, J=0.4946, MCC=0.4952, ConfusionMatrix=
[[2603  982]
 [ 860 2855]]
Epoch 10, Phase val, Loss=0.5129, Acc=0.7568, AUC=0.7549, TPR=0.5902, TNR=0.7866, J=0.3768, MCC=0.3041, ConfusionMatrix=
[[1710  464]
 [ 159  229]]
New Best AUC=0.7549. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.5258, Acc=0.7396, AUC=0.7508, TPR=0.6075, TNR=0.7624, J=0.3699, MCC=0.2881, ConfusionMatrix=
[[1646  513]
 [ 146  226]]
Epoch 10 complete in 213.34

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5256, Acc=0.7384, AUC=0.8166, TPR=0.7439, TNR=0.7328, J=0.4768, MCC=0.4768, ConfusionMatrix=
[[2685  979]
 [ 931 2705]]
Epoch 11, Phase val, Loss=0.5481, Acc=0.7330, AUC=0.7434, TPR=0.6082, TNR=0.7553, J=0.3635, MCC=0.2844, ConfusionMatrix=
[[1642  532]
 [ 152  236]]
Epoch 11, Phase test, Loss=0.5594, Acc=0.7120, AUC=0.7405, TPR=0.6237, TNR=0.7272, J=0.3508, MCC=0.2654, ConfusionMatrix=
[[1570  589]
 [ 140  232]]
Epoch 11 complete in 170.96

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5254, Acc=0.7407, AUC=0.8166, TPR=0.7382, TNR=0.7432, J=0.4814, MCC=0.4814, ConfusionMatrix=
[[2703  934]
 [ 959 2704]]
Epoch 12, Phase val, Loss=0.5093, Acc=0.7580, AUC=0.7441, TPR=0.5438, TNR=0.7962, J=0.3400, MCC=0.2796, ConfusionMatrix=
[[1731  443]
 [ 177  211]]
Epoch 12, Phase test, Loss=0.5104, Acc=0.7491, AUC=0.7482, TPR=0.5780, TNR=0.7786, J=0.3566, MCC=0.2831, ConfusionMatrix=
[[1681  478]
 [ 157  215]]
Epoch 12 complete in 160.38

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5316, Acc=0.7396, AUC=0.8132, TPR=0.7406, TNR=0.7386, J=0.4792, MCC=0.4792, ConfusionMatrix=
[[2712  960]
 [ 941 2687]]
Epoch 13, Phase val, Loss=0.5097, Acc=0.7635, AUC=0.7530, TPR=0.5954, TNR=0.7935, J=0.3888, MCC=0.3157, ConfusionMatrix=
[[1725  449]
 [ 157  231]]
Epoch 13, Phase test, Loss=0.5144, Acc=0.7440, AUC=0.7477, TPR=0.5968, TNR=0.7693, J=0.3661, MCC=0.2873, ConfusionMatrix=
[[1661  498]
 [ 150  222]]
Epoch 13 complete in 126.49

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5313, Acc=0.7314, AUC=0.8114, TPR=0.7357, TNR=0.7269, J=0.4626, MCC=0.4627, ConfusionMatrix=
[[2622  985]
 [ 976 2717]]
Epoch 14, Phase val, Loss=0.4846, Acc=0.7861, AUC=0.7387, TPR=0.5077, TNR=0.8358, J=0.3435, MCC=0.2991, ConfusionMatrix=
[[1817  357]
 [ 191  197]]
Epoch 14, Phase test, Loss=0.4807, Acc=0.7783, AUC=0.7456, TPR=0.5430, TNR=0.8189, J=0.3619, MCC=0.3025, ConfusionMatrix=
[[1768  391]
 [ 170  202]]
Epoch 14 complete in 130.57

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5261, Acc=0.7427, AUC=0.8158, TPR=0.7522, TNR=0.7332, J=0.4854, MCC=0.4855, ConfusionMatrix=
[[2660  968]
 [ 910 2762]]
Epoch 15, Phase val, Loss=0.4774, Acc=0.7853, AUC=0.7324, TPR=0.4407, TNR=0.8468, J=0.2875, MCC=0.2593, ConfusionMatrix=
[[1841  333]
 [ 217  171]]
Epoch 15, Phase test, Loss=0.4755, Acc=0.7780, AUC=0.7375, TPR=0.5134, TNR=0.8235, J=0.3370, MCC=0.2853, ConfusionMatrix=
[[1778  381]
 [ 181  191]]
Epoch 15 complete in 128.63

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5258, Acc=0.7422, AUC=0.8166, TPR=0.7506, TNR=0.7334, J=0.4840, MCC=0.4841, ConfusionMatrix=
[[2622  953]
 [ 929 2796]]
Epoch 16, Phase val, Loss=0.4657, Acc=0.7990, AUC=0.7363, TPR=0.4485, TNR=0.8615, J=0.3100, MCC=0.2860, ConfusionMatrix=
[[1873  301]
 [ 214  174]]
Epoch 16, Phase test, Loss=0.4622, Acc=0.7926, AUC=0.7440, TPR=0.5161, TNR=0.8402, J=0.3563, MCC=0.3086, ConfusionMatrix=
[[1814  345]
 [ 180  192]]
Epoch 16 complete in 127.73

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5254, Acc=0.7384, AUC=0.8171, TPR=0.7318, TNR=0.7448, J=0.4766, MCC=0.4766, ConfusionMatrix=
[[2743  940]
 [ 970 2647]]
Epoch 17, Phase val, Loss=0.4408, Acc=0.8154, AUC=0.7328, TPR=0.3866, TNR=0.8919, J=0.2785, MCC=0.2794, ConfusionMatrix=
[[1939  235]
 [ 238  150]]
Epoch 17, Phase test, Loss=0.4311, Acc=0.8123, AUC=0.7389, TPR=0.4301, TNR=0.8782, J=0.3083, MCC=0.2926, ConfusionMatrix=
[[1896  263]
 [ 212  160]]
Epoch 17 complete in 149.07

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5249, Acc=0.7389, AUC=0.8174, TPR=0.7359, TNR=0.7419, J=0.4778, MCC=0.4778, ConfusionMatrix=
[[2722  947]
 [ 959 2672]]
Epoch 18, Phase val, Loss=0.5630, Acc=0.7307, AUC=0.7450, TPR=0.6366, TNR=0.7475, J=0.3841, MCC=0.2975, ConfusionMatrix=
[[1625  549]
 [ 141  247]]
Epoch 18, Phase test, Loss=0.5672, Acc=0.7080, AUC=0.7493, TPR=0.6452, TNR=0.7189, J=0.3640, MCC=0.2732, ConfusionMatrix=
[[1552  607]
 [ 132  240]]
Epoch 18 complete in 134.70

Early Stop!
Training complete in 43m 55s
The best model val AUC=0.754873671033, test AUC=0.750813050646.
Finish training resnet50fixed-conv1x1-avgpool

Start training resnet50fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6096, Acc=0.6645, AUC=0.7280, TPR=0.7035, TNR=0.6254, J=0.3290, MCC=0.3300, ConfusionMatrix=
[[2281 1366]
 [1083 2570]]
Epoch 0, Phase val, Loss=0.5219, Acc=0.7432, AUC=0.7469, TPR=0.5851, TNR=0.7714, J=0.3564, MCC=0.2838, ConfusionMatrix=
[[1677  497]
 [ 161  227]]
New Best AUC=0.7469. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5453, Acc=0.7143, AUC=0.7330, TPR=0.6102, TNR=0.7323, J=0.3425, MCC=0.2604, ConfusionMatrix=
[[1581  578]
 [ 145  227]]
Epoch 0 complete in 127.29

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5630, Acc=0.7201, AUC=0.7842, TPR=0.7269, TNR=0.7134, J=0.4403, MCC=0.4404, ConfusionMatrix=
[[2616 1051]
 [ 992 2641]]
Epoch 1, Phase val, Loss=0.6293, Acc=0.6585, AUC=0.7469, TPR=0.7448, TNR=0.6431, J=0.3879, MCC=0.2821, ConfusionMatrix=
[[1398  776]
 [  99  289]]
Epoch 1, Phase test, Loss=0.6682, Acc=0.6199, AUC=0.7381, TPR=0.7527, TNR=0.5970, J=0.3497, MCC=0.2487, ConfusionMatrix=
[[1289  870]
 [  92  280]]
Epoch 1 complete in 144.33

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5675, Acc=0.7033, AUC=0.7770, TPR=0.7009, TNR=0.7056, J=0.4065, MCC=0.4065, ConfusionMatrix=
[[2603 1086]
 [1080 2531]]
Epoch 2, Phase val, Loss=0.7358, Acc=0.5847, AUC=0.7555, TPR=0.8273, TNR=0.5414, J=0.3687, MCC=0.2645, ConfusionMatrix=
[[1177  997]
 [  67  321]]
New Best AUC=0.7555. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.7816, Acc=0.5531, AUC=0.7452, TPR=0.8145, TNR=0.5081, J=0.3226, MCC=0.2292, ConfusionMatrix=
[[1097 1062]
 [  69  303]]
Epoch 2 complete in 137.18

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5571, Acc=0.7141, AUC=0.7887, TPR=0.7289, TNR=0.6991, J=0.4281, MCC=0.4283, ConfusionMatrix=
[[2540 1093]
 [ 994 2673]]
Epoch 3, Phase val, Loss=0.4931, Acc=0.7670, AUC=0.7470, TPR=0.5258, TNR=0.8100, J=0.3358, MCC=0.2815, ConfusionMatrix=
[[1761  413]
 [ 184  204]]
Epoch 3, Phase test, Loss=0.5124, Acc=0.7463, AUC=0.7433, TPR=0.5887, TNR=0.7735, J=0.3622, MCC=0.2857, ConfusionMatrix=
[[1670  489]
 [ 153  219]]
Epoch 3 complete in 143.42

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5387, Acc=0.7304, AUC=0.8061, TPR=0.7330, TNR=0.7278, J=0.4609, MCC=0.4608, ConfusionMatrix=
[[2674 1000]
 [ 968 2658]]
Epoch 4, Phase val, Loss=0.8188, Acc=0.5429, AUC=0.7532, TPR=0.8247, TNR=0.4926, J=0.3174, MCC=0.2290, ConfusionMatrix=
[[1071 1103]
 [  68  320]]
Epoch 4, Phase test, Loss=0.8644, Acc=0.5148, AUC=0.7464, TPR=0.8495, TNR=0.4572, J=0.3066, MCC=0.2206, ConfusionMatrix=
[[ 987 1172]
 [  56  316]]
Epoch 4 complete in 141.06

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5376, Acc=0.7275, AUC=0.8058, TPR=0.7294, TNR=0.7257, J=0.4551, MCC=0.4551, ConfusionMatrix=
[[2640  998]
 [ 991 2671]]
Epoch 5, Phase val, Loss=0.5058, Acc=0.7635, AUC=0.7542, TPR=0.5619, TNR=0.7994, J=0.3613, MCC=0.2971, ConfusionMatrix=
[[1738  436]
 [ 170  218]]
Epoch 5, Phase test, Loss=0.5200, Acc=0.7456, AUC=0.7494, TPR=0.5968, TNR=0.7712, J=0.3680, MCC=0.2893, ConfusionMatrix=
[[1665  494]
 [ 150  222]]
Epoch 5 complete in 131.72

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5478, Acc=0.7236, AUC=0.7976, TPR=0.7297, TNR=0.7173, J=0.4470, MCC=0.4470, ConfusionMatrix=
[[2590 1021]
 [ 997 2692]]
Epoch 6, Phase val, Loss=0.4854, Acc=0.7787, AUC=0.7432, TPR=0.5000, TNR=0.8284, J=0.3284, MCC=0.2836, ConfusionMatrix=
[[1801  373]
 [ 194  194]]
Epoch 6, Phase test, Loss=0.5010, Acc=0.7637, AUC=0.7433, TPR=0.5645, TNR=0.7981, J=0.3626, MCC=0.2945, ConfusionMatrix=
[[1723  436]
 [ 162  210]]
Epoch 6 complete in 133.08

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5396, Acc=0.7263, AUC=0.8040, TPR=0.7359, TNR=0.7162, J=0.4521, MCC=0.4522, ConfusionMatrix=
[[2554 1012]
 [ 986 2748]]
Epoch 7, Phase val, Loss=0.5720, Acc=0.7248, AUC=0.7607, TPR=0.6985, TNR=0.7295, J=0.4280, MCC=0.3250, ConfusionMatrix=
[[1586  588]
 [ 117  271]]
New Best AUC=0.7607. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5965, Acc=0.6831, AUC=0.7521, TPR=0.6747, TNR=0.6846, J=0.3593, MCC=0.2638, ConfusionMatrix=
[[1478  681]
 [ 121  251]]
Epoch 7 complete in 165.46

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5337, Acc=0.7341, AUC=0.8104, TPR=0.7310, TNR=0.7372, J=0.4682, MCC=0.4682, ConfusionMatrix=
[[2690  959]
 [ 982 2669]]
Epoch 8, Phase val, Loss=0.5432, Acc=0.7326, AUC=0.7551, TPR=0.6237, TNR=0.7521, J=0.3758, MCC=0.2926, ConfusionMatrix=
[[1635  539]
 [ 146  242]]
Epoch 8, Phase test, Loss=0.5605, Acc=0.7136, AUC=0.7439, TPR=0.6263, TNR=0.7286, J=0.3549, MCC=0.2686, ConfusionMatrix=
[[1573  586]
 [ 139  233]]
Epoch 8 complete in 128.73

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5390, Acc=0.7312, AUC=0.8046, TPR=0.7423, TNR=0.7200, J=0.4623, MCC=0.4624, ConfusionMatrix=
[[2607 1014]
 [ 948 2731]]
Epoch 9, Phase val, Loss=0.4611, Acc=0.7959, AUC=0.7547, TPR=0.4768, TNR=0.8528, J=0.3296, MCC=0.2970, ConfusionMatrix=
[[1854  320]
 [ 203  185]]
Epoch 9, Phase test, Loss=0.4713, Acc=0.7776, AUC=0.7412, TPR=0.5108, TNR=0.8235, J=0.3343, MCC=0.2832, ConfusionMatrix=
[[1778  381]
 [ 182  190]]
Epoch 9 complete in 139.44

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5351, Acc=0.7293, AUC=0.8082, TPR=0.7201, TNR=0.7380, J=0.4582, MCC=0.4582, ConfusionMatrix=
[[2761  980]
 [ 996 2563]]
Epoch 10, Phase val, Loss=0.4626, Acc=0.7947, AUC=0.7550, TPR=0.4845, TNR=0.8500, J=0.3346, MCC=0.2995, ConfusionMatrix=
[[1848  326]
 [ 200  188]]
Epoch 10, Phase test, Loss=0.4693, Acc=0.7874, AUC=0.7447, TPR=0.5134, TNR=0.8346, J=0.3481, MCC=0.2992, ConfusionMatrix=
[[1802  357]
 [ 181  191]]
Epoch 10 complete in 120.72

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5368, Acc=0.7349, AUC=0.8076, TPR=0.7441, TNR=0.7256, J=0.4697, MCC=0.4698, ConfusionMatrix=
[[2620  991]
 [ 944 2745]]
Epoch 11, Phase val, Loss=0.4904, Acc=0.7752, AUC=0.7495, TPR=0.5232, TNR=0.8201, J=0.3433, MCC=0.2917, ConfusionMatrix=
[[1783  391]
 [ 185  203]]
Epoch 11, Phase test, Loss=0.5009, Acc=0.7523, AUC=0.7436, TPR=0.5403, TNR=0.7888, J=0.3291, MCC=0.2658, ConfusionMatrix=
[[1703  456]
 [ 171  201]]
Epoch 11 complete in 124.18

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5445, Acc=0.7201, AUC=0.8010, TPR=0.7088, TNR=0.7312, J=0.4400, MCC=0.4401, ConfusionMatrix=
[[2706  995]
 [1048 2551]]
Epoch 12, Phase val, Loss=0.7264, Acc=0.6261, AUC=0.7504, TPR=0.7680, TNR=0.6007, J=0.3688, MCC=0.2655, ConfusionMatrix=
[[1306  868]
 [  90  298]]
Epoch 12, Phase test, Loss=0.7544, Acc=0.5934, AUC=0.7480, TPR=0.7688, TNR=0.5632, J=0.3320, MCC=0.2352, ConfusionMatrix=
[[1216  943]
 [  86  286]]
Epoch 12 complete in 149.35

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5435, Acc=0.7289, AUC=0.8024, TPR=0.7111, TNR=0.7456, J=0.4567, MCC=0.4570, ConfusionMatrix=
[[2808  958]
 [1021 2513]]
Epoch 13, Phase val, Loss=0.7140, Acc=0.6187, AUC=0.7543, TPR=0.7732, TNR=0.5911, J=0.3643, MCC=0.2618, ConfusionMatrix=
[[1285  889]
 [  88  300]]
Epoch 13, Phase test, Loss=0.7379, Acc=0.5958, AUC=0.7532, TPR=0.7876, TNR=0.5628, J=0.3504, MCC=0.2482, ConfusionMatrix=
[[1215  944]
 [  79  293]]
Epoch 13 complete in 125.53

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5266, Acc=0.7405, AUC=0.8156, TPR=0.7299, TNR=0.7506, J=0.4805, MCC=0.4805, ConfusionMatrix=
[[2823  938]
 [ 956 2583]]
Epoch 14, Phase val, Loss=0.5686, Acc=0.7209, AUC=0.7479, TPR=0.6572, TNR=0.7323, J=0.3895, MCC=0.2977, ConfusionMatrix=
[[1592  582]
 [ 133  255]]
Epoch 14, Phase test, Loss=0.5766, Acc=0.6938, AUC=0.7508, TPR=0.6398, TNR=0.7031, J=0.3429, MCC=0.2550, ConfusionMatrix=
[[1518  641]
 [ 134  238]]
Epoch 14 complete in 88.06

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5244, Acc=0.7418, AUC=0.8175, TPR=0.7425, TNR=0.7411, J=0.4836, MCC=0.4836, ConfusionMatrix=
[[2733  955]
 [ 930 2682]]
Epoch 15, Phase val, Loss=0.5142, Acc=0.7607, AUC=0.7500, TPR=0.5722, TNR=0.7944, J=0.3666, MCC=0.2992, ConfusionMatrix=
[[1727  447]
 [ 166  222]]
Epoch 15, Phase test, Loss=0.5138, Acc=0.7448, AUC=0.7530, TPR=0.5780, TNR=0.7735, J=0.3515, MCC=0.2777, ConfusionMatrix=
[[1670  489]
 [ 157  215]]
Epoch 15 complete in 65.16

Early Stop!
Training complete in 34m 25s
The best model val AUC=0.7606874591, test AUC=0.752112935598.
Finish training resnet50fixed-conv1x1-avgpool

Start training resnet50fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6158, Acc=0.6571, AUC=0.7186, TPR=0.7202, TNR=0.5923, J=0.3125, MCC=0.3153, ConfusionMatrix=
[[2133 1468]
 [1035 2664]]
Epoch 0, Phase val, Loss=0.4236, Acc=0.8138, AUC=0.7376, TPR=0.2603, TNR=0.9126, J=0.1729, MCC=0.1954, ConfusionMatrix=
[[1984  190]
 [ 287  101]]
New Best AUC=0.7376. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4343, Acc=0.8183, AUC=0.7285, TPR=0.3441, TNR=0.9000, J=0.2440, MCC=0.2521, ConfusionMatrix=
[[1943  216]
 [ 244  128]]
Epoch 0 complete in 95.88

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5700, Acc=0.7027, AUC=0.7736, TPR=0.6922, TNR=0.7128, J=0.4050, MCC=0.4051, ConfusionMatrix=
[[2661 1072]
 [1098 2469]]
Epoch 1, Phase val, Loss=0.4146, Acc=0.8181, AUC=0.7425, TPR=0.2603, TNR=0.9177, J=0.1780, MCC=0.2045, ConfusionMatrix=
[[1995  179]
 [ 287  101]]
New Best AUC=0.7425. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4215, Acc=0.8281, AUC=0.7326, TPR=0.3737, TNR=0.9064, J=0.2801, MCC=0.2905, ConfusionMatrix=
[[1957  202]
 [ 233  139]]
Epoch 1 complete in 93.08

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5486, Acc=0.7229, AUC=0.7967, TPR=0.7212, TNR=0.7246, J=0.4457, MCC=0.4457, ConfusionMatrix=
[[2662 1012]
 [1011 2615]]
Epoch 2, Phase val, Loss=0.4441, Acc=0.8009, AUC=0.7566, TPR=0.4407, TNR=0.8652, J=0.3059, MCC=0.2848, ConfusionMatrix=
[[1881  293]
 [ 217  171]]
New Best AUC=0.7566. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4540, Acc=0.7953, AUC=0.7505, TPR=0.5027, TNR=0.8458, J=0.3485, MCC=0.3054, ConfusionMatrix=
[[1826  333]
 [ 185  187]]
Epoch 2 complete in 56.28

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5485, Acc=0.7253, AUC=0.7971, TPR=0.7440, TNR=0.7056, J=0.4496, MCC=0.4500, ConfusionMatrix=
[[2505 1045]
 [ 960 2790]]
Epoch 3, Phase val, Loss=0.6061, Acc=0.6854, AUC=0.7497, TPR=0.7191, TNR=0.6794, J=0.3985, MCC=0.2941, ConfusionMatrix=
[[1477  697]
 [ 109  279]]
Epoch 3, Phase test, Loss=0.6325, Acc=0.6547, AUC=0.7470, TPR=0.7151, TNR=0.6443, J=0.3593, MCC=0.2588, ConfusionMatrix=
[[1391  768]
 [ 106  266]]
Epoch 3 complete in 91.89

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5415, Acc=0.7336, AUC=0.8038, TPR=0.7320, TNR=0.7351, J=0.4671, MCC=0.4671, ConfusionMatrix=
[[2714  978]
 [ 967 2641]]
Epoch 4, Phase val, Loss=0.4878, Acc=0.7748, AUC=0.7364, TPR=0.4948, TNR=0.8247, J=0.3196, MCC=0.2749, ConfusionMatrix=
[[1793  381]
 [ 196  192]]
Epoch 4, Phase test, Loss=0.4952, Acc=0.7614, AUC=0.7393, TPR=0.5242, TNR=0.8022, J=0.3264, MCC=0.2685, ConfusionMatrix=
[[1732  427]
 [ 177  195]]
Epoch 4 complete in 86.10

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5462, Acc=0.7316, AUC=0.8000, TPR=0.7268, TNR=0.7365, J=0.4633, MCC=0.4633, ConfusionMatrix=
[[2691  963]
 [ 996 2650]]
Epoch 5, Phase val, Loss=0.6056, Acc=0.6870, AUC=0.7511, TPR=0.7088, TNR=0.6831, J=0.3918, MCC=0.2899, ConfusionMatrix=
[[1485  689]
 [ 113  275]]
Epoch 5, Phase test, Loss=0.6266, Acc=0.6665, AUC=0.7466, TPR=0.7070, TNR=0.6596, J=0.3666, MCC=0.2656, ConfusionMatrix=
[[1424  735]
 [ 109  263]]
Epoch 5 complete in 58.07

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5408, Acc=0.7293, AUC=0.8033, TPR=0.7500, TNR=0.7081, J=0.4581, MCC=0.4586, ConfusionMatrix=
[[2552 1052]
 [ 924 2772]]
Epoch 6, Phase val, Loss=0.5253, Acc=0.7494, AUC=0.7484, TPR=0.5876, TNR=0.7783, J=0.3659, MCC=0.2931, ConfusionMatrix=
[[1692  482]
 [ 160  228]]
Epoch 6, Phase test, Loss=0.5358, Acc=0.7309, AUC=0.7489, TPR=0.6210, TNR=0.7499, J=0.3709, MCC=0.2853, ConfusionMatrix=
[[1619  540]
 [ 141  231]]
Epoch 6 complete in 93.40

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5327, Acc=0.7342, AUC=0.8097, TPR=0.7320, TNR=0.7365, J=0.4685, MCC=0.4685, ConfusionMatrix=
[[2697  965]
 [ 975 2663]]
Epoch 7, Phase val, Loss=0.4342, Acc=0.8126, AUC=0.7401, TPR=0.3814, TNR=0.8896, J=0.2710, MCC=0.2710, ConfusionMatrix=
[[1934  240]
 [ 240  148]]
Epoch 7, Phase test, Loss=0.4316, Acc=0.8123, AUC=0.7391, TPR=0.4382, TNR=0.8768, J=0.3150, MCC=0.2972, ConfusionMatrix=
[[1893  266]
 [ 209  163]]
Epoch 7 complete in 93.67

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5256, Acc=0.7421, AUC=0.8160, TPR=0.7479, TNR=0.7361, J=0.4840, MCC=0.4840, ConfusionMatrix=
[[2661  954]
 [ 929 2756]]
Epoch 8, Phase val, Loss=0.5880, Acc=0.7073, AUC=0.7511, TPR=0.6830, TNR=0.7116, J=0.3946, MCC=0.2969, ConfusionMatrix=
[[1547  627]
 [ 123  265]]
Epoch 8, Phase test, Loss=0.6072, Acc=0.6717, AUC=0.7473, TPR=0.6667, TNR=0.6725, J=0.3392, MCC=0.2478, ConfusionMatrix=
[[1452  707]
 [ 124  248]]
Epoch 8 complete in 56.02

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5273, Acc=0.7364, AUC=0.8152, TPR=0.7289, TNR=0.7437, J=0.4726, MCC=0.4727, ConfusionMatrix=
[[2765  953]
 [ 971 2611]]
Epoch 9, Phase val, Loss=0.5651, Acc=0.7279, AUC=0.7399, TPR=0.6314, TNR=0.7452, J=0.3766, MCC=0.2914, ConfusionMatrix=
[[1620  554]
 [ 143  245]]
Epoch 9, Phase test, Loss=0.5757, Acc=0.7029, AUC=0.7464, TPR=0.6452, TNR=0.7128, J=0.3580, MCC=0.2676, ConfusionMatrix=
[[1539  620]
 [ 132  240]]
Epoch 9 complete in 87.13

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5219, Acc=0.7437, AUC=0.8197, TPR=0.7508, TNR=0.7364, J=0.4872, MCC=0.4873, ConfusionMatrix=
[[2657  951]
 [ 920 2772]]
Epoch 10, Phase val, Loss=0.5834, Acc=0.7127, AUC=0.7405, TPR=0.6521, TNR=0.7236, J=0.3756, MCC=0.2856, ConfusionMatrix=
[[1573  601]
 [ 135  253]]
Epoch 10, Phase test, Loss=0.5979, Acc=0.6867, AUC=0.7457, TPR=0.6720, TNR=0.6892, J=0.3613, MCC=0.2659, ConfusionMatrix=
[[1488  671]
 [ 122  250]]
Epoch 10 complete in 85.41

Early Stop!
Training complete in 14m 57s
The best model val AUC=0.756568964046, test AUC=0.750498040212.
Finish training resnet50fixed-conv1x1-avgpool

Start training resnet50scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6216, Acc=0.6426, AUC=0.7023, TPR=0.5251, TNR=0.7563, J=0.2814, MCC=0.2895, ConfusionMatrix=
[[2806  904]
 [1705 1885]]
Epoch 0, Phase val, Loss=1.1259, Acc=0.5098, AUC=0.7250, TPR=0.8376, TNR=0.4512, J=0.2889, MCC=0.2107, ConfusionMatrix=
[[ 981 1193]
 [  63  325]]
New Best AUC=0.7250. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=1.1916, Acc=0.4793, AUC=0.7229, TPR=0.8118, TNR=0.4220, J=0.2338, MCC=0.1699, ConfusionMatrix=
[[ 911 1248]
 [  70  302]]
Epoch 0 complete in 128.12

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5746, Acc=0.6970, AUC=0.7674, TPR=0.5910, TNR=0.8010, J=0.3920, MCC=0.4013, ConfusionMatrix=
[[2951  733]
 [1479 2137]]
Epoch 1, Phase val, Loss=0.5874, Acc=0.7443, AUC=0.7769, TPR=0.6289, TNR=0.7649, J=0.3938, MCC=0.3097, ConfusionMatrix=
[[1663  511]
 [ 144  244]]
New Best AUC=0.7769. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5781, Acc=0.7479, AUC=0.7655, TPR=0.6505, TNR=0.7647, J=0.4152, MCC=0.3220, ConfusionMatrix=
[[1651  508]
 [ 130  242]]
Epoch 1 complete in 125.24

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5520, Acc=0.7211, AUC=0.7934, TPR=0.6470, TNR=0.7972, J=0.4442, MCC=0.4489, ConfusionMatrix=
[[2870  730]
 [1306 2394]]
Epoch 2, Phase val, Loss=0.4526, Acc=0.8380, AUC=0.7767, TPR=0.4201, TNR=0.9126, J=0.3327, MCC=0.3460, ConfusionMatrix=
[[1984  190]
 [ 225  163]]
Epoch 2, Phase test, Loss=0.4464, Acc=0.8534, AUC=0.7673, TPR=0.4409, TNR=0.9245, J=0.3654, MCC=0.3857, ConfusionMatrix=
[[1996  163]
 [ 208  164]]
Epoch 2 complete in 108.11

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5420, Acc=0.7312, AUC=0.8031, TPR=0.6634, TNR=0.8003, J=0.4637, MCC=0.4679, ConfusionMatrix=
[[2894  722]
 [1240 2444]]
Epoch 3, Phase val, Loss=0.5598, Acc=0.7600, AUC=0.7917, TPR=0.6778, TNR=0.7746, J=0.4524, MCC=0.3560, ConfusionMatrix=
[[1684  490]
 [ 125  263]]
New Best AUC=0.7917. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5640, Acc=0.7539, AUC=0.7680, TPR=0.6532, TNR=0.7712, J=0.4244, MCC=0.3308, ConfusionMatrix=
[[1665  494]
 [ 129  243]]
Epoch 3 complete in 99.17

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5285, Acc=0.7366, AUC=0.8128, TPR=0.6791, TNR=0.7952, J=0.4743, MCC=0.4772, ConfusionMatrix=
[[2874  740]
 [1183 2503]]
Epoch 4, Phase val, Loss=0.5540, Acc=0.7580, AUC=0.7757, TPR=0.6340, TNR=0.7801, J=0.4141, MCC=0.3297, ConfusionMatrix=
[[1696  478]
 [ 142  246]]
Epoch 4, Phase test, Loss=0.5756, Acc=0.7341, AUC=0.7459, TPR=0.5887, TNR=0.7591, J=0.3479, MCC=0.2709, ConfusionMatrix=
[[1639  520]
 [ 153  219]]
Epoch 4 complete in 108.81

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5333, Acc=0.7348, AUC=0.8038, TPR=0.6626, TNR=0.8046, J=0.4672, MCC=0.4725, ConfusionMatrix=
[[2986  725]
 [1211 2378]]
Epoch 5, Phase val, Loss=0.4450, Acc=0.8283, AUC=0.7833, TPR=0.5206, TNR=0.8832, J=0.4038, MCC=0.3784, ConfusionMatrix=
[[1920  254]
 [ 186  202]]
Epoch 5, Phase test, Loss=0.4453, Acc=0.8301, AUC=0.7575, TPR=0.4758, TNR=0.8912, J=0.3670, MCC=0.3520, ConfusionMatrix=
[[1924  235]
 [ 195  177]]
Epoch 5 complete in 128.42

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5097, Acc=0.7567, AUC=0.8270, TPR=0.6810, TNR=0.8300, J=0.5109, MCC=0.5173, ConfusionMatrix=
[[3080  631]
 [1145 2444]]
Epoch 6, Phase val, Loss=0.6491, Acc=0.6952, AUC=0.7840, TPR=0.7216, TNR=0.6904, J=0.4121, MCC=0.3056, ConfusionMatrix=
[[1501  673]
 [ 108  280]]
Epoch 6, Phase test, Loss=0.6765, Acc=0.6634, AUC=0.7609, TPR=0.7151, TNR=0.6545, J=0.3695, MCC=0.2671, ConfusionMatrix=
[[1413  746]
 [ 106  266]]
Epoch 6 complete in 116.26

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5064, Acc=0.7629, AUC=0.8292, TPR=0.7068, TNR=0.8177, J=0.5245, MCC=0.5281, ConfusionMatrix=
[[3019  673]
 [1058 2550]]
Epoch 7, Phase val, Loss=0.5608, Acc=0.7822, AUC=0.8036, TPR=0.6830, TNR=0.7999, J=0.4829, MCC=0.3885, ConfusionMatrix=
[[1739  435]
 [ 123  265]]
New Best AUC=0.8036. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5527, Acc=0.7783, AUC=0.7852, TPR=0.6425, TNR=0.8018, J=0.4442, MCC=0.3570, ConfusionMatrix=
[[1731  428]
 [ 133  239]]
Epoch 7 complete in 107.99

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4985, Acc=0.7641, AUC=0.8386, TPR=0.7266, TNR=0.8011, J=0.5278, MCC=0.5294, ConfusionMatrix=
[[2941  730]
 [ 992 2637]]
Epoch 8, Phase val, Loss=0.5293, Acc=0.8009, AUC=0.7955, TPR=0.6418, TNR=0.8293, J=0.4711, MCC=0.3943, ConfusionMatrix=
[[1803  371]
 [ 139  249]]
Epoch 8, Phase test, Loss=0.5273, Acc=0.7815, AUC=0.7728, TPR=0.6317, TNR=0.8073, J=0.4390, MCC=0.3557, ConfusionMatrix=
[[1743  416]
 [ 137  235]]
Epoch 8 complete in 106.52

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4958, Acc=0.7679, AUC=0.8386, TPR=0.7099, TNR=0.8248, J=0.5347, MCC=0.5386, ConfusionMatrix=
[[3042  646]
 [1048 2564]]
Epoch 9, Phase val, Loss=0.4842, Acc=0.8162, AUC=0.7998, TPR=0.6314, TNR=0.8491, J=0.4806, MCC=0.4134, ConfusionMatrix=
[[1846  328]
 [ 143  245]]
Epoch 9, Phase test, Loss=0.4969, Acc=0.8084, AUC=0.7758, TPR=0.5860, TNR=0.8467, J=0.4327, MCC=0.3718, ConfusionMatrix=
[[1828  331]
 [ 154  218]]
Epoch 9 complete in 110.00

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4872, Acc=0.7749, AUC=0.8472, TPR=0.7391, TNR=0.8109, J=0.5500, MCC=0.5514, ConfusionMatrix=
[[2955  689]
 [ 954 2702]]
Epoch 10, Phase val, Loss=0.5077, Acc=0.8154, AUC=0.7848, TPR=0.6186, TNR=0.8505, J=0.4691, MCC=0.4056, ConfusionMatrix=
[[1849  325]
 [ 148  240]]
Epoch 10, Phase test, Loss=0.5057, Acc=0.8072, AUC=0.7695, TPR=0.5968, TNR=0.8434, J=0.4402, MCC=0.3755, ConfusionMatrix=
[[1821  338]
 [ 150  222]]
Epoch 10 complete in 124.11

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4916, Acc=0.7749, AUC=0.8424, TPR=0.7318, TNR=0.8167, J=0.5486, MCC=0.5509, ConfusionMatrix=
[[3026  679]
 [ 964 2631]]
Epoch 11, Phase val, Loss=0.6022, Acc=0.7514, AUC=0.7871, TPR=0.6881, TNR=0.7626, J=0.4508, MCC=0.3508, ConfusionMatrix=
[[1658  516]
 [ 121  267]]
Epoch 11, Phase test, Loss=0.6316, Acc=0.7222, AUC=0.7679, TPR=0.6747, TNR=0.7304, J=0.4052, MCC=0.3053, ConfusionMatrix=
[[1577  582]
 [ 121  251]]
Epoch 11 complete in 121.36

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4772, Acc=0.7832, AUC=0.8538, TPR=0.7570, TNR=0.8089, J=0.5658, MCC=0.5667, ConfusionMatrix=
[[2979  704]
 [ 879 2738]]
Epoch 12, Phase val, Loss=0.6059, Acc=0.7287, AUC=0.7966, TPR=0.7268, TNR=0.7291, J=0.4559, MCC=0.3450, ConfusionMatrix=
[[1585  589]
 [ 106  282]]
Epoch 12, Phase test, Loss=0.6339, Acc=0.7092, AUC=0.7882, TPR=0.7473, TNR=0.7026, J=0.4500, MCC=0.3312, ConfusionMatrix=
[[1517  642]
 [  94  278]]
Epoch 12 complete in 106.15

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4654, Acc=0.7930, AUC=0.8599, TPR=0.7548, TNR=0.8322, J=0.5870, MCC=0.5884, ConfusionMatrix=
[[3000  605]
 [ 906 2789]]
Epoch 13, Phase val, Loss=0.6248, Acc=0.7440, AUC=0.8029, TPR=0.7294, TNR=0.7466, J=0.4759, MCC=0.3641, ConfusionMatrix=
[[1623  551]
 [ 105  283]]
Epoch 13, Phase test, Loss=0.6446, Acc=0.7388, AUC=0.7924, TPR=0.7231, TNR=0.7415, J=0.4647, MCC=0.3508, ConfusionMatrix=
[[1601  558]
 [ 103  269]]
Epoch 13 complete in 100.16

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4737, Acc=0.7801, AUC=0.8562, TPR=0.7525, TNR=0.8076, J=0.5601, MCC=0.5610, ConfusionMatrix=
[[2959  705]
 [ 900 2736]]
Epoch 14, Phase val, Loss=0.4946, Acc=0.7842, AUC=0.8091, TPR=0.6856, TNR=0.8017, J=0.4873, MCC=0.3926, ConfusionMatrix=
[[1743  431]
 [ 122  266]]
New Best AUC=0.8091. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 14, Phase test, Loss=0.5470, Acc=0.7321, AUC=0.7650, TPR=0.6694, TNR=0.7429, J=0.4123, MCC=0.3136, ConfusionMatrix=
[[1604  555]
 [ 123  249]]
Epoch 14 complete in 120.15

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4582, Acc=0.7948, AUC=0.8663, TPR=0.7579, TNR=0.8330, J=0.5909, MCC=0.5920, ConfusionMatrix=
[[2988  599]
 [ 899 2814]]
Epoch 15, Phase val, Loss=0.5908, Acc=0.7736, AUC=0.7926, TPR=0.7139, TNR=0.7843, J=0.4982, MCC=0.3931, ConfusionMatrix=
[[1705  469]
 [ 111  277]]
Epoch 15, Phase test, Loss=0.6244, Acc=0.7444, AUC=0.7799, TPR=0.6855, TNR=0.7545, J=0.4400, MCC=0.3368, ConfusionMatrix=
[[1629  530]
 [ 117  255]]
Epoch 15 complete in 124.97

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4652, Acc=0.7882, AUC=0.8611, TPR=0.7621, TNR=0.8144, J=0.5765, MCC=0.5773, ConfusionMatrix=
[[2967  676]
 [ 870 2787]]
Epoch 16, Phase val, Loss=0.5460, Acc=0.7592, AUC=0.8088, TPR=0.7216, TNR=0.7659, J=0.4875, MCC=0.3786, ConfusionMatrix=
[[1665  509]
 [ 108  280]]
Epoch 16, Phase test, Loss=0.6007, Acc=0.7167, AUC=0.7727, TPR=0.6855, TNR=0.7221, J=0.4076, MCC=0.3051, ConfusionMatrix=
[[1559  600]
 [ 117  255]]
Epoch 16 complete in 119.37

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4549, Acc=0.7907, AUC=0.8685, TPR=0.7673, TNR=0.8146, J=0.5819, MCC=0.5824, ConfusionMatrix=
[[2939  669]
 [ 859 2833]]
Epoch 17, Phase val, Loss=0.6560, Acc=0.7272, AUC=0.7914, TPR=0.7423, TNR=0.7245, J=0.4667, MCC=0.3517, ConfusionMatrix=
[[1575  599]
 [ 100  288]]
Epoch 17, Phase test, Loss=0.7163, Acc=0.6823, AUC=0.7761, TPR=0.7285, TNR=0.6744, J=0.4029, MCC=0.2932, ConfusionMatrix=
[[1456  703]
 [ 101  271]]
Epoch 17 complete in 105.97

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4471, Acc=0.7942, AUC=0.8735, TPR=0.7589, TNR=0.8283, J=0.5872, MCC=0.5890, ConfusionMatrix=
[[3078  638]
 [ 864 2720]]
Epoch 18, Phase val, Loss=0.5918, Acc=0.7857, AUC=0.8004, TPR=0.6907, TNR=0.8027, J=0.4934, MCC=0.3974, ConfusionMatrix=
[[1745  429]
 [ 120  268]]
Epoch 18, Phase test, Loss=0.5895, Acc=0.7815, AUC=0.7637, TPR=0.5995, TNR=0.8129, J=0.4123, MCC=0.3382, ConfusionMatrix=
[[1755  404]
 [ 149  223]]
Epoch 18 complete in 106.85

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4484, Acc=0.7938, AUC=0.8723, TPR=0.7725, TNR=0.8161, J=0.5886, MCC=0.5887, ConfusionMatrix=
[[2915  657]
 [ 848 2880]]
Epoch 19, Phase val, Loss=0.4787, Acc=0.8181, AUC=0.8175, TPR=0.6521, TNR=0.8477, J=0.4998, MCC=0.4271, ConfusionMatrix=
[[1843  331]
 [ 135  253]]
New Best AUC=0.8175. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 19, Phase test, Loss=0.5182, Acc=0.7985, AUC=0.7756, TPR=0.6075, TNR=0.8314, J=0.4389, MCC=0.3676, ConfusionMatrix=
[[1795  364]
 [ 146  226]]
Epoch 19 complete in 107.85

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4467, Acc=0.8025, AUC=0.8736, TPR=0.7881, TNR=0.8167, J=0.6048, MCC=0.6051, ConfusionMatrix=
[[2990  671]
 [ 771 2868]]
Epoch 20, Phase val, Loss=0.5582, Acc=0.7689, AUC=0.8074, TPR=0.6933, TNR=0.7824, J=0.4757, MCC=0.3760, ConfusionMatrix=
[[1701  473]
 [ 119  269]]
Epoch 20, Phase test, Loss=0.6081, Acc=0.7491, AUC=0.7699, TPR=0.6962, TNR=0.7582, J=0.4545, MCC=0.3484, ConfusionMatrix=
[[1637  522]
 [ 113  259]]
Epoch 20 complete in 125.16

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4340, Acc=0.8056, AUC=0.8824, TPR=0.7867, TNR=0.8245, J=0.6112, MCC=0.6117, ConfusionMatrix=
[[3011  641]
 [ 778 2870]]
Epoch 21, Phase val, Loss=0.4092, Acc=0.8407, AUC=0.7933, TPR=0.5309, TNR=0.8960, J=0.4270, MCC=0.4088, ConfusionMatrix=
[[1948  226]
 [ 182  206]]
Epoch 21, Phase test, Loss=0.4212, Acc=0.8459, AUC=0.7641, TPR=0.5081, TNR=0.9041, J=0.4122, MCC=0.4017, ConfusionMatrix=
[[1952  207]
 [ 183  189]]
Epoch 21 complete in 112.12

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4350, Acc=0.8019, AUC=0.8810, TPR=0.7869, TNR=0.8175, J=0.6044, MCC=0.6044, ConfusionMatrix=
[[2930  654]
 [ 792 2924]]
Epoch 22, Phase val, Loss=0.6132, Acc=0.7529, AUC=0.8075, TPR=0.7268, TNR=0.7576, J=0.4844, MCC=0.3736, ConfusionMatrix=
[[1647  527]
 [ 106  282]]
Epoch 22, Phase test, Loss=0.6331, Acc=0.7136, AUC=0.7829, TPR=0.6989, TNR=0.7161, J=0.4150, MCC=0.3091, ConfusionMatrix=
[[1546  613]
 [ 112  260]]
Epoch 22 complete in 110.86

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.4172, Acc=0.8182, AUC=0.8914, TPR=0.8071, TNR=0.8294, J=0.6365, MCC=0.6366, ConfusionMatrix=
[[3023  622]
 [ 705 2950]]
Epoch 23, Phase val, Loss=0.4533, Acc=0.8216, AUC=0.7931, TPR=0.6134, TNR=0.8588, J=0.4722, MCC=0.4136, ConfusionMatrix=
[[1867  307]
 [ 150  238]]
Epoch 23, Phase test, Loss=0.4752, Acc=0.8005, AUC=0.7628, TPR=0.5780, TNR=0.8388, J=0.4168, MCC=0.3548, ConfusionMatrix=
[[1811  348]
 [ 157  215]]
Epoch 23 complete in 101.73

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.4029, Acc=0.8264, AUC=0.8991, TPR=0.8243, TNR=0.8287, J=0.6530, MCC=0.6528, ConfusionMatrix=
[[2947  609]
 [ 658 3086]]
Epoch 24, Phase val, Loss=0.4958, Acc=0.8138, AUC=0.7926, TPR=0.6134, TNR=0.8496, J=0.4630, MCC=0.4003, ConfusionMatrix=
[[1847  327]
 [ 150  238]]
Epoch 24, Phase test, Loss=0.5230, Acc=0.7918, AUC=0.7639, TPR=0.6156, TNR=0.8221, J=0.4377, MCC=0.3618, ConfusionMatrix=
[[1775  384]
 [ 143  229]]
Epoch 24 complete in 113.22

Epoch 25 starting with learning_rate: [0.005]
Epoch 25, Phase train, Loss=0.4082, Acc=0.8222, AUC=0.8966, TPR=0.8177, TNR=0.8267, J=0.6444, MCC=0.6444, ConfusionMatrix=
[[3006  630]
 [ 668 2996]]
Epoch 25, Phase val, Loss=0.6156, Acc=0.7440, AUC=0.8001, TPR=0.7216, TNR=0.7479, J=0.4696, MCC=0.3599, ConfusionMatrix=
[[1626  548]
 [ 108  280]]
Epoch 25, Phase test, Loss=0.6428, Acc=0.7234, AUC=0.7840, TPR=0.7258, TNR=0.7230, J=0.4488, MCC=0.3348, ConfusionMatrix=
[[1561  598]
 [ 102  270]]
Epoch 25 complete in 125.52

Epoch 26 starting with learning_rate: [0.005]
Epoch 26, Phase train, Loss=0.4115, Acc=0.8196, AUC=0.8946, TPR=0.8116, TNR=0.8278, J=0.6394, MCC=0.6394, ConfusionMatrix=
[[2981  620]
 [ 697 3002]]
Epoch 26, Phase val, Loss=0.4030, Acc=0.8450, AUC=0.7755, TPR=0.4794, TNR=0.9103, J=0.3897, MCC=0.3926, ConfusionMatrix=
[[1979  195]
 [ 202  186]]
Epoch 26, Phase test, Loss=0.4042, Acc=0.8317, AUC=0.7644, TPR=0.4624, TNR=0.8953, J=0.3577, MCC=0.3479, ConfusionMatrix=
[[1933  226]
 [ 200  172]]
Epoch 26 complete in 110.65

Epoch 27 starting with learning_rate: [0.005]
Epoch 27, Phase train, Loss=0.4242, Acc=0.8127, AUC=0.8877, TPR=0.7947, TNR=0.8304, J=0.6251, MCC=0.6256, ConfusionMatrix=
[[3061  625]
 [ 742 2872]]
Epoch 27, Phase val, Loss=0.5687, Acc=0.7256, AUC=0.7958, TPR=0.7371, TNR=0.7236, J=0.4607, MCC=0.3471, ConfusionMatrix=
[[1573  601]
 [ 102  286]]
Epoch 27, Phase test, Loss=0.6033, Acc=0.7112, AUC=0.7853, TPR=0.7285, TNR=0.7082, J=0.4367, MCC=0.3229, ConfusionMatrix=
[[1529  630]
 [ 101  271]]
Epoch 27 complete in 103.26

Early Stop!
Training complete in 52m 58s
The best model val AUC=0.817492815751, test AUC=0.775627904197.
Finish training resnet50scratch-conv1x1ab-maxpool

Start training resnet50scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6444, Acc=0.6119, AUC=0.6680, TPR=0.4855, TNR=0.7342, J=0.2197, MCC=0.2271, ConfusionMatrix=
[[2724  986]
 [1847 1743]]
Epoch 0, Phase val, Loss=0.7694, Acc=0.6585, AUC=0.7345, TPR=0.6701, TNR=0.6564, J=0.3265, MCC=0.2396, ConfusionMatrix=
[[1427  747]
 [ 128  260]]
New Best AUC=0.7345. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.8024, Acc=0.6385, AUC=0.7113, TPR=0.6640, TNR=0.6341, J=0.2981, MCC=0.2146, ConfusionMatrix=
[[1369  790]
 [ 125  247]]
Epoch 0 complete in 106.70

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5761, Acc=0.6874, AUC=0.7555, TPR=0.5553, TNR=0.8211, J=0.3764, MCC=0.3902, ConfusionMatrix=
[[2979  649]
 [1633 2039]]
Epoch 1, Phase val, Loss=0.6152, Acc=0.7678, AUC=0.7660, TPR=0.5593, TNR=0.8050, J=0.3642, MCC=0.3015, ConfusionMatrix=
[[1750  424]
 [ 171  217]]
New Best AUC=0.7660. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6069, Acc=0.7764, AUC=0.7505, TPR=0.5780, TNR=0.8106, J=0.3885, MCC=0.3192, ConfusionMatrix=
[[1750  409]
 [ 157  215]]
Epoch 1 complete in 111.07

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5620, Acc=0.7084, AUC=0.7811, TPR=0.6186, TNR=0.8002, J=0.4188, MCC=0.4255, ConfusionMatrix=
[[2887  721]
 [1408 2284]]
Epoch 2, Phase val, Loss=0.5781, Acc=0.7447, AUC=0.7598, TPR=0.6005, TNR=0.7705, J=0.3710, MCC=0.2944, ConfusionMatrix=
[[1675  499]
 [ 155  233]]
Epoch 2, Phase test, Loss=0.5698, Acc=0.7467, AUC=0.7477, TPR=0.5995, TNR=0.7721, J=0.3716, MCC=0.2922, ConfusionMatrix=
[[1667  492]
 [ 149  223]]
Epoch 2 complete in 111.82

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5463, Acc=0.7207, AUC=0.7979, TPR=0.6529, TNR=0.7884, J=0.4413, MCC=0.4454, ConfusionMatrix=
[[2880  773]
 [1266 2381]]
Epoch 3, Phase val, Loss=0.8476, Acc=0.6319, AUC=0.7740, TPR=0.7887, TNR=0.6040, J=0.3926, MCC=0.2826, ConfusionMatrix=
[[1313  861]
 [  82  306]]
New Best AUC=0.7740. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.8625, Acc=0.5982, AUC=0.7592, TPR=0.7742, TNR=0.5679, J=0.3420, MCC=0.2424, ConfusionMatrix=
[[1226  933]
 [  84  288]]
Epoch 3 complete in 111.55

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5295, Acc=0.7407, AUC=0.8144, TPR=0.6936, TNR=0.7883, J=0.4819, MCC=0.4840, ConfusionMatrix=
[[2860  768]
 [1125 2547]]
Epoch 4, Phase val, Loss=0.6440, Acc=0.7264, AUC=0.7643, TPR=0.6314, TNR=0.7433, J=0.3748, MCC=0.2896, ConfusionMatrix=
[[1616  558]
 [ 143  245]]
Epoch 4, Phase test, Loss=0.6300, Acc=0.7278, AUC=0.7537, TPR=0.6559, TNR=0.7402, J=0.3961, MCC=0.3011, ConfusionMatrix=
[[1598  561]
 [ 128  244]]
Epoch 4 complete in 101.52

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5215, Acc=0.7452, AUC=0.8209, TPR=0.6921, TNR=0.7975, J=0.4896, MCC=0.4925, ConfusionMatrix=
[[2934  745]
 [1115 2506]]
Epoch 5, Phase val, Loss=0.6183, Acc=0.7283, AUC=0.7827, TPR=0.6753, TNR=0.7378, J=0.4131, MCC=0.3162, ConfusionMatrix=
[[1604  570]
 [ 126  262]]
New Best AUC=0.7827. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.6289, Acc=0.7187, AUC=0.7714, TPR=0.6855, TNR=0.7244, J=0.4099, MCC=0.3073, ConfusionMatrix=
[[1564  595]
 [ 117  255]]
Epoch 5 complete in 106.74

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5369, Acc=0.7340, AUC=0.8065, TPR=0.6791, TNR=0.7878, J=0.4669, MCC=0.4699, ConfusionMatrix=
[[2903  782]
 [1160 2455]]
Epoch 6, Phase val, Loss=0.5639, Acc=0.7748, AUC=0.7915, TPR=0.6031, TNR=0.8054, J=0.4085, MCC=0.3354, ConfusionMatrix=
[[1751  423]
 [ 154  234]]
New Best AUC=0.7915. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5612, Acc=0.7803, AUC=0.7671, TPR=0.5914, TNR=0.8129, J=0.4043, MCC=0.3321, ConfusionMatrix=
[[1755  404]
 [ 152  220]]
Epoch 6 complete in 125.87

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5150, Acc=0.7449, AUC=0.8235, TPR=0.7001, TNR=0.7896, J=0.4896, MCC=0.4917, ConfusionMatrix=
[[2889  770]
 [1092 2549]]
Epoch 7, Phase val, Loss=0.4674, Acc=0.7970, AUC=0.7744, TPR=0.5567, TNR=0.8399, J=0.3966, MCC=0.3432, ConfusionMatrix=
[[1826  348]
 [ 172  216]]
Epoch 7, Phase test, Loss=0.4528, Acc=0.8139, AUC=0.7639, TPR=0.5591, TNR=0.8578, J=0.4169, MCC=0.3667, ConfusionMatrix=
[[1852  307]
 [ 164  208]]
Epoch 7 complete in 99.68

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5054, Acc=0.7573, AUC=0.8304, TPR=0.7182, TNR=0.7963, J=0.5146, MCC=0.5161, ConfusionMatrix=
[[2905  743]
 [1029 2623]]
Epoch 8, Phase val, Loss=0.5389, Acc=0.7611, AUC=0.7771, TPR=0.6392, TNR=0.7829, J=0.4221, MCC=0.3366, ConfusionMatrix=
[[1702  472]
 [ 140  248]]
Epoch 8, Phase test, Loss=0.5148, Acc=0.7693, AUC=0.7628, TPR=0.6237, TNR=0.7943, J=0.4180, MCC=0.3345, ConfusionMatrix=
[[1715  444]
 [ 140  232]]
Epoch 8 complete in 103.13

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4925, Acc=0.7696, AUC=0.8405, TPR=0.7336, TNR=0.8058, J=0.5394, MCC=0.5407, ConfusionMatrix=
[[2933  707]
 [ 975 2685]]
Epoch 9, Phase val, Loss=0.4721, Acc=0.8033, AUC=0.7897, TPR=0.5722, TNR=0.8445, J=0.4167, MCC=0.3614, ConfusionMatrix=
[[1836  338]
 [ 166  222]]
Epoch 9, Phase test, Loss=0.4671, Acc=0.8159, AUC=0.7688, TPR=0.5914, TNR=0.8546, J=0.4460, MCC=0.3870, ConfusionMatrix=
[[1845  314]
 [ 152  220]]
Epoch 9 complete in 108.07

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4940, Acc=0.7722, AUC=0.8407, TPR=0.7344, TNR=0.8101, J=0.5445, MCC=0.5460, ConfusionMatrix=
[[2952  692]
 [ 971 2685]]
Epoch 10, Phase val, Loss=0.6224, Acc=0.7346, AUC=0.7936, TPR=0.7088, TNR=0.7392, J=0.4480, MCC=0.3419, ConfusionMatrix=
[[1607  567]
 [ 113  275]]
New Best AUC=0.7936. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.6322, Acc=0.7222, AUC=0.7816, TPR=0.6989, TNR=0.7263, J=0.4252, MCC=0.3187, ConfusionMatrix=
[[1568  591]
 [ 112  260]]
Epoch 10 complete in 108.21

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4808, Acc=0.7792, AUC=0.8489, TPR=0.7380, TNR=0.8183, J=0.5563, MCC=0.5586, ConfusionMatrix=
[[3063  680]
 [ 932 2625]]
Epoch 11, Phase val, Loss=0.5501, Acc=0.7603, AUC=0.7811, TPR=0.6624, TNR=0.7778, J=0.4402, MCC=0.3482, ConfusionMatrix=
[[1691  483]
 [ 131  257]]
Epoch 11, Phase test, Loss=0.5403, Acc=0.7614, AUC=0.7668, TPR=0.6156, TNR=0.7865, J=0.4021, MCC=0.3197, ConfusionMatrix=
[[1698  461]
 [ 143  229]]
Epoch 11 complete in 104.85

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4670, Acc=0.7888, AUC=0.8599, TPR=0.7537, TNR=0.8238, J=0.5775, MCC=0.5789, ConfusionMatrix=
[[3010  644]
 [ 898 2748]]
Epoch 12, Phase val, Loss=0.6592, Acc=0.7158, AUC=0.8018, TPR=0.7603, TNR=0.7079, J=0.4682, MCC=0.3491, ConfusionMatrix=
[[1539  635]
 [  93  295]]
New Best AUC=0.8018. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 12, Phase test, Loss=0.6539, Acc=0.6914, AUC=0.7749, TPR=0.7043, TNR=0.6892, J=0.3935, MCC=0.2888, ConfusionMatrix=
[[1488  671]
 [ 110  262]]
Epoch 12 complete in 100.83

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4737, Acc=0.7819, AUC=0.8547, TPR=0.7459, TNR=0.8178, J=0.5636, MCC=0.5652, ConfusionMatrix=
[[2993  667]
 [ 925 2715]]
Epoch 13, Phase val, Loss=0.4760, Acc=0.7920, AUC=0.7964, TPR=0.6108, TNR=0.8243, J=0.4351, MCC=0.3644, ConfusionMatrix=
[[1792  382]
 [ 151  237]]
Epoch 13, Phase test, Loss=0.4885, Acc=0.7835, AUC=0.7718, TPR=0.5995, TNR=0.8152, J=0.4147, MCC=0.3410, ConfusionMatrix=
[[1760  399]
 [ 149  223]]
Epoch 13 complete in 107.89

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4614, Acc=0.7915, AUC=0.8632, TPR=0.7584, TNR=0.8241, J=0.5825, MCC=0.5839, ConfusionMatrix=
[[3031  647]
 [ 875 2747]]
Epoch 14, Phase val, Loss=0.4713, Acc=0.8107, AUC=0.7822, TPR=0.5722, TNR=0.8533, J=0.4254, MCC=0.3737, ConfusionMatrix=
[[1855  319]
 [ 166  222]]
Epoch 14, Phase test, Loss=0.4685, Acc=0.8135, AUC=0.7630, TPR=0.5914, TNR=0.8518, J=0.4432, MCC=0.3830, ConfusionMatrix=
[[1839  320]
 [ 152  220]]
Epoch 14 complete in 112.24

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4572, Acc=0.7978, AUC=0.8655, TPR=0.7730, TNR=0.8222, J=0.5952, MCC=0.5960, ConfusionMatrix=
[[3029  655]
 [ 821 2795]]
Epoch 15, Phase val, Loss=0.6248, Acc=0.7518, AUC=0.7977, TPR=0.6959, TNR=0.7617, J=0.4576, MCC=0.3555, ConfusionMatrix=
[[1656  518]
 [ 118  270]]
Epoch 15, Phase test, Loss=0.6779, Acc=0.7136, AUC=0.7665, TPR=0.6720, TNR=0.7207, J=0.3927, MCC=0.2942, ConfusionMatrix=
[[1556  603]
 [ 122  250]]
Epoch 15 complete in 105.45

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4439, Acc=0.8066, AUC=0.8738, TPR=0.7877, TNR=0.8257, J=0.6135, MCC=0.6138, ConfusionMatrix=
[[2990  631]
 [ 781 2898]]
Epoch 16, Phase val, Loss=0.4720, Acc=0.8072, AUC=0.7787, TPR=0.5979, TNR=0.8445, J=0.4425, MCC=0.3814, ConfusionMatrix=
[[1836  338]
 [ 156  232]]
Epoch 16, Phase test, Loss=0.4568, Acc=0.8151, AUC=0.7773, TPR=0.5833, TNR=0.8550, J=0.4384, MCC=0.3815, ConfusionMatrix=
[[1846  313]
 [ 155  217]]
Epoch 16 complete in 89.11

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4495, Acc=0.8001, AUC=0.8711, TPR=0.7841, TNR=0.8166, J=0.6007, MCC=0.6008, ConfusionMatrix=
[[2943  661]
 [ 798 2898]]
Epoch 17, Phase val, Loss=0.5631, Acc=0.7744, AUC=0.7946, TPR=0.6856, TNR=0.7902, J=0.4758, MCC=0.3791, ConfusionMatrix=
[[1718  456]
 [ 122  266]]
Epoch 17, Phase test, Loss=0.5928, Acc=0.7645, AUC=0.7605, TPR=0.6398, TNR=0.7860, J=0.4258, MCC=0.3371, ConfusionMatrix=
[[1697  462]
 [ 134  238]]
Epoch 17 complete in 88.73

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4441, Acc=0.8060, AUC=0.8748, TPR=0.7866, TNR=0.8261, J=0.6127, MCC=0.6129, ConfusionMatrix=
[[2969  625]
 [ 791 2915]]
Epoch 18, Phase val, Loss=0.4323, Acc=0.8169, AUC=0.7785, TPR=0.5644, TNR=0.8620, J=0.4264, MCC=0.3804, ConfusionMatrix=
[[1874  300]
 [ 169  219]]
Epoch 18, Phase test, Loss=0.4508, Acc=0.8048, AUC=0.7546, TPR=0.5376, TNR=0.8509, J=0.3885, MCC=0.3400, ConfusionMatrix=
[[1837  322]
 [ 172  200]]
Epoch 18 complete in 88.68

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4394, Acc=0.8051, AUC=0.8771, TPR=0.7836, TNR=0.8263, J=0.6099, MCC=0.6106, ConfusionMatrix=
[[3030  637]
 [ 786 2847]]
Epoch 19, Phase val, Loss=0.4545, Acc=0.8150, AUC=0.7975, TPR=0.6082, TNR=0.8519, J=0.4601, MCC=0.3996, ConfusionMatrix=
[[1852  322]
 [ 152  236]]
Epoch 19, Phase test, Loss=0.4760, Acc=0.8028, AUC=0.7722, TPR=0.5995, TNR=0.8379, J=0.4374, MCC=0.3700, ConfusionMatrix=
[[1809  350]
 [ 149  223]]
Epoch 19 complete in 89.66

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4267, Acc=0.8149, AUC=0.8863, TPR=0.7939, TNR=0.8359, J=0.6299, MCC=0.6304, ConfusionMatrix=
[[3052  599]
 [ 752 2897]]
Epoch 20, Phase val, Loss=0.5748, Acc=0.7842, AUC=0.7962, TPR=0.6907, TNR=0.8008, J=0.4915, MCC=0.3953, ConfusionMatrix=
[[1741  433]
 [ 120  268]]
Epoch 20, Phase test, Loss=0.5954, Acc=0.7768, AUC=0.7770, TPR=0.6747, TNR=0.7943, J=0.4691, MCC=0.3721, ConfusionMatrix=
[[1715  444]
 [ 121  251]]
Epoch 20 complete in 89.05

Early Stop!
Training complete in 36m 11s
The best model val AUC=0.801761563558, test AUC=0.774920687096.
Finish training resnet50scratch-conv1x1ab-maxpool

Start training resnet50scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6270, Acc=0.6452, AUC=0.7066, TPR=0.5359, TNR=0.7552, J=0.2911, MCC=0.2983, ConfusionMatrix=
[[2748  891]
 [1699 1962]]
Epoch 0, Phase val, Loss=0.7504, Acc=0.7096, AUC=0.7422, TPR=0.6263, TNR=0.7245, J=0.3508, MCC=0.2677, ConfusionMatrix=
[[1575  599]
 [ 145  243]]
New Best AUC=0.7422. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7585, Acc=0.6970, AUC=0.7242, TPR=0.6183, TNR=0.7105, J=0.3288, MCC=0.2462, ConfusionMatrix=
[[1534  625]
 [ 142  230]]
Epoch 0 complete in 90.65

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5755, Acc=0.7015, AUC=0.7674, TPR=0.5686, TNR=0.8327, J=0.4012, MCC=0.4163, ConfusionMatrix=
[[3060  615]
 [1564 2061]]
Epoch 1, Phase val, Loss=0.6218, Acc=0.7721, AUC=0.7617, TPR=0.5567, TNR=0.8105, J=0.3672, MCC=0.3060, ConfusionMatrix=
[[1762  412]
 [ 172  216]]
New Best AUC=0.7617. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6234, Acc=0.7748, AUC=0.7421, TPR=0.5914, TNR=0.8064, J=0.3978, MCC=0.3244, ConfusionMatrix=
[[1741  418]
 [ 152  220]]
Epoch 1 complete in 90.88

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5617, Acc=0.7118, AUC=0.7827, TPR=0.6256, TNR=0.8023, J=0.4279, MCC=0.4338, ConfusionMatrix=
[[2857  704]
 [1400 2339]]
Epoch 2, Phase val, Loss=0.5620, Acc=0.7799, AUC=0.7683, TPR=0.5722, TNR=0.8169, J=0.3891, MCC=0.3257, ConfusionMatrix=
[[1776  398]
 [ 166  222]]
New Best AUC=0.7683. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5454, Acc=0.7926, AUC=0.7382, TPR=0.5376, TNR=0.8365, J=0.3741, MCC=0.3206, ConfusionMatrix=
[[1806  353]
 [ 172  200]]
Epoch 2 complete in 90.76

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5430, Acc=0.7253, AUC=0.7999, TPR=0.6312, TNR=0.8185, J=0.4497, MCC=0.4580, ConfusionMatrix=
[[3003  666]
 [1339 2292]]
Epoch 3, Phase val, Loss=0.5170, Acc=0.7900, AUC=0.7822, TPR=0.5747, TNR=0.8284, J=0.4032, MCC=0.3421, ConfusionMatrix=
[[1801  373]
 [ 165  223]]
New Best AUC=0.7822. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5055, Acc=0.8009, AUC=0.7494, TPR=0.5565, TNR=0.8430, J=0.3994, MCC=0.3438, ConfusionMatrix=
[[1820  339]
 [ 165  207]]
Epoch 3 complete in 89.66

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5323, Acc=0.7344, AUC=0.8110, TPR=0.6706, TNR=0.7993, J=0.4699, MCC=0.4736, ConfusionMatrix=
[[2891  726]
 [1213 2470]]
Epoch 4, Phase val, Loss=0.6047, Acc=0.7767, AUC=0.7775, TPR=0.6082, TNR=0.8068, J=0.4151, MCC=0.3409, ConfusionMatrix=
[[1754  420]
 [ 152  236]]
Epoch 4, Phase test, Loss=0.6187, Acc=0.7756, AUC=0.7608, TPR=0.5726, TNR=0.8106, J=0.3831, MCC=0.3151, ConfusionMatrix=
[[1750  409]
 [ 159  213]]
Epoch 4 complete in 89.98

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5167, Acc=0.7475, AUC=0.8214, TPR=0.7167, TNR=0.7808, J=0.4975, MCC=0.4976, ConfusionMatrix=
[[2742  770]
 [1073 2715]]
Epoch 5, Phase val, Loss=0.5291, Acc=0.7713, AUC=0.7970, TPR=0.6340, TNR=0.7958, J=0.4298, MCC=0.3473, ConfusionMatrix=
[[1730  444]
 [ 142  246]]
New Best AUC=0.7970. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5277, Acc=0.7780, AUC=0.7724, TPR=0.6237, TNR=0.8045, J=0.4282, MCC=0.3464, ConfusionMatrix=
[[1737  422]
 [ 140  232]]
Epoch 5 complete in 89.89

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5069, Acc=0.7592, AUC=0.8301, TPR=0.6986, TNR=0.8178, J=0.5164, MCC=0.5206, ConfusionMatrix=
[[3034  676]
 [1082 2508]]
Epoch 6, Phase val, Loss=0.5811, Acc=0.7806, AUC=0.7836, TPR=0.6160, TNR=0.8100, J=0.4260, MCC=0.3506, ConfusionMatrix=
[[1761  413]
 [ 149  239]]
Epoch 6, Phase test, Loss=0.5930, Acc=0.7752, AUC=0.7609, TPR=0.6344, TNR=0.7994, J=0.4339, MCC=0.3484, ConfusionMatrix=
[[1726  433]
 [ 136  236]]
Epoch 6 complete in 88.61

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5062, Acc=0.7649, AUC=0.8328, TPR=0.7237, TNR=0.8057, J=0.5294, MCC=0.5313, ConfusionMatrix=
[[2957  713]
 [1003 2627]]
Epoch 7, Phase val, Loss=0.4901, Acc=0.7904, AUC=0.7811, TPR=0.5825, TNR=0.8275, J=0.4100, MCC=0.3468, ConfusionMatrix=
[[1799  375]
 [ 162  226]]
Epoch 7, Phase test, Loss=0.4870, Acc=0.7977, AUC=0.7707, TPR=0.5833, TNR=0.8346, J=0.4180, MCC=0.3534, ConfusionMatrix=
[[1802  357]
 [ 155  217]]
Epoch 7 complete in 89.10

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5107, Acc=0.7607, AUC=0.8270, TPR=0.7118, TNR=0.8090, J=0.5208, MCC=0.5234, ConfusionMatrix=
[[2970  701]
 [1046 2583]]
Epoch 8, Phase val, Loss=0.4732, Acc=0.8208, AUC=0.7872, TPR=0.5670, TNR=0.8661, J=0.4332, MCC=0.3886, ConfusionMatrix=
[[1883  291]
 [ 168  220]]
Epoch 8, Phase test, Loss=0.4779, Acc=0.8190, AUC=0.7737, TPR=0.5645, TNR=0.8629, J=0.4274, MCC=0.3784, ConfusionMatrix=
[[1863  296]
 [ 162  210]]
Epoch 8 complete in 88.56

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4837, Acc=0.7733, AUC=0.8476, TPR=0.7464, TNR=0.8002, J=0.5465, MCC=0.5473, ConfusionMatrix=
[[2923  730]
 [ 925 2722]]
Epoch 9, Phase val, Loss=0.4213, Acc=0.8255, AUC=0.7990, TPR=0.5361, TNR=0.8772, J=0.4133, MCC=0.3812, ConfusionMatrix=
[[1907  267]
 [ 180  208]]
New Best AUC=0.7990. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.4188, Acc=0.8333, AUC=0.7821, TPR=0.5161, TNR=0.8879, J=0.4040, MCC=0.3796, ConfusionMatrix=
[[1917  242]
 [ 180  192]]
Epoch 9 complete in 89.83

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4913, Acc=0.7795, AUC=0.8426, TPR=0.7431, TNR=0.8169, J=0.5600, MCC=0.5612, ConfusionMatrix=
[[2936  658]
 [ 952 2754]]
Epoch 10, Phase val, Loss=0.5964, Acc=0.7607, AUC=0.8054, TPR=0.6830, TNR=0.7746, J=0.4576, MCC=0.3598, ConfusionMatrix=
[[1684  490]
 [ 123  265]]
New Best AUC=0.8054. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.6146, Acc=0.7499, AUC=0.7842, TPR=0.6909, TNR=0.7601, J=0.4509, MCC=0.3464, ConfusionMatrix=
[[1641  518]
 [ 115  257]]
Epoch 10 complete in 90.99

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4762, Acc=0.7830, AUC=0.8522, TPR=0.7501, TNR=0.8164, J=0.5664, MCC=0.5676, ConfusionMatrix=
[[2961  666]
 [ 918 2755]]
Epoch 11, Phase val, Loss=0.4994, Acc=0.8041, AUC=0.7961, TPR=0.6392, TNR=0.8335, J=0.4727, MCC=0.3978, ConfusionMatrix=
[[1812  362]
 [ 140  248]]
Epoch 11, Phase test, Loss=0.5165, Acc=0.7870, AUC=0.7703, TPR=0.6183, TNR=0.8161, J=0.4344, MCC=0.3563, ConfusionMatrix=
[[1762  397]
 [ 142  230]]
Epoch 11 complete in 88.97

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4803, Acc=0.7827, AUC=0.8495, TPR=0.7470, TNR=0.8184, J=0.5654, MCC=0.5668, ConfusionMatrix=
[[2992  664]
 [ 922 2722]]
Epoch 12, Phase val, Loss=0.5772, Acc=0.7740, AUC=0.7988, TPR=0.7113, TNR=0.7852, J=0.4965, MCC=0.3923, ConfusionMatrix=
[[1707  467]
 [ 112  276]]
Epoch 12, Phase test, Loss=0.5994, Acc=0.7361, AUC=0.7748, TPR=0.6694, TNR=0.7476, J=0.4169, MCC=0.3182, ConfusionMatrix=
[[1614  545]
 [ 123  249]]
Epoch 12 complete in 89.15

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4680, Acc=0.7923, AUC=0.8577, TPR=0.7605, TNR=0.8246, J=0.5851, MCC=0.5861, ConfusionMatrix=
[[2990  636]
 [ 880 2794]]
Epoch 13, Phase val, Loss=0.5328, Acc=0.7607, AUC=0.7854, TPR=0.6804, TNR=0.7751, J=0.4555, MCC=0.3584, ConfusionMatrix=
[[1685  489]
 [ 124  264]]
Epoch 13, Phase test, Loss=0.5278, Acc=0.7606, AUC=0.7830, TPR=0.6855, TNR=0.7735, J=0.4590, MCC=0.3567, ConfusionMatrix=
[[1670  489]
 [ 117  255]]
Epoch 13 complete in 88.80

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4645, Acc=0.7937, AUC=0.8596, TPR=0.7648, TNR=0.8225, J=0.5873, MCC=0.5883, ConfusionMatrix=
[[3008  649]
 [ 857 2786]]
Epoch 14, Phase val, Loss=0.4877, Acc=0.8087, AUC=0.7916, TPR=0.6160, TNR=0.8431, J=0.4591, MCC=0.3933, ConfusionMatrix=
[[1833  341]
 [ 149  239]]
Epoch 14, Phase test, Loss=0.4887, Acc=0.8021, AUC=0.7807, TPR=0.5968, TNR=0.8374, J=0.4342, MCC=0.3674, ConfusionMatrix=
[[1808  351]
 [ 150  222]]
Epoch 14 complete in 89.75

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4729, Acc=0.7840, AUC=0.8533, TPR=0.7430, TNR=0.8235, J=0.5665, MCC=0.5687, ConfusionMatrix=
[[3061  656]
 [ 921 2662]]
Epoch 15, Phase val, Loss=0.6372, Acc=0.7182, AUC=0.8014, TPR=0.7500, TNR=0.7125, J=0.4625, MCC=0.3459, ConfusionMatrix=
[[1549  625]
 [  97  291]]
Epoch 15, Phase test, Loss=0.6651, Acc=0.6958, AUC=0.7873, TPR=0.7500, TNR=0.6864, J=0.4364, MCC=0.3187, ConfusionMatrix=
[[1482  677]
 [  93  279]]
Epoch 15 complete in 89.38

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4479, Acc=0.8075, AUC=0.8709, TPR=0.7822, TNR=0.8317, J=0.6139, MCC=0.6150, ConfusionMatrix=
[[3108  629]
 [ 776 2787]]
Epoch 16, Phase val, Loss=0.4151, Acc=0.8177, AUC=0.7760, TPR=0.4794, TNR=0.8781, J=0.3575, MCC=0.3365, ConfusionMatrix=
[[1909  265]
 [ 202  186]]
Epoch 16, Phase test, Loss=0.4376, Acc=0.8107, AUC=0.7512, TPR=0.4839, TNR=0.8671, J=0.3509, MCC=0.3203, ConfusionMatrix=
[[1872  287]
 [ 192  180]]
Epoch 16 complete in 90.47

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4460, Acc=0.8064, AUC=0.8727, TPR=0.7982, TNR=0.8148, J=0.6130, MCC=0.6130, ConfusionMatrix=
[[2948  670]
 [ 743 2939]]
Epoch 17, Phase val, Loss=0.4495, Acc=0.8060, AUC=0.7752, TPR=0.5258, TNR=0.8560, J=0.3818, MCC=0.3410, ConfusionMatrix=
[[1861  313]
 [ 184  204]]
Epoch 17, Phase test, Loss=0.4492, Acc=0.8076, AUC=0.7814, TPR=0.5887, TNR=0.8453, J=0.4340, MCC=0.3719, ConfusionMatrix=
[[1825  334]
 [ 153  219]]
Epoch 17 complete in 86.89

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4525, Acc=0.8049, AUC=0.8702, TPR=0.7787, TNR=0.8316, J=0.6103, MCC=0.6110, ConfusionMatrix=
[[3012  610]
 [ 814 2864]]
Epoch 18, Phase val, Loss=0.4712, Acc=0.7955, AUC=0.7822, TPR=0.5876, TNR=0.8326, J=0.4202, MCC=0.3574, ConfusionMatrix=
[[1810  364]
 [ 160  228]]
Epoch 18, Phase test, Loss=0.4703, Acc=0.8009, AUC=0.7733, TPR=0.5887, TNR=0.8374, J=0.4261, MCC=0.3612, ConfusionMatrix=
[[1808  351]
 [ 153  219]]
Epoch 18 complete in 88.67

Early Stop!
Training complete in 28m 21s
The best model val AUC=0.805392217301, test AUC=0.78422034295.
Finish training resnet50scratch-conv1x1ab-maxpool

Start training resnet50scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6449, Acc=0.6155, AUC=0.6704, TPR=0.5538, TNR=0.6786, J=0.2324, MCC=0.2341, ConfusionMatrix=
[[2449 1160]
 [1647 2044]]
Epoch 0, Phase val, Loss=0.8640, Acc=0.5429, AUC=0.7404, TPR=0.7861, TNR=0.4995, J=0.2856, MCC=0.2056, ConfusionMatrix=
[[1086 1088]
 [  83  305]]
New Best AUC=0.7404. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.9115, Acc=0.5235, AUC=0.7248, TPR=0.7984, TNR=0.4761, J=0.2745, MCC=0.1960, ConfusionMatrix=
[[1028 1131]
 [  75  297]]
Epoch 0 complete in 88.56

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5732, Acc=0.6967, AUC=0.7654, TPR=0.6048, TNR=0.7922, J=0.3970, MCC=0.4035, ConfusionMatrix=
[[2836  744]
 [1470 2250]]
Epoch 1, Phase val, Loss=0.6927, Acc=0.6573, AUC=0.7575, TPR=0.6727, TNR=0.6546, J=0.3272, MCC=0.2400, ConfusionMatrix=
[[1423  751]
 [ 127  261]]
New Best AUC=0.7575. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6970, Acc=0.6582, AUC=0.7563, TPR=0.7151, TNR=0.6484, J=0.3635, MCC=0.2622, ConfusionMatrix=
[[1400  759]
 [ 106  266]]
Epoch 1 complete in 89.81

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5585, Acc=0.7162, AUC=0.7831, TPR=0.6121, TNR=0.8182, J=0.4303, MCC=0.4401, ConfusionMatrix=
[[3016  670]
 [1402 2212]]
Epoch 2, Phase val, Loss=0.4857, Acc=0.8236, AUC=0.7724, TPR=0.4820, TNR=0.8845, J=0.3665, MCC=0.3490, ConfusionMatrix=
[[1923  251]
 [ 201  187]]
New Best AUC=0.7724. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4870, Acc=0.8337, AUC=0.7507, TPR=0.4785, TNR=0.8949, J=0.3734, MCC=0.3606, ConfusionMatrix=
[[1932  227]
 [ 194  178]]
Epoch 2 complete in 88.30

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5420, Acc=0.7273, AUC=0.8038, TPR=0.6651, TNR=0.7900, J=0.4551, MCC=0.4586, ConfusionMatrix=
[[2870  763]
 [1228 2439]]
Epoch 3, Phase val, Loss=0.5324, Acc=0.7549, AUC=0.7681, TPR=0.5773, TNR=0.7866, J=0.3639, MCC=0.2943, ConfusionMatrix=
[[1710  464]
 [ 164  224]]
Epoch 3, Phase test, Loss=0.5276, Acc=0.7720, AUC=0.7597, TPR=0.5941, TNR=0.8027, J=0.3968, MCC=0.3221, ConfusionMatrix=
[[1733  426]
 [ 151  221]]
Epoch 3 complete in 87.89

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5311, Acc=0.7381, AUC=0.8115, TPR=0.6707, TNR=0.8062, J=0.4768, MCC=0.4811, ConfusionMatrix=
[[2928  704]
 [1208 2460]]
Epoch 4, Phase val, Loss=0.5357, Acc=0.7728, AUC=0.7828, TPR=0.5928, TNR=0.8050, J=0.3978, MCC=0.3270, ConfusionMatrix=
[[1750  424]
 [ 158  230]]
New Best AUC=0.7828. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5197, Acc=0.7870, AUC=0.7701, TPR=0.6022, TNR=0.8189, J=0.4210, MCC=0.3476, ConfusionMatrix=
[[1768  391]
 [ 148  224]]
Epoch 4 complete in 88.62

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5230, Acc=0.7466, AUC=0.8170, TPR=0.6978, TNR=0.7955, J=0.4933, MCC=0.4957, ConfusionMatrix=
[[2898  745]
 [1105 2552]]
Epoch 5, Phase val, Loss=0.6263, Acc=0.7385, AUC=0.7789, TPR=0.6469, TNR=0.7548, J=0.4017, MCC=0.3125, ConfusionMatrix=
[[1641  533]
 [ 137  251]]
Epoch 5, Phase test, Loss=0.6210, Acc=0.7222, AUC=0.7600, TPR=0.6156, TNR=0.7406, J=0.3562, MCC=0.2723, ConfusionMatrix=
[[1599  560]
 [ 143  229]]
Epoch 5 complete in 88.60

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5123, Acc=0.7601, AUC=0.8261, TPR=0.7244, TNR=0.7966, J=0.5210, MCC=0.5221, ConfusionMatrix=
[[2878  735]
 [1016 2671]]
Epoch 6, Phase val, Loss=0.4992, Acc=0.7912, AUC=0.7882, TPR=0.5825, TNR=0.8284, J=0.4109, MCC=0.3480, ConfusionMatrix=
[[1801  373]
 [ 162  226]]
New Best AUC=0.7882. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5124, Acc=0.7748, AUC=0.7622, TPR=0.5645, TNR=0.8110, J=0.3755, MCC=0.3095, ConfusionMatrix=
[[1751  408]
 [ 162  210]]
Epoch 6 complete in 88.86

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5042, Acc=0.7660, AUC=0.8312, TPR=0.7172, TNR=0.8138, J=0.5310, MCC=0.5338, ConfusionMatrix=
[[3003  687]
 [1021 2589]]
Epoch 7, Phase val, Loss=0.4868, Acc=0.8037, AUC=0.7912, TPR=0.6005, TNR=0.8399, J=0.4404, MCC=0.3771, ConfusionMatrix=
[[1826  348]
 [ 155  233]]
New Best AUC=0.7912. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5090, Acc=0.7863, AUC=0.7609, TPR=0.5699, TNR=0.8235, J=0.3934, MCC=0.3289, ConfusionMatrix=
[[1778  381]
 [ 160  212]]
Epoch 7 complete in 88.30

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4989, Acc=0.7585, AUC=0.8342, TPR=0.7242, TNR=0.7937, J=0.5179, MCC=0.5189, ConfusionMatrix=
[[2859  743]
 [1020 2678]]
Epoch 8, Phase val, Loss=0.5084, Acc=0.7966, AUC=0.7990, TPR=0.6521, TNR=0.8224, J=0.4745, MCC=0.3931, ConfusionMatrix=
[[1788  386]
 [ 135  253]]
New Best AUC=0.7990. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.5141, Acc=0.7961, AUC=0.7805, TPR=0.6183, TNR=0.8268, J=0.4451, MCC=0.3697, ConfusionMatrix=
[[1785  374]
 [ 142  230]]
Epoch 8 complete in 88.69

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4948, Acc=0.7707, AUC=0.8391, TPR=0.7224, TNR=0.8185, J=0.5409, MCC=0.5435, ConfusionMatrix=
[[3003  666]
 [1008 2623]]
Epoch 9, Phase val, Loss=0.6593, Acc=0.7342, AUC=0.7754, TPR=0.6495, TNR=0.7493, J=0.3988, MCC=0.3088, ConfusionMatrix=
[[1629  545]
 [ 136  252]]
Epoch 9, Phase test, Loss=0.7061, Acc=0.7147, AUC=0.7742, TPR=0.7016, TNR=0.7170, J=0.4186, MCC=0.3119, ConfusionMatrix=
[[1548  611]
 [ 111  261]]
Epoch 9 complete in 87.19

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4903, Acc=0.7762, AUC=0.8427, TPR=0.7360, TNR=0.8164, J=0.5524, MCC=0.5541, ConfusionMatrix=
[[2979  670]
 [ 964 2687]]
Epoch 10, Phase val, Loss=0.4963, Acc=0.8123, AUC=0.7601, TPR=0.5258, TNR=0.8634, J=0.3892, MCC=0.3517, ConfusionMatrix=
[[1877  297]
 [ 184  204]]
Epoch 10, Phase test, Loss=0.4871, Acc=0.8080, AUC=0.7613, TPR=0.5968, TNR=0.8444, J=0.4411, MCC=0.3768, ConfusionMatrix=
[[1823  336]
 [ 150  222]]
Epoch 10 complete in 87.96

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4857, Acc=0.7747, AUC=0.8454, TPR=0.7427, TNR=0.8075, J=0.5502, MCC=0.5511, ConfusionMatrix=
[[2907  693]
 [ 952 2748]]
Epoch 11, Phase val, Loss=0.5343, Acc=0.7849, AUC=0.7779, TPR=0.5696, TNR=0.8234, J=0.3930, MCC=0.3317, ConfusionMatrix=
[[1790  384]
 [ 167  221]]
Epoch 11, Phase test, Loss=0.5581, Acc=0.7803, AUC=0.7753, TPR=0.6478, TNR=0.8031, J=0.4510, MCC=0.3627, ConfusionMatrix=
[[1734  425]
 [ 131  241]]
Epoch 11 complete in 86.95

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4908, Acc=0.7705, AUC=0.8437, TPR=0.7225, TNR=0.8174, J=0.5399, MCC=0.5427, ConfusionMatrix=
[[3022  675]
 [1000 2603]]
Epoch 12, Phase val, Loss=0.8431, Acc=0.6963, AUC=0.7959, TPR=0.7706, TNR=0.6831, J=0.4537, MCC=0.3341, ConfusionMatrix=
[[1485  689]
 [  89  299]]
Epoch 12, Phase test, Loss=0.8754, Acc=0.6839, AUC=0.7768, TPR=0.7339, TNR=0.6753, J=0.4092, MCC=0.2978, ConfusionMatrix=
[[1458  701]
 [  99  273]]
Epoch 12 complete in 87.53

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4695, Acc=0.7882, AUC=0.8585, TPR=0.7528, TNR=0.8223, J=0.5751, MCC=0.5769, ConfusionMatrix=
[[3059  661]
 [ 885 2695]]
Epoch 13, Phase val, Loss=0.7090, Acc=0.6760, AUC=0.7793, TPR=0.7500, TNR=0.6628, J=0.4128, MCC=0.3021, ConfusionMatrix=
[[1441  733]
 [  97  291]]
Epoch 13, Phase test, Loss=0.7130, Acc=0.6780, AUC=0.7737, TPR=0.7473, TNR=0.6660, J=0.4134, MCC=0.2994, ConfusionMatrix=
[[1438  721]
 [  94  278]]
Epoch 13 complete in 86.83

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4611, Acc=0.7942, AUC=0.8639, TPR=0.7711, TNR=0.8178, J=0.5890, MCC=0.5894, ConfusionMatrix=
[[2954  658]
 [ 844 2844]]
Epoch 14, Phase val, Loss=0.7009, Acc=0.6874, AUC=0.7698, TPR=0.7371, TNR=0.6785, J=0.4156, MCC=0.3062, ConfusionMatrix=
[[1475  699]
 [ 102  286]]
Epoch 14, Phase test, Loss=0.7131, Acc=0.6713, AUC=0.7477, TPR=0.7097, TNR=0.6647, J=0.3743, MCC=0.2717, ConfusionMatrix=
[[1435  724]
 [ 108  264]]
Epoch 14 complete in 88.82

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4655, Acc=0.7930, AUC=0.8591, TPR=0.7750, TNR=0.8115, J=0.5865, MCC=0.5867, ConfusionMatrix=
[[2923  679]
 [ 832 2866]]
Epoch 15, Phase val, Loss=0.7497, Acc=0.7045, AUC=0.7797, TPR=0.7345, TNR=0.6992, J=0.4337, MCC=0.3227, ConfusionMatrix=
[[1520  654]
 [ 103  285]]
Epoch 15, Phase test, Loss=0.7496, Acc=0.6993, AUC=0.7751, TPR=0.7097, TNR=0.6975, J=0.4072, MCC=0.3000, ConfusionMatrix=
[[1506  653]
 [ 108  264]]
Epoch 15 complete in 87.31

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4492, Acc=0.8003, AUC=0.8710, TPR=0.7732, TNR=0.8275, J=0.6007, MCC=0.6015, ConfusionMatrix=
[[3013  628]
 [ 830 2829]]
Epoch 16, Phase val, Loss=0.5746, Acc=0.7756, AUC=0.7865, TPR=0.6830, TNR=0.7921, J=0.4751, MCC=0.3794, ConfusionMatrix=
[[1722  452]
 [ 123  265]]
Epoch 16, Phase test, Loss=0.5848, Acc=0.7377, AUC=0.7638, TPR=0.6694, TNR=0.7494, J=0.4188, MCC=0.3200, ConfusionMatrix=
[[1618  541]
 [ 123  249]]
Epoch 16 complete in 87.16

Early Stop!
Training complete in 24m 57s
The best model val AUC=0.79898448392, test AUC=0.780541070886.
Finish training resnet50scratch-conv1x1ab-maxpool

Start training resnet50scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6110, Acc=0.6590, AUC=0.7243, TPR=0.6306, TNR=0.6875, J=0.3180, MCC=0.3185, ConfusionMatrix=
[[2512 1142]
 [1347 2299]]
Epoch 0, Phase val, Loss=0.6662, Acc=0.6612, AUC=0.7614, TPR=0.7345, TNR=0.6481, J=0.3827, MCC=0.2789, ConfusionMatrix=
[[1409  765]
 [ 103  285]]
New Best AUC=0.7614. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6740, Acc=0.6377, AUC=0.7414, TPR=0.7231, TNR=0.6230, J=0.3461, MCC=0.2477, ConfusionMatrix=
[[1345  814]
 [ 103  269]]
Epoch 0 complete in 88.23

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5614, Acc=0.7095, AUC=0.7838, TPR=0.6360, TNR=0.7816, J=0.4176, MCC=0.4223, ConfusionMatrix=
[[2878  804]
 [1317 2301]]
Epoch 1, Phase val, Loss=0.6044, Acc=0.7400, AUC=0.7743, TPR=0.6469, TNR=0.7567, J=0.4036, MCC=0.3144, ConfusionMatrix=
[[1645  529]
 [ 137  251]]
New Best AUC=0.7743. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6029, Acc=0.7128, AUC=0.7499, TPR=0.6290, TNR=0.7272, J=0.3562, MCC=0.2693, ConfusionMatrix=
[[1570  589]
 [ 138  234]]
Epoch 1 complete in 91.03

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5410, Acc=0.7300, AUC=0.8053, TPR=0.6827, TNR=0.7773, J=0.4600, MCC=0.4621, ConfusionMatrix=
[[2838  813]
 [1158 2491]]
Epoch 2, Phase val, Loss=0.4704, Acc=0.8232, AUC=0.7636, TPR=0.4433, TNR=0.8910, J=0.3343, MCC=0.3272, ConfusionMatrix=
[[1937  237]
 [ 216  172]]
Epoch 2, Phase test, Loss=0.4775, Acc=0.8277, AUC=0.7521, TPR=0.4731, TNR=0.8888, J=0.3620, MCC=0.3458, ConfusionMatrix=
[[1919  240]
 [ 196  176]]
Epoch 2 complete in 87.45

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5227, Acc=0.7453, AUC=0.8200, TPR=0.6978, TNR=0.7949, J=0.4927, MCC=0.4945, ConfusionMatrix=
[[2841  733]
 [1126 2600]]
Epoch 3, Phase val, Loss=0.4847, Acc=0.8306, AUC=0.7926, TPR=0.5258, TNR=0.8850, J=0.4108, MCC=0.3856, ConfusionMatrix=
[[1924  250]
 [ 184  204]]
New Best AUC=0.7926. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.4746, Acc=0.8372, AUC=0.7751, TPR=0.5349, TNR=0.8893, J=0.4242, MCC=0.3971, ConfusionMatrix=
[[1920  239]
 [ 173  199]]
Epoch 3 complete in 90.98

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5151, Acc=0.7619, AUC=0.8258, TPR=0.7046, TNR=0.8204, J=0.5250, MCC=0.5282, ConfusionMatrix=
[[2964  649]
 [1089 2598]]
Epoch 4, Phase val, Loss=0.7131, Acc=0.7432, AUC=0.8062, TPR=0.7242, TNR=0.7466, J=0.4708, MCC=0.3604, ConfusionMatrix=
[[1623  551]
 [ 107  281]]
New Best AUC=0.8062. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.7054, Acc=0.7222, AUC=0.7831, TPR=0.6935, TNR=0.7272, J=0.4207, MCC=0.3157, ConfusionMatrix=
[[1570  589]
 [ 114  258]]
Epoch 4 complete in 88.89

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5247, Acc=0.7534, AUC=0.8211, TPR=0.6796, TNR=0.8257, J=0.5053, MCC=0.5112, ConfusionMatrix=
[[3046  643]
 [1157 2454]]
Epoch 5, Phase val, Loss=0.6992, Acc=0.7006, AUC=0.8102, TPR=0.7990, TNR=0.6831, J=0.4820, MCC=0.3543, ConfusionMatrix=
[[1485  689]
 [  78  310]]
New Best AUC=0.8102. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.7082, Acc=0.6590, AUC=0.7859, TPR=0.7446, TNR=0.6443, J=0.3889, MCC=0.2797, ConfusionMatrix=
[[1391  768]
 [  95  277]]
Epoch 5 complete in 89.75

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5044, Acc=0.7671, AUC=0.8357, TPR=0.7067, TNR=0.8285, J=0.5352, MCC=0.5389, ConfusionMatrix=
[[3000  621]
 [1079 2600]]
Epoch 6, Phase val, Loss=0.4241, Acc=0.8388, AUC=0.7959, TPR=0.4433, TNR=0.9094, J=0.3527, MCC=0.3601, ConfusionMatrix=
[[1977  197]
 [ 216  172]]
Epoch 6, Phase test, Loss=0.4241, Acc=0.8427, AUC=0.7716, TPR=0.4274, TNR=0.9143, J=0.3417, MCC=0.3531, ConfusionMatrix=
[[1974  185]
 [ 213  159]]
Epoch 6 complete in 88.94

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5032, Acc=0.7595, AUC=0.8354, TPR=0.7125, TNR=0.8090, J=0.5215, MCC=0.5231, ConfusionMatrix=
[[2872  678]
 [1078 2672]]
Epoch 7, Phase val, Loss=0.4685, Acc=0.8333, AUC=0.8076, TPR=0.5464, TNR=0.8845, J=0.4309, MCC=0.4015, ConfusionMatrix=
[[1923  251]
 [ 176  212]]
Epoch 7, Phase test, Loss=0.4708, Acc=0.8293, AUC=0.7787, TPR=0.5134, TNR=0.8837, J=0.3972, MCC=0.3704, ConfusionMatrix=
[[1908  251]
 [ 181  191]]
Epoch 7 complete in 87.01

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5043, Acc=0.7603, AUC=0.8310, TPR=0.6939, TNR=0.8252, J=0.5191, MCC=0.5240, ConfusionMatrix=
[[3045  645]
 [1105 2505]]
Epoch 8, Phase val, Loss=0.4667, Acc=0.8259, AUC=0.8061, TPR=0.5232, TNR=0.8799, J=0.4031, MCC=0.3753, ConfusionMatrix=
[[1913  261]
 [ 185  203]]
Epoch 8, Phase test, Loss=0.4561, Acc=0.8368, AUC=0.7862, TPR=0.5054, TNR=0.8939, J=0.3993, MCC=0.3811, ConfusionMatrix=
[[1930  229]
 [ 184  188]]
Epoch 8 complete in 87.78

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4937, Acc=0.7701, AUC=0.8417, TPR=0.7190, TNR=0.8221, J=0.5411, MCC=0.5438, ConfusionMatrix=
[[2976  644]
 [1034 2646]]
Epoch 9, Phase val, Loss=0.4941, Acc=0.8162, AUC=0.8021, TPR=0.5670, TNR=0.8606, J=0.4276, MCC=0.3803, ConfusionMatrix=
[[1871  303]
 [ 168  220]]
Epoch 9, Phase test, Loss=0.4953, Acc=0.8139, AUC=0.7866, TPR=0.5995, TNR=0.8509, J=0.4503, MCC=0.3879, ConfusionMatrix=
[[1837  322]
 [ 149  223]]
Epoch 9 complete in 86.94

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4903, Acc=0.7749, AUC=0.8399, TPR=0.7223, TNR=0.8277, J=0.5500, MCC=0.5530, ConfusionMatrix=
[[3017  628]
 [1015 2640]]
Epoch 10, Phase val, Loss=0.7969, Acc=0.6288, AUC=0.7935, TPR=0.8170, TNR=0.5952, J=0.4122, MCC=0.2962, ConfusionMatrix=
[[1294  880]
 [  71  317]]
Epoch 10, Phase test, Loss=0.7958, Acc=0.6049, AUC=0.7839, TPR=0.8199, TNR=0.5679, J=0.3877, MCC=0.2747, ConfusionMatrix=
[[1226  933]
 [  67  305]]
Epoch 10 complete in 87.58

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4982, Acc=0.7651, AUC=0.8384, TPR=0.7172, TNR=0.8136, J=0.5308, MCC=0.5331, ConfusionMatrix=
[[2950  676]
 [1039 2635]]
Epoch 11, Phase val, Loss=0.4616, Acc=0.8076, AUC=0.7960, TPR=0.5464, TNR=0.8542, J=0.4006, MCC=0.3548, ConfusionMatrix=
[[1857  317]
 [ 176  212]]
Epoch 11, Phase test, Loss=0.4397, Acc=0.8147, AUC=0.7823, TPR=0.5081, TNR=0.8675, J=0.3756, MCC=0.3406, ConfusionMatrix=
[[1873  286]
 [ 183  189]]
Epoch 11 complete in 86.97

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4866, Acc=0.7756, AUC=0.8453, TPR=0.7330, TNR=0.8180, J=0.5510, MCC=0.5531, ConfusionMatrix=
[[2993  666]
 [ 972 2669]]
Epoch 12, Phase val, Loss=0.6069, Acc=0.7482, AUC=0.7963, TPR=0.6701, TNR=0.7622, J=0.4323, MCC=0.3371, ConfusionMatrix=
[[1657  517]
 [ 128  260]]
Epoch 12, Phase test, Loss=0.6240, Acc=0.7463, AUC=0.7784, TPR=0.6640, TNR=0.7605, J=0.4245, MCC=0.3274, ConfusionMatrix=
[[1642  517]
 [ 125  247]]
Epoch 12 complete in 89.16

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4909, Acc=0.7722, AUC=0.8413, TPR=0.7187, TNR=0.8255, J=0.5442, MCC=0.5474, ConfusionMatrix=
[[3018  638]
 [1025 2619]]
Epoch 13, Phase val, Loss=0.5465, Acc=0.7892, AUC=0.7992, TPR=0.6469, TNR=0.8146, J=0.4615, MCC=0.3795, ConfusionMatrix=
[[1771  403]
 [ 137  251]]
Epoch 13, Phase test, Loss=0.5455, Acc=0.7780, AUC=0.7805, TPR=0.6425, TNR=0.8013, J=0.4438, MCC=0.3565, ConfusionMatrix=
[[1730  429]
 [ 133  239]]
Epoch 13 complete in 86.87

Early Stop!
Training complete in 20m 38s
The best model val AUC=0.810210168913, test AUC=0.785851424644.
Finish training resnet50scratch-conv1x1ab-avgpool

Start training resnet50scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6091, Acc=0.6551, AUC=0.7244, TPR=0.6439, TNR=0.6667, J=0.3105, MCC=0.3105, ConfusionMatrix=
[[2390 1195]
 [1323 2392]]
Epoch 0, Phase val, Loss=0.5625, Acc=0.8025, AUC=0.7716, TPR=0.5309, TNR=0.8510, J=0.3819, MCC=0.3380, ConfusionMatrix=
[[1850  324]
 [ 182  206]]
New Best AUC=0.7716. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5500, Acc=0.7922, AUC=0.7497, TPR=0.5645, TNR=0.8314, J=0.3959, MCC=0.3348, ConfusionMatrix=
[[1795  364]
 [ 162  210]]
Epoch 0 complete in 91.26

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5545, Acc=0.7184, AUC=0.7900, TPR=0.6448, TNR=0.7896, J=0.4344, MCC=0.4394, ConfusionMatrix=
[[2928  780]
 [1276 2316]]
Epoch 1, Phase val, Loss=0.6636, Acc=0.7096, AUC=0.7752, TPR=0.6881, TNR=0.7134, J=0.4016, MCC=0.3023, ConfusionMatrix=
[[1551  623]
 [ 121  267]]
New Best AUC=0.7752. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6598, Acc=0.6942, AUC=0.7543, TPR=0.6720, TNR=0.6980, J=0.3701, MCC=0.2736, ConfusionMatrix=
[[1507  652]
 [ 122  250]]
Epoch 1 complete in 88.55

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5472, Acc=0.7207, AUC=0.7978, TPR=0.6813, TNR=0.7605, J=0.4418, MCC=0.4431, ConfusionMatrix=
[[2760  869]
 [1170 2501]]
Epoch 2, Phase val, Loss=0.5294, Acc=0.8048, AUC=0.7835, TPR=0.5696, TNR=0.8468, J=0.4164, MCC=0.3626, ConfusionMatrix=
[[1841  333]
 [ 167  221]]
New Best AUC=0.7835. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5208, Acc=0.8013, AUC=0.7638, TPR=0.5753, TNR=0.8402, J=0.4155, MCC=0.3546, ConfusionMatrix=
[[1814  345]
 [ 158  214]]
Epoch 2 complete in 90.32

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5302, Acc=0.7378, AUC=0.8127, TPR=0.6797, TNR=0.7947, J=0.4744, MCC=0.4778, ConfusionMatrix=
[[2931  757]
 [1157 2455]]
Epoch 3, Phase val, Loss=0.4841, Acc=0.8279, AUC=0.7976, TPR=0.5464, TNR=0.8781, J=0.4245, MCC=0.3909, ConfusionMatrix=
[[1909  265]
 [ 176  212]]
New Best AUC=0.7976. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.4755, Acc=0.8171, AUC=0.7767, TPR=0.5430, TNR=0.8643, J=0.4073, MCC=0.3636, ConfusionMatrix=
[[1866  293]
 [ 170  202]]
Epoch 3 complete in 88.37

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5261, Acc=0.7426, AUC=0.8156, TPR=0.6721, TNR=0.8114, J=0.4835, MCC=0.4886, ConfusionMatrix=
[[2998  697]
 [1182 2423]]
Epoch 4, Phase val, Loss=0.4525, Acc=0.8407, AUC=0.7967, TPR=0.4923, TNR=0.9029, J=0.3952, MCC=0.3895, ConfusionMatrix=
[[1963  211]
 [ 197  191]]
Epoch 4, Phase test, Loss=0.4498, Acc=0.8471, AUC=0.7804, TPR=0.4731, TNR=0.9115, J=0.3847, MCC=0.3868, ConfusionMatrix=
[[1968  191]
 [ 196  176]]
Epoch 4 complete in 88.09

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5148, Acc=0.7501, AUC=0.8258, TPR=0.6926, TNR=0.8076, J=0.5002, MCC=0.5035, ConfusionMatrix=
[[2950  703]
 [1121 2526]]
Epoch 5, Phase val, Loss=0.4639, Acc=0.8130, AUC=0.7834, TPR=0.4871, TNR=0.8712, J=0.3583, MCC=0.3322, ConfusionMatrix=
[[1894  280]
 [ 199  189]]
Epoch 5, Phase test, Loss=0.4778, Acc=0.8155, AUC=0.7619, TPR=0.4758, TNR=0.8740, J=0.3498, MCC=0.3243, ConfusionMatrix=
[[1887  272]
 [ 195  177]]
Epoch 5 complete in 88.34

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5005, Acc=0.7647, AUC=0.8387, TPR=0.6983, TNR=0.8288, J=0.5270, MCC=0.5322, ConfusionMatrix=
[[3078  636]
 [1082 2504]]
Epoch 6, Phase val, Loss=0.5513, Acc=0.8041, AUC=0.8096, TPR=0.6418, TNR=0.8330, J=0.4748, MCC=0.3992, ConfusionMatrix=
[[1811  363]
 [ 139  249]]
New Best AUC=0.8096. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5627, Acc=0.7819, AUC=0.7872, TPR=0.6532, TNR=0.8041, J=0.4573, MCC=0.3677, ConfusionMatrix=
[[1736  423]
 [ 129  243]]
Epoch 6 complete in 90.16

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5028, Acc=0.7618, AUC=0.8343, TPR=0.7036, TNR=0.8184, J=0.5220, MCC=0.5259, ConfusionMatrix=
[[3028  672]
 [1067 2533]]
Epoch 7, Phase val, Loss=0.4570, Acc=0.8068, AUC=0.7836, TPR=0.4510, TNR=0.8703, J=0.3213, MCC=0.3009, ConfusionMatrix=
[[1892  282]
 [ 213  175]]
Epoch 7, Phase test, Loss=0.4508, Acc=0.8186, AUC=0.7719, TPR=0.4839, TNR=0.8763, J=0.3602, MCC=0.3345, ConfusionMatrix=
[[1892  267]
 [ 192  180]]
Epoch 7 complete in 87.36

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5038, Acc=0.7659, AUC=0.8349, TPR=0.7071, TNR=0.8244, J=0.5316, MCC=0.5353, ConfusionMatrix=
[[3015  642]
 [1067 2576]]
Epoch 8, Phase val, Loss=0.4542, Acc=0.8349, AUC=0.8034, TPR=0.5155, TNR=0.8919, J=0.4074, MCC=0.3890, ConfusionMatrix=
[[1939  235]
 [ 188  200]]
Epoch 8, Phase test, Loss=0.4435, Acc=0.8443, AUC=0.7917, TPR=0.5645, TNR=0.8925, J=0.4571, MCC=0.4263, ConfusionMatrix=
[[1927  232]
 [ 162  210]]
Epoch 8 complete in 88.55

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4928, Acc=0.7715, AUC=0.8408, TPR=0.7127, TNR=0.8307, J=0.5434, MCC=0.5471, ConfusionMatrix=
[[3022  616]
 [1052 2610]]
Epoch 9, Phase val, Loss=0.4932, Acc=0.8060, AUC=0.8041, TPR=0.5979, TNR=0.8431, J=0.4411, MCC=0.3795, ConfusionMatrix=
[[1833  341]
 [ 156  232]]
Epoch 9, Phase test, Loss=0.4700, Acc=0.8210, AUC=0.8009, TPR=0.6048, TNR=0.8583, J=0.4631, MCC=0.4027, ConfusionMatrix=
[[1853  306]
 [ 147  225]]
Epoch 9 complete in 87.69

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4957, Acc=0.7700, AUC=0.8401, TPR=0.7277, TNR=0.8142, J=0.5419, MCC=0.5433, ConfusionMatrix=
[[2906  663]
 [1016 2715]]
Epoch 10, Phase val, Loss=0.4069, Acc=0.8450, AUC=0.7982, TPR=0.3969, TNR=0.9250, J=0.3219, MCC=0.3505, ConfusionMatrix=
[[2011  163]
 [ 234  154]]
Epoch 10, Phase test, Loss=0.3905, Acc=0.8597, AUC=0.7896, TPR=0.3898, TNR=0.9407, J=0.3305, MCC=0.3772, ConfusionMatrix=
[[2031  128]
 [ 227  145]]
Epoch 10 complete in 86.97

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4874, Acc=0.7782, AUC=0.8454, TPR=0.7328, TNR=0.8249, J=0.5576, MCC=0.5596, ConfusionMatrix=
[[2972  631]
 [ 988 2709]]
Epoch 11, Phase val, Loss=0.4972, Acc=0.8216, AUC=0.8144, TPR=0.5979, TNR=0.8615, J=0.4595, MCC=0.4058, ConfusionMatrix=
[[1873  301]
 [ 156  232]]
New Best AUC=0.8144. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.4872, Acc=0.8190, AUC=0.7906, TPR=0.5914, TNR=0.8583, J=0.4497, MCC=0.3924, ConfusionMatrix=
[[1853  306]
 [ 152  220]]
Epoch 11 complete in 88.90

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4822, Acc=0.7837, AUC=0.8491, TPR=0.7325, TNR=0.8351, J=0.5676, MCC=0.5705, ConfusionMatrix=
[[3043  601]
 [ 978 2678]]
Epoch 12, Phase val, Loss=0.4949, Acc=0.7947, AUC=0.7865, TPR=0.5335, TNR=0.8413, J=0.3748, MCC=0.3268, ConfusionMatrix=
[[1829  345]
 [ 181  207]]
Epoch 12, Phase test, Loss=0.4809, Acc=0.8064, AUC=0.7847, TPR=0.5806, TNR=0.8453, J=0.4259, MCC=0.3657, ConfusionMatrix=
[[1825  334]
 [ 156  216]]
Epoch 12 complete in 86.93

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4748, Acc=0.7867, AUC=0.8552, TPR=0.7430, TNR=0.8305, J=0.5735, MCC=0.5757, ConfusionMatrix=
[[3028  618]
 [ 939 2715]]
Epoch 13, Phase val, Loss=0.4668, Acc=0.8224, AUC=0.8013, TPR=0.5619, TNR=0.8689, J=0.4308, MCC=0.3887, ConfusionMatrix=
[[1889  285]
 [ 170  218]]
Epoch 13, Phase test, Loss=0.4461, Acc=0.8404, AUC=0.7976, TPR=0.5376, TNR=0.8925, J=0.4302, MCC=0.4049, ConfusionMatrix=
[[1927  232]
 [ 172  200]]
Epoch 13 complete in 87.60

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4780, Acc=0.7816, AUC=0.8503, TPR=0.7371, TNR=0.8263, J=0.5634, MCC=0.5656, ConfusionMatrix=
[[3012  633]
 [ 961 2694]]
Epoch 14, Phase val, Loss=0.4680, Acc=0.8119, AUC=0.7822, TPR=0.4948, TNR=0.8684, J=0.3633, MCC=0.3343, ConfusionMatrix=
[[1888  286]
 [ 196  192]]
Epoch 14, Phase test, Loss=0.4445, Acc=0.8301, AUC=0.7922, TPR=0.5296, TNR=0.8819, J=0.4115, MCC=0.3804, ConfusionMatrix=
[[1904  255]
 [ 175  197]]
Epoch 14 complete in 86.83

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4612, Acc=0.7966, AUC=0.8617, TPR=0.7555, TNR=0.8377, J=0.5932, MCC=0.5952, ConfusionMatrix=
[[3055  592]
 [ 893 2760]]
Epoch 15, Phase val, Loss=0.5353, Acc=0.7904, AUC=0.8184, TPR=0.6881, TNR=0.8086, J=0.4968, MCC=0.4028, ConfusionMatrix=
[[1758  416]
 [ 121  267]]
New Best AUC=0.8184. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 15, Phase test, Loss=0.5452, Acc=0.7791, AUC=0.7943, TPR=0.6694, TNR=0.7981, J=0.4674, MCC=0.3725, ConfusionMatrix=
[[1723  436]
 [ 123  249]]
Epoch 15 complete in 92.22

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4786, Acc=0.7851, AUC=0.8506, TPR=0.7348, TNR=0.8347, J=0.5695, MCC=0.5726, ConfusionMatrix=
[[3066  607]
 [ 962 2665]]
Epoch 16, Phase val, Loss=0.3993, Acc=0.8247, AUC=0.7746, TPR=0.3428, TNR=0.9108, J=0.2535, MCC=0.2724, ConfusionMatrix=
[[1980  194]
 [ 255  133]]
Epoch 16, Phase test, Loss=0.3821, Acc=0.8522, AUC=0.7863, TPR=0.4005, TNR=0.9301, J=0.3306, MCC=0.3621, ConfusionMatrix=
[[2008  151]
 [ 223  149]]
Epoch 16 complete in 87.02

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4680, Acc=0.7878, AUC=0.8579, TPR=0.7348, TNR=0.8395, J=0.5743, MCC=0.5779, ConfusionMatrix=
[[3102  593]
 [ 956 2649]]
Epoch 17, Phase val, Loss=0.4234, Acc=0.8286, AUC=0.8003, TPR=0.5103, TNR=0.8855, J=0.3958, MCC=0.3738, ConfusionMatrix=
[[1925  249]
 [ 190  198]]
Epoch 17, Phase test, Loss=0.4249, Acc=0.8337, AUC=0.7837, TPR=0.5296, TNR=0.8861, J=0.4156, MCC=0.3873, ConfusionMatrix=
[[1913  246]
 [ 175  197]]
Epoch 17 complete in 91.70

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4683, Acc=0.7859, AUC=0.8585, TPR=0.7606, TNR=0.8121, J=0.5727, MCC=0.5731, ConfusionMatrix=
[[2913  674]
 [ 889 2824]]
Epoch 18, Phase val, Loss=0.5479, Acc=0.7927, AUC=0.7937, TPR=0.6108, TNR=0.8252, J=0.4360, MCC=0.3656, ConfusionMatrix=
[[1794  380]
 [ 151  237]]
Epoch 18, Phase test, Loss=0.5192, Acc=0.8076, AUC=0.7986, TPR=0.6210, TNR=0.8397, J=0.4607, MCC=0.3888, ConfusionMatrix=
[[1813  346]
 [ 141  231]]
Epoch 18 complete in 87.15

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4636, Acc=0.7932, AUC=0.8613, TPR=0.7486, TNR=0.8378, J=0.5864, MCC=0.5887, ConfusionMatrix=
[[3053  591]
 [ 919 2737]]
Epoch 19, Phase val, Loss=0.4639, Acc=0.8115, AUC=0.7856, TPR=0.5567, TNR=0.8569, J=0.4136, MCC=0.3668, ConfusionMatrix=
[[1863  311]
 [ 172  216]]
Epoch 19, Phase test, Loss=0.4531, Acc=0.8230, AUC=0.7863, TPR=0.5806, TNR=0.8648, J=0.4454, MCC=0.3937, ConfusionMatrix=
[[1867  292]
 [ 156  216]]
Epoch 19 complete in 89.17

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4510, Acc=0.8042, AUC=0.8697, TPR=0.7735, TNR=0.8350, J=0.6084, MCC=0.6096, ConfusionMatrix=
[[3051  603]
 [ 826 2820]]
Epoch 20, Phase val, Loss=0.4648, Acc=0.8084, AUC=0.7519, TPR=0.5026, TNR=0.8629, J=0.3655, MCC=0.3324, ConfusionMatrix=
[[1876  298]
 [ 193  195]]
Epoch 20, Phase test, Loss=0.4494, Acc=0.8092, AUC=0.7551, TPR=0.4758, TNR=0.8666, J=0.3424, MCC=0.3131, ConfusionMatrix=
[[1871  288]
 [ 195  177]]
Epoch 20 complete in 87.24

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4527, Acc=0.8032, AUC=0.8681, TPR=0.7631, TNR=0.8432, J=0.6063, MCC=0.6083, ConfusionMatrix=
[[3076  572]
 [ 865 2787]]
Epoch 21, Phase val, Loss=0.5791, Acc=0.7553, AUC=0.7736, TPR=0.6443, TNR=0.7751, J=0.4194, MCC=0.3319, ConfusionMatrix=
[[1685  489]
 [ 138  250]]
Epoch 21, Phase test, Loss=0.5877, Acc=0.7566, AUC=0.7788, TPR=0.6613, TNR=0.7730, J=0.4343, MCC=0.3386, ConfusionMatrix=
[[1669  490]
 [ 126  246]]
Epoch 21 complete in 87.19

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4447, Acc=0.7993, AUC=0.8725, TPR=0.7542, TNR=0.8436, J=0.5978, MCC=0.6005, ConfusionMatrix=
[[3107  576]
 [ 889 2728]]
Epoch 22, Phase val, Loss=0.4886, Acc=0.8216, AUC=0.8101, TPR=0.6443, TNR=0.8533, J=0.4976, MCC=0.4292, ConfusionMatrix=
[[1855  319]
 [ 138  250]]
Epoch 22, Phase test, Loss=0.4858, Acc=0.8127, AUC=0.7974, TPR=0.6452, TNR=0.8416, J=0.4868, MCC=0.4096, ConfusionMatrix=
[[1817  342]
 [ 132  240]]
Epoch 22 complete in 87.53

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.4408, Acc=0.8077, AUC=0.8759, TPR=0.7740, TNR=0.8400, J=0.6140, MCC=0.6158, ConfusionMatrix=
[[3129  596]
 [ 808 2767]]
Epoch 23, Phase val, Loss=0.4965, Acc=0.7877, AUC=0.7986, TPR=0.6521, TNR=0.8119, J=0.4639, MCC=0.3799, ConfusionMatrix=
[[1765  409]
 [ 135  253]]
Epoch 23, Phase test, Loss=0.5045, Acc=0.7819, AUC=0.7889, TPR=0.6237, TNR=0.8092, J=0.4328, MCC=0.3519, ConfusionMatrix=
[[1747  412]
 [ 140  232]]
Epoch 23 complete in 88.36

Early Stop!
Training complete in 35m 24s
The best model val AUC=0.818360616091, test AUC=0.794316240593.
Finish training resnet50scratch-conv1x1ab-avgpool

Start training resnet50scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6029, Acc=0.6618, AUC=0.7367, TPR=0.6388, TNR=0.6843, J=0.3231, MCC=0.3235, ConfusionMatrix=
[[2521 1163]
 [1306 2310]]
Epoch 0, Phase val, Loss=0.7065, Acc=0.6452, AUC=0.7534, TPR=0.7397, TNR=0.6283, J=0.3680, MCC=0.2667, ConfusionMatrix=
[[1366  808]
 [ 101  287]]
New Best AUC=0.7534. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6997, Acc=0.6183, AUC=0.7498, TPR=0.7446, TNR=0.5966, J=0.3412, MCC=0.2427, ConfusionMatrix=
[[1288  871]
 [  95  277]]
Epoch 0 complete in 89.10

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5645, Acc=0.7062, AUC=0.7809, TPR=0.6578, TNR=0.7561, J=0.4138, MCC=0.4155, ConfusionMatrix=
[[2718  877]
 [1268 2437]]
Epoch 1, Phase val, Loss=0.8115, Acc=0.5863, AUC=0.7611, TPR=0.7887, TNR=0.5501, J=0.3388, MCC=0.2429, ConfusionMatrix=
[[1196  978]
 [  82  306]]
New Best AUC=0.7611. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7961, Acc=0.5599, AUC=0.7560, TPR=0.7930, TNR=0.5197, J=0.3127, MCC=0.2217, ConfusionMatrix=
[[1122 1037]
 [  77  295]]
Epoch 1 complete in 89.49

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5391, Acc=0.7258, AUC=0.8020, TPR=0.6646, TNR=0.7862, J=0.4508, MCC=0.4543, ConfusionMatrix=
[[2886  785]
 [1217 2412]]
Epoch 2, Phase val, Loss=0.4840, Acc=0.8185, AUC=0.7766, TPR=0.5052, TNR=0.8744, J=0.3796, MCC=0.3519, ConfusionMatrix=
[[1901  273]
 [ 192  196]]
New Best AUC=0.7766. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4702, Acc=0.8234, AUC=0.7651, TPR=0.5349, TNR=0.8731, J=0.4080, MCC=0.3706, ConfusionMatrix=
[[1885  274]
 [ 173  199]]
Epoch 2 complete in 88.67

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5283, Acc=0.7334, AUC=0.8110, TPR=0.6683, TNR=0.7980, J=0.4664, MCC=0.4704, ConfusionMatrix=
[[2924  740]
 [1206 2430]]
Epoch 3, Phase val, Loss=0.6671, Acc=0.7350, AUC=0.7995, TPR=0.7294, TNR=0.7360, J=0.4654, MCC=0.3536, ConfusionMatrix=
[[1600  574]
 [ 105  283]]
New Best AUC=0.7995. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6550, Acc=0.6977, AUC=0.7749, TPR=0.7097, TNR=0.6957, J=0.4054, MCC=0.2983, ConfusionMatrix=
[[1502  657]
 [ 108  264]]
Epoch 3 complete in 88.02

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5192, Acc=0.7430, AUC=0.8206, TPR=0.6777, TNR=0.8101, J=0.4878, MCC=0.4916, ConfusionMatrix=
[[2918  684]
 [1192 2506]]
Epoch 4, Phase val, Loss=0.6149, Acc=0.7482, AUC=0.8006, TPR=0.6933, TNR=0.7580, J=0.4513, MCC=0.3497, ConfusionMatrix=
[[1648  526]
 [ 119  269]]
New Best AUC=0.8006. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.6105, Acc=0.7373, AUC=0.7875, TPR=0.6882, TNR=0.7457, J=0.4339, MCC=0.3299, ConfusionMatrix=
[[1610  549]
 [ 116  256]]
Epoch 4 complete in 88.59

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5204, Acc=0.7496, AUC=0.8220, TPR=0.6828, TNR=0.8169, J=0.4997, MCC=0.5041, ConfusionMatrix=
[[2971  666]
 [1162 2501]]
Epoch 5, Phase val, Loss=0.5453, Acc=0.8185, AUC=0.8043, TPR=0.6160, TNR=0.8546, J=0.4706, MCC=0.4095, ConfusionMatrix=
[[1858  316]
 [ 149  239]]
New Best AUC=0.8043. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5464, Acc=0.7965, AUC=0.7881, TPR=0.6237, TNR=0.8263, J=0.4500, MCC=0.3731, ConfusionMatrix=
[[1784  375]
 [ 140  232]]
Epoch 5 complete in 88.11

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5070, Acc=0.7596, AUC=0.8320, TPR=0.6891, TNR=0.8279, J=0.5170, MCC=0.5226, ConfusionMatrix=
[[3069  638]
 [1117 2476]]
Epoch 6, Phase val, Loss=0.4557, Acc=0.8396, AUC=0.7989, TPR=0.4768, TNR=0.9043, J=0.3811, MCC=0.3791, ConfusionMatrix=
[[1966  208]
 [ 203  185]]
Epoch 6, Phase test, Loss=0.4458, Acc=0.8495, AUC=0.7844, TPR=0.4892, TNR=0.9115, J=0.4008, MCC=0.4003, ConfusionMatrix=
[[1968  191]
 [ 190  182]]
Epoch 6 complete in 89.41

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5010, Acc=0.7718, AUC=0.8350, TPR=0.7081, TNR=0.8348, J=0.5429, MCC=0.5475, ConfusionMatrix=
[[3063  606]
 [1060 2571]]
Epoch 7, Phase val, Loss=0.5020, Acc=0.8099, AUC=0.7977, TPR=0.5876, TNR=0.8496, J=0.4372, MCC=0.3805, ConfusionMatrix=
[[1847  327]
 [ 160  228]]
Epoch 7, Phase test, Loss=0.5065, Acc=0.8056, AUC=0.7787, TPR=0.5968, TNR=0.8416, J=0.4384, MCC=0.3730, ConfusionMatrix=
[[1817  342]
 [ 150  222]]
Epoch 7 complete in 87.14

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4946, Acc=0.7673, AUC=0.8401, TPR=0.6990, TNR=0.8349, J=0.5340, MCC=0.5391, ConfusionMatrix=
[[3060  605]
 [1094 2541]]
Epoch 8, Phase val, Loss=0.5015, Acc=0.8134, AUC=0.8051, TPR=0.5799, TNR=0.8551, J=0.4350, MCC=0.3823, ConfusionMatrix=
[[1859  315]
 [ 163  225]]
New Best AUC=0.8051. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.4946, Acc=0.8258, AUC=0.7902, TPR=0.5887, TNR=0.8666, J=0.4553, MCC=0.4028, ConfusionMatrix=
[[1871  288]
 [ 153  219]]
Epoch 8 complete in 89.45

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4962, Acc=0.7675, AUC=0.8396, TPR=0.7020, TNR=0.8322, J=0.5343, MCC=0.5391, ConfusionMatrix=
[[3056  616]
 [1081 2547]]
Epoch 9, Phase val, Loss=0.5547, Acc=0.8029, AUC=0.8138, TPR=0.6340, TNR=0.8330, J=0.4670, MCC=0.3933, ConfusionMatrix=
[[1811  363]
 [ 142  246]]
New Best AUC=0.8138. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.5549, Acc=0.7902, AUC=0.7891, TPR=0.6398, TNR=0.8161, J=0.4559, MCC=0.3724, ConfusionMatrix=
[[1762  397]
 [ 134  238]]
Epoch 9 complete in 88.07

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4868, Acc=0.7729, AUC=0.8458, TPR=0.7084, TNR=0.8361, J=0.5445, MCC=0.5494, ConfusionMatrix=
[[3082  604]
 [1054 2560]]
Epoch 10, Phase val, Loss=0.4600, Acc=0.8435, AUC=0.8102, TPR=0.5490, TNR=0.8960, J=0.4450, MCC=0.4234, ConfusionMatrix=
[[1948  226]
 [ 175  213]]
Epoch 10, Phase test, Loss=0.4570, Acc=0.8305, AUC=0.7910, TPR=0.5054, TNR=0.8865, J=0.3919, MCC=0.3685, ConfusionMatrix=
[[1914  245]
 [ 184  188]]
Epoch 10 complete in 88.42

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4958, Acc=0.7704, AUC=0.8383, TPR=0.7176, TNR=0.8227, J=0.5402, MCC=0.5434, ConfusionMatrix=
[[3020  651]
 [1025 2604]]
Epoch 11, Phase val, Loss=0.4858, Acc=0.8165, AUC=0.8127, TPR=0.6598, TNR=0.8445, J=0.5043, MCC=0.4284, ConfusionMatrix=
[[1836  338]
 [ 132  256]]
Epoch 11, Phase test, Loss=0.4809, Acc=0.8115, AUC=0.7914, TPR=0.6022, TNR=0.8476, J=0.4498, MCC=0.3854, ConfusionMatrix=
[[1830  329]
 [ 148  224]]
Epoch 11 complete in 87.00

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4919, Acc=0.7701, AUC=0.8438, TPR=0.7199, TNR=0.8196, J=0.5396, MCC=0.5425, ConfusionMatrix=
[[3013  663]
 [1015 2609]]
Epoch 12, Phase val, Loss=0.6054, Acc=0.7681, AUC=0.8074, TPR=0.6985, TNR=0.7806, J=0.4790, MCC=0.3777, ConfusionMatrix=
[[1697  477]
 [ 117  271]]
Epoch 12, Phase test, Loss=0.5961, Acc=0.7460, AUC=0.7940, TPR=0.6909, TNR=0.7554, J=0.4463, MCC=0.3416, ConfusionMatrix=
[[1631  528]
 [ 115  257]]
Epoch 12 complete in 88.78

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4862, Acc=0.7732, AUC=0.8448, TPR=0.7232, TNR=0.8229, J=0.5461, MCC=0.5489, ConfusionMatrix=
[[3011  648]
 [1008 2633]]
Epoch 13, Phase val, Loss=0.6509, Acc=0.7744, AUC=0.8135, TPR=0.7165, TNR=0.7847, J=0.5012, MCC=0.3955, ConfusionMatrix=
[[1706  468]
 [ 110  278]]
Epoch 13, Phase test, Loss=0.6602, Acc=0.7554, AUC=0.7921, TPR=0.7097, TNR=0.7633, J=0.4730, MCC=0.3634, ConfusionMatrix=
[[1648  511]
 [ 108  264]]
Epoch 13 complete in 87.97

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4798, Acc=0.7753, AUC=0.8491, TPR=0.7203, TNR=0.8298, J=0.5502, MCC=0.5537, ConfusionMatrix=
[[3043  624]
 [1016 2617]]
Epoch 14, Phase val, Loss=0.5770, Acc=0.7713, AUC=0.8061, TPR=0.6753, TNR=0.7884, J=0.4637, MCC=0.3695, ConfusionMatrix=
[[1714  460]
 [ 126  262]]
Epoch 14, Phase test, Loss=0.5626, Acc=0.7673, AUC=0.7965, TPR=0.6935, TNR=0.7800, J=0.4735, MCC=0.3697, ConfusionMatrix=
[[1684  475]
 [ 114  258]]
Epoch 14 complete in 87.52

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4772, Acc=0.7773, AUC=0.8508, TPR=0.7286, TNR=0.8261, J=0.5548, MCC=0.5573, ConfusionMatrix=
[[3008  633]
 [ 993 2666]]
Epoch 15, Phase val, Loss=0.4757, Acc=0.8283, AUC=0.8081, TPR=0.5851, TNR=0.8717, J=0.4567, MCC=0.4112, ConfusionMatrix=
[[1895  279]
 [ 161  227]]
Epoch 15, Phase test, Loss=0.4675, Acc=0.8333, AUC=0.7887, TPR=0.5833, TNR=0.8763, J=0.4597, MCC=0.4139, ConfusionMatrix=
[[1892  267]
 [ 155  217]]
Epoch 15 complete in 87.22

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4787, Acc=0.7816, AUC=0.8506, TPR=0.7289, TNR=0.8335, J=0.5624, MCC=0.5658, ConfusionMatrix=
[[3069  613]
 [ 981 2637]]
Epoch 16, Phase val, Loss=0.4623, Acc=0.8173, AUC=0.7892, TPR=0.5361, TNR=0.8675, J=0.4036, MCC=0.3662, ConfusionMatrix=
[[1886  288]
 [ 180  208]]
Epoch 16, Phase test, Loss=0.4541, Acc=0.8266, AUC=0.7921, TPR=0.5806, TNR=0.8689, J=0.4496, MCC=0.4001, ConfusionMatrix=
[[1876  283]
 [ 156  216]]
Epoch 16 complete in 87.04

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4676, Acc=0.7871, AUC=0.8582, TPR=0.7351, TNR=0.8391, J=0.5743, MCC=0.5774, ConfusionMatrix=
[[3062  587]
 [ 967 2684]]
Epoch 17, Phase val, Loss=0.4898, Acc=0.7927, AUC=0.7948, TPR=0.6314, TNR=0.8215, J=0.4530, MCC=0.3765, ConfusionMatrix=
[[1786  388]
 [ 143  245]]
Epoch 17, Phase test, Loss=0.4710, Acc=0.8084, AUC=0.7793, TPR=0.6048, TNR=0.8434, J=0.4483, MCC=0.3817, ConfusionMatrix=
[[1821  338]
 [ 147  225]]
Epoch 17 complete in 87.83

Early Stop!
Training complete in 26m 28s
The best model val AUC=0.813803478789, test AUC=0.789131019439.
Finish training resnet50scratch-conv1x1ab-avgpool

Start training resnet50scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5983, Acc=0.6601, AUC=0.7362, TPR=0.6363, TNR=0.6842, J=0.3204, MCC=0.3208, ConfusionMatrix=
[[2489 1149]
 [1332 2330]]
Epoch 0, Phase val, Loss=0.5496, Acc=0.7947, AUC=0.7592, TPR=0.4948, TNR=0.8482, J=0.3431, MCC=0.3053, ConfusionMatrix=
[[1844  330]
 [ 196  192]]
New Best AUC=0.7592. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5403, Acc=0.7831, AUC=0.7541, TPR=0.5457, TNR=0.8240, J=0.3697, MCC=0.3109, ConfusionMatrix=
[[1779  380]
 [ 169  203]]
Epoch 0 complete in 88.28

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5557, Acc=0.7104, AUC=0.7895, TPR=0.6360, TNR=0.7839, J=0.4198, MCC=0.4247, ConfusionMatrix=
[[2880  794]
 [1320 2306]]
Epoch 1, Phase val, Loss=0.5503, Acc=0.7947, AUC=0.7670, TPR=0.5309, TNR=0.8418, J=0.3727, MCC=0.3254, ConfusionMatrix=
[[1830  344]
 [ 182  206]]
New Best AUC=0.7670. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5394, Acc=0.7926, AUC=0.7596, TPR=0.5511, TNR=0.8342, J=0.3853, MCC=0.3280, ConfusionMatrix=
[[1801  358]
 [ 167  205]]
Epoch 1 complete in 89.08

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5483, Acc=0.7263, AUC=0.7978, TPR=0.6469, TNR=0.8004, J=0.4473, MCC=0.4535, ConfusionMatrix=
[[3023  754]
 [1244 2279]]
Epoch 2, Phase val, Loss=0.5439, Acc=0.8029, AUC=0.7822, TPR=0.5567, TNR=0.8468, J=0.4035, MCC=0.3525, ConfusionMatrix=
[[1841  333]
 [ 172  216]]
New Best AUC=0.7822. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5400, Acc=0.7997, AUC=0.7636, TPR=0.5699, TNR=0.8393, J=0.4092, MCC=0.3493, ConfusionMatrix=
[[1812  347]
 [ 160  212]]
Epoch 2 complete in 88.42

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5246, Acc=0.7430, AUC=0.8171, TPR=0.6731, TNR=0.8129, J=0.4860, MCC=0.4908, ConfusionMatrix=
[[2968  683]
 [1193 2456]]
Epoch 3, Phase val, Loss=0.6387, Acc=0.7377, AUC=0.7895, TPR=0.7294, TNR=0.7392, J=0.4686, MCC=0.3567, ConfusionMatrix=
[[1607  567]
 [ 105  283]]
New Best AUC=0.7895. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6596, Acc=0.7072, AUC=0.7793, TPR=0.7581, TNR=0.6985, J=0.4565, MCC=0.3351, ConfusionMatrix=
[[1508  651]
 [  90  282]]
Epoch 3 complete in 90.25

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5201, Acc=0.7516, AUC=0.8225, TPR=0.6967, TNR=0.8089, J=0.5056, MCC=0.5081, ConfusionMatrix=
[[2891  683]
 [1130 2596]]
Epoch 4, Phase val, Loss=0.4289, Acc=0.8450, AUC=0.7856, TPR=0.4356, TNR=0.9181, J=0.3537, MCC=0.3705, ConfusionMatrix=
[[1996  178]
 [ 219  169]]
Epoch 4, Phase test, Loss=0.4304, Acc=0.8566, AUC=0.7747, TPR=0.4785, TNR=0.9217, J=0.4002, MCC=0.4120, ConfusionMatrix=
[[1990  169]
 [ 194  178]]
Epoch 4 complete in 86.99

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5213, Acc=0.7533, AUC=0.8230, TPR=0.6909, TNR=0.8164, J=0.5073, MCC=0.5112, ConfusionMatrix=
[[2962  666]
 [1135 2537]]
Epoch 5, Phase val, Loss=0.6766, Acc=0.7592, AUC=0.8040, TPR=0.6830, TNR=0.7728, J=0.4558, MCC=0.3578, ConfusionMatrix=
[[1680  494]
 [ 123  265]]
New Best AUC=0.8040. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.6856, Acc=0.7440, AUC=0.7862, TPR=0.6989, TNR=0.7517, J=0.4507, MCC=0.3437, ConfusionMatrix=
[[1623  536]
 [ 112  260]]
Epoch 5 complete in 88.92

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5120, Acc=0.7563, AUC=0.8250, TPR=0.6873, TNR=0.8259, J=0.5132, MCC=0.5180, ConfusionMatrix=
[[3002  633]
 [1146 2519]]
Epoch 6, Phase val, Loss=0.5406, Acc=0.8017, AUC=0.8029, TPR=0.6314, TNR=0.8321, J=0.4636, MCC=0.3902, ConfusionMatrix=
[[1809  365]
 [ 143  245]]
Epoch 6, Phase test, Loss=0.5461, Acc=0.7764, AUC=0.7893, TPR=0.6532, TNR=0.7976, J=0.4508, MCC=0.3601, ConfusionMatrix=
[[1722  437]
 [ 129  243]]
Epoch 6 complete in 86.98

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5135, Acc=0.7595, AUC=0.8259, TPR=0.6925, TNR=0.8257, J=0.5181, MCC=0.5230, ConfusionMatrix=
[[3031  640]
 [1116 2513]]
Epoch 7, Phase val, Loss=0.5484, Acc=0.8041, AUC=0.8093, TPR=0.6392, TNR=0.8335, J=0.4727, MCC=0.3978, ConfusionMatrix=
[[1812  362]
 [ 140  248]]
New Best AUC=0.8093. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5497, Acc=0.7898, AUC=0.7868, TPR=0.6452, TNR=0.8147, J=0.4599, MCC=0.3746, ConfusionMatrix=
[[1759  400]
 [ 132  240]]
Epoch 7 complete in 90.54

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5082, Acc=0.7562, AUC=0.8284, TPR=0.6864, TNR=0.8252, J=0.5116, MCC=0.5168, ConfusionMatrix=
[[3027  641]
 [1139 2493]]
Epoch 8, Phase val, Loss=0.6083, Acc=0.7830, AUC=0.8175, TPR=0.7062, TNR=0.7967, J=0.5029, MCC=0.4017, ConfusionMatrix=
[[1732  442]
 [ 114  274]]
New Best AUC=0.8175. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.6229, Acc=0.7661, AUC=0.7891, TPR=0.6989, TNR=0.7777, J=0.4766, MCC=0.3710, ConfusionMatrix=
[[1679  480]
 [ 112  260]]
Epoch 8 complete in 88.24

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4994, Acc=0.7664, AUC=0.8387, TPR=0.7229, TNR=0.8103, J=0.5333, MCC=0.5352, ConfusionMatrix=
[[2944  689]
 [1016 2651]]
Epoch 9, Phase val, Loss=0.5304, Acc=0.7877, AUC=0.7984, TPR=0.6005, TNR=0.8211, J=0.4216, MCC=0.3525, ConfusionMatrix=
[[1785  389]
 [ 155  233]]
Epoch 9, Phase test, Loss=0.5437, Acc=0.7712, AUC=0.7790, TPR=0.6290, TNR=0.7957, J=0.4248, MCC=0.3401, ConfusionMatrix=
[[1718  441]
 [ 138  234]]
Epoch 9 complete in 90.73

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4944, Acc=0.7674, AUC=0.8422, TPR=0.7240, TNR=0.8123, J=0.5363, MCC=0.5379, ConfusionMatrix=
[[2913  673]
 [1025 2689]]
Epoch 10, Phase val, Loss=0.4712, Acc=0.8275, AUC=0.8100, TPR=0.5928, TNR=0.8694, J=0.4621, MCC=0.4137, ConfusionMatrix=
[[1890  284]
 [ 158  230]]
Epoch 10, Phase test, Loss=0.4792, Acc=0.8167, AUC=0.7905, TPR=0.5887, TNR=0.8560, J=0.4447, MCC=0.3870, ConfusionMatrix=
[[1848  311]
 [ 153  219]]
Epoch 10 complete in 87.14

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5083, Acc=0.7607, AUC=0.8303, TPR=0.7232, TNR=0.7993, J=0.5226, MCC=0.5237, ConfusionMatrix=
[[2872  721]
 [1026 2681]]
Epoch 11, Phase val, Loss=0.7383, Acc=0.6354, AUC=0.8034, TPR=0.8247, TNR=0.6017, J=0.4264, MCC=0.3066, ConfusionMatrix=
[[1308  866]
 [  68  320]]
Epoch 11, Phase test, Loss=0.7539, Acc=0.6171, AUC=0.7854, TPR=0.7957, TNR=0.5864, J=0.3821, MCC=0.2711, ConfusionMatrix=
[[1266  893]
 [  76  296]]
Epoch 11 complete in 88.04

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4896, Acc=0.7721, AUC=0.8432, TPR=0.7194, TNR=0.8238, J=0.5432, MCC=0.5464, ConfusionMatrix=
[[3034  649]
 [1015 2602]]
Epoch 12, Phase val, Loss=0.6815, Acc=0.6932, AUC=0.8060, TPR=0.7990, TNR=0.6743, J=0.4733, MCC=0.3467, ConfusionMatrix=
[[1466  708]
 [  78  310]]
Epoch 12, Phase test, Loss=0.7068, Acc=0.6582, AUC=0.7921, TPR=0.7581, TNR=0.6410, J=0.3991, MCC=0.2865, ConfusionMatrix=
[[1384  775]
 [  90  282]]
Epoch 12 complete in 87.96

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4906, Acc=0.7707, AUC=0.8417, TPR=0.7172, TNR=0.8237, J=0.5408, MCC=0.5441, ConfusionMatrix=
[[3022  647]
 [1027 2604]]
Epoch 13, Phase val, Loss=0.4246, Acc=0.8411, AUC=0.7921, TPR=0.4356, TNR=0.9135, J=0.3491, MCC=0.3614, ConfusionMatrix=
[[1986  188]
 [ 219  169]]
Epoch 13, Phase test, Loss=0.4082, Acc=0.8586, AUC=0.7903, TPR=0.4409, TNR=0.9305, J=0.3714, MCC=0.3989, ConfusionMatrix=
[[2009  150]
 [ 208  164]]
Epoch 13 complete in 88.65

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4894, Acc=0.7755, AUC=0.8442, TPR=0.7236, TNR=0.8270, J=0.5506, MCC=0.5536, ConfusionMatrix=
[[3030  634]
 [1005 2631]]
Epoch 14, Phase val, Loss=0.5142, Acc=0.7955, AUC=0.8026, TPR=0.6366, TNR=0.8238, J=0.4604, MCC=0.3833, ConfusionMatrix=
[[1791  383]
 [ 141  247]]
Epoch 14, Phase test, Loss=0.5166, Acc=0.7890, AUC=0.7986, TPR=0.6586, TNR=0.8115, J=0.4701, MCC=0.3806, ConfusionMatrix=
[[1752  407]
 [ 127  245]]
Epoch 14 complete in 87.27

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4870, Acc=0.7760, AUC=0.8460, TPR=0.7318, TNR=0.8188, J=0.5506, MCC=0.5531, ConfusionMatrix=
[[3037  672]
 [ 963 2628]]
Epoch 15, Phase val, Loss=0.4260, Acc=0.8341, AUC=0.8070, TPR=0.5464, TNR=0.8855, J=0.4319, MCC=0.4030, ConfusionMatrix=
[[1925  249]
 [ 176  212]]
Epoch 15, Phase test, Loss=0.4177, Acc=0.8427, AUC=0.7862, TPR=0.4919, TNR=0.9032, J=0.3951, MCC=0.3867, ConfusionMatrix=
[[1950  209]
 [ 189  183]]
Epoch 15 complete in 87.00

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4760, Acc=0.7822, AUC=0.8510, TPR=0.7387, TNR=0.8262, J=0.5649, MCC=0.5669, ConfusionMatrix=
[[2999  631]
 [ 959 2711]]
Epoch 16, Phase val, Loss=0.4672, Acc=0.8150, AUC=0.8107, TPR=0.6005, TNR=0.8533, J=0.4538, MCC=0.3957, ConfusionMatrix=
[[1855  319]
 [ 155  233]]
Epoch 16, Phase test, Loss=0.4673, Acc=0.8190, AUC=0.7920, TPR=0.6022, TNR=0.8564, J=0.4586, MCC=0.3980, ConfusionMatrix=
[[1849  310]
 [ 148  224]]
Epoch 16 complete in 88.61

Early Stop!
Training complete in 25m 3s
The best model val AUC=0.817528381339, test AUC=0.789062538909.
Finish training resnet50scratch-conv1x1ab-avgpool

Start training resnet50scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6748, Acc=0.5862, AUC=0.6301, TPR=0.5942, TNR=0.5784, J=0.1726, MCC=0.1726, ConfusionMatrix=
[[2150 1567]
 [1454 2129]]
Epoch 0, Phase val, Loss=1.3018, Acc=0.3310, AUC=0.6785, TPR=0.9536, TNR=0.2199, J=0.1735, MCC=0.1574, ConfusionMatrix=
[[ 478 1696]
 [  18  370]]
New Best AUC=0.6785. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=1.3851, Acc=0.3094, AUC=0.6543, TPR=0.9301, TNR=0.2024, J=0.1325, MCC=0.1214, ConfusionMatrix=
[[ 437 1722]
 [  26  346]]
Epoch 0 complete in 92.42

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5966, Acc=0.6570, AUC=0.7363, TPR=0.6231, TNR=0.6909, J=0.3140, MCC=0.3147, ConfusionMatrix=
[[2521 1128]
 [1376 2275]]
Epoch 1, Phase val, Loss=0.5840, Acc=0.7900, AUC=0.7348, TPR=0.4485, TNR=0.8510, J=0.2994, MCC=0.2712, ConfusionMatrix=
[[1850  324]
 [ 214  174]]
New Best AUC=0.7348. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5330, Acc=0.7957, AUC=0.7414, TPR=0.4651, TNR=0.8527, J=0.3178, MCC=0.2845, ConfusionMatrix=
[[1841  318]
 [ 199  173]]
Epoch 1 complete in 90.40

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5888, Acc=0.6929, AUC=0.7621, TPR=0.6683, TNR=0.7181, J=0.3864, MCC=0.3868, ConfusionMatrix=
[[2586 1015]
 [1227 2472]]
Epoch 2, Phase val, Loss=0.7013, Acc=0.7170, AUC=0.7593, TPR=0.6108, TNR=0.7360, J=0.3468, MCC=0.2673, ConfusionMatrix=
[[1600  574]
 [ 151  237]]
New Best AUC=0.7593. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6846, Acc=0.7199, AUC=0.7479, TPR=0.6102, TNR=0.7388, J=0.3490, MCC=0.2666, ConfusionMatrix=
[[1595  564]
 [ 145  227]]
Epoch 2 complete in 89.78

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5865, Acc=0.6897, AUC=0.7599, TPR=0.6445, TNR=0.7367, J=0.3812, MCC=0.3825, ConfusionMatrix=
[[2638  943]
 [1322 2397]]
Epoch 3, Phase val, Loss=0.6248, Acc=0.7147, AUC=0.7496, TPR=0.6263, TNR=0.7305, J=0.3567, MCC=0.2734, ConfusionMatrix=
[[1588  586]
 [ 145  243]]
Epoch 3, Phase test, Loss=0.6063, Acc=0.7361, AUC=0.7537, TPR=0.6398, TNR=0.7527, J=0.3924, MCC=0.3018, ConfusionMatrix=
[[1625  534]
 [ 134  238]]
Epoch 3 complete in 87.24

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5379, Acc=0.7255, AUC=0.8053, TPR=0.6800, TNR=0.7712, J=0.4513, MCC=0.4531, ConfusionMatrix=
[[2805  832]
 [1172 2491]]
Epoch 4, Phase val, Loss=0.5849, Acc=0.7248, AUC=0.7539, TPR=0.6263, TNR=0.7424, J=0.3687, MCC=0.2849, ConfusionMatrix=
[[1614  560]
 [ 145  243]]
Epoch 4, Phase test, Loss=0.5899, Acc=0.7175, AUC=0.7490, TPR=0.6586, TNR=0.7277, J=0.3863, MCC=0.2911, ConfusionMatrix=
[[1571  588]
 [ 127  245]]
Epoch 4 complete in 86.19

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5325, Acc=0.7330, AUC=0.8093, TPR=0.6653, TNR=0.7988, J=0.4641, MCC=0.4687, ConfusionMatrix=
[[2958  745]
 [1204 2393]]
Epoch 5, Phase val, Loss=0.5736, Acc=0.7521, AUC=0.7361, TPR=0.5335, TNR=0.7912, J=0.3247, MCC=0.2660, ConfusionMatrix=
[[1720  454]
 [ 181  207]]
Epoch 5, Phase test, Loss=0.5583, Acc=0.7586, AUC=0.7540, TPR=0.5833, TNR=0.7888, J=0.3721, MCC=0.2982, ConfusionMatrix=
[[1703  456]
 [ 155  217]]
Epoch 5 complete in 87.53

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5497, Acc=0.7138, AUC=0.7930, TPR=0.6668, TNR=0.7608, J=0.4276, MCC=0.4295, ConfusionMatrix=
[[2780  874]
 [1215 2431]]
Epoch 6, Phase val, Loss=0.5407, Acc=0.7771, AUC=0.7451, TPR=0.5361, TNR=0.8201, J=0.3562, MCC=0.3017, ConfusionMatrix=
[[1783  391]
 [ 180  208]]
Epoch 6, Phase test, Loss=0.5103, Acc=0.7847, AUC=0.7486, TPR=0.5403, TNR=0.8268, J=0.3671, MCC=0.3102, ConfusionMatrix=
[[1785  374]
 [ 171  201]]
Epoch 6 complete in 86.23

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5280, Acc=0.7325, AUC=0.8112, TPR=0.6756, TNR=0.7893, J=0.4649, MCC=0.4680, ConfusionMatrix=
[[2881  769]
 [1184 2466]]
Epoch 7, Phase val, Loss=0.4210, Acc=0.8333, AUC=0.7654, TPR=0.4278, TNR=0.9057, J=0.3335, MCC=0.3398, ConfusionMatrix=
[[1969  205]
 [ 222  166]]
New Best AUC=0.7654. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.4038, Acc=0.8483, AUC=0.7681, TPR=0.4543, TNR=0.9162, J=0.3705, MCC=0.3800, ConfusionMatrix=
[[1978  181]
 [ 203  169]]
Epoch 7 complete in 96.40

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5104, Acc=0.7414, AUC=0.8274, TPR=0.6971, TNR=0.7862, J=0.4833, MCC=0.4851, ConfusionMatrix=
[[2853  776]
 [1112 2559]]
Epoch 8, Phase val, Loss=0.5587, Acc=0.7303, AUC=0.7535, TPR=0.6108, TNR=0.7516, J=0.3624, MCC=0.2826, ConfusionMatrix=
[[1634  540]
 [ 151  237]]
Epoch 8, Phase test, Loss=0.5672, Acc=0.7278, AUC=0.7388, TPR=0.5914, TNR=0.7513, J=0.3427, MCC=0.2650, ConfusionMatrix=
[[1622  537]
 [ 152  220]]
Epoch 8 complete in 85.81

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5152, Acc=0.7559, AUC=0.8262, TPR=0.7221, TNR=0.7888, J=0.5110, MCC=0.5123, ConfusionMatrix=
[[2914  780]
 [1002 2604]]
Epoch 9, Phase val, Loss=0.5596, Acc=0.7572, AUC=0.7627, TPR=0.5902, TNR=0.7870, J=0.3772, MCC=0.3046, ConfusionMatrix=
[[1711  463]
 [ 159  229]]
Epoch 9, Phase test, Loss=0.5717, Acc=0.7487, AUC=0.7551, TPR=0.6317, TNR=0.7689, J=0.4006, MCC=0.3126, ConfusionMatrix=
[[1660  499]
 [ 137  235]]
Epoch 9 complete in 86.62

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5258, Acc=0.7410, AUC=0.8170, TPR=0.7056, TNR=0.7771, J=0.4827, MCC=0.4837, ConfusionMatrix=
[[2806  805]
 [1086 2603]]
Epoch 10, Phase val, Loss=0.4531, Acc=0.8146, AUC=0.7632, TPR=0.5232, TNR=0.8666, J=0.3898, MCC=0.3545, ConfusionMatrix=
[[1884  290]
 [ 185  203]]
Epoch 10, Phase test, Loss=0.4439, Acc=0.8218, AUC=0.7685, TPR=0.5081, TNR=0.8759, J=0.3839, MCC=0.3534, ConfusionMatrix=
[[1891  268]
 [ 183  189]]
Epoch 10 complete in 86.33

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4879, Acc=0.7647, AUC=0.8449, TPR=0.7336, TNR=0.7952, J=0.5289, MCC=0.5300, ConfusionMatrix=
[[2924  753]
 [ 965 2658]]
Epoch 11, Phase val, Loss=0.7301, Acc=0.6756, AUC=0.7856, TPR=0.7423, TNR=0.6638, J=0.4060, MCC=0.2974, ConfusionMatrix=
[[1443  731]
 [ 100  288]]
New Best AUC=0.7856. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.7603, Acc=0.6349, AUC=0.7667, TPR=0.7285, TNR=0.6188, J=0.3473, MCC=0.2482, ConfusionMatrix=
[[1336  823]
 [ 101  271]]
Epoch 11 complete in 87.75

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4946, Acc=0.7656, AUC=0.8410, TPR=0.7355, TNR=0.7961, J=0.5316, MCC=0.5325, ConfusionMatrix=
[[2889  740]
 [ 971 2700]]
Epoch 12, Phase val, Loss=0.6734, Acc=0.6874, AUC=0.7531, TPR=0.7062, TNR=0.6840, J=0.3902, MCC=0.2889, ConfusionMatrix=
[[1487  687]
 [ 114  274]]
Epoch 12, Phase test, Loss=0.6733, Acc=0.6808, AUC=0.7555, TPR=0.7070, TNR=0.6762, J=0.3832, MCC=0.2795, ConfusionMatrix=
[[1460  699]
 [ 109  263]]
Epoch 12 complete in 86.58

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4841, Acc=0.7662, AUC=0.8485, TPR=0.7343, TNR=0.7983, J=0.5327, MCC=0.5337, ConfusionMatrix=
[[2898  732]
 [ 975 2695]]
Epoch 13, Phase val, Loss=0.4547, Acc=0.8123, AUC=0.7817, TPR=0.5387, TNR=0.8611, J=0.3997, MCC=0.3586, ConfusionMatrix=
[[1872  302]
 [ 179  209]]
Epoch 13, Phase test, Loss=0.4608, Acc=0.8104, AUC=0.7582, TPR=0.5430, TNR=0.8564, J=0.3994, MCC=0.3521, ConfusionMatrix=
[[1849  310]
 [ 170  202]]
Epoch 13 complete in 88.83

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4771, Acc=0.7755, AUC=0.8535, TPR=0.7505, TNR=0.8009, J=0.5514, MCC=0.5519, ConfusionMatrix=
[[2900  721]
 [ 918 2761]]
Epoch 14, Phase val, Loss=0.5303, Acc=0.7717, AUC=0.7630, TPR=0.6160, TNR=0.7994, J=0.4154, MCC=0.3381, ConfusionMatrix=
[[1738  436]
 [ 149  239]]
Epoch 14, Phase test, Loss=0.5489, Acc=0.7539, AUC=0.7551, TPR=0.6102, TNR=0.7786, J=0.3888, MCC=0.3071, ConfusionMatrix=
[[1681  478]
 [ 145  227]]
Epoch 14 complete in 86.73

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4706, Acc=0.7779, AUC=0.8581, TPR=0.7599, TNR=0.7965, J=0.5563, MCC=0.5565, ConfusionMatrix=
[[2872  734]
 [ 887 2807]]
Epoch 15, Phase val, Loss=0.5410, Acc=0.7717, AUC=0.7814, TPR=0.6443, TNR=0.7944, J=0.4387, MCC=0.3534, ConfusionMatrix=
[[1727  447]
 [ 138  250]]
Epoch 15, Phase test, Loss=0.5510, Acc=0.7653, AUC=0.7677, TPR=0.6478, TNR=0.7855, J=0.4334, MCC=0.3425, ConfusionMatrix=
[[1696  463]
 [ 131  241]]
Epoch 15 complete in 86.12

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4567, Acc=0.7910, AUC=0.8675, TPR=0.7634, TNR=0.8185, J=0.5819, MCC=0.5828, ConfusionMatrix=
[[2986  662]
 [ 864 2788]]
Epoch 16, Phase val, Loss=0.5828, Acc=0.7443, AUC=0.7583, TPR=0.6469, TNR=0.7617, J=0.4086, MCC=0.3196, ConfusionMatrix=
[[1656  518]
 [ 137  251]]
Epoch 16, Phase test, Loss=0.5700, Acc=0.7448, AUC=0.7589, TPR=0.6532, TNR=0.7605, J=0.4138, MCC=0.3196, ConfusionMatrix=
[[1642  517]
 [ 129  243]]
Epoch 16 complete in 86.85

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4654, Acc=0.7859, AUC=0.8634, TPR=0.7678, TNR=0.8043, J=0.5721, MCC=0.5723, ConfusionMatrix=
[[2913  709]
 [ 854 2824]]
Epoch 17, Phase val, Loss=0.6455, Acc=0.7221, AUC=0.7586, TPR=0.6675, TNR=0.7318, J=0.3994, MCC=0.3048, ConfusionMatrix=
[[1591  583]
 [ 129  259]]
Epoch 17, Phase test, Loss=0.6472, Acc=0.7337, AUC=0.7597, TPR=0.6774, TNR=0.7434, J=0.4208, MCC=0.3198, ConfusionMatrix=
[[1605  554]
 [ 120  252]]
Epoch 17 complete in 86.29

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4541, Acc=0.7948, AUC=0.8691, TPR=0.7818, TNR=0.8076, J=0.5895, MCC=0.5897, ConfusionMatrix=
[[2960  705]
 [ 793 2842]]
Epoch 18, Phase val, Loss=0.5326, Acc=0.7697, AUC=0.7569, TPR=0.5747, TNR=0.8045, J=0.3793, MCC=0.3128, ConfusionMatrix=
[[1749  425]
 [ 165  223]]
Epoch 18, Phase test, Loss=0.5351, Acc=0.7740, AUC=0.7652, TPR=0.6183, TNR=0.8008, J=0.4191, MCC=0.3380, ConfusionMatrix=
[[1729  430]
 [ 142  230]]
Epoch 18 complete in 87.13

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4472, Acc=0.7989, AUC=0.8739, TPR=0.7818, TNR=0.8155, J=0.5973, MCC=0.5978, ConfusionMatrix=
[[3023  684]
 [ 784 2809]]
Epoch 19, Phase val, Loss=0.5315, Acc=0.7865, AUC=0.7760, TPR=0.5928, TNR=0.8211, J=0.4139, MCC=0.3466, ConfusionMatrix=
[[1785  389]
 [ 158  230]]
Epoch 19, Phase test, Loss=0.5428, Acc=0.7681, AUC=0.7567, TPR=0.6452, TNR=0.7893, J=0.4344, MCC=0.3446, ConfusionMatrix=
[[1704  455]
 [ 132  240]]
Epoch 19 complete in 86.35

Early Stop!
Training complete in 29m 18s
The best model val AUC=0.785609451911, test AUC=0.766734151115.
Finish training resnet50scratch-conv1x1-maxpool

Start training resnet50scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6793, Acc=0.5978, AUC=0.6446, TPR=0.5896, TNR=0.6059, J=0.1954, MCC=0.1955, ConfusionMatrix=
[[2235 1454]
 [1482 2129]]
Epoch 0, Phase val, Loss=0.7375, Acc=0.5312, AUC=0.7045, TPR=0.7552, TNR=0.4913, J=0.2464, MCC=0.1774, ConfusionMatrix=
[[1068 1106]
 [  95  293]]
New Best AUC=0.7045. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7492, Acc=0.5263, AUC=0.6940, TPR=0.7473, TNR=0.4882, J=0.2355, MCC=0.1675, ConfusionMatrix=
[[1054 1105]
 [  94  278]]
Epoch 0 complete in 89.88

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.6164, Acc=0.6592, AUC=0.7273, TPR=0.6186, TNR=0.6995, J=0.3181, MCC=0.3192, ConfusionMatrix=
[[2561 1100]
 [1388 2251]]
Epoch 1, Phase val, Loss=0.5000, Acc=0.7931, AUC=0.7066, TPR=0.4021, TNR=0.8629, J=0.2650, MCC=0.2488, ConfusionMatrix=
[[1876  298]
 [ 232  156]]
New Best AUC=0.7066. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4791, Acc=0.8044, AUC=0.7311, TPR=0.4274, TNR=0.8694, J=0.2968, MCC=0.2771, ConfusionMatrix=
[[1877  282]
 [ 213  159]]
Epoch 1 complete in 87.79

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5712, Acc=0.7003, AUC=0.7717, TPR=0.6394, TNR=0.7604, J=0.3998, MCC=0.4029, ConfusionMatrix=
[[2793  880]
 [1308 2319]]
Epoch 2, Phase val, Loss=0.5748, Acc=0.7287, AUC=0.7446, TPR=0.5851, TNR=0.7544, J=0.3394, MCC=0.2663, ConfusionMatrix=
[[1640  534]
 [ 161  227]]
New Best AUC=0.7446. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5794, Acc=0.7384, AUC=0.7396, TPR=0.5941, TNR=0.7633, J=0.3574, MCC=0.2791, ConfusionMatrix=
[[1648  511]
 [ 151  221]]
Epoch 2 complete in 88.33

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5568, Acc=0.7104, AUC=0.7848, TPR=0.6465, TNR=0.7735, J=0.4200, MCC=0.4236, ConfusionMatrix=
[[2841  832]
 [1282 2345]]
Epoch 3, Phase val, Loss=0.5506, Acc=0.7799, AUC=0.7477, TPR=0.5412, TNR=0.8224, J=0.3637, MCC=0.3086, ConfusionMatrix=
[[1788  386]
 [ 178  210]]
New Best AUC=0.7477. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5267, Acc=0.7926, AUC=0.7490, TPR=0.5296, TNR=0.8379, J=0.3675, MCC=0.3161, ConfusionMatrix=
[[1809  350]
 [ 175  197]]
Epoch 3 complete in 87.84

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5368, Acc=0.7315, AUC=0.8081, TPR=0.6990, TNR=0.7650, J=0.4641, MCC=0.4648, ConfusionMatrix=
[[2748  844]
 [1116 2592]]
Epoch 4, Phase val, Loss=0.4550, Acc=0.8087, AUC=0.7526, TPR=0.4794, TNR=0.8675, J=0.3469, MCC=0.3203, ConfusionMatrix=
[[1886  288]
 [ 202  186]]
New Best AUC=0.7526. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4466, Acc=0.8262, AUC=0.7597, TPR=0.5215, TNR=0.8786, J=0.4002, MCC=0.3687, ConfusionMatrix=
[[1897  262]
 [ 178  194]]
Epoch 4 complete in 89.82

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5252, Acc=0.7404, AUC=0.8159, TPR=0.7117, TNR=0.7696, J=0.4814, MCC=0.4820, ConfusionMatrix=
[[2783  833]
 [1062 2622]]
Epoch 5, Phase val, Loss=0.5359, Acc=0.7631, AUC=0.7680, TPR=0.6186, TNR=0.7889, J=0.4074, MCC=0.3279, ConfusionMatrix=
[[1715  459]
 [ 148  240]]
New Best AUC=0.7680. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5327, Acc=0.7665, AUC=0.7718, TPR=0.6290, TNR=0.7902, J=0.4192, MCC=0.3338, ConfusionMatrix=
[[1706  453]
 [ 138  234]]
Epoch 5 complete in 87.67

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5167, Acc=0.7486, AUC=0.8254, TPR=0.7031, TNR=0.7943, J=0.4975, MCC=0.4995, ConfusionMatrix=
[[2893  749]
 [1086 2572]]
Epoch 6, Phase val, Loss=0.4420, Acc=0.8244, AUC=0.7440, TPR=0.4588, TNR=0.8896, J=0.3484, MCC=0.3380, ConfusionMatrix=
[[1934  240]
 [ 210  178]]
Epoch 6, Phase test, Loss=0.4392, Acc=0.8293, AUC=0.7422, TPR=0.4704, TNR=0.8912, J=0.3616, MCC=0.3475, ConfusionMatrix=
[[1924  235]
 [ 197  175]]
Epoch 6 complete in 87.68

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5209, Acc=0.7471, AUC=0.8210, TPR=0.7161, TNR=0.7785, J=0.4947, MCC=0.4955, ConfusionMatrix=
[[2823  803]
 [1043 2631]]
Epoch 7, Phase val, Loss=0.4948, Acc=0.8013, AUC=0.7646, TPR=0.5258, TNR=0.8505, J=0.3763, MCC=0.3332, ConfusionMatrix=
[[1849  325]
 [ 184  204]]
Epoch 7, Phase test, Loss=0.4733, Acc=0.8163, AUC=0.7755, TPR=0.5430, TNR=0.8634, J=0.4064, MCC=0.3622, ConfusionMatrix=
[[1864  295]
 [ 170  202]]
Epoch 7 complete in 87.06

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5243, Acc=0.7486, AUC=0.8205, TPR=0.7205, TNR=0.7767, J=0.4973, MCC=0.4980, ConfusionMatrix=
[[2835  815]
 [1020 2630]]
Epoch 8, Phase val, Loss=0.5961, Acc=0.6893, AUC=0.7287, TPR=0.6211, TNR=0.7015, J=0.3226, MCC=0.2429, ConfusionMatrix=
[[1525  649]
 [ 147  241]]
Epoch 8, Phase test, Loss=0.5859, Acc=0.7167, AUC=0.7600, TPR=0.6586, TNR=0.7267, J=0.3853, MCC=0.2902, ConfusionMatrix=
[[1569  590]
 [ 127  245]]
Epoch 8 complete in 86.36

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5135, Acc=0.7486, AUC=0.8271, TPR=0.7102, TNR=0.7865, J=0.4967, MCC=0.4983, ConfusionMatrix=
[[2892  785]
 [1050 2573]]
Epoch 9, Phase val, Loss=0.4315, Acc=0.8267, AUC=0.7859, TPR=0.5103, TNR=0.8832, J=0.3935, MCC=0.3700, ConfusionMatrix=
[[1920  254]
 [ 190  198]]
New Best AUC=0.7859. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.4304, Acc=0.8309, AUC=0.7793, TPR=0.5430, TNR=0.8805, J=0.4235, MCC=0.3889, ConfusionMatrix=
[[1901  258]
 [ 170  202]]
Epoch 9 complete in 88.43

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4914, Acc=0.7727, AUC=0.8455, TPR=0.7398, TNR=0.8051, J=0.5449, MCC=0.5462, ConfusionMatrix=
[[2965  718]
 [ 941 2676]]
Epoch 10, Phase val, Loss=0.4482, Acc=0.8197, AUC=0.7817, TPR=0.5361, TNR=0.8703, J=0.4064, MCC=0.3704, ConfusionMatrix=
[[1892  282]
 [ 180  208]]
Epoch 10, Phase test, Loss=0.4395, Acc=0.8293, AUC=0.7909, TPR=0.5806, TNR=0.8722, J=0.4528, MCC=0.4052, ConfusionMatrix=
[[1883  276]
 [ 156  216]]
Epoch 10 complete in 86.17

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4898, Acc=0.7723, AUC=0.8452, TPR=0.7336, TNR=0.8112, J=0.5448, MCC=0.5464, ConfusionMatrix=
[[2956  688]
 [ 974 2682]]
Epoch 11, Phase val, Loss=0.5980, Acc=0.7498, AUC=0.7725, TPR=0.6753, TNR=0.7631, J=0.4384, MCC=0.3419, ConfusionMatrix=
[[1659  515]
 [ 126  262]]
Epoch 11, Phase test, Loss=0.6047, Acc=0.7282, AUC=0.7679, TPR=0.6747, TNR=0.7374, J=0.4121, MCC=0.3120, ConfusionMatrix=
[[1592  567]
 [ 121  251]]
Epoch 11 complete in 87.05

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4825, Acc=0.7711, AUC=0.8499, TPR=0.7459, TNR=0.7966, J=0.5425, MCC=0.5431, ConfusionMatrix=
[[2890  738]
 [ 933 2739]]
Epoch 12, Phase val, Loss=0.4655, Acc=0.8115, AUC=0.7531, TPR=0.5232, TNR=0.8629, J=0.3861, MCC=0.3490, ConfusionMatrix=
[[1876  298]
 [ 185  203]]
Epoch 12, Phase test, Loss=0.4713, Acc=0.8080, AUC=0.7450, TPR=0.5430, TNR=0.8536, J=0.3966, MCC=0.3481, ConfusionMatrix=
[[1843  316]
 [ 170  202]]
Epoch 12 complete in 86.22

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4573, Acc=0.7921, AUC=0.8673, TPR=0.7808, TNR=0.8033, J=0.5841, MCC=0.5842, ConfusionMatrix=
[[2936  719]
 [ 799 2846]]
Epoch 13, Phase val, Loss=0.5355, Acc=0.7783, AUC=0.7722, TPR=0.6057, TNR=0.8091, J=0.4148, MCC=0.3417, ConfusionMatrix=
[[1759  415]
 [ 153  235]]
Epoch 13, Phase test, Loss=0.5361, Acc=0.7764, AUC=0.7661, TPR=0.6290, TNR=0.8018, J=0.4308, MCC=0.3471, ConfusionMatrix=
[[1731  428]
 [ 138  234]]
Epoch 13 complete in 87.05

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4516, Acc=0.7919, AUC=0.8711, TPR=0.7626, TNR=0.8208, J=0.5834, MCC=0.5845, ConfusionMatrix=
[[3018  659]
 [ 860 2763]]
Epoch 14, Phase val, Loss=0.4819, Acc=0.8041, AUC=0.7690, TPR=0.6031, TNR=0.8399, J=0.4430, MCC=0.3790, ConfusionMatrix=
[[1826  348]
 [ 154  234]]
Epoch 14, Phase test, Loss=0.4872, Acc=0.7870, AUC=0.7503, TPR=0.5914, TNR=0.8208, J=0.4121, MCC=0.3418, ConfusionMatrix=
[[1772  387]
 [ 152  220]]
Epoch 14 complete in 87.19

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4776, Acc=0.7749, AUC=0.8553, TPR=0.7541, TNR=0.7954, J=0.5495, MCC=0.5501, ConfusionMatrix=
[[2927  753]
 [ 890 2730]]
Epoch 15, Phase val, Loss=0.5085, Acc=0.7966, AUC=0.7695, TPR=0.6057, TNR=0.8307, J=0.4364, MCC=0.3688, ConfusionMatrix=
[[1806  368]
 [ 153  235]]
Epoch 15, Phase test, Loss=0.5144, Acc=0.7724, AUC=0.7585, TPR=0.6156, TNR=0.7994, J=0.4150, MCC=0.3344, ConfusionMatrix=
[[1726  433]
 [ 143  229]]
Epoch 15 complete in 87.99

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4497, Acc=0.7977, AUC=0.8728, TPR=0.7836, TNR=0.8115, J=0.5951, MCC=0.5954, ConfusionMatrix=
[[2992  695]
 [ 782 2831]]
Epoch 16, Phase val, Loss=0.6363, Acc=0.7143, AUC=0.7747, TPR=0.6804, TNR=0.7203, J=0.4007, MCC=0.3032, ConfusionMatrix=
[[1566  608]
 [ 124  264]]
Epoch 16, Phase test, Loss=0.6564, Acc=0.6950, AUC=0.7724, TPR=0.6882, TNR=0.6962, J=0.3843, MCC=0.2835, ConfusionMatrix=
[[1503  656]
 [ 116  256]]
Epoch 16 complete in 86.96

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4448, Acc=0.8001, AUC=0.8747, TPR=0.7835, TNR=0.8164, J=0.5999, MCC=0.6003, ConfusionMatrix=
[[3014  678]
 [ 781 2827]]
Epoch 17, Phase val, Loss=0.4757, Acc=0.8009, AUC=0.7787, TPR=0.6108, TNR=0.8349, J=0.4457, MCC=0.3782, ConfusionMatrix=
[[1815  359]
 [ 151  237]]
Epoch 17, Phase test, Loss=0.4914, Acc=0.7906, AUC=0.7670, TPR=0.6048, TNR=0.8226, J=0.4274, MCC=0.3543, ConfusionMatrix=
[[1776  383]
 [ 147  225]]
Epoch 17 complete in 86.21

Early Stop!
Training complete in 26m 16s
The best model val AUC=0.785931913239, test AUC=0.779271068346.
Finish training resnet50scratch-conv1x1-maxpool

Start training resnet50scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.7316, Acc=0.5719, AUC=0.6022, TPR=0.5828, TNR=0.5610, J=0.1438, MCC=0.1438, ConfusionMatrix=
[[2043 1599]
 [1526 2132]]
Epoch 0, Phase val, Loss=0.8269, Acc=0.4746, AUC=0.6861, TPR=0.8015, TNR=0.4163, J=0.2178, MCC=0.1606, ConfusionMatrix=
[[ 905 1269]
 [  77  311]]
New Best AUC=0.6861. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.8700, Acc=0.4548, AUC=0.6747, TPR=0.8253, TNR=0.3909, J=0.2162, MCC=0.1596, ConfusionMatrix=
[[ 844 1315]
 [  65  307]]
Epoch 0 complete in 88.00

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.6026, Acc=0.6740, AUC=0.7436, TPR=0.6433, TNR=0.7055, J=0.3488, MCC=0.3494, ConfusionMatrix=
[[2539 1060]
 [1320 2381]]
Epoch 1, Phase val, Loss=0.6134, Acc=0.7217, AUC=0.7356, TPR=0.5541, TNR=0.7516, J=0.3057, MCC=0.2404, ConfusionMatrix=
[[1634  540]
 [ 173  215]]
New Best AUC=0.7356. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6271, Acc=0.7005, AUC=0.7339, TPR=0.6290, TNR=0.7128, J=0.3419, MCC=0.2560, ConfusionMatrix=
[[1539  620]
 [ 138  234]]
Epoch 1 complete in 87.15

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5638, Acc=0.7037, AUC=0.7769, TPR=0.6264, TNR=0.7804, J=0.4069, MCC=0.4119, ConfusionMatrix=
[[2858  804]
 [1359 2279]]
Epoch 2, Phase val, Loss=0.6065, Acc=0.7178, AUC=0.7417, TPR=0.5825, TNR=0.7420, J=0.3244, MCC=0.2521, ConfusionMatrix=
[[1613  561]
 [ 162  226]]
New Best AUC=0.7417. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6015, Acc=0.7341, AUC=0.7481, TPR=0.6156, TNR=0.7545, J=0.3701, MCC=0.2860, ConfusionMatrix=
[[1629  530]
 [ 143  229]]
Epoch 2 complete in 87.86

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5604, Acc=0.7177, AUC=0.7838, TPR=0.6576, TNR=0.7762, J=0.4338, MCC=0.4371, ConfusionMatrix=
[[2871  828]
 [1233 2368]]
Epoch 3, Phase val, Loss=0.5706, Acc=0.7518, AUC=0.7629, TPR=0.5876, TNR=0.7810, J=0.3687, MCC=0.2961, ConfusionMatrix=
[[1698  476]
 [ 160  228]]
New Best AUC=0.7629. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5612, Acc=0.7578, AUC=0.7518, TPR=0.6156, TNR=0.7823, J=0.3979, MCC=0.3151, ConfusionMatrix=
[[1689  470]
 [ 143  229]]
Epoch 3 complete in 87.42

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5308, Acc=0.7384, AUC=0.8098, TPR=0.6928, TNR=0.7845, J=0.4773, MCC=0.4791, ConfusionMatrix=
[[2846  782]
 [1128 2544]]
Epoch 4, Phase val, Loss=0.5606, Acc=0.7588, AUC=0.7629, TPR=0.5515, TNR=0.7958, J=0.3473, MCC=0.2850, ConfusionMatrix=
[[1730  444]
 [ 174  214]]
Epoch 4, Phase test, Loss=0.5736, Acc=0.7614, AUC=0.7584, TPR=0.6290, TNR=0.7842, J=0.4132, MCC=0.3271, ConfusionMatrix=
[[1693  466]
 [ 138  234]]
Epoch 4 complete in 87.99

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5285, Acc=0.7421, AUC=0.8119, TPR=0.6818, TNR=0.8041, J=0.4859, MCC=0.4891, ConfusionMatrix=
[[2893  705]
 [1178 2524]]
Epoch 5, Phase val, Loss=0.5925, Acc=0.7381, AUC=0.7612, TPR=0.6237, TNR=0.7585, J=0.3822, MCC=0.2992, ConfusionMatrix=
[[1649  525]
 [ 146  242]]
Epoch 5, Phase test, Loss=0.5952, Acc=0.7436, AUC=0.7523, TPR=0.6398, TNR=0.7615, J=0.4012, MCC=0.3108, ConfusionMatrix=
[[1644  515]
 [ 134  238]]
Epoch 5 complete in 86.08

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5384, Acc=0.7326, AUC=0.8037, TPR=0.6874, TNR=0.7786, J=0.4660, MCC=0.4678, ConfusionMatrix=
[[2817  801]
 [1151 2531]]
Epoch 6, Phase val, Loss=0.5461, Acc=0.7767, AUC=0.7675, TPR=0.5722, TNR=0.8132, J=0.3854, MCC=0.3212, ConfusionMatrix=
[[1768  406]
 [ 166  222]]
New Best AUC=0.7675. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5455, Acc=0.7752, AUC=0.7592, TPR=0.6022, TNR=0.8050, J=0.4072, MCC=0.3308, ConfusionMatrix=
[[1738  421]
 [ 148  224]]
Epoch 6 complete in 87.83

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5163, Acc=0.7507, AUC=0.8222, TPR=0.6969, TNR=0.8046, J=0.5014, MCC=0.5043, ConfusionMatrix=
[[2935  713]
 [1107 2545]]
Epoch 7, Phase val, Loss=0.4952, Acc=0.7923, AUC=0.7801, TPR=0.5438, TNR=0.8367, J=0.3805, MCC=0.3288, ConfusionMatrix=
[[1819  355]
 [ 177  211]]
New Best AUC=0.7801. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5031, Acc=0.7930, AUC=0.7644, TPR=0.5860, TNR=0.8286, J=0.4146, MCC=0.3477, ConfusionMatrix=
[[1789  370]
 [ 154  218]]
Epoch 7 complete in 87.62

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5076, Acc=0.7595, AUC=0.8291, TPR=0.7203, TNR=0.7996, J=0.5198, MCC=0.5212, ConfusionMatrix=
[[2884  723]
 [1033 2660]]
Epoch 8, Phase val, Loss=0.4852, Acc=0.8251, AUC=0.7793, TPR=0.5541, TNR=0.8735, J=0.4276, MCC=0.3898, ConfusionMatrix=
[[1899  275]
 [ 173  215]]
Epoch 8, Phase test, Loss=0.4908, Acc=0.8167, AUC=0.7532, TPR=0.5511, TNR=0.8624, J=0.4135, MCC=0.3672, ConfusionMatrix=
[[1862  297]
 [ 167  205]]
Epoch 8 complete in 88.83

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4934, Acc=0.7689, AUC=0.8399, TPR=0.7286, TNR=0.8083, J=0.5370, MCC=0.5389, ConfusionMatrix=
[[2982  707]
 [ 980 2631]]
Epoch 9, Phase val, Loss=0.4845, Acc=0.8099, AUC=0.7783, TPR=0.5567, TNR=0.8551, J=0.4118, MCC=0.3642, ConfusionMatrix=
[[1859  315]
 [ 172  216]]
Epoch 9, Phase test, Loss=0.4892, Acc=0.8111, AUC=0.7425, TPR=0.5618, TNR=0.8541, J=0.4159, MCC=0.3635, ConfusionMatrix=
[[1844  315]
 [ 163  209]]
Epoch 9 complete in 86.88

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4977, Acc=0.7625, AUC=0.8353, TPR=0.7272, TNR=0.7982, J=0.5255, MCC=0.5266, ConfusionMatrix=
[[2892  731]
 [1003 2674]]
Epoch 10, Phase val, Loss=0.4987, Acc=0.8107, AUC=0.7994, TPR=0.5722, TNR=0.8533, J=0.4254, MCC=0.3737, ConfusionMatrix=
[[1855  319]
 [ 166  222]]
New Best AUC=0.7994. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.5227, Acc=0.7926, AUC=0.7667, TPR=0.5806, TNR=0.8291, J=0.4097, MCC=0.3442, ConfusionMatrix=
[[1790  369]
 [ 156  216]]
Epoch 10 complete in 87.10

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4742, Acc=0.7816, AUC=0.8523, TPR=0.7406, TNR=0.8231, J=0.5637, MCC=0.5655, ConfusionMatrix=
[[2988  642]
 [ 952 2718]]
Epoch 11, Phase val, Loss=0.5025, Acc=0.8021, AUC=0.7776, TPR=0.5851, TNR=0.8408, J=0.4259, MCC=0.3664, ConfusionMatrix=
[[1828  346]
 [ 161  227]]
Epoch 11, Phase test, Loss=0.5136, Acc=0.7938, AUC=0.7604, TPR=0.5833, TNR=0.8300, J=0.4133, MCC=0.3474, ConfusionMatrix=
[[1792  367]
 [ 155  217]]
Epoch 11 complete in 87.58

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4803, Acc=0.7796, AUC=0.8509, TPR=0.7593, TNR=0.8003, J=0.5596, MCC=0.5599, ConfusionMatrix=
[[2889  721]
 [ 888 2802]]
Epoch 12, Phase val, Loss=0.5857, Acc=0.7494, AUC=0.7900, TPR=0.6856, TNR=0.7608, J=0.4464, MCC=0.3470, ConfusionMatrix=
[[1654  520]
 [ 122  266]]
Epoch 12, Phase test, Loss=0.6221, Acc=0.7290, AUC=0.7735, TPR=0.6828, TNR=0.7369, J=0.4197, MCC=0.3174, ConfusionMatrix=
[[1591  568]
 [ 118  254]]
Epoch 12 complete in 86.12

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4701, Acc=0.7866, AUC=0.8561, TPR=0.7469, TNR=0.8251, J=0.5721, MCC=0.5742, ConfusionMatrix=
[[3053  647]
 [ 911 2689]]
Epoch 13, Phase val, Loss=0.4914, Acc=0.8099, AUC=0.7913, TPR=0.5979, TNR=0.8477, J=0.4457, MCC=0.3858, ConfusionMatrix=
[[1843  331]
 [ 156  232]]
Epoch 13, Phase test, Loss=0.5190, Acc=0.7910, AUC=0.7484, TPR=0.5753, TNR=0.8282, J=0.4034, MCC=0.3389, ConfusionMatrix=
[[1788  371]
 [ 158  214]]
Epoch 13 complete in 86.66

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4862, Acc=0.7801, AUC=0.8463, TPR=0.7636, TNR=0.7974, J=0.5610, MCC=0.5610, ConfusionMatrix=
[[2850  724]
 [ 881 2845]]
Epoch 14, Phase val, Loss=0.4871, Acc=0.7978, AUC=0.7852, TPR=0.6134, TNR=0.8307, J=0.4441, MCC=0.3747, ConfusionMatrix=
[[1806  368]
 [ 150  238]]
Epoch 14, Phase test, Loss=0.5109, Acc=0.7910, AUC=0.7554, TPR=0.6183, TNR=0.8208, J=0.4390, MCC=0.3621, ConfusionMatrix=
[[1772  387]
 [ 142  230]]
Epoch 14 complete in 86.21

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4720, Acc=0.7805, AUC=0.8560, TPR=0.7505, TNR=0.8117, J=0.5622, MCC=0.5628, ConfusionMatrix=
[[2909  675]
 [ 927 2789]]
Epoch 15, Phase val, Loss=0.4539, Acc=0.8236, AUC=0.7815, TPR=0.5490, TNR=0.8726, J=0.4216, MCC=0.3842, ConfusionMatrix=
[[1897  277]
 [ 175  213]]
Epoch 15, Phase test, Loss=0.4685, Acc=0.8123, AUC=0.7542, TPR=0.5726, TNR=0.8536, J=0.4262, MCC=0.3712, ConfusionMatrix=
[[1843  316]
 [ 159  213]]
Epoch 15 complete in 88.03

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4671, Acc=0.7842, AUC=0.8603, TPR=0.7629, TNR=0.8058, J=0.5688, MCC=0.5692, ConfusionMatrix=
[[2922  704]
 [ 871 2803]]
Epoch 16, Phase val, Loss=0.4372, Acc=0.8201, AUC=0.7855, TPR=0.6005, TNR=0.8592, J=0.4598, MCC=0.4044, ConfusionMatrix=
[[1868  306]
 [ 155  233]]
Epoch 16, Phase test, Loss=0.4560, Acc=0.8167, AUC=0.7597, TPR=0.5699, TNR=0.8592, J=0.4291, MCC=0.3771, ConfusionMatrix=
[[1855  304]
 [ 160  212]]
Epoch 16 complete in 86.47

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4526, Acc=0.7992, AUC=0.8689, TPR=0.7747, TNR=0.8240, J=0.5986, MCC=0.5993, ConfusionMatrix=
[[2991  639]
 [ 827 2843]]
Epoch 17, Phase val, Loss=0.5249, Acc=0.7705, AUC=0.7813, TPR=0.6469, TNR=0.7925, J=0.4395, MCC=0.3532, ConfusionMatrix=
[[1723  451]
 [ 137  251]]
Epoch 17, Phase test, Loss=0.5374, Acc=0.7649, AUC=0.7827, TPR=0.6532, TNR=0.7842, J=0.4374, MCC=0.3449, ConfusionMatrix=
[[1693  466]
 [ 129  243]]
Epoch 17 complete in 88.02

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4610, Acc=0.7942, AUC=0.8649, TPR=0.7838, TNR=0.8049, J=0.5886, MCC=0.5887, ConfusionMatrix=
[[2920  708]
 [ 794 2878]]
Epoch 18, Phase val, Loss=0.4618, Acc=0.8103, AUC=0.7675, TPR=0.6211, TNR=0.8441, J=0.4652, MCC=0.3985, ConfusionMatrix=
[[1835  339]
 [ 147  241]]
Epoch 18, Phase test, Loss=0.4681, Acc=0.8107, AUC=0.7456, TPR=0.5430, TNR=0.8569, J=0.3999, MCC=0.3527, ConfusionMatrix=
[[1850  309]
 [ 170  202]]
Epoch 18 complete in 86.27

Early Stop!
Training complete in 27m 38s
The best model val AUC=0.79941601305, test AUC=0.766726680512.
Finish training resnet50scratch-conv1x1-maxpool

Start training resnet50scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6725, Acc=0.6158, AUC=0.6770, TPR=0.5873, TNR=0.6445, J=0.2318, MCC=0.2322, ConfusionMatrix=
[[2339 1290]
 [1515 2156]]
Epoch 0, Phase val, Loss=0.4625, Acc=0.8322, AUC=0.7025, TPR=0.3325, TNR=0.9213, J=0.2538, MCC=0.2830, ConfusionMatrix=
[[2003  171]
 [ 259  129]]
New Best AUC=0.7025. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4475, Acc=0.8372, AUC=0.7063, TPR=0.3333, TNR=0.9240, J=0.2574, MCC=0.2870, ConfusionMatrix=
[[1995  164]
 [ 248  124]]
Epoch 0 complete in 88.35

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.6018, Acc=0.6774, AUC=0.7451, TPR=0.6292, TNR=0.7270, J=0.3563, MCC=0.3578, ConfusionMatrix=
[[2613  981]
 [1374 2332]]
Epoch 1, Phase val, Loss=0.5654, Acc=0.7791, AUC=0.7575, TPR=0.5309, TNR=0.8234, J=0.3543, MCC=0.3017, ConfusionMatrix=
[[1790  384]
 [ 182  206]]
New Best AUC=0.7575. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5603, Acc=0.7918, AUC=0.7561, TPR=0.5860, TNR=0.8272, J=0.4133, MCC=0.3459, ConfusionMatrix=
[[1786  373]
 [ 154  218]]
Epoch 1 complete in 88.37

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5649, Acc=0.7041, AUC=0.7802, TPR=0.6721, TNR=0.7373, J=0.4094, MCC=0.4100, ConfusionMatrix=
[[2641  941]
 [1219 2499]]
Epoch 2, Phase val, Loss=0.4947, Acc=0.8013, AUC=0.7608, TPR=0.4948, TNR=0.8560, J=0.3509, MCC=0.3162, ConfusionMatrix=
[[1861  313]
 [ 196  192]]
New Best AUC=0.7608. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4813, Acc=0.8226, AUC=0.7454, TPR=0.4758, TNR=0.8824, J=0.3582, MCC=0.3374, ConfusionMatrix=
[[1905  254]
 [ 195  177]]
Epoch 2 complete in 87.63

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5369, Acc=0.7290, AUC=0.8054, TPR=0.6754, TNR=0.7808, J=0.4562, MCC=0.4591, ConfusionMatrix=
[[2900  814]
 [1164 2422]]
Epoch 3, Phase val, Loss=0.5330, Acc=0.7767, AUC=0.7708, TPR=0.5464, TNR=0.8178, J=0.3642, MCC=0.3069, ConfusionMatrix=
[[1778  396]
 [ 176  212]]
New Best AUC=0.7708. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5222, Acc=0.7851, AUC=0.7492, TPR=0.5430, TNR=0.8268, J=0.3698, MCC=0.3123, ConfusionMatrix=
[[1785  374]
 [ 170  202]]
Epoch 3 complete in 88.10

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5259, Acc=0.7467, AUC=0.8162, TPR=0.7036, TNR=0.7892, J=0.4928, MCC=0.4948, ConfusionMatrix=
[[2902  775]
 [1074 2549]]
Epoch 4, Phase val, Loss=0.5397, Acc=0.7888, AUC=0.7665, TPR=0.5902, TNR=0.8243, J=0.4145, MCC=0.3487, ConfusionMatrix=
[[1792  382]
 [ 159  229]]
Epoch 4, Phase test, Loss=0.5280, Acc=0.7874, AUC=0.7576, TPR=0.5780, TNR=0.8235, J=0.4015, MCC=0.3350, ConfusionMatrix=
[[1778  381]
 [ 157  215]]
Epoch 4 complete in 90.38

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5212, Acc=0.7490, AUC=0.8212, TPR=0.7128, TNR=0.7864, J=0.4992, MCC=0.5002, ConfusionMatrix=
[[2827  768]
 [1064 2641]]
Epoch 5, Phase val, Loss=0.5160, Acc=0.7689, AUC=0.7441, TPR=0.5077, TNR=0.8155, J=0.3233, MCC=0.2740, ConfusionMatrix=
[[1773  401]
 [ 191  197]]
Epoch 5, Phase test, Loss=0.5097, Acc=0.7756, AUC=0.7328, TPR=0.5242, TNR=0.8189, J=0.3431, MCC=0.2880, ConfusionMatrix=
[[1768  391]
 [ 177  195]]
Epoch 5 complete in 88.32

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5243, Acc=0.7464, AUC=0.8174, TPR=0.7142, TNR=0.7784, J=0.4926, MCC=0.4937, ConfusionMatrix=
[[2853  812]
 [1039 2596]]
Epoch 6, Phase val, Loss=0.5706, Acc=0.7490, AUC=0.7669, TPR=0.6186, TNR=0.7723, J=0.3909, MCC=0.3098, ConfusionMatrix=
[[1679  495]
 [ 148  240]]
Epoch 6, Phase test, Loss=0.5809, Acc=0.7365, AUC=0.7443, TPR=0.6075, TNR=0.7587, J=0.3662, MCC=0.2843, ConfusionMatrix=
[[1638  521]
 [ 146  226]]
Epoch 6 complete in 87.42

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5174, Acc=0.7492, AUC=0.8245, TPR=0.7286, TNR=0.7705, J=0.4991, MCC=0.4993, ConfusionMatrix=
[[2760  822]
 [1009 2709]]
Epoch 7, Phase val, Loss=0.5797, Acc=0.7358, AUC=0.7860, TPR=0.6778, TNR=0.7461, J=0.4239, MCC=0.3263, ConfusionMatrix=
[[1622  552]
 [ 125  263]]
New Best AUC=0.7860. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5939, Acc=0.7218, AUC=0.7690, TPR=0.6855, TNR=0.7281, J=0.4136, MCC=0.3108, ConfusionMatrix=
[[1572  587]
 [ 117  255]]
Epoch 7 complete in 89.21

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5100, Acc=0.7562, AUC=0.8285, TPR=0.7154, TNR=0.7974, J=0.5128, MCC=0.5144, ConfusionMatrix=
[[2893  735]
 [1045 2627]]
Epoch 8, Phase val, Loss=0.4500, Acc=0.8107, AUC=0.7833, TPR=0.5284, TNR=0.8611, J=0.3894, MCC=0.3504, ConfusionMatrix=
[[1872  302]
 [ 183  205]]
Epoch 8, Phase test, Loss=0.4439, Acc=0.8246, AUC=0.7574, TPR=0.5457, TNR=0.8726, J=0.4183, MCC=0.3784, ConfusionMatrix=
[[1884  275]
 [ 169  203]]
Epoch 8 complete in 87.00

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4875, Acc=0.7775, AUC=0.8465, TPR=0.7563, TNR=0.7994, J=0.5557, MCC=0.5560, ConfusionMatrix=
[[2877  722]
 [ 902 2799]]
Epoch 9, Phase val, Loss=0.4114, Acc=0.8224, AUC=0.7681, TPR=0.4639, TNR=0.8864, J=0.3503, MCC=0.3370, ConfusionMatrix=
[[1927  247]
 [ 208  180]]
Epoch 9, Phase test, Loss=0.4150, Acc=0.8285, AUC=0.7275, TPR=0.4382, TNR=0.8958, J=0.3340, MCC=0.3282, ConfusionMatrix=
[[1934  225]
 [ 209  163]]
Epoch 9 complete in 89.11

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5061, Acc=0.7575, AUC=0.8320, TPR=0.7194, TNR=0.7960, J=0.5153, MCC=0.5168, ConfusionMatrix=
[[2895  742]
 [1028 2635]]
Epoch 10, Phase val, Loss=0.5178, Acc=0.8037, AUC=0.7494, TPR=0.5619, TNR=0.8468, J=0.4087, MCC=0.3566, ConfusionMatrix=
[[1841  333]
 [ 170  218]]
Epoch 10, Phase test, Loss=0.5112, Acc=0.7942, AUC=0.7334, TPR=0.5430, TNR=0.8374, J=0.3804, MCC=0.3260, ConfusionMatrix=
[[1808  351]
 [ 170  202]]
Epoch 10 complete in 89.10

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4702, Acc=0.7847, AUC=0.8579, TPR=0.7513, TNR=0.8177, J=0.5690, MCC=0.5704, ConfusionMatrix=
[[2997  668]
 [ 904 2731]]
Epoch 11, Phase val, Loss=0.5171, Acc=0.7955, AUC=0.7697, TPR=0.6082, TNR=0.8289, J=0.4371, MCC=0.3683, ConfusionMatrix=
[[1802  372]
 [ 152  236]]
Epoch 11, Phase test, Loss=0.5169, Acc=0.7847, AUC=0.7504, TPR=0.5860, TNR=0.8189, J=0.4049, MCC=0.3354, ConfusionMatrix=
[[1768  391]
 [ 154  218]]
Epoch 11 complete in 88.80

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4668, Acc=0.7879, AUC=0.8608, TPR=0.7707, TNR=0.8059, J=0.5766, MCC=0.5766, ConfusionMatrix=
[[2881  694]
 [ 854 2871]]
Epoch 12, Phase val, Loss=0.5249, Acc=0.7998, AUC=0.7644, TPR=0.6237, TNR=0.8312, J=0.4549, MCC=0.3831, ConfusionMatrix=
[[1807  367]
 [ 146  242]]
Epoch 12, Phase test, Loss=0.5257, Acc=0.7772, AUC=0.7505, TPR=0.5645, TNR=0.8138, J=0.3783, MCC=0.3129, ConfusionMatrix=
[[1757  402]
 [ 162  210]]
Epoch 12 complete in 87.19

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4615, Acc=0.7919, AUC=0.8650, TPR=0.7746, TNR=0.8094, J=0.5841, MCC=0.5843, ConfusionMatrix=
[[2935  691]
 [ 828 2846]]
Epoch 13, Phase val, Loss=0.4760, Acc=0.8173, AUC=0.7857, TPR=0.6134, TNR=0.8537, J=0.4671, MCC=0.4062, ConfusionMatrix=
[[1856  318]
 [ 150  238]]
Epoch 13, Phase test, Loss=0.4994, Acc=0.7914, AUC=0.7520, TPR=0.5753, TNR=0.8286, J=0.4039, MCC=0.3394, ConfusionMatrix=
[[1789  370]
 [ 158  214]]
Epoch 13 complete in 87.98

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4679, Acc=0.7862, AUC=0.8604, TPR=0.7612, TNR=0.8130, J=0.5742, MCC=0.5741, ConfusionMatrix=
[[2861  658]
 [ 903 2878]]
Epoch 14, Phase val, Loss=0.6068, Acc=0.7627, AUC=0.7765, TPR=0.6830, TNR=0.7769, J=0.4599, MCC=0.3623, ConfusionMatrix=
[[1689  485]
 [ 123  265]]
Epoch 14, Phase test, Loss=0.6132, Acc=0.7483, AUC=0.7627, TPR=0.6505, TNR=0.7652, J=0.4157, MCC=0.3225, ConfusionMatrix=
[[1652  507]
 [ 130  242]]
Epoch 14 complete in 92.33

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4624, Acc=0.7912, AUC=0.8625, TPR=0.7633, TNR=0.8186, J=0.5819, MCC=0.5830, ConfusionMatrix=
[[3019  669]
 [ 855 2757]]
Epoch 15, Phase val, Loss=0.4788, Acc=0.8123, AUC=0.7818, TPR=0.6186, TNR=0.8468, J=0.4654, MCC=0.4004, ConfusionMatrix=
[[1841  333]
 [ 148  240]]
Epoch 15, Phase test, Loss=0.4896, Acc=0.8028, AUC=0.7630, TPR=0.5565, TNR=0.8453, J=0.4018, MCC=0.3470, ConfusionMatrix=
[[1825  334]
 [ 165  207]]
Epoch 15 complete in 103.60

Early Stop!
Training complete in 23m 53s
The best model val AUC=0.785967478827, test AUC=0.768976577169.
Finish training resnet50scratch-conv1x1-maxpool

Start training resnet50scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6226, Acc=0.6519, AUC=0.7222, TPR=0.6125, TNR=0.6918, J=0.3043, MCC=0.3052, ConfusionMatrix=
[[2510 1118]
 [1423 2249]]
Epoch 0, Phase val, Loss=0.5982, Acc=0.7724, AUC=0.7609, TPR=0.5773, TNR=0.8073, J=0.3846, MCC=0.3180, ConfusionMatrix=
[[1755  419]
 [ 164  224]]
New Best AUC=0.7609. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5763, Acc=0.7633, AUC=0.7594, TPR=0.6075, TNR=0.7902, J=0.3977, MCC=0.3178, ConfusionMatrix=
[[1706  453]
 [ 146  226]]
Epoch 0 complete in 89.67

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5762, Acc=0.7015, AUC=0.7741, TPR=0.6555, TNR=0.7470, J=0.4025, MCC=0.4042, ConfusionMatrix=
[[2743  929]
 [1250 2378]]
Epoch 1, Phase val, Loss=1.0406, Acc=0.6507, AUC=0.7705, TPR=0.7320, TNR=0.6362, J=0.3681, MCC=0.2674, ConfusionMatrix=
[[1383  791]
 [ 104  284]]
New Best AUC=0.7705. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=1.0258, Acc=0.6262, AUC=0.7566, TPR=0.7366, TNR=0.6072, J=0.3438, MCC=0.2450, ConfusionMatrix=
[[1311  848]
 [  98  274]]
Epoch 1 complete in 95.04

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5803, Acc=0.7156, AUC=0.7803, TPR=0.6588, TNR=0.7722, J=0.4310, MCC=0.4339, ConfusionMatrix=
[[2824  833]
 [1243 2400]]
Epoch 2, Phase val, Loss=0.6967, Acc=0.7116, AUC=0.7761, TPR=0.6985, TNR=0.7139, J=0.4123, MCC=0.3102, ConfusionMatrix=
[[1552  622]
 [ 117  271]]
New Best AUC=0.7761. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6701, Acc=0.6756, AUC=0.7707, TPR=0.7124, TNR=0.6693, J=0.3817, MCC=0.2775, ConfusionMatrix=
[[1445  714]
 [ 107  265]]
Epoch 2 complete in 91.45

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5384, Acc=0.7295, AUC=0.8062, TPR=0.6700, TNR=0.7890, J=0.4591, MCC=0.4623, ConfusionMatrix=
[[2876  769]
 [1206 2449]]
Epoch 3, Phase val, Loss=0.4964, Acc=0.8189, AUC=0.7844, TPR=0.5129, TNR=0.8735, J=0.3864, MCC=0.3567, ConfusionMatrix=
[[1899  275]
 [ 189  199]]
New Best AUC=0.7844. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.4734, Acc=0.8297, AUC=0.7799, TPR=0.5269, TNR=0.8819, J=0.4088, MCC=0.3782, ConfusionMatrix=
[[1904  255]
 [ 176  196]]
Epoch 3 complete in 102.96

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5311, Acc=0.7460, AUC=0.8153, TPR=0.6840, TNR=0.8068, J=0.4908, MCC=0.4949, ConfusionMatrix=
[[2974  712]
 [1142 2472]]
Epoch 4, Phase val, Loss=0.4668, Acc=0.8286, AUC=0.7861, TPR=0.4820, TNR=0.8905, J=0.3725, MCC=0.3590, ConfusionMatrix=
[[1936  238]
 [ 201  187]]
New Best AUC=0.7861. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4367, Acc=0.8475, AUC=0.7814, TPR=0.5081, TNR=0.9060, J=0.4140, MCC=0.4052, ConfusionMatrix=
[[1956  203]
 [ 183  189]]
Epoch 4 complete in 90.69

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5134, Acc=0.7521, AUC=0.8264, TPR=0.6816, TNR=0.8200, J=0.5016, MCC=0.5070, ConfusionMatrix=
[[3048  669]
 [1141 2442]]
Epoch 5, Phase val, Loss=0.8632, Acc=0.7034, AUC=0.7845, TPR=0.7268, TNR=0.6992, J=0.4260, MCC=0.3171, ConfusionMatrix=
[[1520  654]
 [ 106  282]]
Epoch 5, Phase test, Loss=0.8050, Acc=0.6725, AUC=0.7733, TPR=0.7204, TNR=0.6642, J=0.3846, MCC=0.2789, ConfusionMatrix=
[[1434  725]
 [ 104  268]]
Epoch 5 complete in 91.05

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5102, Acc=0.7588, AUC=0.8313, TPR=0.7083, TNR=0.8084, J=0.5167, MCC=0.5195, ConfusionMatrix=
[[2975  705]
 [1056 2564]]
Epoch 6, Phase val, Loss=0.5333, Acc=0.7670, AUC=0.7841, TPR=0.6366, TNR=0.7902, J=0.4268, MCC=0.3429, ConfusionMatrix=
[[1718  456]
 [ 141  247]]
Epoch 6, Phase test, Loss=0.5271, Acc=0.7831, AUC=0.7595, TPR=0.6371, TNR=0.8082, J=0.4453, MCC=0.3608, ConfusionMatrix=
[[1745  414]
 [ 135  237]]
Epoch 6 complete in 92.36

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5103, Acc=0.7567, AUC=0.8293, TPR=0.7014, TNR=0.8126, J=0.5141, MCC=0.5171, ConfusionMatrix=
[[2949  680]
 [1096 2575]]
Epoch 7, Phase val, Loss=0.4111, Acc=0.8521, AUC=0.7871, TPR=0.4485, TNR=0.9241, J=0.3726, MCC=0.3942, ConfusionMatrix=
[[2009  165]
 [ 214  174]]
New Best AUC=0.7871. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.4110, Acc=0.8487, AUC=0.7612, TPR=0.4328, TNR=0.9203, J=0.3531, MCC=0.3699, ConfusionMatrix=
[[1987  172]
 [ 211  161]]
Epoch 7 complete in 88.50

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5177, Acc=0.7560, AUC=0.8285, TPR=0.7078, TNR=0.8047, J=0.5126, MCC=0.5148, ConfusionMatrix=
[[2922  709]
 [1072 2597]]
Epoch 8, Phase val, Loss=0.4737, Acc=0.8380, AUC=0.7880, TPR=0.5026, TNR=0.8979, J=0.4005, MCC=0.3889, ConfusionMatrix=
[[1952  222]
 [ 193  195]]
New Best AUC=0.7880. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.4460, Acc=0.8435, AUC=0.7722, TPR=0.4543, TNR=0.9106, J=0.3649, MCC=0.3691, ConfusionMatrix=
[[1966  193]
 [ 203  169]]
Epoch 8 complete in 105.49

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5552, Acc=0.7401, AUC=0.8087, TPR=0.6885, TNR=0.7918, J=0.4803, MCC=0.4829, ConfusionMatrix=
[[2890  760]
 [1137 2513]]
Epoch 9, Phase val, Loss=0.5847, Acc=0.7760, AUC=0.7941, TPR=0.6546, TNR=0.7976, J=0.4522, MCC=0.3648, ConfusionMatrix=
[[1734  440]
 [ 134  254]]
New Best AUC=0.7941. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.5536, Acc=0.7752, AUC=0.7908, TPR=0.6505, TNR=0.7967, J=0.4472, MCC=0.3571, ConfusionMatrix=
[[1720  439]
 [ 130  242]]
Epoch 9 complete in 92.82

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5077, Acc=0.7675, AUC=0.8406, TPR=0.7092, TNR=0.8256, J=0.5348, MCC=0.5385, ConfusionMatrix=
[[3020  638]
 [1059 2583]]
Epoch 10, Phase val, Loss=0.5111, Acc=0.8052, AUC=0.7918, TPR=0.6418, TNR=0.8344, J=0.4762, MCC=0.4010, ConfusionMatrix=
[[1814  360]
 [ 139  249]]
Epoch 10, Phase test, Loss=0.4909, Acc=0.7942, AUC=0.7747, TPR=0.6048, TNR=0.8268, J=0.4316, MCC=0.3596, ConfusionMatrix=
[[1785  374]
 [ 147  225]]
Epoch 10 complete in 95.60

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5029, Acc=0.7679, AUC=0.8394, TPR=0.7159, TNR=0.8216, J=0.5375, MCC=0.5400, ConfusionMatrix=
[[2952  641]
 [1053 2654]]
Epoch 11, Phase val, Loss=0.5934, Acc=0.7896, AUC=0.7923, TPR=0.6289, TNR=0.8183, J=0.4472, MCC=0.3705, ConfusionMatrix=
[[1779  395]
 [ 144  244]]
Epoch 11, Phase test, Loss=0.5472, Acc=0.7910, AUC=0.7927, TPR=0.6317, TNR=0.8184, J=0.4502, MCC=0.3692, ConfusionMatrix=
[[1767  392]
 [ 137  235]]
Epoch 11 complete in 88.62

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4740, Acc=0.7886, AUC=0.8594, TPR=0.7424, TNR=0.8335, J=0.5759, MCC=0.5787, ConfusionMatrix=
[[3088  617]
 [ 926 2669]]
Epoch 12, Phase val, Loss=0.4728, Acc=0.8263, AUC=0.7837, TPR=0.5103, TNR=0.8827, J=0.3930, MCC=0.3693, ConfusionMatrix=
[[1919  255]
 [ 190  198]]
Epoch 12, Phase test, Loss=0.4684, Acc=0.8297, AUC=0.7867, TPR=0.5296, TNR=0.8814, J=0.4110, MCC=0.3796, ConfusionMatrix=
[[1903  256]
 [ 175  197]]
Epoch 12 complete in 90.75

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4795, Acc=0.7859, AUC=0.8561, TPR=0.7362, TNR=0.8349, J=0.5711, MCC=0.5741, ConfusionMatrix=
[[3069  607]
 [ 956 2668]]
Epoch 13, Phase val, Loss=0.4302, Acc=0.8372, AUC=0.8037, TPR=0.5232, TNR=0.8933, J=0.4165, MCC=0.3977, ConfusionMatrix=
[[1942  232]
 [ 185  203]]
New Best AUC=0.8037. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 13, Phase test, Loss=0.4295, Acc=0.8376, AUC=0.7958, TPR=0.5484, TNR=0.8874, J=0.4358, MCC=0.4047, ConfusionMatrix=
[[1916  243]
 [ 168  204]]
Epoch 13 complete in 92.68

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4693, Acc=0.7932, AUC=0.8637, TPR=0.7570, TNR=0.8299, J=0.5869, MCC=0.5882, ConfusionMatrix=
[[3005  616]
 [ 894 2785]]
Epoch 14, Phase val, Loss=0.5938, Acc=0.7900, AUC=0.8038, TPR=0.6546, TNR=0.8142, J=0.4688, MCC=0.3847, ConfusionMatrix=
[[1770  404]
 [ 134  254]]
New Best AUC=0.8038. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 14, Phase test, Loss=0.5680, Acc=0.7772, AUC=0.8002, TPR=0.6694, TNR=0.7957, J=0.4651, MCC=0.3698, ConfusionMatrix=
[[1718  441]
 [ 123  249]]
Epoch 14 complete in 101.81

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4767, Acc=0.7893, AUC=0.8578, TPR=0.7552, TNR=0.8230, J=0.5782, MCC=0.5797, ConfusionMatrix=
[[3023  650]
 [ 888 2739]]
Epoch 15, Phase val, Loss=0.5952, Acc=0.7611, AUC=0.7760, TPR=0.6546, TNR=0.7801, J=0.4348, MCC=0.3450, ConfusionMatrix=
[[1696  478]
 [ 134  254]]
Epoch 15, Phase test, Loss=0.5334, Acc=0.7724, AUC=0.7917, TPR=0.6882, TNR=0.7869, J=0.4751, MCC=0.3735, ConfusionMatrix=
[[1699  460]
 [ 116  256]]
Epoch 15 complete in 87.84

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4736, Acc=0.7899, AUC=0.8591, TPR=0.7487, TNR=0.8303, J=0.5790, MCC=0.5812, ConfusionMatrix=
[[3058  625]
 [ 909 2708]]
Epoch 16, Phase val, Loss=0.3968, Acc=0.8361, AUC=0.7701, TPR=0.3325, TNR=0.9259, J=0.2584, MCC=0.2924, ConfusionMatrix=
[[2013  161]
 [ 259  129]]
Epoch 16, Phase test, Loss=0.3651, Acc=0.8586, AUC=0.7773, TPR=0.3790, TNR=0.9412, J=0.3202, MCC=0.3685, ConfusionMatrix=
[[2032  127]
 [ 231  141]]
Epoch 16 complete in 90.75

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4619, Acc=0.7914, AUC=0.8662, TPR=0.7432, TNR=0.8376, J=0.5808, MCC=0.5840, ConfusionMatrix=
[[3120  605]
 [ 918 2657]]
Epoch 17, Phase val, Loss=0.5622, Acc=0.7920, AUC=0.7711, TPR=0.5876, TNR=0.8284, J=0.4161, MCC=0.3520, ConfusionMatrix=
[[1801  373]
 [ 160  228]]
Epoch 17, Phase test, Loss=0.5381, Acc=0.8151, AUC=0.7674, TPR=0.6022, TNR=0.8518, J=0.4539, MCC=0.3913, ConfusionMatrix=
[[1839  320]
 [ 148  224]]
Epoch 17 complete in 103.25

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4555, Acc=0.7986, AUC=0.8708, TPR=0.7626, TNR=0.8344, J=0.5970, MCC=0.5986, ConfusionMatrix=
[[3058  607]
 [ 863 2772]]
Epoch 18, Phase val, Loss=0.4393, Acc=0.8283, AUC=0.7575, TPR=0.4794, TNR=0.8905, J=0.3699, MCC=0.3568, ConfusionMatrix=
[[1936  238]
 [ 202  186]]
Epoch 18, Phase test, Loss=0.4236, Acc=0.8360, AUC=0.7455, TPR=0.4328, TNR=0.9055, J=0.3383, MCC=0.3410, ConfusionMatrix=
[[1955  204]
 [ 211  161]]
Epoch 18 complete in 90.69

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4425, Acc=0.8037, AUC=0.8752, TPR=0.7715, TNR=0.8353, J=0.6069, MCC=0.6083, ConfusionMatrix=
[[3074  606]
 [ 827 2793]]
Epoch 19, Phase val, Loss=0.7426, Acc=0.6725, AUC=0.7889, TPR=0.7784, TNR=0.6536, J=0.4320, MCC=0.3147, ConfusionMatrix=
[[1421  753]
 [  86  302]]
Epoch 19, Phase test, Loss=0.7148, Acc=0.6669, AUC=0.7991, TPR=0.7742, TNR=0.6484, J=0.4226, MCC=0.3039, ConfusionMatrix=
[[1400  759]
 [  84  288]]
Epoch 19 complete in 92.87

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4484, Acc=0.8022, AUC=0.8744, TPR=0.7700, TNR=0.8347, J=0.6047, MCC=0.6059, ConfusionMatrix=
[[3030  600]
 [ 844 2826]]
Epoch 20, Phase val, Loss=0.5686, Acc=0.7560, AUC=0.7686, TPR=0.6521, TNR=0.7746, J=0.4267, MCC=0.3371, ConfusionMatrix=
[[1684  490]
 [ 135  253]]
Epoch 20, Phase test, Loss=0.5321, Acc=0.7574, AUC=0.7877, TPR=0.6801, TNR=0.7707, J=0.4508, MCC=0.3499, ConfusionMatrix=
[[1664  495]
 [ 119  253]]
Epoch 20 complete in 91.59

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4450, Acc=0.7997, AUC=0.8760, TPR=0.7855, TNR=0.8146, J=0.6001, MCC=0.6000, ConfusionMatrix=
[[2909  662]
 [ 800 2929]]
Epoch 21, Phase val, Loss=0.4207, Acc=0.8337, AUC=0.7693, TPR=0.4665, TNR=0.8993, J=0.3658, MCC=0.3612, ConfusionMatrix=
[[1955  219]
 [ 207  181]]
Epoch 21, Phase test, Loss=0.4121, Acc=0.8372, AUC=0.7577, TPR=0.4973, TNR=0.8958, J=0.3931, MCC=0.3778, ConfusionMatrix=
[[1934  225]
 [ 187  185]]
Epoch 21 complete in 101.76

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4365, Acc=0.8118, AUC=0.8811, TPR=0.7816, TNR=0.8428, J=0.6244, MCC=0.6252, ConfusionMatrix=
[[3035  566]
 [ 808 2891]]
Epoch 22, Phase val, Loss=0.4211, Acc=0.8275, AUC=0.7718, TPR=0.4536, TNR=0.8942, J=0.3478, MCC=0.3414, ConfusionMatrix=
[[1944  230]
 [ 212  176]]
Epoch 22, Phase test, Loss=0.4027, Acc=0.8372, AUC=0.7714, TPR=0.4785, TNR=0.8990, J=0.3775, MCC=0.3680, ConfusionMatrix=
[[1941  218]
 [ 194  178]]
Epoch 22 complete in 88.35

Early Stop!
Training complete in 35m 57s
The best model val AUC=0.803809548649, test AUC=0.800199963145.
Finish training resnet50scratch-conv1x1-avgpool

Start training resnet50scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6511, Acc=0.6390, AUC=0.7053, TPR=0.5927, TNR=0.6841, J=0.2768, MCC=0.2780, ConfusionMatrix=
[[2532 1169]
 [1466 2133]]
Epoch 0, Phase val, Loss=1.1030, Acc=0.4945, AUC=0.7658, TPR=0.8686, TNR=0.4278, J=0.2963, MCC=0.2185, ConfusionMatrix=
[[ 930 1244]
 [  51  337]]
New Best AUC=0.7658. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=1.1113, Acc=0.4646, AUC=0.7486, TPR=0.8468, TNR=0.3988, J=0.2456, MCC=0.1809, ConfusionMatrix=
[[ 861 1298]
 [  57  315]]
Epoch 0 complete in 91.43

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5715, Acc=0.7011, AUC=0.7732, TPR=0.6332, TNR=0.7667, J=0.3999, MCC=0.4039, ConfusionMatrix=
[[2846  866]
 [1316 2272]]
Epoch 1, Phase val, Loss=1.2306, Acc=0.4664, AUC=0.7714, TPR=0.9201, TNR=0.3855, J=0.3056, MCC=0.2314, ConfusionMatrix=
[[ 838 1336]
 [  31  357]]
New Best AUC=0.7714. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=1.2142, Acc=0.4394, AUC=0.7543, TPR=0.8925, TNR=0.3613, J=0.2538, MCC=0.1920, ConfusionMatrix=
[[ 780 1379]
 [  40  332]]
Epoch 1 complete in 94.50

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5822, Acc=0.7056, AUC=0.7734, TPR=0.6463, TNR=0.7645, J=0.4109, MCC=0.4138, ConfusionMatrix=
[[2799  862]
 [1287 2352]]
Epoch 2, Phase val, Loss=0.6341, Acc=0.7818, AUC=0.7790, TPR=0.5696, TNR=0.8197, J=0.3893, MCC=0.3271, ConfusionMatrix=
[[1782  392]
 [ 167  221]]
New Best AUC=0.7790. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5942, Acc=0.7835, AUC=0.7661, TPR=0.6022, TNR=0.8147, J=0.4169, MCC=0.3425, ConfusionMatrix=
[[1759  400]
 [ 148  224]]
Epoch 2 complete in 88.36

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5399, Acc=0.7308, AUC=0.8042, TPR=0.6763, TNR=0.7864, J=0.4627, MCC=0.4653, ConfusionMatrix=
[[2843  772]
 [1193 2492]]
Epoch 3, Phase val, Loss=0.7048, Acc=0.7151, AUC=0.7815, TPR=0.6495, TNR=0.7268, J=0.3763, MCC=0.2868, ConfusionMatrix=
[[1580  594]
 [ 136  252]]
New Best AUC=0.7815. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6866, Acc=0.7053, AUC=0.7672, TPR=0.7016, TNR=0.7059, J=0.4075, MCC=0.3017, ConfusionMatrix=
[[1524  635]
 [ 111  261]]
Epoch 3 complete in 93.25

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.6111, Acc=0.6974, AUC=0.7674, TPR=0.6587, TNR=0.7356, J=0.3943, MCC=0.3956, ConfusionMatrix=
[[2702  971]
 [1238 2389]]
Epoch 4, Phase val, Loss=1.2163, Acc=0.6475, AUC=0.7842, TPR=0.7577, TNR=0.6279, J=0.3856, MCC=0.2792, ConfusionMatrix=
[[1365  809]
 [  94  294]]
New Best AUC=0.7842. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=1.1707, Acc=0.6282, AUC=0.7757, TPR=0.7823, TNR=0.6017, J=0.3839, MCC=0.2730, ConfusionMatrix=
[[1299  860]
 [  81  291]]
Epoch 4 complete in 92.23

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5615, Acc=0.7290, AUC=0.7990, TPR=0.6551, TNR=0.8007, J=0.4558, MCC=0.4611, ConfusionMatrix=
[[2969  739]
 [1239 2353]]
Epoch 5, Phase val, Loss=0.6651, Acc=0.8072, AUC=0.7804, TPR=0.5773, TNR=0.8482, J=0.4255, MCC=0.3705, ConfusionMatrix=
[[1844  330]
 [ 164  224]]
Epoch 5, Phase test, Loss=0.6163, Acc=0.8139, AUC=0.7747, TPR=0.5833, TNR=0.8536, J=0.4370, MCC=0.3795, ConfusionMatrix=
[[1843  316]
 [ 155  217]]
Epoch 5 complete in 104.83

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5060, Acc=0.7455, AUC=0.8291, TPR=0.6898, TNR=0.8008, J=0.4905, MCC=0.4937, ConfusionMatrix=
[[2934  730]
 [1128 2508]]
Epoch 6, Phase val, Loss=0.5696, Acc=0.7826, AUC=0.7916, TPR=0.6211, TNR=0.8114, J=0.4325, MCC=0.3562, ConfusionMatrix=
[[1764  410]
 [ 147  241]]
New Best AUC=0.7916. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5473, Acc=0.7803, AUC=0.7851, TPR=0.6344, TNR=0.8055, J=0.4399, MCC=0.3554, ConfusionMatrix=
[[1739  420]
 [ 136  236]]
Epoch 6 complete in 89.32

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5314, Acc=0.7386, AUC=0.8145, TPR=0.6689, TNR=0.8053, J=0.4742, MCC=0.4793, ConfusionMatrix=
[[3006  727]
 [1181 2386]]
Epoch 7, Phase val, Loss=0.4218, Acc=0.8478, AUC=0.7831, TPR=0.4407, TNR=0.9204, J=0.3611, MCC=0.3797, ConfusionMatrix=
[[2001  173]
 [ 217  171]]
Epoch 7, Phase test, Loss=0.4209, Acc=0.8455, AUC=0.7680, TPR=0.4220, TNR=0.9185, J=0.3405, MCC=0.3567, ConfusionMatrix=
[[1983  176]
 [ 215  157]]
Epoch 7 complete in 91.81

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5159, Acc=0.7549, AUC=0.8281, TPR=0.6919, TNR=0.8165, J=0.5084, MCC=0.5127, ConfusionMatrix=
[[3016  678]
 [1111 2495]]
Epoch 8, Phase val, Loss=0.4635, Acc=0.8240, AUC=0.7781, TPR=0.5206, TNR=0.8781, J=0.3987, MCC=0.3702, ConfusionMatrix=
[[1909  265]
 [ 186  202]]
Epoch 8, Phase test, Loss=0.4733, Acc=0.8167, AUC=0.7341, TPR=0.4731, TNR=0.8759, J=0.3490, MCC=0.3249, ConfusionMatrix=
[[1891  268]
 [ 196  176]]
Epoch 8 complete in 94.80

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5360, Acc=0.7560, AUC=0.8195, TPR=0.6880, TNR=0.8223, J=0.5103, MCC=0.5154, ConfusionMatrix=
[[3040  657]
 [1124 2479]]
Epoch 9, Phase val, Loss=0.7470, Acc=0.7490, AUC=0.7997, TPR=0.7088, TNR=0.7562, J=0.4650, MCC=0.3591, ConfusionMatrix=
[[1644  530]
 [ 113  275]]
New Best AUC=0.7997. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.7208, Acc=0.7392, AUC=0.7956, TPR=0.7285, TNR=0.7411, J=0.4696, MCC=0.3542, ConfusionMatrix=
[[1600  559]
 [ 101  271]]
Epoch 9 complete in 88.61

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4961, Acc=0.7668, AUC=0.8394, TPR=0.6948, TNR=0.8380, J=0.5328, MCC=0.5386, ConfusionMatrix=
[[3078  595]
 [1107 2520]]
Epoch 10, Phase val, Loss=0.5580, Acc=0.7884, AUC=0.7811, TPR=0.6495, TNR=0.8132, J=0.4627, MCC=0.3797, ConfusionMatrix=
[[1768  406]
 [ 136  252]]
Epoch 10, Phase test, Loss=0.5131, Acc=0.7898, AUC=0.7999, TPR=0.6694, TNR=0.8106, J=0.4799, MCC=0.3874, ConfusionMatrix=
[[1750  409]
 [ 123  249]]
Epoch 10 complete in 91.85

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4847, Acc=0.7756, AUC=0.8506, TPR=0.7315, TNR=0.8215, J=0.5530, MCC=0.5546, ConfusionMatrix=
[[2941  639]
 [ 999 2721]]
Epoch 11, Phase val, Loss=0.5879, Acc=0.7912, AUC=0.7947, TPR=0.6366, TNR=0.8188, J=0.4554, MCC=0.3769, ConfusionMatrix=
[[1780  394]
 [ 141  247]]
Epoch 11, Phase test, Loss=0.5671, Acc=0.7827, AUC=0.8046, TPR=0.6452, TNR=0.8064, J=0.4516, MCC=0.3645, ConfusionMatrix=
[[1741  418]
 [ 132  240]]
Epoch 11 complete in 90.50

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4826, Acc=0.7803, AUC=0.8523, TPR=0.7258, TNR=0.8334, J=0.5592, MCC=0.5628, ConfusionMatrix=
[[3081  616]
 [ 988 2615]]
Epoch 12, Phase val, Loss=0.5492, Acc=0.7756, AUC=0.7939, TPR=0.6598, TNR=0.7962, J=0.4560, MCC=0.3670, ConfusionMatrix=
[[1731  443]
 [ 132  256]]
Epoch 12, Phase test, Loss=0.5423, Acc=0.7637, AUC=0.7971, TPR=0.7124, TNR=0.7726, J=0.4849, MCC=0.3752, ConfusionMatrix=
[[1668  491]
 [ 107  265]]
Epoch 12 complete in 105.54

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4637, Acc=0.7886, AUC=0.8629, TPR=0.7447, TNR=0.8330, J=0.5776, MCC=0.5798, ConfusionMatrix=
[[3027  607]
 [ 936 2730]]
Epoch 13, Phase val, Loss=0.4440, Acc=0.8337, AUC=0.7742, TPR=0.5206, TNR=0.8896, J=0.4102, MCC=0.3892, ConfusionMatrix=
[[1934  240]
 [ 186  202]]
Epoch 13, Phase test, Loss=0.4107, Acc=0.8416, AUC=0.7662, TPR=0.4704, TNR=0.9055, J=0.3759, MCC=0.3731, ConfusionMatrix=
[[1955  204]
 [ 197  175]]
Epoch 13 complete in 87.44

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4729, Acc=0.7812, AUC=0.8565, TPR=0.7337, TNR=0.8299, J=0.5635, MCC=0.5658, ConfusionMatrix=
[[2995  614]
 [ 983 2708]]
Epoch 14, Phase val, Loss=0.4822, Acc=0.8216, AUC=0.7759, TPR=0.5515, TNR=0.8698, J=0.4214, MCC=0.3820, ConfusionMatrix=
[[1891  283]
 [ 174  214]]
Epoch 14, Phase test, Loss=0.4673, Acc=0.8238, AUC=0.7886, TPR=0.5645, TNR=0.8685, J=0.4330, MCC=0.3868, ConfusionMatrix=
[[1875  284]
 [ 162  210]]
Epoch 14 complete in 91.27

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4683, Acc=0.7867, AUC=0.8593, TPR=0.7490, TNR=0.8243, J=0.5732, MCC=0.5749, ConfusionMatrix=
[[3016  643]
 [ 914 2727]]
Epoch 15, Phase val, Loss=0.5042, Acc=0.8111, AUC=0.7824, TPR=0.5515, TNR=0.8574, J=0.4090, MCC=0.3635, ConfusionMatrix=
[[1864  310]
 [ 174  214]]
Epoch 15, Phase test, Loss=0.4899, Acc=0.8151, AUC=0.7800, TPR=0.5538, TNR=0.8601, J=0.4139, MCC=0.3659, ConfusionMatrix=
[[1857  302]
 [ 166  206]]
Epoch 15 complete in 99.21

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4776, Acc=0.7874, AUC=0.8565, TPR=0.7367, TNR=0.8377, J=0.5744, MCC=0.5775, ConfusionMatrix=
[[3071  595]
 [ 957 2677]]
Epoch 16, Phase val, Loss=0.4754, Acc=0.8201, AUC=0.7829, TPR=0.5979, TNR=0.8597, J=0.4576, MCC=0.4031, ConfusionMatrix=
[[1869  305]
 [ 156  232]]
Epoch 16, Phase test, Loss=0.4324, Acc=0.8293, AUC=0.7860, TPR=0.5914, TNR=0.8703, J=0.4617, MCC=0.4106, ConfusionMatrix=
[[1879  280]
 [ 152  220]]
Epoch 16 complete in 88.74

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4760, Acc=0.7838, AUC=0.8558, TPR=0.7403, TNR=0.8255, J=0.5658, MCC=0.5684, ConfusionMatrix=
[[3080  651]
 [ 927 2642]]
Epoch 17, Phase val, Loss=0.5140, Acc=0.8068, AUC=0.8008, TPR=0.6418, TNR=0.8362, J=0.4780, MCC=0.4035, ConfusionMatrix=
[[1818  356]
 [ 139  249]]
New Best AUC=0.8008. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 17, Phase test, Loss=0.4977, Acc=0.8167, AUC=0.8062, TPR=0.6317, TNR=0.8485, J=0.4803, MCC=0.4092, ConfusionMatrix=
[[1832  327]
 [ 137  235]]
Epoch 17 complete in 93.03

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4474, Acc=0.7977, AUC=0.8734, TPR=0.7556, TNR=0.8418, J=0.5974, MCC=0.5988, ConfusionMatrix=
[[3001  564]
 [ 913 2822]]
Epoch 18, Phase val, Loss=0.7089, Acc=0.7502, AUC=0.7800, TPR=0.6933, TNR=0.7603, J=0.4536, MCC=0.3521, ConfusionMatrix=
[[1653  521]
 [ 119  269]]
Epoch 18, Phase test, Loss=0.7112, Acc=0.7424, AUC=0.7946, TPR=0.7177, TNR=0.7466, J=0.4644, MCC=0.3520, ConfusionMatrix=
[[1612  547]
 [ 105  267]]
Epoch 18 complete in 92.56

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4541, Acc=0.7944, AUC=0.8701, TPR=0.7590, TNR=0.8309, J=0.5899, MCC=0.5910, ConfusionMatrix=
[[2983  607]
 [ 894 2816]]
Epoch 19, Phase val, Loss=0.4646, Acc=0.8521, AUC=0.7659, TPR=0.5438, TNR=0.9071, J=0.4509, MCC=0.4396, ConfusionMatrix=
[[1972  202]
 [ 177  211]]
Epoch 19, Phase test, Loss=0.4543, Acc=0.8558, AUC=0.7830, TPR=0.5457, TNR=0.9092, J=0.4549, MCC=0.4420, ConfusionMatrix=
[[1963  196]
 [ 169  203]]
Epoch 19 complete in 105.20

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4363, Acc=0.8088, AUC=0.8808, TPR=0.7748, TNR=0.8428, J=0.6176, MCC=0.6190, ConfusionMatrix=
[[3073  573]
 [ 823 2831]]
Epoch 20, Phase val, Loss=0.8134, Acc=0.7545, AUC=0.7753, TPR=0.6830, TNR=0.7672, J=0.4502, MCC=0.3519, ConfusionMatrix=
[[1668  506]
 [ 123  265]]
Epoch 20, Phase test, Loss=0.8019, Acc=0.7392, AUC=0.7583, TPR=0.6640, TNR=0.7522, J=0.4162, MCC=0.3189, ConfusionMatrix=
[[1624  535]
 [ 125  247]]
Epoch 20 complete in 88.61

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4407, Acc=0.8045, AUC=0.8787, TPR=0.7712, TNR=0.8383, J=0.6095, MCC=0.6107, ConfusionMatrix=
[[3038  586]
 [ 841 2835]]
Epoch 21, Phase val, Loss=0.4255, Acc=0.8427, AUC=0.7654, TPR=0.4588, TNR=0.9112, J=0.3700, MCC=0.3769, ConfusionMatrix=
[[1981  193]
 [ 210  178]]
Epoch 21, Phase test, Loss=0.4064, Acc=0.8625, AUC=0.7475, TPR=0.4758, TNR=0.9291, J=0.4049, MCC=0.4258, ConfusionMatrix=
[[2006  153]
 [ 195  177]]
Epoch 21 complete in 92.04

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4640, Acc=0.7974, AUC=0.8644, TPR=0.7550, TNR=0.8399, J=0.5949, MCC=0.5970, ConfusionMatrix=
[[3063  584]
 [ 895 2758]]
Epoch 22, Phase val, Loss=0.5757, Acc=0.7939, AUC=0.7908, TPR=0.6418, TNR=0.8211, J=0.4628, MCC=0.3837, ConfusionMatrix=
[[1785  389]
 [ 139  249]]
Epoch 22, Phase test, Loss=0.5561, Acc=0.7878, AUC=0.7812, TPR=0.6344, TNR=0.8143, J=0.4487, MCC=0.3661, ConfusionMatrix=
[[1758  401]
 [ 136  236]]
Epoch 22 complete in 96.08

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.4176, Acc=0.8204, AUC=0.8911, TPR=0.7910, TNR=0.8499, J=0.6409, MCC=0.6420, ConfusionMatrix=
[[3098  547]
 [ 764 2891]]
Epoch 23, Phase val, Loss=0.6322, Acc=0.7260, AUC=0.7224, TPR=0.5851, TNR=0.7511, J=0.3362, MCC=0.2631, ConfusionMatrix=
[[1633  541]
 [ 161  227]]
Epoch 23, Phase test, Loss=0.6141, Acc=0.7384, AUC=0.7733, TPR=0.6559, TNR=0.7527, J=0.4086, MCC=0.3135, ConfusionMatrix=
[[1625  534]
 [ 128  244]]
Epoch 23 complete in 89.58

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.4245, Acc=0.8138, AUC=0.8874, TPR=0.7825, TNR=0.8446, J=0.6270, MCC=0.6285, ConfusionMatrix=
[[3114  573]
 [ 786 2827]]
Epoch 24, Phase val, Loss=0.5035, Acc=0.8142, AUC=0.7814, TPR=0.5670, TNR=0.8583, J=0.4253, MCC=0.3770, ConfusionMatrix=
[[1866  308]
 [ 168  220]]
Epoch 24, Phase test, Loss=0.4734, Acc=0.8258, AUC=0.7727, TPR=0.5565, TNR=0.8722, J=0.4286, MCC=0.3862, ConfusionMatrix=
[[1883  276]
 [ 165  207]]
Epoch 24 complete in 94.22

Epoch 25 starting with learning_rate: [0.005]
Epoch 25, Phase train, Loss=0.4246, Acc=0.8174, AUC=0.8890, TPR=0.7917, TNR=0.8432, J=0.6349, MCC=0.6357, ConfusionMatrix=
[[3070  571]
 [ 762 2897]]
Epoch 25, Phase val, Loss=0.5433, Acc=0.8197, AUC=0.7654, TPR=0.5799, TNR=0.8625, J=0.4424, MCC=0.3931, ConfusionMatrix=
[[1875  299]
 [ 163  225]]
Epoch 25, Phase test, Loss=0.5190, Acc=0.8107, AUC=0.7663, TPR=0.5618, TNR=0.8536, J=0.4155, MCC=0.3628, ConfusionMatrix=
[[1843  316]
 [ 163  209]]
Epoch 25 complete in 93.94

Early Stop!
Training complete in 40m 29s
The best model val AUC=0.800816111685, test AUC=0.806215043803.
Finish training resnet50scratch-conv1x1-avgpool

Start training resnet50scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6511, Acc=0.6429, AUC=0.7065, TPR=0.6097, TNR=0.6755, J=0.2852, MCC=0.2859, ConfusionMatrix=
[[2486 1194]
 [1413 2207]]
Epoch 0, Phase val, Loss=0.6875, Acc=0.7666, AUC=0.7636, TPR=0.5696, TNR=0.8017, J=0.3713, MCC=0.3056, ConfusionMatrix=
[[1743  431]
 [ 167  221]]
New Best AUC=0.7636. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6398, Acc=0.7685, AUC=0.7542, TPR=0.5941, TNR=0.7985, J=0.3926, MCC=0.3172, ConfusionMatrix=
[[1724  435]
 [ 151  221]]
Epoch 0 complete in 106.35

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5966, Acc=0.6848, AUC=0.7632, TPR=0.6398, TNR=0.7289, J=0.3687, MCC=0.3702, ConfusionMatrix=
[[2688 1000]
 [1301 2311]]
Epoch 1, Phase val, Loss=1.4379, Acc=0.4372, AUC=0.7717, TPR=0.9381, TNR=0.3477, J=0.2859, MCC=0.2227, ConfusionMatrix=
[[ 756 1418]
 [  24  364]]
New Best AUC=0.7717. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=1.4128, Acc=0.4081, AUC=0.7526, TPR=0.9167, TNR=0.3205, J=0.2372, MCC=0.1859, ConfusionMatrix=
[[ 692 1467]
 [  31  341]]
Epoch 1 complete in 90.72

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5923, Acc=0.6964, AUC=0.7666, TPR=0.6371, TNR=0.7540, J=0.3911, MCC=0.3941, ConfusionMatrix=
[[2793  911]
 [1305 2291]]
Epoch 2, Phase val, Loss=0.7660, Acc=0.7061, AUC=0.7796, TPR=0.6701, TNR=0.7125, J=0.3826, MCC=0.2884, ConfusionMatrix=
[[1549  625]
 [ 128  260]]
New Best AUC=0.7796. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.7334, Acc=0.6748, AUC=0.7688, TPR=0.7043, TNR=0.6698, J=0.3741, MCC=0.2722, ConfusionMatrix=
[[1446  713]
 [ 110  262]]
Epoch 2 complete in 92.95

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5483, Acc=0.7310, AUC=0.8033, TPR=0.6574, TNR=0.8020, J=0.4594, MCC=0.4648, ConfusionMatrix=
[[2978  735]
 [1229 2358]]
Epoch 3, Phase val, Loss=0.4359, Acc=0.8439, AUC=0.7832, TPR=0.4794, TNR=0.9089, J=0.3883, MCC=0.3900, ConfusionMatrix=
[[1976  198]
 [ 202  186]]
New Best AUC=0.7832. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.4231, Acc=0.8435, AUC=0.7686, TPR=0.4328, TNR=0.9143, J=0.3471, MCC=0.3578, ConfusionMatrix=
[[1974  185]
 [ 211  161]]
Epoch 3 complete in 96.53

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5392, Acc=0.7355, AUC=0.8098, TPR=0.6751, TNR=0.7953, J=0.4704, MCC=0.4739, ConfusionMatrix=
[[2917  751]
 [1180 2452]]
Epoch 4, Phase val, Loss=0.4779, Acc=0.7783, AUC=0.7596, TPR=0.5412, TNR=0.8206, J=0.3618, MCC=0.3063, ConfusionMatrix=
[[1784  390]
 [ 178  210]]
Epoch 4, Phase test, Loss=0.5046, Acc=0.7701, AUC=0.6931, TPR=0.3978, TNR=0.8342, J=0.2320, MCC=0.2054, ConfusionMatrix=
[[1801  358]
 [ 224  148]]
Epoch 4 complete in 88.28

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5219, Acc=0.7490, AUC=0.8241, TPR=0.7015, TNR=0.7959, J=0.4973, MCC=0.4997, ConfusionMatrix=
[[2928  751]
 [1081 2540]]
Epoch 5, Phase val, Loss=0.4553, Acc=0.8185, AUC=0.7810, TPR=0.5206, TNR=0.8717, J=0.3923, MCC=0.3601, ConfusionMatrix=
[[1895  279]
 [ 186  202]]
Epoch 5, Phase test, Loss=0.4392, Acc=0.8218, AUC=0.7843, TPR=0.5081, TNR=0.8759, J=0.3839, MCC=0.3534, ConfusionMatrix=
[[1891  268]
 [ 183  189]]
Epoch 5 complete in 105.01

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5032, Acc=0.7636, AUC=0.8361, TPR=0.7048, TNR=0.8220, J=0.5267, MCC=0.5305, ConfusionMatrix=
[[3010  652]
 [1074 2564]]
Epoch 6, Phase val, Loss=0.6771, Acc=0.7681, AUC=0.7918, TPR=0.6469, TNR=0.7898, J=0.4367, MCC=0.3501, ConfusionMatrix=
[[1717  457]
 [ 137  251]]
New Best AUC=0.7918. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.6521, Acc=0.7566, AUC=0.7710, TPR=0.6317, TNR=0.7781, J=0.4099, MCC=0.3225, ConfusionMatrix=
[[1680  479]
 [ 137  235]]
Epoch 6 complete in 92.84

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5177, Acc=0.7519, AUC=0.8266, TPR=0.6956, TNR=0.8076, J=0.5032, MCC=0.5066, ConfusionMatrix=
[[2964  706]
 [1105 2525]]
Epoch 7, Phase val, Loss=0.7886, Acc=0.7506, AUC=0.7973, TPR=0.7088, TNR=0.7580, J=0.4668, MCC=0.3610, ConfusionMatrix=
[[1648  526]
 [ 113  275]]
New Best AUC=0.7973. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.7610, Acc=0.7388, AUC=0.7815, TPR=0.6774, TNR=0.7494, J=0.4268, MCC=0.3258, ConfusionMatrix=
[[1618  541]
 [ 120  252]]
Epoch 7 complete in 106.45

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5253, Acc=0.7568, AUC=0.8255, TPR=0.6936, TNR=0.8169, J=0.5105, MCC=0.5151, ConfusionMatrix=
[[3060  686]
 [1089 2465]]
Epoch 8, Phase val, Loss=0.6097, Acc=0.7576, AUC=0.8011, TPR=0.6856, TNR=0.7705, J=0.4560, MCC=0.3572, ConfusionMatrix=
[[1675  499]
 [ 122  266]]
New Best AUC=0.8011. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.5879, Acc=0.7641, AUC=0.7906, TPR=0.6747, TNR=0.7795, J=0.4543, MCC=0.3555, ConfusionMatrix=
[[1683  476]
 [ 121  251]]
Epoch 8 complete in 89.34

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5091, Acc=0.7618, AUC=0.8293, TPR=0.7094, TNR=0.8157, J=0.5251, MCC=0.5276, ConfusionMatrix=
[[2934  663]
 [1076 2627]]
Epoch 9, Phase val, Loss=0.4685, Acc=0.8365, AUC=0.7866, TPR=0.4639, TNR=0.9029, J=0.3669, MCC=0.3657, ConfusionMatrix=
[[1963  211]
 [ 208  180]]
Epoch 9, Phase test, Loss=0.4410, Acc=0.8364, AUC=0.7694, TPR=0.4892, TNR=0.8962, J=0.3855, MCC=0.3719, ConfusionMatrix=
[[1935  224]
 [ 190  182]]
Epoch 9 complete in 90.98

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4931, Acc=0.7704, AUC=0.8425, TPR=0.7145, TNR=0.8269, J=0.5413, MCC=0.5446, ConfusionMatrix=
[[3004  629]
 [1047 2620]]
Epoch 10, Phase val, Loss=0.4149, Acc=0.8497, AUC=0.7882, TPR=0.4897, TNR=0.9140, J=0.4037, MCC=0.4085, ConfusionMatrix=
[[1987  187]
 [ 198  190]]
Epoch 10, Phase test, Loss=0.4167, Acc=0.8495, AUC=0.7768, TPR=0.4677, TNR=0.9152, J=0.3830, MCC=0.3896, ConfusionMatrix=
[[1976  183]
 [ 198  174]]
Epoch 10 complete in 93.55

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4841, Acc=0.7718, AUC=0.8502, TPR=0.7118, TNR=0.8299, J=0.5417, MCC=0.5460, ConfusionMatrix=
[[3078  631]
 [1035 2556]]
Epoch 11, Phase val, Loss=0.9974, Acc=0.6807, AUC=0.7880, TPR=0.7938, TNR=0.6605, J=0.4543, MCC=0.3314, ConfusionMatrix=
[[1436  738]
 [  80  308]]
Epoch 11, Phase test, Loss=0.9496, Acc=0.6590, AUC=0.7881, TPR=0.7796, TNR=0.6383, J=0.4178, MCC=0.2995, ConfusionMatrix=
[[1378  781]
 [  82  290]]
Epoch 11 complete in 100.96

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4855, Acc=0.7778, AUC=0.8496, TPR=0.7326, TNR=0.8228, J=0.5554, MCC=0.5578, ConfusionMatrix=
[[3009  648]
 [ 974 2669]]
Epoch 12, Phase val, Loss=0.5303, Acc=0.8025, AUC=0.7803, TPR=0.5954, TNR=0.8395, J=0.4348, MCC=0.3725, ConfusionMatrix=
[[1825  349]
 [ 157  231]]
Epoch 12, Phase test, Loss=0.5154, Acc=0.8084, AUC=0.7692, TPR=0.5672, TNR=0.8499, J=0.4171, MCC=0.3618, ConfusionMatrix=
[[1835  324]
 [ 161  211]]
Epoch 12 complete in 87.92

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4875, Acc=0.7773, AUC=0.8507, TPR=0.7375, TNR=0.8173, J=0.5548, MCC=0.5565, ConfusionMatrix=
[[2971  664]
 [ 962 2703]]
Epoch 13, Phase val, Loss=0.6131, Acc=0.7627, AUC=0.8012, TPR=0.7113, TNR=0.7718, J=0.4832, MCC=0.3775, ConfusionMatrix=
[[1678  496]
 [ 112  276]]
New Best AUC=0.8012. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 13, Phase test, Loss=0.6200, Acc=0.7262, AUC=0.7929, TPR=0.7151, TNR=0.7281, J=0.4432, MCC=0.3320, ConfusionMatrix=
[[1572  587]
 [ 106  266]]
Epoch 13 complete in 92.50

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4998, Acc=0.7727, AUC=0.8445, TPR=0.7260, TNR=0.8193, J=0.5453, MCC=0.5477, ConfusionMatrix=
[[2996  661]
 [ 998 2645]]
Epoch 14, Phase val, Loss=0.6917, Acc=0.7666, AUC=0.7993, TPR=0.6778, TNR=0.7824, J=0.4603, MCC=0.3646, ConfusionMatrix=
[[1701  473]
 [ 125  263]]
Epoch 14, Phase test, Loss=0.6863, Acc=0.7400, AUC=0.7914, TPR=0.7016, TNR=0.7466, J=0.4483, MCC=0.3405, ConfusionMatrix=
[[1612  547]
 [ 111  261]]
Epoch 14 complete in 101.04

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4782, Acc=0.7840, AUC=0.8567, TPR=0.7385, TNR=0.8301, J=0.5686, MCC=0.5708, ConfusionMatrix=
[[3009  616]
 [ 961 2714]]
Epoch 15, Phase val, Loss=0.6414, Acc=0.7783, AUC=0.7998, TPR=0.6804, TNR=0.7958, J=0.4762, MCC=0.3817, ConfusionMatrix=
[[1730  444]
 [ 124  264]]
Epoch 15, Phase test, Loss=0.6386, Acc=0.7653, AUC=0.7867, TPR=0.6478, TNR=0.7855, J=0.4334, MCC=0.3425, ConfusionMatrix=
[[1696  463]
 [ 131  241]]
Epoch 15 complete in 88.21

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4675, Acc=0.7896, AUC=0.8608, TPR=0.7460, TNR=0.8331, J=0.5791, MCC=0.5813, ConfusionMatrix=
[[3044  610]
 [ 926 2720]]
Epoch 16, Phase val, Loss=0.4750, Acc=0.8103, AUC=0.7835, TPR=0.5722, TNR=0.8528, J=0.4250, MCC=0.3730, ConfusionMatrix=
[[1854  320]
 [ 166  222]]
Epoch 16, Phase test, Loss=0.4611, Acc=0.8183, AUC=0.7852, TPR=0.6022, TNR=0.8555, J=0.4576, MCC=0.3966, ConfusionMatrix=
[[1847  312]
 [ 148  224]]
Epoch 16 complete in 90.52

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4733, Acc=0.7888, AUC=0.8595, TPR=0.7455, TNR=0.8316, J=0.5771, MCC=0.5794, ConfusionMatrix=
[[3051  618]
 [ 924 2707]]
Epoch 17, Phase val, Loss=0.5597, Acc=0.8025, AUC=0.7928, TPR=0.6598, TNR=0.8280, J=0.4878, MCC=0.4060, ConfusionMatrix=
[[1800  374]
 [ 132  256]]
Epoch 17, Phase test, Loss=0.5491, Acc=0.7847, AUC=0.7796, TPR=0.5941, TNR=0.8175, J=0.4116, MCC=0.3398, ConfusionMatrix=
[[1765  394]
 [ 151  221]]
Epoch 17 complete in 92.38

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4542, Acc=0.7955, AUC=0.8708, TPR=0.7523, TNR=0.8379, J=0.5902, MCC=0.5926, ConfusionMatrix=
[[3086  597]
 [ 896 2721]]
Epoch 18, Phase val, Loss=0.4558, Acc=0.8247, AUC=0.7799, TPR=0.5258, TNR=0.8781, J=0.4039, MCC=0.3744, ConfusionMatrix=
[[1909  265]
 [ 184  204]]
Epoch 18, Phase test, Loss=0.4535, Acc=0.8175, AUC=0.7737, TPR=0.5188, TNR=0.8689, J=0.3877, MCC=0.3513, ConfusionMatrix=
[[1876  283]
 [ 179  193]]
Epoch 18 complete in 103.32

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4477, Acc=0.8032, AUC=0.8760, TPR=0.7664, TNR=0.8395, J=0.6059, MCC=0.6077, ConfusionMatrix=
[[3081  589]
 [ 848 2782]]
Epoch 19, Phase val, Loss=0.6670, Acc=0.7623, AUC=0.7948, TPR=0.7216, TNR=0.7695, J=0.4912, MCC=0.3825, ConfusionMatrix=
[[1673  501]
 [ 108  280]]
Epoch 19, Phase test, Loss=0.6487, Acc=0.7377, AUC=0.7834, TPR=0.7016, TNR=0.7439, J=0.4455, MCC=0.3377, ConfusionMatrix=
[[1606  553]
 [ 111  261]]
Epoch 19 complete in 89.42

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4617, Acc=0.7952, AUC=0.8661, TPR=0.7613, TNR=0.8296, J=0.5909, MCC=0.5921, ConfusionMatrix=
[[3008  618]
 [ 877 2797]]
Epoch 20, Phase val, Loss=0.9630, Acc=0.7198, AUC=0.7945, TPR=0.7577, TNR=0.7130, J=0.4707, MCC=0.3519, ConfusionMatrix=
[[1550  624]
 [  94  294]]
Epoch 20, Phase test, Loss=0.9511, Acc=0.6851, AUC=0.7821, TPR=0.7608, TNR=0.6721, J=0.4328, MCC=0.3140, ConfusionMatrix=
[[1451  708]
 [  89  283]]
Epoch 20 complete in 91.82

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4345, Acc=0.8132, AUC=0.8811, TPR=0.7763, TNR=0.8502, J=0.6265, MCC=0.6282, ConfusionMatrix=
[[3094  545]
 [ 819 2842]]
Epoch 21, Phase val, Loss=0.5428, Acc=0.8244, AUC=0.7857, TPR=0.5876, TNR=0.8666, J=0.4542, MCC=0.4054, ConfusionMatrix=
[[1884  290]
 [ 160  228]]
Epoch 21, Phase test, Loss=0.4895, Acc=0.8277, AUC=0.7701, TPR=0.5565, TNR=0.8745, J=0.4309, MCC=0.3898, ConfusionMatrix=
[[1888  271]
 [ 165  207]]
Epoch 21 complete in 98.15

Early Stop!
Training complete in 34m 49s
The best model val AUC=0.801172953082, test AUC=0.792931066254.
Finish training resnet50scratch-conv1x1-avgpool

Start training resnet50scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6212, Acc=0.6621, AUC=0.7222, TPR=0.6143, TNR=0.7085, J=0.3228, MCC=0.3243, ConfusionMatrix=
[[2622 1079]
 [1388 2211]]
Epoch 0, Phase val, Loss=0.4909, Acc=0.8236, AUC=0.7675, TPR=0.4253, TNR=0.8947, J=0.3199, MCC=0.3179, ConfusionMatrix=
[[1945  229]
 [ 223  165]]
New Best AUC=0.7675. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4644, Acc=0.8356, AUC=0.7624, TPR=0.4355, TNR=0.9046, J=0.3401, MCC=0.3416, ConfusionMatrix=
[[1953  206]
 [ 210  162]]
Epoch 0 complete in 89.90

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5782, Acc=0.7034, AUC=0.7757, TPR=0.6591, TNR=0.7477, J=0.4068, MCC=0.4084, ConfusionMatrix=
[[2730  921]
 [1244 2405]]
Epoch 1, Phase val, Loss=0.7171, Acc=0.6710, AUC=0.7722, TPR=0.7036, TNR=0.6651, J=0.3687, MCC=0.2709, ConfusionMatrix=
[[1446  728]
 [ 115  273]]
New Best AUC=0.7722. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7084, Acc=0.6393, AUC=0.7671, TPR=0.7581, TNR=0.6188, J=0.3769, MCC=0.2691, ConfusionMatrix=
[[1336  823]
 [  90  282]]
Epoch 1 complete in 96.85

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5522, Acc=0.7230, AUC=0.7941, TPR=0.6757, TNR=0.7711, J=0.4469, MCC=0.4487, ConfusionMatrix=
[[2790  828]
 [1194 2488]]
Epoch 2, Phase val, Loss=0.5359, Acc=0.7955, AUC=0.7721, TPR=0.5232, TNR=0.8441, J=0.3673, MCC=0.3224, ConfusionMatrix=
[[1835  339]
 [ 185  203]]
Epoch 2, Phase test, Loss=0.5048, Acc=0.8024, AUC=0.7683, TPR=0.5511, TNR=0.8458, J=0.3968, MCC=0.3435, ConfusionMatrix=
[[1826  333]
 [ 167  205]]
Epoch 2 complete in 91.76

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5571, Acc=0.7182, AUC=0.7952, TPR=0.6680, TNR=0.7697, J=0.4377, MCC=0.4397, ConfusionMatrix=
[[2774  830]
 [1227 2469]]
Epoch 3, Phase val, Loss=0.7621, Acc=0.6436, AUC=0.7720, TPR=0.7552, TNR=0.6237, J=0.3789, MCC=0.2741, ConfusionMatrix=
[[1356  818]
 [  95  293]]
Epoch 3, Phase test, Loss=0.7425, Acc=0.6096, AUC=0.7780, TPR=0.7849, TNR=0.5794, J=0.3644, MCC=0.2584, ConfusionMatrix=
[[1251  908]
 [  80  292]]
Epoch 3 complete in 103.95

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5435, Acc=0.7308, AUC=0.8057, TPR=0.6894, TNR=0.7736, J=0.4630, MCC=0.4643, ConfusionMatrix=
[[2778  813]
 [1152 2557]]
Epoch 4, Phase val, Loss=0.4301, Acc=0.8419, AUC=0.7699, TPR=0.4227, TNR=0.9167, J=0.3394, MCC=0.3564, ConfusionMatrix=
[[1993  181]
 [ 224  164]]
Epoch 4, Phase test, Loss=0.4094, Acc=0.8562, AUC=0.7648, TPR=0.4597, TNR=0.9245, J=0.3842, MCC=0.4019, ConfusionMatrix=
[[1996  163]
 [ 201  171]]
Epoch 4 complete in 89.09

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5273, Acc=0.7425, AUC=0.8171, TPR=0.7008, TNR=0.7848, J=0.4856, MCC=0.4872, ConfusionMatrix=
[[2841  779]
 [1101 2579]]
Epoch 5, Phase val, Loss=0.4236, Acc=0.8450, AUC=0.7688, TPR=0.4278, TNR=0.9195, J=0.3473, MCC=0.3666, ConfusionMatrix=
[[1999  175]
 [ 222  166]]
Epoch 5, Phase test, Loss=0.4139, Acc=0.8550, AUC=0.7616, TPR=0.4409, TNR=0.9264, J=0.3672, MCC=0.3897, ConfusionMatrix=
[[2000  159]
 [ 208  164]]
Epoch 5 complete in 90.33

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5264, Acc=0.7492, AUC=0.8178, TPR=0.6916, TNR=0.8063, J=0.4979, MCC=0.5013, ConfusionMatrix=
[[2955  710]
 [1121 2514]]
Epoch 6, Phase val, Loss=0.6475, Acc=0.7233, AUC=0.7687, TPR=0.6881, TNR=0.7295, J=0.4177, MCC=0.3175, ConfusionMatrix=
[[1586  588]
 [ 121  267]]
Epoch 6, Phase test, Loss=0.6388, Acc=0.6993, AUC=0.7589, TPR=0.6586, TNR=0.7063, J=0.3649, MCC=0.2714, ConfusionMatrix=
[[1525  634]
 [ 127  245]]
Epoch 6 complete in 91.33

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5254, Acc=0.7515, AUC=0.8200, TPR=0.6934, TNR=0.8082, J=0.5016, MCC=0.5052, ConfusionMatrix=
[[2987  709]
 [1105 2499]]
Epoch 7, Phase val, Loss=0.6830, Acc=0.7791, AUC=0.7900, TPR=0.6211, TNR=0.8073, J=0.4284, MCC=0.3512, ConfusionMatrix=
[[1755  419]
 [ 147  241]]
New Best AUC=0.7900. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.6246, Acc=0.7685, AUC=0.7822, TPR=0.6263, TNR=0.7930, J=0.4193, MCC=0.3349, ConfusionMatrix=
[[1712  447]
 [ 139  233]]
Epoch 7 complete in 88.62

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5233, Acc=0.7475, AUC=0.8228, TPR=0.6926, TNR=0.8031, J=0.4958, MCC=0.4986, ConfusionMatrix=
[[2913  714]
 [1129 2544]]
Epoch 8, Phase val, Loss=0.3903, Acc=0.8509, AUC=0.7802, TPR=0.3531, TNR=0.9397, J=0.2928, MCC=0.3430, ConfusionMatrix=
[[2043  131]
 [ 251  137]]
Epoch 8, Phase test, Loss=0.4022, Acc=0.8352, AUC=0.7455, TPR=0.2984, TNR=0.9277, J=0.2261, MCC=0.2607, ConfusionMatrix=
[[2003  156]
 [ 261  111]]
Epoch 8 complete in 92.78

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5035, Acc=0.7703, AUC=0.8373, TPR=0.7265, TNR=0.8149, J=0.5414, MCC=0.5433, ConfusionMatrix=
[[2945  669]
 [1008 2678]]
Epoch 9, Phase val, Loss=0.5124, Acc=0.8041, AUC=0.7805, TPR=0.5954, TNR=0.8413, J=0.4367, MCC=0.3750, ConfusionMatrix=
[[1829  345]
 [ 157  231]]
Epoch 9, Phase test, Loss=0.5266, Acc=0.7953, AUC=0.7433, TPR=0.5323, TNR=0.8407, J=0.3729, MCC=0.3219, ConfusionMatrix=
[[1815  344]
 [ 174  198]]
Epoch 9 complete in 90.28

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5021, Acc=0.7686, AUC=0.8364, TPR=0.7071, TNR=0.8292, J=0.5364, MCC=0.5407, ConfusionMatrix=
[[3049  628]
 [1061 2562]]
Epoch 10, Phase val, Loss=0.5025, Acc=0.7974, AUC=0.7934, TPR=0.6366, TNR=0.8261, J=0.4627, MCC=0.3862, ConfusionMatrix=
[[1796  378]
 [ 141  247]]
New Best AUC=0.7934. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.4952, Acc=0.7906, AUC=0.7986, TPR=0.6586, TNR=0.8133, J=0.4719, MCC=0.3829, ConfusionMatrix=
[[1756  403]
 [ 127  245]]
Epoch 10 complete in 104.93

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4747, Acc=0.7845, AUC=0.8576, TPR=0.7315, TNR=0.8358, J=0.5673, MCC=0.5710, ConfusionMatrix=
[[3101  609]
 [ 964 2626]]
Epoch 11, Phase val, Loss=0.4220, Acc=0.8349, AUC=0.7802, TPR=0.4536, TNR=0.9029, J=0.3566, MCC=0.3569, ConfusionMatrix=
[[1963  211]
 [ 212  176]]
Epoch 11, Phase test, Loss=0.4039, Acc=0.8404, AUC=0.7875, TPR=0.4785, TNR=0.9027, J=0.3812, MCC=0.3747, ConfusionMatrix=
[[1949  210]
 [ 194  178]]
Epoch 11 complete in 90.04

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4764, Acc=0.7829, AUC=0.8541, TPR=0.7489, TNR=0.8172, J=0.5661, MCC=0.5673, ConfusionMatrix=
[[2968  664]
 [ 921 2747]]
Epoch 12, Phase val, Loss=0.5313, Acc=0.8025, AUC=0.7992, TPR=0.6572, TNR=0.8284, J=0.4856, MCC=0.4047, ConfusionMatrix=
[[1801  373]
 [ 133  255]]
New Best AUC=0.7992. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 12, Phase test, Loss=0.4996, Acc=0.7989, AUC=0.7779, TPR=0.5780, TNR=0.8370, J=0.4149, MCC=0.3524, ConfusionMatrix=
[[1807  352]
 [ 157  215]]
Epoch 12 complete in 91.97

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4797, Acc=0.7845, AUC=0.8569, TPR=0.7372, TNR=0.8305, J=0.5678, MCC=0.5706, ConfusionMatrix=
[[3073  627]
 [ 946 2654]]
Epoch 13, Phase val, Loss=0.5198, Acc=0.7955, AUC=0.8020, TPR=0.6340, TNR=0.8243, J=0.4583, MCC=0.3819, ConfusionMatrix=
[[1792  382]
 [ 142  246]]
New Best AUC=0.8020. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 13, Phase test, Loss=0.4911, Acc=0.8024, AUC=0.7918, TPR=0.6183, TNR=0.8342, J=0.4525, MCC=0.3794, ConfusionMatrix=
[[1801  358]
 [ 142  230]]
Epoch 13 complete in 95.03

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4952, Acc=0.7734, AUC=0.8425, TPR=0.7350, TNR=0.8126, J=0.5476, MCC=0.5490, ConfusionMatrix=
[[2936  677]
 [ 977 2710]]
Epoch 14, Phase val, Loss=0.5772, Acc=0.7834, AUC=0.7925, TPR=0.6521, TNR=0.8068, J=0.4589, MCC=0.3738, ConfusionMatrix=
[[1754  420]
 [ 135  253]]
Epoch 14, Phase test, Loss=0.5588, Acc=0.7859, AUC=0.8009, TPR=0.6801, TNR=0.8041, J=0.4842, MCC=0.3875, ConfusionMatrix=
[[1736  423]
 [ 119  253]]
Epoch 14 complete in 88.08

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4547, Acc=0.7984, AUC=0.8677, TPR=0.7484, TNR=0.8462, J=0.5945, MCC=0.5981, ConfusionMatrix=
[[3157  574]
 [ 898 2671]]
Epoch 15, Phase val, Loss=0.6641, Acc=0.7545, AUC=0.7912, TPR=0.6624, TNR=0.7709, J=0.4333, MCC=0.3407, ConfusionMatrix=
[[1676  498]
 [ 131  257]]
Epoch 15, Phase test, Loss=0.6410, Acc=0.7558, AUC=0.7996, TPR=0.6882, TNR=0.7675, J=0.4557, MCC=0.3522, ConfusionMatrix=
[[1657  502]
 [ 116  256]]
Epoch 15 complete in 91.71

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4618, Acc=0.7960, AUC=0.8657, TPR=0.7573, TNR=0.8336, J=0.5909, MCC=0.5930, ConfusionMatrix=
[[3090  617]
 [ 872 2721]]
Epoch 16, Phase val, Loss=0.6307, Acc=0.7319, AUC=0.7993, TPR=0.7320, TNR=0.7318, J=0.4638, MCC=0.3514, ConfusionMatrix=
[[1591  583]
 [ 104  284]]
Epoch 16, Phase test, Loss=0.6120, Acc=0.7436, AUC=0.7985, TPR=0.7204, TNR=0.7476, J=0.4680, MCC=0.3549, ConfusionMatrix=
[[1614  545]
 [ 104  268]]
Epoch 16 complete in 91.05

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4377, Acc=0.8070, AUC=0.8801, TPR=0.7736, TNR=0.8400, J=0.6135, MCC=0.6150, ConfusionMatrix=
[[3086  588]
 [ 821 2805]]
Epoch 17, Phase val, Loss=1.0173, Acc=0.6429, AUC=0.8072, TPR=0.8299, TNR=0.6095, J=0.4394, MCC=0.3162, ConfusionMatrix=
[[1325  849]
 [  66  322]]
New Best AUC=0.8072. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_bestAUC.pth
Epoch 17, Phase test, Loss=0.9644, Acc=0.6385, AUC=0.8077, TPR=0.8226, TNR=0.6068, J=0.4293, MCC=0.3052, ConfusionMatrix=
[[1310  849]
 [  66  306]]
Epoch 17 complete in 106.21

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4389, Acc=0.8095, AUC=0.8801, TPR=0.7737, TNR=0.8453, J=0.6190, MCC=0.6206, ConfusionMatrix=
[[3081  564]
 [ 827 2828]]
Epoch 18, Phase val, Loss=0.4197, Acc=0.8271, AUC=0.7687, TPR=0.4510, TNR=0.8942, J=0.3452, MCC=0.3392, ConfusionMatrix=
[[1944  230]
 [ 213  175]]
Epoch 18, Phase test, Loss=0.4021, Acc=0.8285, AUC=0.7578, TPR=0.4651, TNR=0.8912, J=0.3562, MCC=0.3430, ConfusionMatrix=
[[1924  235]
 [ 199  173]]
Epoch 18 complete in 90.27

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4556, Acc=0.7981, AUC=0.8697, TPR=0.7661, TNR=0.8305, J=0.5966, MCC=0.5977, ConfusionMatrix=
[[3009  614]
 [ 860 2817]]
Epoch 19, Phase val, Loss=0.5327, Acc=0.8080, AUC=0.7933, TPR=0.6495, TNR=0.8362, J=0.4857, MCC=0.4093, ConfusionMatrix=
[[1818  356]
 [ 136  252]]
Epoch 19, Phase test, Loss=0.5183, Acc=0.8107, AUC=0.7782, TPR=0.5914, TNR=0.8485, J=0.4399, MCC=0.3785, ConfusionMatrix=
[[1832  327]
 [ 152  220]]
Epoch 19 complete in 90.92

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4576, Acc=0.7968, AUC=0.8704, TPR=0.7685, TNR=0.8250, J=0.5935, MCC=0.5945, ConfusionMatrix=
[[3022  641]
 [ 842 2795]]
Epoch 20, Phase val, Loss=0.4589, Acc=0.8025, AUC=0.7584, TPR=0.4588, TNR=0.8638, J=0.3226, MCC=0.2978, ConfusionMatrix=
[[1878  296]
 [ 210  178]]
Epoch 20, Phase test, Loss=0.4466, Acc=0.8072, AUC=0.7426, TPR=0.4866, TNR=0.8624, J=0.3490, MCC=0.3157, ConfusionMatrix=
[[1862  297]
 [ 191  181]]
Epoch 20 complete in 89.44

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4665, Acc=0.7979, AUC=0.8707, TPR=0.7666, TNR=0.8301, J=0.5966, MCC=0.5975, ConfusionMatrix=
[[2994  613]
 [ 862 2831]]
Epoch 21, Phase val, Loss=0.3755, Acc=0.8505, AUC=0.7695, TPR=0.3892, TNR=0.9328, J=0.3220, MCC=0.3606, ConfusionMatrix=
[[2028  146]
 [ 237  151]]
Epoch 21, Phase test, Loss=0.3875, Acc=0.8487, AUC=0.7352, TPR=0.3548, TNR=0.9338, J=0.2886, MCC=0.3284, ConfusionMatrix=
[[2016  143]
 [ 240  132]]
Epoch 21 complete in 87.94

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4462, Acc=0.8051, AUC=0.8784, TPR=0.7832, TNR=0.8280, J=0.6113, MCC=0.6113, ConfusionMatrix=
[[2947  612]
 [ 811 2930]]
Epoch 22, Phase val, Loss=0.6259, Acc=0.7194, AUC=0.7775, TPR=0.7191, TNR=0.7194, J=0.4385, MCC=0.3302, ConfusionMatrix=
[[1564  610]
 [ 109  279]]
Epoch 22, Phase test, Loss=0.6039, Acc=0.7136, AUC=0.7722, TPR=0.6935, TNR=0.7170, J=0.4105, MCC=0.3062, ConfusionMatrix=
[[1548  611]
 [ 114  258]]
Epoch 22 complete in 89.30

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.4144, Acc=0.8192, AUC=0.8936, TPR=0.7909, TNR=0.8471, J=0.6380, MCC=0.6391, ConfusionMatrix=
[[3113  562]
 [ 758 2867]]
Epoch 23, Phase val, Loss=0.3822, Acc=0.8435, AUC=0.7670, TPR=0.3531, TNR=0.9310, J=0.2841, MCC=0.3229, ConfusionMatrix=
[[2024  150]
 [ 251  137]]
Epoch 23, Phase test, Loss=0.3999, Acc=0.8372, AUC=0.7252, TPR=0.3333, TNR=0.9240, J=0.2574, MCC=0.2870, ConfusionMatrix=
[[1995  164]
 [ 248  124]]
Epoch 23 complete in 91.92

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.4065, Acc=0.8273, AUC=0.8974, TPR=0.8009, TNR=0.8532, J=0.6541, MCC=0.6552, ConfusionMatrix=
[[3138  540]
 [ 721 2901]]
Epoch 24, Phase val, Loss=0.4395, Acc=0.8224, AUC=0.7495, TPR=0.4691, TNR=0.8855, J=0.3545, MCC=0.3398, ConfusionMatrix=
[[1925  249]
 [ 206  182]]
Epoch 24, Phase test, Loss=0.4299, Acc=0.8313, AUC=0.7280, TPR=0.4382, TNR=0.8990, J=0.3372, MCC=0.3339, ConfusionMatrix=
[[1941  218]
 [ 209  163]]
Epoch 24 complete in 86.93

Epoch 25 starting with learning_rate: [0.005]
Epoch 25, Phase train, Loss=0.4190, Acc=0.8175, AUC=0.8921, TPR=0.7964, TNR=0.8395, J=0.6359, MCC=0.6361, ConfusionMatrix=
[[3007  575]
 [ 757 2961]]
Epoch 25, Phase val, Loss=0.4720, Acc=0.8353, AUC=0.7810, TPR=0.5619, TNR=0.8841, J=0.4459, MCC=0.4130, ConfusionMatrix=
[[1922  252]
 [ 170  218]]
Epoch 25, Phase test, Loss=0.4538, Acc=0.8246, AUC=0.7574, TPR=0.5108, TNR=0.8786, J=0.3894, MCC=0.3600, ConfusionMatrix=
[[1897  262]
 [ 182  190]]
Epoch 25 complete in 103.25

Early Stop!
Training complete in 40m 14s
The best model val AUC=0.80724281338, test AUC=0.807721615443.
Finish training resnet50scratch-conv1x1-avgpool

Start training resnet18-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6282, Acc=0.6523, AUC=0.7079, TPR=0.7702, TNR=0.5312, J=0.3014, MCC=0.3107, ConfusionMatrix=
[[1913 1688]
 [ 850 2849]]
Epoch 0, Phase val, Loss=0.6336, Acc=0.6975, AUC=0.7801, TPR=0.7268, TNR=0.6923, J=0.4191, MCC=0.3110, ConfusionMatrix=
[[1505  669]
 [ 106  282]]
New Best AUC=0.7801. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6655, Acc=0.6689, AUC=0.7568, TPR=0.7258, TNR=0.6591, J=0.3849, MCC=0.2785, ConfusionMatrix=
[[1423  736]
 [ 102  270]]
Epoch 0 complete in 38.94

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5051, Acc=0.7642, AUC=0.8337, TPR=0.7288, TNR=0.8001, J=0.5289, MCC=0.5301, ConfusionMatrix=
[[2905  726]
 [ 995 2674]]
Epoch 1, Phase val, Loss=0.5217, Acc=0.7834, AUC=0.8186, TPR=0.6649, TNR=0.8045, J=0.4695, MCC=0.3806, ConfusionMatrix=
[[1749  425]
 [ 130  258]]
New Best AUC=0.8186. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5428, Acc=0.7938, AUC=0.7967, TPR=0.6694, TNR=0.8152, J=0.4845, MCC=0.3931, ConfusionMatrix=
[[1760  399]
 [ 123  249]]
Epoch 1 complete in 45.63

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4524, Acc=0.7919, AUC=0.8694, TPR=0.7470, TNR=0.8369, J=0.5839, MCC=0.5862, ConfusionMatrix=
[[3053  595]
 [ 924 2728]]
Epoch 2, Phase val, Loss=0.4865, Acc=0.8185, AUC=0.8109, TPR=0.6237, TNR=0.8533, J=0.4770, MCC=0.4135, ConfusionMatrix=
[[1855  319]
 [ 146  242]]
Epoch 2, Phase test, Loss=0.5263, Acc=0.8088, AUC=0.7988, TPR=0.6129, TNR=0.8425, J=0.4554, MCC=0.3865, ConfusionMatrix=
[[1819  340]
 [ 144  228]]
Epoch 2 complete in 37.16

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4336, Acc=0.8096, AUC=0.8816, TPR=0.7795, TNR=0.8395, J=0.6190, MCC=0.6202, ConfusionMatrix=
[[3075  588]
 [ 802 2835]]
Epoch 3, Phase val, Loss=0.4114, Acc=0.8298, AUC=0.8113, TPR=0.5722, TNR=0.8758, J=0.4480, MCC=0.4077, ConfusionMatrix=
[[1904  270]
 [ 166  222]]
Epoch 3, Phase test, Loss=0.4529, Acc=0.8309, AUC=0.7757, TPR=0.5914, TNR=0.8722, J=0.4636, MCC=0.4135, ConfusionMatrix=
[[1883  276]
 [ 152  220]]
Epoch 3 complete in 46.90

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3930, Acc=0.8353, AUC=0.9042, TPR=0.8218, TNR=0.8493, J=0.6711, MCC=0.6711, ConfusionMatrix=
[[3055  542]
 [ 660 3043]]
Epoch 4, Phase val, Loss=0.4179, Acc=0.8329, AUC=0.7958, TPR=0.5567, TNR=0.8822, J=0.4389, MCC=0.4059, ConfusionMatrix=
[[1918  256]
 [ 172  216]]
Epoch 4, Phase test, Loss=0.4600, Acc=0.8242, AUC=0.7774, TPR=0.5941, TNR=0.8638, J=0.4579, MCC=0.4027, ConfusionMatrix=
[[1865  294]
 [ 151  221]]
Epoch 4 complete in 43.62

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3584, Acc=0.8499, AUC=0.9208, TPR=0.8370, TNR=0.8626, J=0.6996, MCC=0.6999, ConfusionMatrix=
[[3164  504]
 [ 592 3040]]
Epoch 5, Phase val, Loss=0.3860, Acc=0.8501, AUC=0.8082, TPR=0.5335, TNR=0.9066, J=0.4401, MCC=0.4303, ConfusionMatrix=
[[1971  203]
 [ 181  207]]
Epoch 5, Phase test, Loss=0.4198, Acc=0.8435, AUC=0.7710, TPR=0.5108, TNR=0.9009, J=0.4116, MCC=0.3980, ConfusionMatrix=
[[1945  214]
 [ 182  190]]
Epoch 5 complete in 37.95

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3418, Acc=0.8582, AUC=0.9283, TPR=0.8490, TNR=0.8673, J=0.7163, MCC=0.7165, ConfusionMatrix=
[[3195  489]
 [ 546 3070]]
Epoch 6, Phase val, Loss=0.5829, Acc=0.7642, AUC=0.8062, TPR=0.7139, TNR=0.7732, J=0.4871, MCC=0.3809, ConfusionMatrix=
[[1681  493]
 [ 111  277]]
Epoch 6, Phase test, Loss=0.6197, Acc=0.7467, AUC=0.7772, TPR=0.6774, TNR=0.7587, J=0.4361, MCC=0.3353, ConfusionMatrix=
[[1638  521]
 [ 120  252]]
Epoch 6 complete in 37.18

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3251, Acc=0.8663, AUC=0.9350, TPR=0.8679, TNR=0.8647, J=0.7326, MCC=0.7326, ConfusionMatrix=
[[3170  496]
 [ 480 3154]]
Epoch 7, Phase val, Loss=0.4041, Acc=0.8443, AUC=0.7703, TPR=0.4536, TNR=0.9140, J=0.3676, MCC=0.3779, ConfusionMatrix=
[[1987  187]
 [ 212  176]]
Epoch 7, Phase test, Loss=0.4294, Acc=0.8475, AUC=0.7427, TPR=0.5134, TNR=0.9050, J=0.4185, MCC=0.4079, ConfusionMatrix=
[[1954  205]
 [ 181  191]]
Epoch 7 complete in 51.56

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2968, Acc=0.8797, AUC=0.9454, TPR=0.8856, TNR=0.8738, J=0.7594, MCC=0.7595, ConfusionMatrix=
[[3170  458]
 [ 420 3252]]
Epoch 8, Phase val, Loss=0.4919, Acc=0.7994, AUC=0.7968, TPR=0.6057, TNR=0.8339, J=0.4396, MCC=0.3730, ConfusionMatrix=
[[1813  361]
 [ 153  235]]
Epoch 8, Phase test, Loss=0.5449, Acc=0.7918, AUC=0.7627, TPR=0.6344, TNR=0.8189, J=0.4533, MCC=0.3718, ConfusionMatrix=
[[1768  391]
 [ 136  236]]
Epoch 8 complete in 37.31

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2847, Acc=0.8897, AUC=0.9496, TPR=0.9024, TNR=0.8764, J=0.7788, MCC=0.7794, ConfusionMatrix=
[[3120  440]
 [ 365 3375]]
Epoch 9, Phase val, Loss=0.4134, Acc=0.8505, AUC=0.8024, TPR=0.4948, TNR=0.9140, J=0.4088, MCC=0.4128, ConfusionMatrix=
[[1987  187]
 [ 196  192]]
Epoch 9, Phase test, Loss=0.4617, Acc=0.8420, AUC=0.7457, TPR=0.4973, TNR=0.9013, J=0.3987, MCC=0.3878, ConfusionMatrix=
[[1946  213]
 [ 187  185]]
Epoch 9 complete in 37.72

Early Stop!
Training complete in 6m 54s
The best model val AUC=0.818629729038, test AUC=0.796727377768.
Finish training resnet18-conv1x1ab-maxpool

Start training resnet18-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6327, Acc=0.6434, AUC=0.7027, TPR=0.7073, TNR=0.5806, J=0.2879, MCC=0.2901, ConfusionMatrix=
[[2136 1543]
 [1060 2561]]
Epoch 0, Phase val, Loss=0.5598, Acc=0.7361, AUC=0.7827, TPR=0.6985, TNR=0.7429, J=0.4413, MCC=0.3381, ConfusionMatrix=
[[1615  559]
 [ 117  271]]
New Best AUC=0.7827. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5852, Acc=0.6981, AUC=0.7602, TPR=0.6640, TNR=0.7040, J=0.3680, MCC=0.2732, ConfusionMatrix=
[[1520  639]
 [ 125  247]]
Epoch 0 complete in 49.83

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4918, Acc=0.7758, AUC=0.8442, TPR=0.7280, TNR=0.8233, J=0.5514, MCC=0.5539, ConfusionMatrix=
[[3010  646]
 [ 991 2653]]
Epoch 1, Phase val, Loss=0.5245, Acc=0.7830, AUC=0.7946, TPR=0.6237, TNR=0.8114, J=0.4351, MCC=0.3581, ConfusionMatrix=
[[1764  410]
 [ 146  242]]
New Best AUC=0.7946. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5625, Acc=0.7531, AUC=0.7806, TPR=0.6640, TNR=0.7684, J=0.4324, MCC=0.3357, ConfusionMatrix=
[[1659  500]
 [ 125  247]]
Epoch 1 complete in 39.18

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4651, Acc=0.7866, AUC=0.8623, TPR=0.7652, TNR=0.8092, J=0.5744, MCC=0.5744, ConfusionMatrix=
[[2867  676]
 [ 882 2875]]
Epoch 2, Phase val, Loss=0.4829, Acc=0.8068, AUC=0.8147, TPR=0.6572, TNR=0.8335, J=0.4907, MCC=0.4114, ConfusionMatrix=
[[1812  362]
 [ 133  255]]
New Best AUC=0.8147. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5115, Acc=0.7957, AUC=0.7973, TPR=0.6613, TNR=0.8189, J=0.4802, MCC=0.3918, ConfusionMatrix=
[[1768  391]
 [ 126  246]]
Epoch 2 complete in 40.76

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4200, Acc=0.8162, AUC=0.8899, TPR=0.7907, TNR=0.8414, J=0.6321, MCC=0.6330, ConfusionMatrix=
[[3083  581]
 [ 761 2875]]
Epoch 3, Phase val, Loss=0.4855, Acc=0.7994, AUC=0.8145, TPR=0.6546, TNR=0.8252, J=0.4798, MCC=0.3986, ConfusionMatrix=
[[1794  380]
 [ 134  254]]
Epoch 3, Phase test, Loss=0.5106, Acc=0.8032, AUC=0.7956, TPR=0.6667, TNR=0.8268, J=0.4934, MCC=0.4058, ConfusionMatrix=
[[1785  374]
 [ 124  248]]
Epoch 3 complete in 51.00

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3929, Acc=0.8310, AUC=0.9043, TPR=0.8119, TNR=0.8505, J=0.6624, MCC=0.6626, ConfusionMatrix=
[[3067  539]
 [ 695 2999]]
Epoch 4, Phase val, Loss=0.4909, Acc=0.7994, AUC=0.8204, TPR=0.7242, TNR=0.8128, J=0.5370, MCC=0.4344, ConfusionMatrix=
[[1767  407]
 [ 107  281]]
New Best AUC=0.8204. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5323, Acc=0.7819, AUC=0.7924, TPR=0.6855, TNR=0.7985, J=0.4840, MCC=0.3849, ConfusionMatrix=
[[1724  435]
 [ 117  255]]
Epoch 4 complete in 38.23

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3815, Acc=0.8319, AUC=0.9100, TPR=0.8256, TNR=0.8383, J=0.6639, MCC=0.6639, ConfusionMatrix=
[[3038  586]
 [ 641 3035]]
Epoch 5, Phase val, Loss=0.4463, Acc=0.8201, AUC=0.8173, TPR=0.6082, TNR=0.8579, J=0.4661, MCC=0.4083, ConfusionMatrix=
[[1865  309]
 [ 152  236]]
Epoch 5, Phase test, Loss=0.4952, Acc=0.8202, AUC=0.7914, TPR=0.6344, TNR=0.8522, J=0.4867, MCC=0.4165, ConfusionMatrix=
[[1840  319]
 [ 136  236]]
Epoch 5 complete in 38.51

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3509, Acc=0.8499, AUC=0.9241, TPR=0.8542, TNR=0.8454, J=0.6996, MCC=0.6996, ConfusionMatrix=
[[3040  556]
 [ 540 3164]]
Epoch 6, Phase val, Loss=0.4740, Acc=0.7834, AUC=0.7962, TPR=0.6237, TNR=0.8119, J=0.4356, MCC=0.3587, ConfusionMatrix=
[[1765  409]
 [ 146  242]]
Epoch 6, Phase test, Loss=0.5049, Acc=0.7910, AUC=0.7779, TPR=0.6774, TNR=0.8106, J=0.4880, MCC=0.3933, ConfusionMatrix=
[[1750  409]
 [ 120  252]]
Epoch 6 complete in 48.85

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3419, Acc=0.8560, AUC=0.9289, TPR=0.8535, TNR=0.8586, J=0.7121, MCC=0.7121, ConfusionMatrix=
[[3115  513]
 [ 538 3134]]
Epoch 7, Phase val, Loss=0.4594, Acc=0.8220, AUC=0.8027, TPR=0.6186, TNR=0.8583, J=0.4769, MCC=0.4169, ConfusionMatrix=
[[1866  308]
 [ 148  240]]
Epoch 7, Phase test, Loss=0.4944, Acc=0.8111, AUC=0.7785, TPR=0.6290, TNR=0.8425, J=0.4716, MCC=0.3987, ConfusionMatrix=
[[1819  340]
 [ 138  234]]
Epoch 7 complete in 37.33

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3118, Acc=0.8711, AUC=0.9403, TPR=0.8754, TNR=0.8670, J=0.7424, MCC=0.7422, ConfusionMatrix=
[[3240  497]
 [ 444 3119]]
Epoch 8, Phase val, Loss=0.4057, Acc=0.8392, AUC=0.8033, TPR=0.4871, TNR=0.9020, J=0.3891, MCC=0.3835, ConfusionMatrix=
[[1961  213]
 [ 199  189]]
Epoch 8, Phase test, Loss=0.4269, Acc=0.8514, AUC=0.7853, TPR=0.5672, TNR=0.9004, J=0.4676, MCC=0.4425, ConfusionMatrix=
[[1944  215]
 [ 161  211]]
Epoch 8 complete in 36.90

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2811, Acc=0.8814, AUC=0.9512, TPR=0.8910, TNR=0.8720, J=0.7630, MCC=0.7630, ConfusionMatrix=
[[3222  473]
 [ 393 3212]]
Epoch 9, Phase val, Loss=0.4779, Acc=0.8150, AUC=0.7913, TPR=0.5851, TNR=0.8560, J=0.4411, MCC=0.3877, ConfusionMatrix=
[[1861  313]
 [ 161  227]]
Epoch 9, Phase test, Loss=0.5017, Acc=0.8135, AUC=0.7857, TPR=0.6290, TNR=0.8453, J=0.4743, MCC=0.4026, ConfusionMatrix=
[[1825  334]
 [ 138  234]]
Epoch 9 complete in 52.65

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2764, Acc=0.8874, AUC=0.9527, TPR=0.8937, TNR=0.8811, J=0.7748, MCC=0.7749, ConfusionMatrix=
[[3215  434]
 [ 388 3263]]
Epoch 10, Phase val, Loss=0.5242, Acc=0.7853, AUC=0.7956, TPR=0.6392, TNR=0.8114, J=0.4506, MCC=0.3697, ConfusionMatrix=
[[1764  410]
 [ 140  248]]
Epoch 10, Phase test, Loss=0.5905, Acc=0.7839, AUC=0.7774, TPR=0.6747, TNR=0.8027, J=0.4774, MCC=0.3819, ConfusionMatrix=
[[1733  426]
 [ 121  251]]
Epoch 10 complete in 36.50

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2609, Acc=0.8959, AUC=0.9577, TPR=0.9057, TNR=0.8865, J=0.7922, MCC=0.7920, ConfusionMatrix=
[[3313  424]
 [ 336 3227]]
Epoch 11, Phase val, Loss=0.5130, Acc=0.8111, AUC=0.8003, TPR=0.5902, TNR=0.8505, J=0.4407, MCC=0.3838, ConfusionMatrix=
[[1849  325]
 [ 159  229]]
Epoch 11, Phase test, Loss=0.5576, Acc=0.8001, AUC=0.7636, TPR=0.6290, TNR=0.8296, J=0.4586, MCC=0.3814, ConfusionMatrix=
[[1791  368]
 [ 138  234]]
Epoch 11 complete in 42.68

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.2509, Acc=0.9033, AUC=0.9607, TPR=0.9146, TNR=0.8925, J=0.8071, MCC=0.8069, ConfusionMatrix=
[[3329  401]
 [ 305 3265]]
Epoch 12, Phase val, Loss=0.5177, Acc=0.8271, AUC=0.8066, TPR=0.6005, TNR=0.8675, J=0.4680, MCC=0.4169, ConfusionMatrix=
[[1886  288]
 [ 155  233]]
Epoch 12, Phase test, Loss=0.5620, Acc=0.8171, AUC=0.7850, TPR=0.5941, TNR=0.8555, J=0.4496, MCC=0.3904, ConfusionMatrix=
[[1847  312]
 [ 151  221]]
Epoch 12 complete in 57.87

Early Stop!
Training complete in 9m 30s
The best model val AUC=0.820410972221, test AUC=0.792444231947.
Finish training resnet18-conv1x1ab-maxpool

Start training resnet18-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6087, Acc=0.6729, AUC=0.7404, TPR=0.7900, TNR=0.5543, J=0.3443, MCC=0.3545, ConfusionMatrix=
[[2011 1617]
 [ 771 2901]]
Epoch 0, Phase val, Loss=0.5410, Acc=0.8072, AUC=0.7740, TPR=0.5284, TNR=0.8569, J=0.3853, MCC=0.3444, ConfusionMatrix=
[[1863  311]
 [ 183  205]]
New Best AUC=0.7740. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5620, Acc=0.7835, AUC=0.7551, TPR=0.5914, TNR=0.8166, J=0.4080, MCC=0.3366, ConfusionMatrix=
[[1763  396]
 [ 152  220]]
Epoch 0 complete in 37.65

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4900, Acc=0.7774, AUC=0.8457, TPR=0.7179, TNR=0.8347, J=0.5526, MCC=0.5570, ConfusionMatrix=
[[3105  615]
 [1010 2570]]
Epoch 1, Phase val, Loss=0.5531, Acc=0.7810, AUC=0.8185, TPR=0.6907, TNR=0.7971, J=0.4879, MCC=0.3909, ConfusionMatrix=
[[1733  441]
 [ 120  268]]
New Best AUC=0.8185. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6004, Acc=0.7539, AUC=0.7918, TPR=0.7151, TNR=0.7605, J=0.4756, MCC=0.3643, ConfusionMatrix=
[[1642  517]
 [ 106  266]]
Epoch 1 complete in 37.58

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4445, Acc=0.7990, AUC=0.8752, TPR=0.7700, TNR=0.8285, J=0.5985, MCC=0.5993, ConfusionMatrix=
[[3004  622]
 [ 845 2829]]
Epoch 2, Phase val, Loss=0.4769, Acc=0.7990, AUC=0.8113, TPR=0.6546, TNR=0.8247, J=0.4794, MCC=0.3980, ConfusionMatrix=
[[1793  381]
 [ 134  254]]
Epoch 2, Phase test, Loss=0.5230, Acc=0.7993, AUC=0.7907, TPR=0.6747, TNR=0.8208, J=0.4955, MCC=0.4041, ConfusionMatrix=
[[1772  387]
 [ 121  251]]
Epoch 2 complete in 61.79

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4265, Acc=0.8092, AUC=0.8860, TPR=0.7772, TNR=0.8419, J=0.6191, MCC=0.6201, ConfusionMatrix=
[[3036  570]
 [ 823 2871]]
Epoch 3, Phase val, Loss=0.4240, Acc=0.8322, AUC=0.8034, TPR=0.5619, TNR=0.8804, J=0.4423, MCC=0.4070, ConfusionMatrix=
[[1914  260]
 [ 170  218]]
Epoch 3, Phase test, Loss=0.4453, Acc=0.8341, AUC=0.7925, TPR=0.6183, TNR=0.8712, J=0.4895, MCC=0.4327, ConfusionMatrix=
[[1881  278]
 [ 142  230]]
Epoch 3 complete in 36.94

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4012, Acc=0.8248, AUC=0.8999, TPR=0.8035, TNR=0.8457, J=0.6492, MCC=0.6499, ConfusionMatrix=
[[3114  568]
 [ 711 2907]]
Epoch 4, Phase val, Loss=0.5499, Acc=0.7931, AUC=0.8001, TPR=0.6753, TNR=0.8142, J=0.4894, MCC=0.4000, ConfusionMatrix=
[[1770  404]
 [ 126  262]]
Epoch 4, Phase test, Loss=0.6288, Acc=0.7693, AUC=0.7901, TPR=0.7097, TNR=0.7795, J=0.4892, MCC=0.3808, ConfusionMatrix=
[[1683  476]
 [ 108  264]]
Epoch 4 complete in 39.17

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3749, Acc=0.8429, AUC=0.9128, TPR=0.8470, TNR=0.8386, J=0.6856, MCC=0.6856, ConfusionMatrix=
[[2987  575]
 [ 572 3166]]
Epoch 5, Phase val, Loss=0.4411, Acc=0.8466, AUC=0.8148, TPR=0.6108, TNR=0.8887, J=0.4995, MCC=0.4593, ConfusionMatrix=
[[1932  242]
 [ 151  237]]
Epoch 5, Phase test, Loss=0.5035, Acc=0.8400, AUC=0.7776, TPR=0.6156, TNR=0.8786, J=0.4942, MCC=0.4426, ConfusionMatrix=
[[1897  262]
 [ 143  229]]
Epoch 5 complete in 50.39

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3581, Acc=0.8477, AUC=0.9210, TPR=0.8481, TNR=0.8472, J=0.6953, MCC=0.6953, ConfusionMatrix=
[[3083  556]
 [ 556 3105]]
Epoch 6, Phase val, Loss=0.4038, Acc=0.8466, AUC=0.7969, TPR=0.5747, TNR=0.8951, J=0.4699, MCC=0.4423, ConfusionMatrix=
[[1946  228]
 [ 165  223]]
Epoch 6, Phase test, Loss=0.4376, Acc=0.8538, AUC=0.7880, TPR=0.6156, TNR=0.8949, J=0.5105, MCC=0.4703, ConfusionMatrix=
[[1932  227]
 [ 143  229]]
Epoch 6 complete in 41.97

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3281, Acc=0.8678, AUC=0.9331, TPR=0.8716, TNR=0.8638, J=0.7355, MCC=0.7355, ConfusionMatrix=
[[3089  487]
 [ 478 3246]]
Epoch 7, Phase val, Loss=0.4250, Acc=0.8368, AUC=0.8054, TPR=0.5722, TNR=0.8841, J=0.4562, MCC=0.4212, ConfusionMatrix=
[[1922  252]
 [ 166  222]]
Epoch 7, Phase test, Loss=0.4559, Acc=0.8435, AUC=0.7882, TPR=0.6156, TNR=0.8828, J=0.4984, MCC=0.4495, ConfusionMatrix=
[[1906  253]
 [ 143  229]]
Epoch 7 complete in 38.82

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3078, Acc=0.8767, AUC=0.9411, TPR=0.8901, TNR=0.8629, J=0.7530, MCC=0.7535, ConfusionMatrix=
[[3102  493]
 [ 407 3298]]
Epoch 8, Phase val, Loss=0.4710, Acc=0.8041, AUC=0.7991, TPR=0.5979, TNR=0.8408, J=0.4388, MCC=0.3763, ConfusionMatrix=
[[1828  346]
 [ 156  232]]
Epoch 8, Phase test, Loss=0.5191, Acc=0.8068, AUC=0.7835, TPR=0.6505, TNR=0.8337, J=0.4843, MCC=0.4030, ConfusionMatrix=
[[1800  359]
 [ 130  242]]
Epoch 8 complete in 50.33

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2947, Acc=0.8804, AUC=0.9455, TPR=0.8924, TNR=0.8681, J=0.7604, MCC=0.7608, ConfusionMatrix=
[[3119  474]
 [ 399 3308]]
Epoch 9, Phase val, Loss=0.4115, Acc=0.8458, AUC=0.7982, TPR=0.4278, TNR=0.9204, J=0.3483, MCC=0.3684, ConfusionMatrix=
[[2001  173]
 [ 222  166]]
Epoch 9, Phase test, Loss=0.4338, Acc=0.8507, AUC=0.7843, TPR=0.4919, TNR=0.9125, J=0.4044, MCC=0.4044, ConfusionMatrix=
[[1970  189]
 [ 189  183]]
Epoch 9 complete in 40.72

Early Stop!
Training complete in 7m 15s
The best model val AUC=0.818468498373, test AUC=0.791835377788.
Finish training resnet18-conv1x1ab-maxpool

Start training resnet18-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5695, Acc=0.7059, AUC=0.7815, TPR=0.7366, TNR=0.6752, J=0.4117, MCC=0.4125, ConfusionMatrix=
[[2463 1185]
 [ 962 2690]]
Epoch 0, Phase val, Loss=0.4509, Acc=0.8216, AUC=0.8111, TPR=0.5954, TNR=0.8620, J=0.4574, MCC=0.4045, ConfusionMatrix=
[[1874  300]
 [ 157  231]]
New Best AUC=0.8111. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4849, Acc=0.7938, AUC=0.7797, TPR=0.6102, TNR=0.8254, J=0.4356, MCC=0.3618, ConfusionMatrix=
[[1782  377]
 [ 145  227]]
Epoch 0 complete in 40.00

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4639, Acc=0.7893, AUC=0.8601, TPR=0.7353, TNR=0.8419, J=0.5772, MCC=0.5809, ConfusionMatrix=
[[3115  585]
 [ 953 2647]]
Epoch 1, Phase val, Loss=0.4969, Acc=0.8212, AUC=0.8250, TPR=0.6521, TNR=0.8514, J=0.5035, MCC=0.4323, ConfusionMatrix=
[[1851  323]
 [ 135  253]]
New Best AUC=0.8250. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5367, Acc=0.7997, AUC=0.8033, TPR=0.6694, TNR=0.8221, J=0.4915, MCC=0.4019, ConfusionMatrix=
[[1775  384]
 [ 123  249]]
Epoch 1 complete in 51.95

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4513, Acc=0.8023, AUC=0.8696, TPR=0.7626, TNR=0.8423, J=0.6049, MCC=0.6067, ConfusionMatrix=
[[3065  574]
 [ 869 2792]]
Epoch 2, Phase val, Loss=0.5078, Acc=0.7775, AUC=0.7974, TPR=0.6624, TNR=0.7981, J=0.4604, MCC=0.3711, ConfusionMatrix=
[[1735  439]
 [ 131  257]]
Epoch 2, Phase test, Loss=0.5763, Acc=0.7361, AUC=0.7671, TPR=0.6962, TNR=0.7429, J=0.4392, MCC=0.3329, ConfusionMatrix=
[[1604  555]
 [ 113  259]]
Epoch 2 complete in 42.23

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4307, Acc=0.8059, AUC=0.8836, TPR=0.7810, TNR=0.8306, J=0.6116, MCC=0.6124, ConfusionMatrix=
[[3041  620]
 [ 797 2842]]
Epoch 3, Phase val, Loss=0.4967, Acc=0.7920, AUC=0.8136, TPR=0.6778, TNR=0.8123, J=0.4902, MCC=0.3996, ConfusionMatrix=
[[1766  408]
 [ 125  263]]
Epoch 3, Phase test, Loss=0.5779, Acc=0.7621, AUC=0.7843, TPR=0.6909, TNR=0.7744, J=0.4653, MCC=0.3616, ConfusionMatrix=
[[1672  487]
 [ 115  257]]
Epoch 3 complete in 38.07

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3922, Acc=0.8336, AUC=0.9047, TPR=0.8169, TNR=0.8505, J=0.6674, MCC=0.6676, ConfusionMatrix=
[[3077  541]
 [ 674 3008]]
Epoch 4, Phase val, Loss=0.5254, Acc=0.7881, AUC=0.8122, TPR=0.6649, TNR=0.8100, J=0.4750, MCC=0.3873, ConfusionMatrix=
[[1761  413]
 [ 130  258]]
Epoch 4, Phase test, Loss=0.6095, Acc=0.7641, AUC=0.7792, TPR=0.7043, TNR=0.7744, J=0.4787, MCC=0.3714, ConfusionMatrix=
[[1672  487]
 [ 110  262]]
Epoch 4 complete in 59.14

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3730, Acc=0.8445, AUC=0.9140, TPR=0.8275, TNR=0.8610, J=0.6885, MCC=0.6891, ConfusionMatrix=
[[3195  516]
 [ 619 2970]]
Epoch 5, Phase val, Loss=0.4454, Acc=0.8169, AUC=0.8059, TPR=0.6134, TNR=0.8533, J=0.4667, MCC=0.4056, ConfusionMatrix=
[[1855  319]
 [ 150  238]]
Epoch 5, Phase test, Loss=0.5040, Acc=0.8163, AUC=0.7786, TPR=0.6532, TNR=0.8444, J=0.4976, MCC=0.4195, ConfusionMatrix=
[[1823  336]
 [ 129  243]]
Epoch 5 complete in 36.92

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3336, Acc=0.8633, AUC=0.9314, TPR=0.8567, TNR=0.8696, J=0.7264, MCC=0.7265, ConfusionMatrix=
[[3228  484]
 [ 514 3074]]
Epoch 6, Phase val, Loss=0.4622, Acc=0.8236, AUC=0.8002, TPR=0.5902, TNR=0.8652, J=0.4554, MCC=0.4053, ConfusionMatrix=
[[1881  293]
 [ 159  229]]
Epoch 6, Phase test, Loss=0.4911, Acc=0.8210, AUC=0.7683, TPR=0.5968, TNR=0.8597, J=0.4564, MCC=0.3986, ConfusionMatrix=
[[1856  303]
 [ 150  222]]
Epoch 6 complete in 38.38

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3177, Acc=0.8704, AUC=0.9383, TPR=0.8694, TNR=0.8715, J=0.7408, MCC=0.7408, ConfusionMatrix=
[[3166  467]
 [ 479 3188]]
Epoch 7, Phase val, Loss=0.4138, Acc=0.8326, AUC=0.7963, TPR=0.4923, TNR=0.8933, J=0.3856, MCC=0.3723, ConfusionMatrix=
[[1942  232]
 [ 197  191]]
Epoch 7, Phase test, Loss=0.4397, Acc=0.8447, AUC=0.7512, TPR=0.5349, TNR=0.8981, J=0.4330, MCC=0.4126, ConfusionMatrix=
[[1939  220]
 [ 173  199]]
Epoch 7 complete in 49.38

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2940, Acc=0.8834, AUC=0.9468, TPR=0.8934, TNR=0.8730, J=0.7664, MCC=0.7667, ConfusionMatrix=
[[3113  453]
 [ 398 3336]]
Epoch 8, Phase val, Loss=0.5007, Acc=0.8294, AUC=0.7853, TPR=0.5876, TNR=0.8726, J=0.4602, MCC=0.4147, ConfusionMatrix=
[[1897  277]
 [ 160  228]]
Epoch 8, Phase test, Loss=0.5291, Acc=0.8175, AUC=0.7824, TPR=0.6640, TNR=0.8439, J=0.5079, MCC=0.4269, ConfusionMatrix=
[[1822  337]
 [ 125  247]]
Epoch 8 complete in 38.21

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2882, Acc=0.8832, AUC=0.9485, TPR=0.8892, TNR=0.8772, J=0.7664, MCC=0.7664, ConfusionMatrix=
[[3221  451]
 [ 402 3226]]
Epoch 9, Phase val, Loss=0.5992, Acc=0.7756, AUC=0.7912, TPR=0.6366, TNR=0.8004, J=0.4370, MCC=0.3546, ConfusionMatrix=
[[1740  434]
 [ 141  247]]
Epoch 9, Phase test, Loss=0.6542, Acc=0.7748, AUC=0.7865, TPR=0.6667, TNR=0.7934, J=0.4601, MCC=0.3652, ConfusionMatrix=
[[1713  446]
 [ 124  248]]
Epoch 9 complete in 37.09

Early Stop!
Training complete in 7m 11s
The best model val AUC=0.825048724855, test AUC=0.803317694871.
Finish training resnet18-conv1x1ab-maxpool

Start training resnet18-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6267, Acc=0.6492, AUC=0.7132, TPR=0.6940, TNR=0.6039, J=0.2979, MCC=0.2991, ConfusionMatrix=
[[2192 1438]
 [1123 2547]]
Epoch 0, Phase val, Loss=0.6247, Acc=0.6979, AUC=0.7840, TPR=0.7448, TNR=0.6895, J=0.4344, MCC=0.3214, ConfusionMatrix=
[[1499  675]
 [  99  289]]
New Best AUC=0.7840. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6667, Acc=0.6326, AUC=0.7795, TPR=0.7769, TNR=0.6077, J=0.3846, MCC=0.2738, ConfusionMatrix=
[[1312  847]
 [  83  289]]
Epoch 0 complete in 52.98

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4956, Acc=0.7674, AUC=0.8399, TPR=0.7357, TNR=0.7991, J=0.5347, MCC=0.5358, ConfusionMatrix=
[[2919  734]
 [ 964 2683]]
Epoch 1, Phase val, Loss=0.5480, Acc=0.7916, AUC=0.8150, TPR=0.6856, TNR=0.8105, J=0.4961, MCC=0.4031, ConfusionMatrix=
[[1762  412]
 [ 122  266]]
New Best AUC=0.8150. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5686, Acc=0.7594, AUC=0.7979, TPR=0.7016, TNR=0.7693, J=0.4710, MCC=0.3639, ConfusionMatrix=
[[1661  498]
 [ 111  261]]
Epoch 1 complete in 38.31

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4527, Acc=0.7911, AUC=0.8695, TPR=0.7590, TNR=0.8234, J=0.5824, MCC=0.5836, ConfusionMatrix=
[[2994  642]
 [ 883 2781]]
Epoch 2, Phase val, Loss=0.4220, Acc=0.8232, AUC=0.8094, TPR=0.6005, TNR=0.8629, J=0.4634, MCC=0.4099, ConfusionMatrix=
[[1876  298]
 [ 155  233]]
Epoch 2, Phase test, Loss=0.4382, Acc=0.8246, AUC=0.7999, TPR=0.6317, TNR=0.8578, J=0.4895, MCC=0.4225, ConfusionMatrix=
[[1852  307]
 [ 137  235]]
Epoch 2 complete in 38.03

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4103, Acc=0.8147, AUC=0.8950, TPR=0.8009, TNR=0.8283, J=0.6292, MCC=0.6295, ConfusionMatrix=
[[3034  629]
 [ 724 2913]]
Epoch 3, Phase val, Loss=0.4982, Acc=0.8115, AUC=0.7855, TPR=0.6057, TNR=0.8482, J=0.4539, MCC=0.3924, ConfusionMatrix=
[[1844  330]
 [ 153  235]]
Epoch 3, Phase test, Loss=0.5477, Acc=0.7938, AUC=0.7748, TPR=0.6559, TNR=0.8175, J=0.4734, MCC=0.3861, ConfusionMatrix=
[[1765  394]
 [ 128  244]]
Epoch 3 complete in 53.74

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3901, Acc=0.8348, AUC=0.9056, TPR=0.8259, TNR=0.8437, J=0.6697, MCC=0.6697, ConfusionMatrix=
[[3067  568]
 [ 638 3027]]
Epoch 4, Phase val, Loss=0.5348, Acc=0.7865, AUC=0.7940, TPR=0.6778, TNR=0.8059, J=0.4837, MCC=0.3918, ConfusionMatrix=
[[1752  422]
 [ 125  263]]
Epoch 4, Phase test, Loss=0.5423, Acc=0.7922, AUC=0.7854, TPR=0.6747, TNR=0.8124, J=0.4871, MCC=0.3936, ConfusionMatrix=
[[1754  405]
 [ 121  251]]
Epoch 4 complete in 38.78

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3474, Acc=0.8544, AUC=0.9253, TPR=0.8547, TNR=0.8540, J=0.7088, MCC=0.7088, ConfusionMatrix=
[[3136  536]
 [ 527 3101]]
Epoch 5, Phase val, Loss=0.4636, Acc=0.8181, AUC=0.8028, TPR=0.5851, TNR=0.8597, J=0.4448, MCC=0.3931, ConfusionMatrix=
[[1869  305]
 [ 161  227]]
Epoch 5, Phase test, Loss=0.4910, Acc=0.8202, AUC=0.7729, TPR=0.6075, TNR=0.8569, J=0.4644, MCC=0.4028, ConfusionMatrix=
[[1850  309]
 [ 146  226]]
Epoch 5 complete in 36.98

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3157, Acc=0.8675, AUC=0.9380, TPR=0.8791, TNR=0.8562, J=0.7353, MCC=0.7353, ConfusionMatrix=
[[3155  530]
 [ 437 3178]]
Epoch 6, Phase val, Loss=0.5332, Acc=0.8052, AUC=0.7606, TPR=0.5438, TNR=0.8519, J=0.3957, MCC=0.3495, ConfusionMatrix=
[[1852  322]
 [ 177  211]]
Epoch 6, Phase test, Loss=0.5025, Acc=0.8234, AUC=0.7667, TPR=0.5753, TNR=0.8661, J=0.4414, MCC=0.3917, ConfusionMatrix=
[[1870  289]
 [ 158  214]]
Epoch 6 complete in 51.04

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2920, Acc=0.8804, AUC=0.9473, TPR=0.8912, TNR=0.8698, J=0.7609, MCC=0.7610, ConfusionMatrix=
[[3193  478]
 [ 395 3234]]
Epoch 7, Phase val, Loss=0.4910, Acc=0.7990, AUC=0.7790, TPR=0.5644, TNR=0.8408, J=0.4053, MCC=0.3504, ConfusionMatrix=
[[1828  346]
 [ 169  219]]
Epoch 7, Phase test, Loss=0.4938, Acc=0.8107, AUC=0.7735, TPR=0.6156, TNR=0.8444, J=0.4600, MCC=0.3911, ConfusionMatrix=
[[1823  336]
 [ 143  229]]
Epoch 7 complete in 36.88

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2571, Acc=0.8997, AUC=0.9590, TPR=0.9028, TNR=0.8967, J=0.7995, MCC=0.7995, ConfusionMatrix=
[[3308  381]
 [ 351 3260]]
Epoch 8, Phase val, Loss=0.7195, Acc=0.7463, AUC=0.7803, TPR=0.6675, TNR=0.7603, J=0.4279, MCC=0.3333, ConfusionMatrix=
[[1653  521]
 [ 129  259]]
Epoch 8, Phase test, Loss=0.6961, Acc=0.7586, AUC=0.7794, TPR=0.6962, TNR=0.7693, J=0.4656, MCC=0.3600, ConfusionMatrix=
[[1661  498]
 [ 113  259]]
Epoch 8 complete in 38.98

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2516, Acc=0.9010, AUC=0.9599, TPR=0.9191, TNR=0.8822, J=0.8013, MCC=0.8022, ConfusionMatrix=
[[3169  423]
 [ 300 3408]]
Epoch 9, Phase val, Loss=0.5288, Acc=0.8275, AUC=0.7828, TPR=0.5129, TNR=0.8836, J=0.3965, MCC=0.3729, ConfusionMatrix=
[[1921  253]
 [ 189  199]]
Epoch 9, Phase test, Loss=0.4809, Acc=0.8526, AUC=0.7775, TPR=0.5511, TNR=0.9046, J=0.4557, MCC=0.4375, ConfusionMatrix=
[[1953  206]
 [ 167  205]]
Epoch 9 complete in 51.65

Early Stop!
Training complete in 7m 17s
The best model val AUC=0.814978328702, test AUC=0.797887811462.
Finish training resnet18-conv1x1ab-avgpool

Start training resnet18-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6190, Acc=0.6614, AUC=0.7339, TPR=0.8244, TNR=0.4946, J=0.3190, MCC=0.3384, ConfusionMatrix=
[[1785 1824]
 [ 648 3043]]
Epoch 0, Phase val, Loss=0.4831, Acc=0.7822, AUC=0.7951, TPR=0.6237, TNR=0.8105, J=0.4342, MCC=0.3570, ConfusionMatrix=
[[1762  412]
 [ 146  242]]
New Best AUC=0.7951. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5181, Acc=0.7495, AUC=0.7621, TPR=0.6075, TNR=0.7740, J=0.3815, MCC=0.3002, ConfusionMatrix=
[[1671  488]
 [ 146  226]]
Epoch 0 complete in 43.21

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4918, Acc=0.7726, AUC=0.8432, TPR=0.7384, TNR=0.8065, J=0.5449, MCC=0.5462, ConfusionMatrix=
[[2959  710]
 [ 950 2681]]
Epoch 1, Phase val, Loss=0.5663, Acc=0.7623, AUC=0.8260, TPR=0.7500, TNR=0.7645, J=0.5145, MCC=0.3976, ConfusionMatrix=
[[1662  512]
 [  97  291]]
New Best AUC=0.8260. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6233, Acc=0.7203, AUC=0.7980, TPR=0.7285, TNR=0.7189, J=0.4473, MCC=0.3328, ConfusionMatrix=
[[1552  607]
 [ 101  271]]
Epoch 1 complete in 38.28

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4444, Acc=0.7993, AUC=0.8756, TPR=0.7649, TNR=0.8335, J=0.5984, MCC=0.5999, ConfusionMatrix=
[[3053  610]
 [ 855 2782]]
Epoch 2, Phase val, Loss=0.4480, Acc=0.8033, AUC=0.8117, TPR=0.6366, TNR=0.8330, J=0.4696, MCC=0.3953, ConfusionMatrix=
[[1811  363]
 [ 141  247]]
Epoch 2, Phase test, Loss=0.4826, Acc=0.7957, AUC=0.7846, TPR=0.6237, TNR=0.8254, J=0.4490, MCC=0.3720, ConfusionMatrix=
[[1782  377]
 [ 140  232]]
Epoch 2 complete in 54.89

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4197, Acc=0.8132, AUC=0.8898, TPR=0.8032, TNR=0.8231, J=0.6263, MCC=0.6264, ConfusionMatrix=
[[3010  647]
 [ 717 2926]]
Epoch 3, Phase val, Loss=0.4284, Acc=0.8212, AUC=0.8184, TPR=0.6649, TNR=0.8491, J=0.5141, MCC=0.4388, ConfusionMatrix=
[[1846  328]
 [ 130  258]]
Epoch 3, Phase test, Loss=0.4703, Acc=0.8060, AUC=0.7922, TPR=0.6559, TNR=0.8319, J=0.4878, MCC=0.4045, ConfusionMatrix=
[[1796  363]
 [ 128  244]]
Epoch 3 complete in 37.27

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3675, Acc=0.8395, AUC=0.9165, TPR=0.8304, TNR=0.8485, J=0.6788, MCC=0.6790, ConfusionMatrix=
[[3108  555]
 [ 617 3020]]
Epoch 4, Phase val, Loss=0.4451, Acc=0.8306, AUC=0.7903, TPR=0.5515, TNR=0.8804, J=0.4320, MCC=0.3988, ConfusionMatrix=
[[1914  260]
 [ 174  214]]
Epoch 4, Phase test, Loss=0.4733, Acc=0.8242, AUC=0.7775, TPR=0.6129, TNR=0.8606, J=0.4735, MCC=0.4123, ConfusionMatrix=
[[1858  301]
 [ 144  228]]
Epoch 4 complete in 38.45

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3529, Acc=0.8474, AUC=0.9227, TPR=0.8509, TNR=0.8438, J=0.6947, MCC=0.6948, ConfusionMatrix=
[[3046  564]
 [ 550 3140]]
Epoch 5, Phase val, Loss=0.5276, Acc=0.7810, AUC=0.7765, TPR=0.5876, TNR=0.8155, J=0.4032, MCC=0.3358, ConfusionMatrix=
[[1773  401]
 [ 160  228]]
Epoch 5, Phase test, Loss=0.5353, Acc=0.7886, AUC=0.7617, TPR=0.6156, TNR=0.8184, J=0.4340, MCC=0.3572, ConfusionMatrix=
[[1767  392]
 [ 143  229]]
Epoch 5 complete in 54.82

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3278, Acc=0.8619, AUC=0.9333, TPR=0.8641, TNR=0.8597, J=0.7239, MCC=0.7238, ConfusionMatrix=
[[3150  514]
 [ 494 3142]]
Epoch 6, Phase val, Loss=0.5132, Acc=0.8044, AUC=0.7880, TPR=0.5696, TNR=0.8464, J=0.4160, MCC=0.3620, ConfusionMatrix=
[[1840  334]
 [ 167  221]]
Epoch 6, Phase test, Loss=0.5358, Acc=0.7938, AUC=0.7683, TPR=0.5860, TNR=0.8296, J=0.4156, MCC=0.3488, ConfusionMatrix=
[[1791  368]
 [ 154  218]]
Epoch 6 complete in 39.08

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2893, Acc=0.8804, AUC=0.9483, TPR=0.8849, TNR=0.8761, J=0.7610, MCC=0.7609, ConfusionMatrix=
[[3259  461]
 [ 412 3168]]
Epoch 7, Phase val, Loss=0.5187, Acc=0.8232, AUC=0.7905, TPR=0.5902, TNR=0.8648, J=0.4550, MCC=0.4046, ConfusionMatrix=
[[1880  294]
 [ 159  229]]
Epoch 7, Phase test, Loss=0.5055, Acc=0.8301, AUC=0.7915, TPR=0.5806, TNR=0.8731, J=0.4537, MCC=0.4066, ConfusionMatrix=
[[1885  274]
 [ 156  216]]
Epoch 7 complete in 37.13

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2597, Acc=0.8960, AUC=0.9576, TPR=0.9118, TNR=0.8803, J=0.7921, MCC=0.7924, ConfusionMatrix=
[[3213  437]
 [ 322 3328]]
Epoch 8, Phase val, Loss=0.5020, Acc=0.7853, AUC=0.7900, TPR=0.5747, TNR=0.8229, J=0.3976, MCC=0.3351, ConfusionMatrix=
[[1789  385]
 [ 165  223]]
Epoch 8, Phase test, Loss=0.5322, Acc=0.8048, AUC=0.7734, TPR=0.6156, TNR=0.8374, J=0.4530, MCC=0.3817, ConfusionMatrix=
[[1808  351]
 [ 143  229]]
Epoch 8 complete in 51.86

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2404, Acc=0.9059, AUC=0.9634, TPR=0.9182, TNR=0.8937, J=0.8118, MCC=0.8120, ConfusionMatrix=
[[3270  389]
 [ 298 3343]]
Epoch 9, Phase val, Loss=0.5049, Acc=0.8497, AUC=0.8053, TPR=0.5026, TNR=0.9117, J=0.4143, MCC=0.4147, ConfusionMatrix=
[[1982  192]
 [ 193  195]]
Epoch 9, Phase test, Loss=0.5293, Acc=0.8601, AUC=0.7779, TPR=0.5430, TNR=0.9148, J=0.4578, MCC=0.4509, ConfusionMatrix=
[[1975  184]
 [ 170  202]]
Epoch 9 complete in 36.85

Early Stop!
Training complete in 7m 12s
The best model val AUC=0.82595861114, test AUC=0.798028507822.
Finish training resnet18-conv1x1ab-avgpool

Start training resnet18-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6284, Acc=0.6432, AUC=0.7140, TPR=0.8133, TNR=0.4691, J=0.2824, MCC=0.3012, ConfusionMatrix=
[[1693 1916]
 [ 689 3002]]
Epoch 0, Phase val, Loss=0.5260, Acc=0.7510, AUC=0.7889, TPR=0.6263, TNR=0.7732, J=0.3995, MCC=0.3165, ConfusionMatrix=
[[1681  493]
 [ 145  243]]
New Best AUC=0.7889. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5386, Acc=0.7416, AUC=0.7689, TPR=0.6290, TNR=0.7610, J=0.3900, MCC=0.3024, ConfusionMatrix=
[[1643  516]
 [ 138  234]]
Epoch 0 complete in 40.77

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4870, Acc=0.7767, AUC=0.8447, TPR=0.7349, TNR=0.8184, J=0.5533, MCC=0.5553, ConfusionMatrix=
[[2992  664]
 [ 966 2678]]
Epoch 1, Phase val, Loss=0.4958, Acc=0.7978, AUC=0.8136, TPR=0.6521, TNR=0.8238, J=0.4759, MCC=0.3949, ConfusionMatrix=
[[1791  383]
 [ 135  253]]
New Best AUC=0.8136. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5298, Acc=0.7776, AUC=0.7755, TPR=0.6505, TNR=0.7994, J=0.4500, MCC=0.3603, ConfusionMatrix=
[[1726  433]
 [ 130  242]]
Epoch 1 complete in 56.30

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4409, Acc=0.7996, AUC=0.8772, TPR=0.7612, TNR=0.8380, J=0.5992, MCC=0.6010, ConfusionMatrix=
[[3058  591]
 [ 872 2779]]
Epoch 2, Phase val, Loss=0.4652, Acc=0.8099, AUC=0.8089, TPR=0.6598, TNR=0.8367, J=0.4965, MCC=0.4177, ConfusionMatrix=
[[1819  355]
 [ 132  256]]
Epoch 2, Phase test, Loss=0.5099, Acc=0.7827, AUC=0.7860, TPR=0.6774, TNR=0.8008, J=0.4783, MCC=0.3817, ConfusionMatrix=
[[1729  430]
 [ 120  252]]
Epoch 2 complete in 37.65

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4245, Acc=0.8096, AUC=0.8868, TPR=0.7942, TNR=0.8249, J=0.6190, MCC=0.6194, ConfusionMatrix=
[[3024  642]
 [ 748 2886]]
Epoch 3, Phase val, Loss=0.6235, Acc=0.7240, AUC=0.8059, TPR=0.7629, TNR=0.7171, J=0.4800, MCC=0.3595, ConfusionMatrix=
[[1559  615]
 [  92  296]]
Epoch 3, Phase test, Loss=0.7032, Acc=0.6634, AUC=0.7936, TPR=0.7823, TNR=0.6429, J=0.4251, MCC=0.3050, ConfusionMatrix=
[[1388  771]
 [  81  291]]
Epoch 3 complete in 36.88

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3646, Acc=0.8438, AUC=0.9183, TPR=0.8421, TNR=0.8456, J=0.6877, MCC=0.6877, ConfusionMatrix=
[[3067  560]
 [ 580 3093]]
Epoch 4, Phase val, Loss=0.4820, Acc=0.8029, AUC=0.8177, TPR=0.6701, TNR=0.8266, J=0.4967, MCC=0.4120, ConfusionMatrix=
[[1797  377]
 [ 128  260]]
New Best AUC=0.8177. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5383, Acc=0.7799, AUC=0.7826, TPR=0.6667, TNR=0.7994, J=0.4661, MCC=0.3722, ConfusionMatrix=
[[1726  433]
 [ 124  248]]
Epoch 4 complete in 56.20

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3345, Acc=0.8622, AUC=0.9308, TPR=0.8689, TNR=0.8554, J=0.7243, MCC=0.7244, ConfusionMatrix=
[[3112  526]
 [ 480 3182]]
Epoch 5, Phase val, Loss=0.6035, Acc=0.7490, AUC=0.7739, TPR=0.6985, TNR=0.7580, J=0.4565, MCC=0.3535, ConfusionMatrix=
[[1648  526]
 [ 117  271]]
Epoch 5, Phase test, Loss=0.6419, Acc=0.7147, AUC=0.7680, TPR=0.6989, TNR=0.7175, J=0.4164, MCC=0.3104, ConfusionMatrix=
[[1549  610]
 [ 112  260]]
Epoch 5 complete in 36.85

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3199, Acc=0.8703, AUC=0.9363, TPR=0.8817, TNR=0.8592, J=0.7409, MCC=0.7408, ConfusionMatrix=
[[3179  521]
 [ 426 3174]]
Epoch 6, Phase val, Loss=0.5073, Acc=0.7990, AUC=0.7882, TPR=0.6340, TNR=0.8284, J=0.4624, MCC=0.3873, ConfusionMatrix=
[[1801  373]
 [ 142  246]]
Epoch 6, Phase test, Loss=0.5593, Acc=0.7673, AUC=0.7662, TPR=0.6237, TNR=0.7920, J=0.4157, MCC=0.3319, ConfusionMatrix=
[[1710  449]
 [ 140  232]]
Epoch 6 complete in 38.85

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2944, Acc=0.8821, AUC=0.9460, TPR=0.8876, TNR=0.8769, J=0.7645, MCC=0.7641, ConfusionMatrix=
[[3304  464]
 [ 397 3135]]
Epoch 7, Phase val, Loss=0.5612, Acc=0.7775, AUC=0.7936, TPR=0.6495, TNR=0.8004, J=0.4499, MCC=0.3642, ConfusionMatrix=
[[1740  434]
 [ 136  252]]
Epoch 7, Phase test, Loss=0.5909, Acc=0.7768, AUC=0.7798, TPR=0.6774, TNR=0.7939, J=0.4713, MCC=0.3736, ConfusionMatrix=
[[1714  445]
 [ 120  252]]
Epoch 7 complete in 51.69

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2636, Acc=0.8888, AUC=0.9562, TPR=0.9068, TNR=0.8696, J=0.7765, MCC=0.7775, ConfusionMatrix=
[[3082  462]
 [ 350 3406]]
Epoch 8, Phase val, Loss=0.5156, Acc=0.8041, AUC=0.7610, TPR=0.5026, TNR=0.8579, J=0.3604, MCC=0.3250, ConfusionMatrix=
[[1865  309]
 [ 193  195]]
Epoch 8, Phase test, Loss=0.5400, Acc=0.7938, AUC=0.7485, TPR=0.5134, TNR=0.8421, J=0.3555, MCC=0.3089, ConfusionMatrix=
[[1818  341]
 [ 181  191]]
Epoch 8 complete in 44.77

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2374, Acc=0.9059, AUC=0.9641, TPR=0.9216, TNR=0.8900, J=0.8117, MCC=0.8121, ConfusionMatrix=
[[3237  400]
 [ 287 3376]]
Epoch 9, Phase val, Loss=0.6526, Acc=0.7490, AUC=0.7543, TPR=0.5799, TNR=0.7792, J=0.3591, MCC=0.2882, ConfusionMatrix=
[[1694  480]
 [ 163  225]]
Epoch 9, Phase test, Loss=0.7425, Acc=0.7246, AUC=0.7572, TPR=0.6855, TNR=0.7314, J=0.4168, MCC=0.3139, ConfusionMatrix=
[[1579  580]
 [ 117  255]]
Epoch 9 complete in 36.91

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2151, Acc=0.9186, AUC=0.9704, TPR=0.9311, TNR=0.9064, J=0.8374, MCC=0.8376, ConfusionMatrix=
[[3330  344]
 [ 250 3376]]
Epoch 10, Phase val, Loss=0.6205, Acc=0.7557, AUC=0.7947, TPR=0.6727, TNR=0.7705, J=0.4431, MCC=0.3478, ConfusionMatrix=
[[1675  499]
 [ 127  261]]
Epoch 10, Phase test, Loss=0.7076, Acc=0.7290, AUC=0.7606, TPR=0.6505, TNR=0.7425, J=0.3930, MCC=0.2995, ConfusionMatrix=
[[1603  556]
 [ 130  242]]
Epoch 10 complete in 66.04

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2102, Acc=0.9204, AUC=0.9712, TPR=0.9347, TNR=0.9066, J=0.8412, MCC=0.8412, ConfusionMatrix=
[[3357  346]
 [ 235 3362]]
Epoch 11, Phase val, Loss=0.5691, Acc=0.7951, AUC=0.7839, TPR=0.5902, TNR=0.8316, J=0.4219, MCC=0.3581, ConfusionMatrix=
[[1808  366]
 [ 159  229]]
Epoch 11, Phase test, Loss=0.5968, Acc=0.8064, AUC=0.7702, TPR=0.6048, TNR=0.8411, J=0.4460, MCC=0.3785, ConfusionMatrix=
[[1816  343]
 [ 147  225]]
Epoch 11 complete in 36.93

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.1833, Acc=0.9290, AUC=0.9781, TPR=0.9427, TNR=0.9153, J=0.8581, MCC=0.8584, ConfusionMatrix=
[[3341  309]
 [ 209 3441]]
Epoch 12, Phase val, Loss=0.5910, Acc=0.8169, AUC=0.7734, TPR=0.4613, TNR=0.8804, J=0.3417, MCC=0.3251, ConfusionMatrix=
[[1914  260]
 [ 209  179]]
Epoch 12, Phase test, Loss=0.5733, Acc=0.8348, AUC=0.7804, TPR=0.5188, TNR=0.8893, J=0.4081, MCC=0.3841, ConfusionMatrix=
[[1920  239]
 [ 179  193]]
Epoch 12 complete in 36.80

Early Stop!
Training complete in 9m 37s
The best model val AUC=0.817729326909, test AUC=0.782560623945.
Finish training resnet18-conv1x1ab-avgpool

Start training resnet18-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6259, Acc=0.6533, AUC=0.7125, TPR=0.7810, TNR=0.5188, J=0.2998, MCC=0.3113, ConfusionMatrix=
[[1845 1711]
 [ 820 2924]]
Epoch 0, Phase val, Loss=0.6965, Acc=0.6011, AUC=0.7747, TPR=0.7964, TNR=0.5662, J=0.3626, MCC=0.2601, ConfusionMatrix=
[[1231  943]
 [  79  309]]
New Best AUC=0.7747. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7229, Acc=0.5642, AUC=0.7665, TPR=0.7930, TNR=0.5248, J=0.3178, MCC=0.2253, ConfusionMatrix=
[[1133 1026]
 [  77  295]]
Epoch 0 complete in 50.87

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4796, Acc=0.7711, AUC=0.8503, TPR=0.7385, TNR=0.8046, J=0.5431, MCC=0.5440, ConfusionMatrix=
[[2898  704]
 [ 967 2731]]
Epoch 1, Phase val, Loss=0.4833, Acc=0.8201, AUC=0.8113, TPR=0.6186, TNR=0.8560, J=0.4746, MCC=0.4135, ConfusionMatrix=
[[1861  313]
 [ 148  240]]
New Best AUC=0.8113. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4914, Acc=0.8060, AUC=0.8026, TPR=0.6586, TNR=0.8314, J=0.4900, MCC=0.4059, ConfusionMatrix=
[[1795  364]
 [ 127  245]]
Epoch 1 complete in 42.96

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4558, Acc=0.7930, AUC=0.8669, TPR=0.7519, TNR=0.8335, J=0.5853, MCC=0.5875, ConfusionMatrix=
[[3068  613]
 [ 898 2721]]
Epoch 2, Phase val, Loss=0.6098, Acc=0.7330, AUC=0.7965, TPR=0.7423, TNR=0.7314, J=0.4736, MCC=0.3583, ConfusionMatrix=
[[1590  584]
 [ 100  288]]
Epoch 2, Phase test, Loss=0.6548, Acc=0.6871, AUC=0.8083, TPR=0.7769, TNR=0.6716, J=0.4485, MCC=0.3249, ConfusionMatrix=
[[1450  709]
 [  83  289]]
Epoch 2 complete in 38.67

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4193, Acc=0.8095, AUC=0.8900, TPR=0.7950, TNR=0.8242, J=0.6192, MCC=0.6193, ConfusionMatrix=
[[2978  635]
 [ 756 2931]]
Epoch 3, Phase val, Loss=0.4313, Acc=0.8349, AUC=0.7893, TPR=0.5000, TNR=0.8947, J=0.3947, MCC=0.3811, ConfusionMatrix=
[[1945  229]
 [ 194  194]]
Epoch 3, Phase test, Loss=0.4298, Acc=0.8392, AUC=0.7802, TPR=0.5860, TNR=0.8828, J=0.4688, MCC=0.4266, ConfusionMatrix=
[[1906  253]
 [ 154  218]]
Epoch 3 complete in 68.70

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3741, Acc=0.8378, AUC=0.9134, TPR=0.8212, TNR=0.8543, J=0.6755, MCC=0.6759, ConfusionMatrix=
[[3126  533]
 [ 651 2990]]
Epoch 4, Phase val, Loss=0.4547, Acc=0.8177, AUC=0.7984, TPR=0.5541, TNR=0.8648, J=0.4189, MCC=0.3763, ConfusionMatrix=
[[1880  294]
 [ 173  215]]
Epoch 4, Phase test, Loss=0.4704, Acc=0.8226, AUC=0.7869, TPR=0.6022, TNR=0.8606, J=0.4627, MCC=0.4041, ConfusionMatrix=
[[1858  301]
 [ 148  224]]
Epoch 4 complete in 38.80

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3574, Acc=0.8490, AUC=0.9217, TPR=0.8412, TNR=0.8569, J=0.6981, MCC=0.6982, ConfusionMatrix=
[[3120  521]
 [ 581 3078]]
Epoch 5, Phase val, Loss=0.4712, Acc=0.8048, AUC=0.7607, TPR=0.5490, TNR=0.8505, J=0.3995, MCC=0.3516, ConfusionMatrix=
[[1849  325]
 [ 175  213]]
Epoch 5, Phase test, Loss=0.4883, Acc=0.8001, AUC=0.7675, TPR=0.6102, TNR=0.8328, J=0.4430, MCC=0.3714, ConfusionMatrix=
[[1798  361]
 [ 145  227]]
Epoch 5 complete in 36.81

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3144, Acc=0.8705, AUC=0.9393, TPR=0.8717, TNR=0.8695, J=0.7411, MCC=0.7411, ConfusionMatrix=
[[3224  484]
 [ 461 3131]]
Epoch 6, Phase val, Loss=0.4434, Acc=0.8224, AUC=0.7921, TPR=0.5644, TNR=0.8684, J=0.4329, MCC=0.3901, ConfusionMatrix=
[[1888  286]
 [ 169  219]]
Epoch 6, Phase test, Loss=0.4529, Acc=0.8194, AUC=0.7793, TPR=0.5699, TNR=0.8624, J=0.4323, MCC=0.3819, ConfusionMatrix=
[[1862  297]
 [ 160  212]]
Epoch 6 complete in 46.50

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2965, Acc=0.8756, AUC=0.9460, TPR=0.8736, TNR=0.8776, J=0.7512, MCC=0.7511, ConfusionMatrix=
[[3269  456]
 [ 452 3123]]
Epoch 7, Phase val, Loss=0.4365, Acc=0.8298, AUC=0.7808, TPR=0.4485, TNR=0.8979, J=0.3463, MCC=0.3435, ConfusionMatrix=
[[1952  222]
 [ 214  174]]
Epoch 7, Phase test, Loss=0.4675, Acc=0.8368, AUC=0.7593, TPR=0.4892, TNR=0.8967, J=0.3860, MCC=0.3728, ConfusionMatrix=
[[1936  223]
 [ 190  182]]
Epoch 7 complete in 43.64

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2643, Acc=0.8915, AUC=0.9561, TPR=0.8983, TNR=0.8848, J=0.7831, MCC=0.7831, ConfusionMatrix=
[[3240  422]
 [ 370 3268]]
Epoch 8, Phase val, Loss=0.4761, Acc=0.8470, AUC=0.7649, TPR=0.4124, TNR=0.9246, J=0.3369, MCC=0.3634, ConfusionMatrix=
[[2010  164]
 [ 228  160]]
Epoch 8, Phase test, Loss=0.4659, Acc=0.8597, AUC=0.7548, TPR=0.4489, TNR=0.9305, J=0.3794, MCC=0.4059, ConfusionMatrix=
[[2009  150]
 [ 205  167]]
Epoch 8 complete in 38.20

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2549, Acc=0.8971, AUC=0.9592, TPR=0.9096, TNR=0.8846, J=0.7942, MCC=0.7945, ConfusionMatrix=
[[3227  421]
 [ 330 3322]]
Epoch 9, Phase val, Loss=0.4907, Acc=0.8478, AUC=0.7763, TPR=0.4407, TNR=0.9204, J=0.3611, MCC=0.3797, ConfusionMatrix=
[[2001  173]
 [ 217  171]]
Epoch 9, Phase test, Loss=0.4829, Acc=0.8514, AUC=0.7608, TPR=0.4839, TNR=0.9148, J=0.3986, MCC=0.4023, ConfusionMatrix=
[[1975  184]
 [ 192  180]]
Epoch 9 complete in 47.71

Early Stop!
Training complete in 7m 33s
The best model val AUC=0.811295512097, test AUC=0.802580595357.
Finish training resnet18-conv1x1ab-avgpool

Start training resnet18-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6111, Acc=0.6622, AUC=0.7313, TPR=0.6390, TNR=0.6854, J=0.3244, MCC=0.3247, ConfusionMatrix=
[[2503 1149]
 [1317 2331]]
Epoch 0, Phase val, Loss=0.4735, Acc=0.8333, AUC=0.7811, TPR=0.4149, TNR=0.9080, J=0.3230, MCC=0.3328, ConfusionMatrix=
[[1974  200]
 [ 227  161]]
New Best AUC=0.7811. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4773, Acc=0.8420, AUC=0.7750, TPR=0.5188, TNR=0.8976, J=0.4165, MCC=0.3987, ConfusionMatrix=
[[1938  221]
 [ 179  193]]
Epoch 0 complete in 43.58

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5117, Acc=0.7549, AUC=0.8279, TPR=0.7066, TNR=0.8024, J=0.5091, MCC=0.5116, ConfusionMatrix=
[[2953  727]
 [1062 2558]]
Epoch 1, Phase val, Loss=0.4789, Acc=0.8068, AUC=0.8152, TPR=0.6856, TNR=0.8284, J=0.5140, MCC=0.4259, ConfusionMatrix=
[[1801  373]
 [ 122  266]]
New Best AUC=0.8152. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5079, Acc=0.7890, AUC=0.7983, TPR=0.6801, TNR=0.8078, J=0.4879, MCC=0.3919, ConfusionMatrix=
[[1744  415]
 [ 119  253]]
Epoch 1 complete in 37.68

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4595, Acc=0.7859, AUC=0.8647, TPR=0.7469, TNR=0.8246, J=0.5715, MCC=0.5733, ConfusionMatrix=
[[3022  643]
 [ 920 2715]]
Epoch 2, Phase val, Loss=0.4653, Acc=0.8162, AUC=0.8141, TPR=0.6804, TNR=0.8404, J=0.5208, MCC=0.4381, ConfusionMatrix=
[[1827  347]
 [ 124  264]]
Epoch 2, Phase test, Loss=0.4803, Acc=0.8024, AUC=0.7934, TPR=0.6747, TNR=0.8245, J=0.4992, MCC=0.4088, ConfusionMatrix=
[[1780  379]
 [ 121  251]]
Epoch 2 complete in 66.56

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4290, Acc=0.8160, AUC=0.8848, TPR=0.7981, TNR=0.8335, J=0.6316, MCC=0.6321, ConfusionMatrix=
[[3083  616]
 [ 727 2874]]
Epoch 3, Phase val, Loss=0.4984, Acc=0.8126, AUC=0.8169, TPR=0.6907, TNR=0.8344, J=0.5251, MCC=0.4376, ConfusionMatrix=
[[1814  360]
 [ 120  268]]
New Best AUC=0.8169. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5325, Acc=0.7926, AUC=0.7896, TPR=0.6694, TNR=0.8138, J=0.4832, MCC=0.3914, ConfusionMatrix=
[[1757  402]
 [ 123  249]]
Epoch 3 complete in 42.51

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4062, Acc=0.8230, AUC=0.8971, TPR=0.8183, TNR=0.8278, J=0.6461, MCC=0.6461, ConfusionMatrix=
[[2991  622]
 [ 670 3017]]
Epoch 4, Phase val, Loss=0.4454, Acc=0.8150, AUC=0.8214, TPR=0.6521, TNR=0.8441, J=0.4961, MCC=0.4219, ConfusionMatrix=
[[1835  339]
 [ 135  253]]
New Best AUC=0.8214. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4760, Acc=0.8080, AUC=0.7923, TPR=0.6452, TNR=0.8360, J=0.4812, MCC=0.4020, ConfusionMatrix=
[[1805  354]
 [ 132  240]]
Epoch 4 complete in 37.56

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3815, Acc=0.8345, AUC=0.9097, TPR=0.8360, TNR=0.8330, J=0.6690, MCC=0.6690, ConfusionMatrix=
[[3012  604]
 [ 604 3080]]
Epoch 5, Phase val, Loss=0.5128, Acc=0.8087, AUC=0.8090, TPR=0.6701, TNR=0.8335, J=0.5036, MCC=0.4210, ConfusionMatrix=
[[1812  362]
 [ 128  260]]
Epoch 5, Phase test, Loss=0.5427, Acc=0.7922, AUC=0.7874, TPR=0.6559, TNR=0.8157, J=0.4716, MCC=0.3838, ConfusionMatrix=
[[1761  398]
 [ 128  244]]
Epoch 5 complete in 54.80

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3595, Acc=0.8492, AUC=0.9201, TPR=0.8536, TNR=0.8446, J=0.6982, MCC=0.6983, ConfusionMatrix=
[[3044  560]
 [ 541 3155]]
Epoch 6, Phase val, Loss=0.5013, Acc=0.7939, AUC=0.7758, TPR=0.6211, TNR=0.8247, J=0.4459, MCC=0.3728, ConfusionMatrix=
[[1793  381]
 [ 147  241]]
Epoch 6, Phase test, Loss=0.5169, Acc=0.7649, AUC=0.7877, TPR=0.6774, TNR=0.7800, J=0.4574, MCC=0.3579, ConfusionMatrix=
[[1684  475]
 [ 120  252]]
Epoch 6 complete in 37.09

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3494, Acc=0.8537, AUC=0.9243, TPR=0.8622, TNR=0.8453, J=0.7075, MCC=0.7076, ConfusionMatrix=
[[3110  569]
 [ 499 3122]]
Epoch 7, Phase val, Loss=0.5103, Acc=0.7861, AUC=0.8048, TPR=0.6624, TNR=0.8082, J=0.4706, MCC=0.3831, ConfusionMatrix=
[[1757  417]
 [ 131  257]]
Epoch 7, Phase test, Loss=0.5579, Acc=0.7610, AUC=0.7869, TPR=0.6801, TNR=0.7749, J=0.4550, MCC=0.3543, ConfusionMatrix=
[[1673  486]
 [ 119  253]]
Epoch 7 complete in 39.84

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3271, Acc=0.8660, AUC=0.9331, TPR=0.8746, TNR=0.8577, J=0.7323, MCC=0.7322, ConfusionMatrix=
[[3170  526]
 [ 452 3152]]
Epoch 8, Phase val, Loss=0.4513, Acc=0.8197, AUC=0.7870, TPR=0.5696, TNR=0.8643, J=0.4339, MCC=0.3878, ConfusionMatrix=
[[1879  295]
 [ 167  221]]
Epoch 8, Phase test, Loss=0.4400, Acc=0.8297, AUC=0.7799, TPR=0.6102, TNR=0.8675, J=0.4777, MCC=0.4208, ConfusionMatrix=
[[1873  286]
 [ 145  227]]
Epoch 8 complete in 47.66

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.3127, Acc=0.8715, AUC=0.9398, TPR=0.8792, TNR=0.8636, J=0.7428, MCC=0.7430, ConfusionMatrix=
[[3116  492]
 [ 446 3246]]
Epoch 9, Phase val, Loss=0.4770, Acc=0.8095, AUC=0.7985, TPR=0.6108, TNR=0.8450, J=0.4558, MCC=0.3919, ConfusionMatrix=
[[1837  337]
 [ 151  237]]
Epoch 9, Phase test, Loss=0.4900, Acc=0.8119, AUC=0.7831, TPR=0.6263, TNR=0.8439, J=0.4703, MCC=0.3986, ConfusionMatrix=
[[1822  337]
 [ 139  233]]
Epoch 9 complete in 37.88

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2989, Acc=0.8790, AUC=0.9445, TPR=0.8915, TNR=0.8663, J=0.7579, MCC=0.7582, ConfusionMatrix=
[[3137  484]
 [ 399 3280]]
Epoch 10, Phase val, Loss=0.4810, Acc=0.8181, AUC=0.7715, TPR=0.5851, TNR=0.8597, J=0.4448, MCC=0.3931, ConfusionMatrix=
[[1869  305]
 [ 161  227]]
Epoch 10, Phase test, Loss=0.4755, Acc=0.8186, AUC=0.7621, TPR=0.5941, TNR=0.8573, J=0.4514, MCC=0.3931, ConfusionMatrix=
[[1851  308]
 [ 151  221]]
Epoch 10 complete in 37.73

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2778, Acc=0.8892, AUC=0.9513, TPR=0.9058, TNR=0.8729, J=0.7787, MCC=0.7789, ConfusionMatrix=
[[3220  469]
 [ 340 3271]]
Epoch 11, Phase val, Loss=0.4518, Acc=0.8212, AUC=0.8001, TPR=0.5825, TNR=0.8638, J=0.4463, MCC=0.3972, ConfusionMatrix=
[[1878  296]
 [ 162  226]]
Epoch 11, Phase test, Loss=0.4915, Acc=0.8072, AUC=0.7808, TPR=0.5995, TNR=0.8430, J=0.4424, MCC=0.3769, ConfusionMatrix=
[[1820  339]
 [ 149  223]]
Epoch 11 complete in 66.30

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.2696, Acc=0.8908, AUC=0.9547, TPR=0.9023, TNR=0.8793, J=0.7816, MCC=0.7818, ConfusionMatrix=
[[3198  439]
 [ 358 3305]]
Epoch 12, Phase val, Loss=0.5795, Acc=0.7923, AUC=0.8127, TPR=0.7010, TNR=0.8086, J=0.5097, MCC=0.4123, ConfusionMatrix=
[[1758  416]
 [ 116  272]]
Epoch 12, Phase test, Loss=0.6372, Acc=0.7803, AUC=0.7975, TPR=0.6882, TNR=0.7962, J=0.4844, MCC=0.3841, ConfusionMatrix=
[[1719  440]
 [ 116  256]]
Epoch 12 complete in 37.03

Early Stop!
Training complete in 9m 46s
The best model val AUC=0.821373021368, test AUC=0.7923321729.
Finish training resnet18-conv1x1-maxpool

Start training resnet18-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6445, Acc=0.6233, AUC=0.6700, TPR=0.6642, TNR=0.5821, J=0.2464, MCC=0.2472, ConfusionMatrix=
[[2119 1521]
 [1229 2431]]
Epoch 0, Phase val, Loss=0.5265, Acc=0.7619, AUC=0.6916, TPR=0.4098, TNR=0.8247, J=0.2345, MCC=0.2061, ConfusionMatrix=
[[1793  381]
 [ 229  159]]
New Best AUC=0.6916. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5390, Acc=0.7290, AUC=0.6557, TPR=0.3710, TNR=0.7906, J=0.1616, MCC=0.1353, ConfusionMatrix=
[[1707  452]
 [ 234  138]]
Epoch 0 complete in 37.80

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5419, Acc=0.7264, AUC=0.8023, TPR=0.6943, TNR=0.7569, J=0.4512, MCC=0.4523, ConfusionMatrix=
[[2836  911]
 [1086 2467]]
Epoch 1, Phase val, Loss=0.5605, Acc=0.7931, AUC=0.8014, TPR=0.6598, TNR=0.8169, J=0.4767, MCC=0.3920, ConfusionMatrix=
[[1776  398]
 [ 132  256]]
New Best AUC=0.8014. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5781, Acc=0.7740, AUC=0.7740, TPR=0.6478, TNR=0.7957, J=0.4436, MCC=0.3540, ConfusionMatrix=
[[1718  441]
 [ 131  241]]
Epoch 1 complete in 63.57

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4909, Acc=0.7721, AUC=0.8443, TPR=0.7291, TNR=0.8138, J=0.5429, MCC=0.5452, ConfusionMatrix=
[[3012  689]
 [ 975 2624]]
Epoch 2, Phase val, Loss=0.4617, Acc=0.8208, AUC=0.8020, TPR=0.5928, TNR=0.8615, J=0.4543, MCC=0.4018, ConfusionMatrix=
[[1873  301]
 [ 158  230]]
New Best AUC=0.8020. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4916, Acc=0.8131, AUC=0.7819, TPR=0.5860, TNR=0.8522, J=0.4383, MCC=0.3796, ConfusionMatrix=
[[1840  319]
 [ 154  218]]
Epoch 2 complete in 38.51

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4651, Acc=0.7888, AUC=0.8607, TPR=0.7456, TNR=0.8315, J=0.5771, MCC=0.5794, ConfusionMatrix=
[[3050  618]
 [ 924 2708]]
Epoch 3, Phase val, Loss=0.5437, Acc=0.7814, AUC=0.8166, TPR=0.7216, TNR=0.7921, J=0.5137, MCC=0.4077, ConfusionMatrix=
[[1722  452]
 [ 108  280]]
New Best AUC=0.8166. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5887, Acc=0.7554, AUC=0.7867, TPR=0.6989, TNR=0.7652, J=0.4641, MCC=0.3576, ConfusionMatrix=
[[1652  507]
 [ 112  260]]
Epoch 3 complete in 39.07

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4275, Acc=0.8082, AUC=0.8847, TPR=0.7846, TNR=0.8325, J=0.6170, MCC=0.6175, ConfusionMatrix=
[[3001  604]
 [ 796 2899]]
Epoch 4, Phase val, Loss=0.4327, Acc=0.8263, AUC=0.8150, TPR=0.5902, TNR=0.8684, J=0.4587, MCC=0.4103, ConfusionMatrix=
[[1888  286]
 [ 159  229]]
Epoch 4, Phase test, Loss=0.4407, Acc=0.8360, AUC=0.7937, TPR=0.6156, TNR=0.8740, J=0.4896, MCC=0.4351, ConfusionMatrix=
[[1887  272]
 [ 143  229]]
Epoch 4 complete in 74.14

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4100, Acc=0.8200, AUC=0.8949, TPR=0.8105, TNR=0.8298, J=0.6402, MCC=0.6402, ConfusionMatrix=
[[2993  614]
 [ 700 2993]]
Epoch 5, Phase val, Loss=0.5025, Acc=0.7787, AUC=0.8026, TPR=0.6907, TNR=0.7944, J=0.4851, MCC=0.3877, ConfusionMatrix=
[[1727  447]
 [ 120  268]]
Epoch 5, Phase test, Loss=0.5274, Acc=0.7756, AUC=0.7775, TPR=0.6532, TNR=0.7967, J=0.4499, MCC=0.3590, ConfusionMatrix=
[[1720  439]
 [ 129  243]]
Epoch 5 complete in 36.81

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3862, Acc=0.8334, AUC=0.9073, TPR=0.8330, TNR=0.8338, J=0.6669, MCC=0.6668, ConfusionMatrix=
[[3001  598]
 [ 618 3083]]
Epoch 6, Phase val, Loss=0.4472, Acc=0.8185, AUC=0.8155, TPR=0.6186, TNR=0.8542, J=0.4727, MCC=0.4109, ConfusionMatrix=
[[1857  317]
 [ 148  240]]
Epoch 6, Phase test, Loss=0.4872, Acc=0.7965, AUC=0.7891, TPR=0.6398, TNR=0.8235, J=0.4633, MCC=0.3817, ConfusionMatrix=
[[1778  381]
 [ 134  238]]
Epoch 6 complete in 37.73

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3547, Acc=0.8464, AUC=0.9221, TPR=0.8527, TNR=0.8400, J=0.6927, MCC=0.6928, ConfusionMatrix=
[[3029  577]
 [ 544 3150]]
Epoch 7, Phase val, Loss=0.5274, Acc=0.7756, AUC=0.8048, TPR=0.6727, TNR=0.7939, J=0.4666, MCC=0.3739, ConfusionMatrix=
[[1726  448]
 [ 127  261]]
Epoch 7, Phase test, Loss=0.5694, Acc=0.7641, AUC=0.7773, TPR=0.6801, TNR=0.7786, J=0.4587, MCC=0.3584, ConfusionMatrix=
[[1681  478]
 [ 119  253]]
Epoch 7 complete in 56.94

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3378, Acc=0.8593, AUC=0.9295, TPR=0.8600, TNR=0.8587, J=0.7186, MCC=0.7186, ConfusionMatrix=
[[3153  519]
 [ 508 3120]]
Epoch 8, Phase val, Loss=0.4573, Acc=0.7966, AUC=0.8085, TPR=0.6418, TNR=0.8243, J=0.4660, MCC=0.3878, ConfusionMatrix=
[[1792  382]
 [ 139  249]]
Epoch 8, Phase test, Loss=0.5279, Acc=0.7780, AUC=0.7807, TPR=0.6801, TNR=0.7948, J=0.4749, MCC=0.3766, ConfusionMatrix=
[[1716  443]
 [ 119  253]]
Epoch 8 complete in 37.80

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.3249, Acc=0.8636, AUC=0.9348, TPR=0.8638, TNR=0.8633, J=0.7271, MCC=0.7271, ConfusionMatrix=
[[3183  504]
 [ 492 3121]]
Epoch 9, Phase val, Loss=0.5030, Acc=0.7978, AUC=0.8066, TPR=0.6366, TNR=0.8266, J=0.4632, MCC=0.3868, ConfusionMatrix=
[[1797  377]
 [ 141  247]]
Epoch 9, Phase test, Loss=0.5847, Acc=0.7839, AUC=0.7767, TPR=0.6344, TNR=0.8096, J=0.4440, MCC=0.3604, ConfusionMatrix=
[[1748  411]
 [ 136  236]]
Epoch 9 complete in 37.36

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.3173, Acc=0.8649, AUC=0.9379, TPR=0.8704, TNR=0.8596, J=0.7300, MCC=0.7299, ConfusionMatrix=
[[3183  520]
 [ 466 3131]]
Epoch 10, Phase val, Loss=0.5217, Acc=0.7826, AUC=0.8107, TPR=0.6753, TNR=0.8017, J=0.4770, MCC=0.3849, ConfusionMatrix=
[[1743  431]
 [ 126  262]]
Epoch 10, Phase test, Loss=0.6376, Acc=0.7452, AUC=0.7703, TPR=0.6828, TNR=0.7559, J=0.4387, MCC=0.3363, ConfusionMatrix=
[[1632  527]
 [ 118  254]]
Epoch 10 complete in 66.12

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2880, Acc=0.8792, AUC=0.9489, TPR=0.8908, TNR=0.8677, J=0.7586, MCC=0.7586, ConfusionMatrix=
[[3195  487]
 [ 395 3223]]
Epoch 11, Phase val, Loss=0.4660, Acc=0.8333, AUC=0.7952, TPR=0.5284, TNR=0.8878, J=0.4161, MCC=0.3924, ConfusionMatrix=
[[1930  244]
 [ 183  205]]
Epoch 11, Phase test, Loss=0.4731, Acc=0.8507, AUC=0.7610, TPR=0.5269, TNR=0.9064, J=0.4333, MCC=0.4215, ConfusionMatrix=
[[1957  202]
 [ 176  196]]
Epoch 11 complete in 38.21

Early Stop!
Training complete in 9m 24s
The best model val AUC=0.816645169245, test AUC=0.786660739988.
Finish training resnet18-conv1x1-maxpool

Start training resnet18-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6337, Acc=0.6374, AUC=0.6925, TPR=0.6722, TNR=0.6011, J=0.2733, MCC=0.2741, ConfusionMatrix=
[[2149 1426]
 [1221 2504]]
Epoch 0, Phase val, Loss=0.4470, Acc=0.8185, AUC=0.7500, TPR=0.3840, TNR=0.8960, J=0.2801, MCC=0.2840, ConfusionMatrix=
[[1948  226]
 [ 239  149]]
New Best AUC=0.7500. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4778, Acc=0.8194, AUC=0.7342, TPR=0.4301, TNR=0.8865, J=0.3166, MCC=0.3058, ConfusionMatrix=
[[1914  245]
 [ 212  160]]
Epoch 0 complete in 37.89

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5073, Acc=0.7582, AUC=0.8306, TPR=0.7111, TNR=0.8050, J=0.5160, MCC=0.5184, ConfusionMatrix=
[[2951  715]
 [1050 2584]]
Epoch 1, Phase val, Loss=0.5416, Acc=0.7869, AUC=0.8155, TPR=0.7397, TNR=0.7953, J=0.5350, MCC=0.4245, ConfusionMatrix=
[[1729  445]
 [ 101  287]]
New Best AUC=0.8155. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5598, Acc=0.7570, AUC=0.7927, TPR=0.7043, TNR=0.7661, J=0.4704, MCC=0.3624, ConfusionMatrix=
[[1654  505]
 [ 110  262]]
Epoch 1 complete in 78.68

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4677, Acc=0.7871, AUC=0.8587, TPR=0.7406, TNR=0.8324, J=0.5730, MCC=0.5758, ConfusionMatrix=
[[3079  620]
 [ 934 2667]]
Epoch 2, Phase val, Loss=0.4495, Acc=0.8103, AUC=0.8141, TPR=0.6237, TNR=0.8436, J=0.4673, MCC=0.3998, ConfusionMatrix=
[[1834  340]
 [ 146  242]]
Epoch 2, Phase test, Loss=0.4970, Acc=0.7851, AUC=0.7871, TPR=0.6882, TNR=0.8018, J=0.4899, MCC=0.3906, ConfusionMatrix=
[[1731  428]
 [ 116  256]]
Epoch 2 complete in 36.93

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4480, Acc=0.7955, AUC=0.8718, TPR=0.7634, TNR=0.8286, J=0.5920, MCC=0.5928, ConfusionMatrix=
[[2978  616]
 [ 877 2829]]
Epoch 3, Phase val, Loss=0.4553, Acc=0.8099, AUC=0.8107, TPR=0.6495, TNR=0.8385, J=0.4880, MCC=0.4124, ConfusionMatrix=
[[1823  351]
 [ 136  252]]
Epoch 3, Phase test, Loss=0.4831, Acc=0.7981, AUC=0.7937, TPR=0.6613, TNR=0.8217, J=0.4830, MCC=0.3953, ConfusionMatrix=
[[1774  385]
 [ 126  246]]
Epoch 3 complete in 38.50

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4343, Acc=0.8074, AUC=0.8811, TPR=0.7876, TNR=0.8272, J=0.6148, MCC=0.6153, ConfusionMatrix=
[[3020  631]
 [ 775 2874]]
Epoch 4, Phase val, Loss=0.4186, Acc=0.8349, AUC=0.7948, TPR=0.5799, TNR=0.8804, J=0.4603, MCC=0.4212, ConfusionMatrix=
[[1914  260]
 [ 163  225]]
Epoch 4, Phase test, Loss=0.4340, Acc=0.8289, AUC=0.7948, TPR=0.6210, TNR=0.8648, J=0.4857, MCC=0.4248, ConfusionMatrix=
[[1867  292]
 [ 141  231]]
Epoch 4 complete in 70.85

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3942, Acc=0.8267, AUC=0.9028, TPR=0.8071, TNR=0.8459, J=0.6530, MCC=0.6537, ConfusionMatrix=
[[3119  568]
 [ 697 2916]]
Epoch 5, Phase val, Loss=0.4065, Acc=0.8271, AUC=0.8192, TPR=0.6186, TNR=0.8643, J=0.4829, MCC=0.4259, ConfusionMatrix=
[[1879  295]
 [ 148  240]]
New Best AUC=0.8192. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.4289, Acc=0.8234, AUC=0.7904, TPR=0.6425, TNR=0.8546, J=0.4970, MCC=0.4259, ConfusionMatrix=
[[1845  314]
 [ 133  239]]
Epoch 5 complete in 37.15

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3745, Acc=0.8418, AUC=0.9129, TPR=0.8300, TNR=0.8531, J=0.6831, MCC=0.6834, ConfusionMatrix=
[[3176  547]
 [ 608 2969]]
Epoch 6, Phase val, Loss=0.4264, Acc=0.8259, AUC=0.7977, TPR=0.5876, TNR=0.8684, J=0.4561, MCC=0.4083, ConfusionMatrix=
[[1888  286]
 [ 160  228]]
Epoch 6, Phase test, Loss=0.4345, Acc=0.8408, AUC=0.7943, TPR=0.6425, TNR=0.8749, J=0.5174, MCC=0.4571, ConfusionMatrix=
[[1889  270]
 [ 133  239]]
Epoch 6 complete in 37.19

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3506, Acc=0.8545, AUC=0.9239, TPR=0.8571, TNR=0.8520, J=0.7091, MCC=0.7091, ConfusionMatrix=
[[3126  543]
 [ 519 3112]]
Epoch 7, Phase val, Loss=0.4335, Acc=0.8267, AUC=0.8096, TPR=0.6366, TNR=0.8606, J=0.4972, MCC=0.4341, ConfusionMatrix=
[[1871  303]
 [ 141  247]]
Epoch 7, Phase test, Loss=0.4545, Acc=0.8202, AUC=0.7792, TPR=0.6344, TNR=0.8522, J=0.4867, MCC=0.4165, ConfusionMatrix=
[[1840  319]
 [ 136  236]]
Epoch 7 complete in 36.07

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3360, Acc=0.8616, AUC=0.9299, TPR=0.8795, TNR=0.8430, J=0.7225, MCC=0.7233, ConfusionMatrix=
[[3007  560]
 [ 450 3283]]
Epoch 8, Phase val, Loss=0.4612, Acc=0.8337, AUC=0.8027, TPR=0.5799, TNR=0.8790, J=0.4589, MCC=0.4190, ConfusionMatrix=
[[1911  263]
 [ 163  225]]
Epoch 8, Phase test, Loss=0.4574, Acc=0.8384, AUC=0.7975, TPR=0.6317, TNR=0.8740, J=0.5057, MCC=0.4474, ConfusionMatrix=
[[1887  272]
 [ 137  235]]
Epoch 8 complete in 38.49

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.3211, Acc=0.8682, AUC=0.9361, TPR=0.8769, TNR=0.8596, J=0.7365, MCC=0.7366, ConfusionMatrix=
[[3141  513]
 [ 449 3197]]
Epoch 9, Phase val, Loss=0.5060, Acc=0.7802, AUC=0.7895, TPR=0.6624, TNR=0.8013, J=0.4637, MCC=0.3749, ConfusionMatrix=
[[1742  432]
 [ 131  257]]
Epoch 9, Phase test, Loss=0.5591, Acc=0.7669, AUC=0.7809, TPR=0.6962, TNR=0.7791, J=0.4753, MCC=0.3706, ConfusionMatrix=
[[1682  477]
 [ 113  259]]
Epoch 9 complete in 36.05

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.3013, Acc=0.8777, AUC=0.9435, TPR=0.8960, TNR=0.8589, J=0.7549, MCC=0.7557, ConfusionMatrix=
[[3098  509]
 [ 384 3309]]
Epoch 10, Phase val, Loss=0.4575, Acc=0.8240, AUC=0.7910, TPR=0.5876, TNR=0.8661, J=0.4538, MCC=0.4047, ConfusionMatrix=
[[1883  291]
 [ 160  228]]
Epoch 10, Phase test, Loss=0.4721, Acc=0.8171, AUC=0.7722, TPR=0.5914, TNR=0.8560, J=0.4473, MCC=0.3890, ConfusionMatrix=
[[1848  311]
 [ 152  220]]
Epoch 10 complete in 37.21

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2897, Acc=0.8819, AUC=0.9478, TPR=0.8950, TNR=0.8689, J=0.7640, MCC=0.7642, ConfusionMatrix=
[[3189  481]
 [ 381 3249]]
Epoch 11, Phase val, Loss=0.5431, Acc=0.7869, AUC=0.7828, TPR=0.6031, TNR=0.8197, J=0.4228, MCC=0.3527, ConfusionMatrix=
[[1782  392]
 [ 154  234]]
Epoch 11, Phase test, Loss=0.5802, Acc=0.7701, AUC=0.7727, TPR=0.6667, TNR=0.7879, J=0.4545, MCC=0.3589, ConfusionMatrix=
[[1701  458]
 [ 124  248]]
Epoch 11 complete in 36.29

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.2644, Acc=0.8918, AUC=0.9563, TPR=0.9029, TNR=0.8810, J=0.7839, MCC=0.7838, ConfusionMatrix=
[[3264  441]
 [ 349 3246]]
Epoch 12, Phase val, Loss=0.4503, Acc=0.8290, AUC=0.8035, TPR=0.5696, TNR=0.8753, J=0.4449, MCC=0.4049, ConfusionMatrix=
[[1903  271]
 [ 167  221]]
Epoch 12, Phase test, Loss=0.4868, Acc=0.8190, AUC=0.7851, TPR=0.6237, TNR=0.8527, J=0.4764, MCC=0.4090, ConfusionMatrix=
[[1841  318]
 [ 140  232]]
Epoch 12 complete in 36.46

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.2531, Acc=0.8990, AUC=0.9597, TPR=0.9135, TNR=0.8849, J=0.7984, MCC=0.7985, ConfusionMatrix=
[[3269  425]
 [ 312 3294]]
Epoch 13, Phase val, Loss=0.4802, Acc=0.8349, AUC=0.7635, TPR=0.4046, TNR=0.9117, J=0.3163, MCC=0.3306, ConfusionMatrix=
[[1982  192]
 [ 231  157]]
Epoch 13, Phase test, Loss=0.4485, Acc=0.8550, AUC=0.7881, TPR=0.4973, TNR=0.9166, J=0.4139, MCC=0.4172, ConfusionMatrix=
[[1979  180]
 [ 187  185]]
Epoch 13 complete in 37.18

Early Stop!
Training complete in 9m 55s
The best model val AUC=0.819151357657, test AUC=0.79042716909.
Finish training resnet18-conv1x1-maxpool

Start training resnet18-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6177, Acc=0.6456, AUC=0.7130, TPR=0.6007, TNR=0.6892, J=0.2899, MCC=0.2911, ConfusionMatrix=
[[2554 1152]
 [1435 2159]]
Epoch 0, Phase val, Loss=0.5455, Acc=0.8029, AUC=0.7849, TPR=0.5284, TNR=0.8519, J=0.3802, MCC=0.3372, ConfusionMatrix=
[[1852  322]
 [ 183  205]]
New Best AUC=0.7849. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5553, Acc=0.7977, AUC=0.7613, TPR=0.5349, TNR=0.8430, J=0.3779, MCC=0.3271, ConfusionMatrix=
[[1820  339]
 [ 173  199]]
Epoch 0 complete in 38.76

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5109, Acc=0.7600, AUC=0.8296, TPR=0.7100, TNR=0.8094, J=0.5194, MCC=0.5221, ConfusionMatrix=
[[2973  700]
 [1052 2575]]
Epoch 1, Phase val, Loss=0.4204, Acc=0.8423, AUC=0.8094, TPR=0.5309, TNR=0.8979, J=0.4288, MCC=0.4121, ConfusionMatrix=
[[1952  222]
 [ 182  206]]
New Best AUC=0.8094. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4344, Acc=0.8566, AUC=0.7802, TPR=0.5511, TNR=0.9092, J=0.4603, MCC=0.4463, ConfusionMatrix=
[[1963  196]
 [ 167  205]]
Epoch 1 complete in 37.14

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4685, Acc=0.7879, AUC=0.8579, TPR=0.7395, TNR=0.8365, J=0.5760, MCC=0.5787, ConfusionMatrix=
[[3050  596]
 [ 952 2702]]
Epoch 2, Phase val, Loss=0.4141, Acc=0.8322, AUC=0.7973, TPR=0.5206, TNR=0.8878, J=0.4084, MCC=0.3861, ConfusionMatrix=
[[1930  244]
 [ 186  202]]
Epoch 2, Phase test, Loss=0.4384, Acc=0.8305, AUC=0.7738, TPR=0.5806, TNR=0.8736, J=0.4542, MCC=0.4073, ConfusionMatrix=
[[1886  273]
 [ 156  216]]
Epoch 2 complete in 37.77

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4449, Acc=0.7979, AUC=0.8735, TPR=0.7606, TNR=0.8346, J=0.5952, MCC=0.5971, ConfusionMatrix=
[[3074  609]
 [ 866 2751]]
Epoch 3, Phase val, Loss=0.4405, Acc=0.8329, AUC=0.7913, TPR=0.5747, TNR=0.8790, J=0.4538, MCC=0.4149, ConfusionMatrix=
[[1911  263]
 [ 165  223]]
Epoch 3, Phase test, Loss=0.4719, Acc=0.8238, AUC=0.7780, TPR=0.6102, TNR=0.8606, J=0.4708, MCC=0.4103, ConfusionMatrix=
[[1858  301]
 [ 145  227]]
Epoch 3 complete in 36.32

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4182, Acc=0.8200, AUC=0.8882, TPR=0.7898, TNR=0.8500, J=0.6397, MCC=0.6410, ConfusionMatrix=
[[3116  550]
 [ 764 2870]]
Epoch 4, Phase val, Loss=0.4372, Acc=0.8443, AUC=0.8014, TPR=0.5593, TNR=0.8951, J=0.4544, MCC=0.4300, ConfusionMatrix=
[[1946  228]
 [ 171  217]]
Epoch 4, Phase test, Loss=0.4432, Acc=0.8510, AUC=0.7695, TPR=0.5914, TNR=0.8958, J=0.4872, MCC=0.4532, ConfusionMatrix=
[[1934  225]
 [ 152  220]]
Epoch 4 complete in 37.21

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4078, Acc=0.8267, AUC=0.8951, TPR=0.7983, TNR=0.8550, J=0.6533, MCC=0.6544, ConfusionMatrix=
[[3126  530]
 [ 735 2909]]
Epoch 5, Phase val, Loss=0.4155, Acc=0.8388, AUC=0.7974, TPR=0.5515, TNR=0.8901, J=0.4416, MCC=0.4150, ConfusionMatrix=
[[1935  239]
 [ 174  214]]
Epoch 5, Phase test, Loss=0.4304, Acc=0.8352, AUC=0.7795, TPR=0.6102, TNR=0.8740, J=0.4842, MCC=0.4310, ConfusionMatrix=
[[1887  272]
 [ 145  227]]
Epoch 5 complete in 36.22

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3747, Acc=0.8410, AUC=0.9125, TPR=0.8341, TNR=0.8479, J=0.6819, MCC=0.6820, ConfusionMatrix=
[[3093  555]
 [ 606 3046]]
Epoch 6, Phase val, Loss=0.4943, Acc=0.8005, AUC=0.7980, TPR=0.6546, TNR=0.8266, J=0.4812, MCC=0.4004, ConfusionMatrix=
[[1797  377]
 [ 134  254]]
Epoch 6, Phase test, Loss=0.5159, Acc=0.7949, AUC=0.7866, TPR=0.6909, TNR=0.8129, J=0.5037, MCC=0.4061, ConfusionMatrix=
[[1755  404]
 [ 115  257]]
Epoch 6 complete in 37.43

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3590, Acc=0.8462, AUC=0.9200, TPR=0.8354, TNR=0.8567, J=0.6921, MCC=0.6923, ConfusionMatrix=
[[3163  529]
 [ 594 3014]]
Epoch 7, Phase val, Loss=0.5210, Acc=0.8216, AUC=0.7522, TPR=0.5335, TNR=0.8730, J=0.4066, MCC=0.3726, ConfusionMatrix=
[[1898  276]
 [ 181  207]]
Epoch 7, Phase test, Loss=0.5275, Acc=0.8254, AUC=0.7642, TPR=0.6156, TNR=0.8615, J=0.4771, MCC=0.4158, ConfusionMatrix=
[[1860  299]
 [ 143  229]]
Epoch 7 complete in 37.35

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3521, Acc=0.8533, AUC=0.9235, TPR=0.8537, TNR=0.8529, J=0.7066, MCC=0.7066, ConfusionMatrix=
[[3102  535]
 [ 536 3127]]
Epoch 8, Phase val, Loss=0.5684, Acc=0.7728, AUC=0.7561, TPR=0.6057, TNR=0.8027, J=0.4083, MCC=0.3341, ConfusionMatrix=
[[1745  429]
 [ 153  235]]
Epoch 8, Phase test, Loss=0.6001, Acc=0.7621, AUC=0.7720, TPR=0.6720, TNR=0.7777, J=0.4497, MCC=0.3515, ConfusionMatrix=
[[1679  480]
 [ 122  250]]
Epoch 8 complete in 36.37

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.3312, Acc=0.8632, AUC=0.9319, TPR=0.8773, TNR=0.8486, J=0.7260, MCC=0.7264, ConfusionMatrix=
[[3061  546]
 [ 453 3240]]
Epoch 9, Phase val, Loss=0.4678, Acc=0.8283, AUC=0.7693, TPR=0.5206, TNR=0.8832, J=0.4038, MCC=0.3784, ConfusionMatrix=
[[1920  254]
 [ 186  202]]
Epoch 9, Phase test, Loss=0.4437, Acc=0.8550, AUC=0.7790, TPR=0.5833, TNR=0.9018, J=0.4851, MCC=0.4578, ConfusionMatrix=
[[1947  212]
 [ 155  217]]
Epoch 9 complete in 36.11

Early Stop!
Training complete in 6m 11s
The best model val AUC=0.809386232798, test AUC=0.78022108005.
Finish training resnet18-conv1x1-maxpool

Start training resnet18-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5485, Acc=0.7132, AUC=0.7955, TPR=0.7279, TNR=0.6984, J=0.4263, MCC=0.4265, ConfusionMatrix=
[[2549 1101]
 [ 993 2657]]
Epoch 0, Phase val, Loss=0.7012, Acc=0.6573, AUC=0.7885, TPR=0.7603, TNR=0.6389, J=0.3992, MCC=0.2898, ConfusionMatrix=
[[1389  785]
 [  93  295]]
New Best AUC=0.7885. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7508, Acc=0.6191, AUC=0.7852, TPR=0.7661, TNR=0.5938, J=0.3599, MCC=0.2557, ConfusionMatrix=
[[1282  877]
 [  87  285]]
Epoch 0 complete in 39.38

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4658, Acc=0.7808, AUC=0.8618, TPR=0.7547, TNR=0.8079, J=0.5626, MCC=0.5630, ConfusionMatrix=
[[2897  689]
 [ 911 2803]]
Epoch 1, Phase val, Loss=0.5514, Acc=0.7744, AUC=0.8041, TPR=0.7268, TNR=0.7829, J=0.5097, MCC=0.4009, ConfusionMatrix=
[[1702  472]
 [ 106  282]]
New Best AUC=0.8041. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6039, Acc=0.7246, AUC=0.7993, TPR=0.7285, TNR=0.7239, J=0.4524, MCC=0.3376, ConfusionMatrix=
[[1563  596]
 [ 101  271]]
Epoch 1 complete in 37.23

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4211, Acc=0.8123, AUC=0.8890, TPR=0.8056, TNR=0.8191, J=0.6246, MCC=0.6247, ConfusionMatrix=
[[2992  661]
 [ 709 2938]]
Epoch 2, Phase val, Loss=0.4532, Acc=0.8017, AUC=0.8010, TPR=0.6134, TNR=0.8353, J=0.4487, MCC=0.3807, ConfusionMatrix=
[[1816  358]
 [ 150  238]]
Epoch 2, Phase test, Loss=0.5070, Acc=0.7795, AUC=0.7766, TPR=0.6263, TNR=0.8059, J=0.4323, MCC=0.3500, ConfusionMatrix=
[[1740  419]
 [ 139  233]]
Epoch 2 complete in 36.73

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3782, Acc=0.8349, AUC=0.9113, TPR=0.8366, TNR=0.8332, J=0.6698, MCC=0.6697, ConfusionMatrix=
[[2977  596]
 [ 609 3118]]
Epoch 3, Phase val, Loss=0.4286, Acc=0.8302, AUC=0.7928, TPR=0.5464, TNR=0.8809, J=0.4273, MCC=0.3954, ConfusionMatrix=
[[1915  259]
 [ 176  212]]
Epoch 3, Phase test, Loss=0.4508, Acc=0.8380, AUC=0.7718, TPR=0.5968, TNR=0.8796, J=0.4763, MCC=0.4296, ConfusionMatrix=
[[1899  260]
 [ 150  222]]
Epoch 3 complete in 36.17

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3424, Acc=0.8537, AUC=0.9272, TPR=0.8635, TNR=0.8436, J=0.7071, MCC=0.7073, ConfusionMatrix=
[[3026  561]
 [ 507 3206]]
Epoch 4, Phase val, Loss=0.5035, Acc=0.7947, AUC=0.7912, TPR=0.6314, TNR=0.8238, J=0.4553, MCC=0.3794, ConfusionMatrix=
[[1791  383]
 [ 143  245]]
Epoch 4, Phase test, Loss=0.5463, Acc=0.7874, AUC=0.7664, TPR=0.6183, TNR=0.8166, J=0.4349, MCC=0.3569, ConfusionMatrix=
[[1763  396]
 [ 142  230]]
Epoch 4 complete in 37.77

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3202, Acc=0.8656, AUC=0.9363, TPR=0.8770, TNR=0.8543, J=0.7313, MCC=0.7314, ConfusionMatrix=
[[3125  533]
 [ 448 3194]]
Epoch 5, Phase val, Loss=0.5397, Acc=0.8169, AUC=0.7912, TPR=0.5979, TNR=0.8560, J=0.4540, MCC=0.3977, ConfusionMatrix=
[[1861  313]
 [ 156  232]]
Epoch 5, Phase test, Loss=0.5408, Acc=0.8222, AUC=0.7718, TPR=0.5887, TNR=0.8624, J=0.4511, MCC=0.3965, ConfusionMatrix=
[[1862  297]
 [ 153  219]]
Epoch 5 complete in 37.34

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2812, Acc=0.8895, AUC=0.9508, TPR=0.9002, TNR=0.8786, J=0.7788, MCC=0.7790, ConfusionMatrix=
[[3193  441]
 [ 366 3300]]
Epoch 6, Phase val, Loss=0.4479, Acc=0.8454, AUC=0.7858, TPR=0.3918, TNR=0.9264, J=0.3182, MCC=0.3488, ConfusionMatrix=
[[2014  160]
 [ 236  152]]
Epoch 6, Phase test, Loss=0.4507, Acc=0.8578, AUC=0.7573, TPR=0.4435, TNR=0.9291, J=0.3727, MCC=0.3981, ConfusionMatrix=
[[2006  153]
 [ 207  165]]
Epoch 6 complete in 36.51

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2750, Acc=0.8918, AUC=0.9526, TPR=0.9035, TNR=0.8802, J=0.7838, MCC=0.7838, ConfusionMatrix=
[[3241  441]
 [ 349 3269]]
Epoch 7, Phase val, Loss=0.5235, Acc=0.7963, AUC=0.8013, TPR=0.6340, TNR=0.8252, J=0.4592, MCC=0.3831, ConfusionMatrix=
[[1794  380]
 [ 142  246]]
Epoch 7, Phase test, Loss=0.5667, Acc=0.7855, AUC=0.7709, TPR=0.6183, TNR=0.8143, J=0.4325, MCC=0.3540, ConfusionMatrix=
[[1758  401]
 [ 142  230]]
Epoch 7 complete in 36.20

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2346, Acc=0.9088, AUC=0.9645, TPR=0.9204, TNR=0.8972, J=0.8176, MCC=0.8178, ConfusionMatrix=
[[3280  376]
 [ 290 3354]]
Epoch 8, Phase val, Loss=0.5209, Acc=0.8033, AUC=0.7888, TPR=0.5670, TNR=0.8454, J=0.4125, MCC=0.3587, ConfusionMatrix=
[[1838  336]
 [ 168  220]]
Epoch 8, Phase test, Loss=0.5387, Acc=0.8143, AUC=0.7640, TPR=0.5968, TNR=0.8518, J=0.4486, MCC=0.3872, ConfusionMatrix=
[[1839  320]
 [ 150  222]]
Epoch 8 complete in 38.28

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2177, Acc=0.9151, AUC=0.9696, TPR=0.9294, TNR=0.9010, J=0.8304, MCC=0.8305, ConfusionMatrix=
[[3323  365]
 [ 255 3357]]
Epoch 9, Phase val, Loss=0.5710, Acc=0.8318, AUC=0.8055, TPR=0.5284, TNR=0.8859, J=0.4143, MCC=0.3893, ConfusionMatrix=
[[1926  248]
 [ 183  205]]
New Best AUC=0.8055. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.6104, Acc=0.8431, AUC=0.7677, TPR=0.5726, TNR=0.8898, J=0.4623, MCC=0.4278, ConfusionMatrix=
[[1921  238]
 [ 159  213]]
Epoch 9 complete in 37.43

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2072, Acc=0.9215, AUC=0.9720, TPR=0.9322, TNR=0.9107, J=0.8430, MCC=0.8432, ConfusionMatrix=
[[3315  325]
 [ 248 3412]]
Epoch 10, Phase val, Loss=0.5458, Acc=0.8123, AUC=0.8009, TPR=0.5387, TNR=0.8611, J=0.3997, MCC=0.3586, ConfusionMatrix=
[[1872  302]
 [ 179  209]]
Epoch 10, Phase test, Loss=0.6329, Acc=0.7961, AUC=0.7629, TPR=0.5780, TNR=0.8337, J=0.4117, MCC=0.3481, ConfusionMatrix=
[[1800  359]
 [ 157  215]]
Epoch 10 complete in 37.20

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.1801, Acc=0.9307, AUC=0.9789, TPR=0.9401, TNR=0.9213, J=0.8614, MCC=0.8615, ConfusionMatrix=
[[3372  288]
 [ 218 3422]]
Epoch 11, Phase val, Loss=0.5736, Acc=0.8439, AUC=0.7801, TPR=0.3479, TNR=0.9324, J=0.2803, MCC=0.3211, ConfusionMatrix=
[[2027  147]
 [ 253  135]]
Epoch 11, Phase test, Loss=0.5650, Acc=0.8645, AUC=0.7566, TPR=0.4167, TNR=0.9416, J=0.3583, MCC=0.4038, ConfusionMatrix=
[[2033  126]
 [ 217  155]]
Epoch 11 complete in 36.14

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.1685, Acc=0.9371, AUC=0.9811, TPR=0.9479, TNR=0.9264, J=0.8743, MCC=0.8745, ConfusionMatrix=
[[3384  269]
 [ 190 3457]]
Epoch 12, Phase val, Loss=0.5619, Acc=0.8095, AUC=0.7574, TPR=0.3763, TNR=0.8868, J=0.2631, MCC=0.2620, ConfusionMatrix=
[[1928  246]
 [ 242  146]]
Epoch 12, Phase test, Loss=0.5665, Acc=0.8262, AUC=0.7488, TPR=0.4758, TNR=0.8865, J=0.3623, MCC=0.3442, ConfusionMatrix=
[[1914  245]
 [ 195  177]]
Epoch 12 complete in 37.96

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.1547, Acc=0.9415, AUC=0.9844, TPR=0.9508, TNR=0.9320, J=0.8829, MCC=0.8831, ConfusionMatrix=
[[3374  246]
 [ 181 3499]]
Epoch 13, Phase val, Loss=0.5881, Acc=0.8361, AUC=0.7918, TPR=0.4381, TNR=0.9071, J=0.3452, MCC=0.3513, ConfusionMatrix=
[[1972  202]
 [ 218  170]]
Epoch 13, Phase test, Loss=0.5855, Acc=0.8566, AUC=0.7783, TPR=0.5323, TNR=0.9125, J=0.4447, MCC=0.4375, ConfusionMatrix=
[[1970  189]
 [ 174  198]]
Epoch 13 complete in 36.94

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.1313, Acc=0.9564, AUC=0.9883, TPR=0.9676, TNR=0.9450, J=0.9126, MCC=0.9130, ConfusionMatrix=
[[3402  198]
 [ 120 3580]]
Epoch 14, Phase val, Loss=0.5921, Acc=0.8407, AUC=0.7610, TPR=0.2990, TNR=0.9374, J=0.2364, MCC=0.2846, ConfusionMatrix=
[[2038  136]
 [ 272  116]]
Epoch 14, Phase test, Loss=0.6003, Acc=0.8526, AUC=0.7407, TPR=0.3656, TNR=0.9365, J=0.3021, MCC=0.3449, ConfusionMatrix=
[[2022  137]
 [ 236  136]]
Epoch 14 complete in 36.97

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.1233, Acc=0.9533, AUC=0.9897, TPR=0.9605, TNR=0.9461, J=0.9066, MCC=0.9067, ConfusionMatrix=
[[3457  197]
 [ 144 3502]]
Epoch 15, Phase val, Loss=0.6615, Acc=0.8470, AUC=0.7891, TPR=0.4742, TNR=0.9135, J=0.3878, MCC=0.3946, ConfusionMatrix=
[[1986  188]
 [ 204  184]]
Epoch 15, Phase test, Loss=0.6917, Acc=0.8483, AUC=0.7726, TPR=0.4919, TNR=0.9097, J=0.4016, MCC=0.3990, ConfusionMatrix=
[[1964  195]
 [ 189  183]]
Epoch 15 complete in 36.25

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.1417, Acc=0.9468, AUC=0.9867, TPR=0.9556, TNR=0.9381, J=0.8937, MCC=0.8938, ConfusionMatrix=
[[3426  226]
 [ 162 3486]]
Epoch 16, Phase val, Loss=0.6039, Acc=0.8505, AUC=0.7984, TPR=0.3531, TNR=0.9393, J=0.2924, MCC=0.3419, ConfusionMatrix=
[[2042  132]
 [ 251  137]]
Epoch 16, Phase test, Loss=0.6534, Acc=0.8657, AUC=0.7619, TPR=0.3817, TNR=0.9491, J=0.3308, MCC=0.3912, ConfusionMatrix=
[[2049  110]
 [ 230  142]]
Epoch 16 complete in 36.83

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.1239, Acc=0.9526, AUC=0.9895, TPR=0.9610, TNR=0.9442, J=0.9052, MCC=0.9053, ConfusionMatrix=
[[3453  204]
 [ 142 3501]]
Epoch 17, Phase val, Loss=0.6740, Acc=0.8247, AUC=0.7981, TPR=0.5155, TNR=0.8799, J=0.3954, MCC=0.3690, ConfusionMatrix=
[[1913  261]
 [ 188  200]]
Epoch 17, Phase test, Loss=0.6654, Acc=0.8416, AUC=0.7905, TPR=0.5538, TNR=0.8912, J=0.4449, MCC=0.4153, ConfusionMatrix=
[[1924  235]
 [ 166  206]]
Epoch 17 complete in 36.19

Early Stop!
Training complete in 11m 8s
The best model val AUC=0.805541592769, test AUC=0.76766175101.
Finish training resnet18-conv1x1-avgpool

Start training resnet18-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5588, Acc=0.7048, AUC=0.7828, TPR=0.6796, TNR=0.7282, J=0.4077, MCC=0.4083, ConfusionMatrix=
[[2759 1030]
 [1125 2386]]
Epoch 0, Phase val, Loss=0.5308, Acc=0.7927, AUC=0.8114, TPR=0.6675, TNR=0.8151, J=0.4826, MCC=0.3954, ConfusionMatrix=
[[1772  402]
 [ 129  259]]
New Best AUC=0.8114. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5500, Acc=0.7677, AUC=0.7861, TPR=0.6425, TNR=0.7893, J=0.4317, MCC=0.3427, ConfusionMatrix=
[[1704  455]
 [ 133  239]]
Epoch 0 complete in 39.03

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4560, Acc=0.7890, AUC=0.8677, TPR=0.7582, TNR=0.8202, J=0.5784, MCC=0.5794, ConfusionMatrix=
[[2979  653]
 [ 887 2781]]
Epoch 1, Phase val, Loss=0.4992, Acc=0.7990, AUC=0.8064, TPR=0.6392, TNR=0.8275, J=0.4667, MCC=0.3900, ConfusionMatrix=
[[1799  375]
 [ 140  248]]
Epoch 1, Phase test, Loss=0.5295, Acc=0.7791, AUC=0.7905, TPR=0.6828, TNR=0.7957, J=0.4785, MCC=0.3796, ConfusionMatrix=
[[1718  441]
 [ 118  254]]
Epoch 1 complete in 36.67

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4261, Acc=0.8107, AUC=0.8861, TPR=0.7877, TNR=0.8338, J=0.6216, MCC=0.6221, ConfusionMatrix=
[[3031  604]
 [ 778 2887]]
Epoch 2, Phase val, Loss=0.6552, Acc=0.7190, AUC=0.8223, TPR=0.7964, TNR=0.7052, J=0.5015, MCC=0.3722, ConfusionMatrix=
[[1533  641]
 [  79  309]]
New Best AUC=0.8223. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.7363, Acc=0.6677, AUC=0.7957, TPR=0.7903, TNR=0.6466, J=0.4369, MCC=0.3137, ConfusionMatrix=
[[1396  763]
 [  78  294]]
Epoch 2 complete in 37.62

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3985, Acc=0.8249, AUC=0.9016, TPR=0.8236, TNR=0.8263, J=0.6499, MCC=0.6499, ConfusionMatrix=
[[2997  630]
 [ 648 3025]]
Epoch 3, Phase val, Loss=0.4265, Acc=0.8302, AUC=0.8145, TPR=0.5670, TNR=0.8772, J=0.4442, MCC=0.4058, ConfusionMatrix=
[[1907  267]
 [ 168  220]]
Epoch 3, Phase test, Loss=0.4524, Acc=0.8277, AUC=0.7864, TPR=0.5726, TNR=0.8717, J=0.4443, MCC=0.3981, ConfusionMatrix=
[[1882  277]
 [ 159  213]]
Epoch 3 complete in 36.36

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3573, Acc=0.8497, AUC=0.9217, TPR=0.8519, TNR=0.8476, J=0.6995, MCC=0.6995, ConfusionMatrix=
[[3132  563]
 [ 534 3071]]
Epoch 4, Phase val, Loss=0.4737, Acc=0.7998, AUC=0.7751, TPR=0.5464, TNR=0.8450, J=0.3914, MCC=0.3419, ConfusionMatrix=
[[1837  337]
 [ 176  212]]
Epoch 4, Phase test, Loss=0.4921, Acc=0.7977, AUC=0.7690, TPR=0.6022, TNR=0.8314, J=0.4336, MCC=0.3635, ConfusionMatrix=
[[1795  364]
 [ 148  224]]
Epoch 4 complete in 39.47

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3085, Acc=0.8666, AUC=0.9413, TPR=0.8728, TNR=0.8602, J=0.7330, MCC=0.7331, ConfusionMatrix=
[[3107  505]
 [ 469 3219]]
Epoch 5, Phase val, Loss=0.4618, Acc=0.8193, AUC=0.7799, TPR=0.5180, TNR=0.8730, J=0.3911, MCC=0.3602, ConfusionMatrix=
[[1898  276]
 [ 187  201]]
Epoch 5, Phase test, Loss=0.4931, Acc=0.8167, AUC=0.7552, TPR=0.5511, TNR=0.8624, J=0.4135, MCC=0.3672, ConfusionMatrix=
[[1862  297]
 [ 167  205]]
Epoch 5 complete in 36.24

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2850, Acc=0.8858, AUC=0.9496, TPR=0.8925, TNR=0.8792, J=0.7717, MCC=0.7716, ConfusionMatrix=
[[3261  448]
 [ 386 3205]]
Epoch 6, Phase val, Loss=0.4832, Acc=0.8193, AUC=0.8071, TPR=0.5902, TNR=0.8602, J=0.4504, MCC=0.3978, ConfusionMatrix=
[[1870  304]
 [ 159  229]]
Epoch 6, Phase test, Loss=0.5006, Acc=0.8222, AUC=0.7764, TPR=0.5726, TNR=0.8652, J=0.4378, MCC=0.3882, ConfusionMatrix=
[[1868  291]
 [ 159  213]]
Epoch 6 complete in 36.40

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2447, Acc=0.9038, AUC=0.9623, TPR=0.9156, TNR=0.8914, J=0.8070, MCC=0.8076, ConfusionMatrix=
[[3168  386]
 [ 316 3430]]
Epoch 7, Phase val, Loss=0.6856, Acc=0.7412, AUC=0.8024, TPR=0.7294, TNR=0.7433, J=0.4727, MCC=0.3609, ConfusionMatrix=
[[1616  558]
 [ 105  283]]
Epoch 7, Phase test, Loss=0.7980, Acc=0.7088, AUC=0.7670, TPR=0.6828, TNR=0.7133, J=0.3961, MCC=0.2950, ConfusionMatrix=
[[1540  619]
 [ 118  254]]
Epoch 7 complete in 36.05

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2393, Acc=0.9021, AUC=0.9644, TPR=0.9074, TNR=0.8970, J=0.8044, MCC=0.8041, ConfusionMatrix=
[[3379  388]
 [ 327 3206]]
Epoch 8, Phase val, Loss=0.5134, Acc=0.8384, AUC=0.8019, TPR=0.5541, TNR=0.8891, J=0.4433, MCC=0.4154, ConfusionMatrix=
[[1933  241]
 [ 173  215]]
Epoch 8, Phase test, Loss=0.5536, Acc=0.8384, AUC=0.7800, TPR=0.5753, TNR=0.8837, J=0.4590, MCC=0.4197, ConfusionMatrix=
[[1908  251]
 [ 158  214]]
Epoch 8 complete in 38.20

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2004, Acc=0.9247, AUC=0.9738, TPR=0.9369, TNR=0.9123, J=0.8492, MCC=0.8495, ConfusionMatrix=
[[3320  319]
 [ 231 3430]]
Epoch 9, Phase val, Loss=0.5965, Acc=0.7861, AUC=0.7826, TPR=0.5825, TNR=0.8224, J=0.4049, MCC=0.3404, ConfusionMatrix=
[[1788  386]
 [ 162  226]]
Epoch 9, Phase test, Loss=0.6880, Acc=0.7720, AUC=0.7467, TPR=0.5591, TNR=0.8087, J=0.3678, MCC=0.3027, ConfusionMatrix=
[[1746  413]
 [ 164  208]]
Epoch 9 complete in 36.29

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2050, Acc=0.9216, AUC=0.9731, TPR=0.9354, TNR=0.9072, J=0.8426, MCC=0.8434, ConfusionMatrix=
[[3236  331]
 [ 241 3492]]
Epoch 10, Phase val, Loss=0.6363, Acc=0.7923, AUC=0.7598, TPR=0.5129, TNR=0.8422, J=0.3551, MCC=0.3117, ConfusionMatrix=
[[1831  343]
 [ 189  199]]
Epoch 10, Phase test, Loss=0.6582, Acc=0.8111, AUC=0.7550, TPR=0.5753, TNR=0.8518, J=0.4271, MCC=0.3706, ConfusionMatrix=
[[1839  320]
 [ 158  214]]
Epoch 10 complete in 37.33

Early Stop!
Training complete in 6m 50s
The best model val AUC=0.822340405353, test AUC=0.795675267821.
Finish training resnet18-conv1x1-avgpool

Start training resnet18-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5513, Acc=0.7158, AUC=0.7936, TPR=0.7171, TNR=0.7144, J=0.4315, MCC=0.4315, ConfusionMatrix=
[[2622 1048]
 [1027 2603]]
Epoch 0, Phase val, Loss=0.5176, Acc=0.8002, AUC=0.8070, TPR=0.6521, TNR=0.8266, J=0.4786, MCC=0.3985, ConfusionMatrix=
[[1797  377]
 [ 135  253]]
New Best AUC=0.8070. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5361, Acc=0.7764, AUC=0.7897, TPR=0.6613, TNR=0.7962, J=0.4575, MCC=0.3644, ConfusionMatrix=
[[1719  440]
 [ 126  246]]
Epoch 0 complete in 36.63

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4516, Acc=0.8014, AUC=0.8711, TPR=0.7787, TNR=0.8241, J=0.6029, MCC=0.6034, ConfusionMatrix=
[[2999  640]
 [ 810 2851]]
Epoch 1, Phase val, Loss=0.5085, Acc=0.7721, AUC=0.7776, TPR=0.6366, TNR=0.7962, J=0.4328, MCC=0.3498, ConfusionMatrix=
[[1731  443]
 [ 141  247]]
Epoch 1, Phase test, Loss=0.5445, Acc=0.7499, AUC=0.7813, TPR=0.6909, TNR=0.7601, J=0.4509, MCC=0.3464, ConfusionMatrix=
[[1641  518]
 [ 115  257]]
Epoch 1 complete in 36.99

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4120, Acc=0.8216, AUC=0.8941, TPR=0.8004, TNR=0.8419, J=0.6424, MCC=0.6432, ConfusionMatrix=
[[3142  590]
 [ 712 2856]]
Epoch 2, Phase val, Loss=0.4179, Acc=0.8298, AUC=0.7836, TPR=0.5232, TNR=0.8845, J=0.4077, MCC=0.3828, ConfusionMatrix=
[[1923  251]
 [ 185  203]]
Epoch 2, Phase test, Loss=0.4315, Acc=0.8345, AUC=0.7817, TPR=0.5538, TNR=0.8828, J=0.4366, MCC=0.4012, ConfusionMatrix=
[[1906  253]
 [ 166  206]]
Epoch 2 complete in 37.09

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3647, Acc=0.8429, AUC=0.9180, TPR=0.8353, TNR=0.8504, J=0.6857, MCC=0.6858, ConfusionMatrix=
[[3121  549]
 [ 598 3032]]
Epoch 3, Phase val, Loss=0.5643, Acc=0.7834, AUC=0.8063, TPR=0.6856, TNR=0.8008, J=0.4864, MCC=0.3915, ConfusionMatrix=
[[1741  433]
 [ 122  266]]
Epoch 3, Phase test, Loss=0.5906, Acc=0.7732, AUC=0.7849, TPR=0.6747, TNR=0.7902, J=0.4649, MCC=0.3674, ConfusionMatrix=
[[1706  453]
 [ 121  251]]
Epoch 3 complete in 38.80

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3389, Acc=0.8578, AUC=0.9287, TPR=0.8697, TNR=0.8461, J=0.7158, MCC=0.7159, ConfusionMatrix=
[[3111  566]
 [ 472 3151]]
Epoch 4, Phase val, Loss=0.5479, Acc=0.7603, AUC=0.7746, TPR=0.6134, TNR=0.7866, J=0.4000, MCC=0.3215, ConfusionMatrix=
[[1710  464]
 [ 150  238]]
Epoch 4, Phase test, Loss=0.5915, Acc=0.7539, AUC=0.7660, TPR=0.6559, TNR=0.7707, J=0.4266, MCC=0.3323, ConfusionMatrix=
[[1664  495]
 [ 128  244]]
Epoch 4 complete in 36.28

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3264, Acc=0.8623, AUC=0.9335, TPR=0.8780, TNR=0.8460, J=0.7240, MCC=0.7246, ConfusionMatrix=
[[3022  550]
 [ 455 3273]]
Epoch 5, Phase val, Loss=0.4409, Acc=0.8337, AUC=0.7837, TPR=0.4459, TNR=0.9029, J=0.3488, MCC=0.3503, ConfusionMatrix=
[[1963  211]
 [ 215  173]]
Epoch 5, Phase test, Loss=0.4487, Acc=0.8558, AUC=0.7615, TPR=0.5134, TNR=0.9148, J=0.4282, MCC=0.4268, ConfusionMatrix=
[[1975  184]
 [ 181  191]]
Epoch 5 complete in 38.16

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2945, Acc=0.8832, AUC=0.9457, TPR=0.8972, TNR=0.8693, J=0.7665, MCC=0.7667, ConfusionMatrix=
[[3193  480]
 [ 373 3254]]
Epoch 6, Phase val, Loss=0.5210, Acc=0.8208, AUC=0.7771, TPR=0.5387, TNR=0.8712, J=0.4099, MCC=0.3739, ConfusionMatrix=
[[1894  280]
 [ 179  209]]
Epoch 6, Phase test, Loss=0.5260, Acc=0.8250, AUC=0.7617, TPR=0.5349, TNR=0.8749, J=0.4099, MCC=0.3735, ConfusionMatrix=
[[1889  270]
 [ 173  199]]
Epoch 6 complete in 36.49

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2642, Acc=0.8963, AUC=0.9561, TPR=0.9108, TNR=0.8815, J=0.7923, MCC=0.7928, ConfusionMatrix=
[[3185  428]
 [ 329 3358]]
Epoch 7, Phase val, Loss=0.5423, Acc=0.7963, AUC=0.7787, TPR=0.5412, TNR=0.8418, J=0.3830, MCC=0.3335, ConfusionMatrix=
[[1830  344]
 [ 178  210]]
Epoch 7, Phase test, Loss=0.5736, Acc=0.8060, AUC=0.7711, TPR=0.6344, TNR=0.8356, J=0.4700, MCC=0.3934, ConfusionMatrix=
[[1804  355]
 [ 136  236]]
Epoch 7 complete in 37.32

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2390, Acc=0.9103, AUC=0.9635, TPR=0.9285, TNR=0.8913, J=0.8198, MCC=0.8208, ConfusionMatrix=
[[3191  389]
 [ 266 3454]]
Epoch 8, Phase val, Loss=0.5686, Acc=0.8130, AUC=0.7957, TPR=0.5696, TNR=0.8565, J=0.4261, MCC=0.3763, ConfusionMatrix=
[[1862  312]
 [ 167  221]]
Epoch 8, Phase test, Loss=0.6142, Acc=0.8242, AUC=0.7790, TPR=0.5941, TNR=0.8638, J=0.4579, MCC=0.4027, ConfusionMatrix=
[[1865  294]
 [ 151  221]]
Epoch 8 complete in 36.21

Early Stop!
Training complete in 5m 34s
The best model val AUC=0.807048388168, test AUC=0.78970003038.
Finish training resnet18-conv1x1-avgpool

Start training resnet18-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5497, Acc=0.7126, AUC=0.7928, TPR=0.7348, TNR=0.6900, J=0.4248, MCC=0.4253, ConfusionMatrix=
[[2495 1121]
 [ 977 2707]]
Epoch 0, Phase val, Loss=0.5184, Acc=0.7814, AUC=0.8111, TPR=0.6546, TNR=0.8040, J=0.4587, MCC=0.3724, ConfusionMatrix=
[[1748  426]
 [ 134  254]]
New Best AUC=0.8111. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5524, Acc=0.7633, AUC=0.7885, TPR=0.6882, TNR=0.7763, J=0.4645, MCC=0.3617, ConfusionMatrix=
[[1676  483]
 [ 116  256]]
Epoch 0 complete in 38.04

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4687, Acc=0.7773, AUC=0.8591, TPR=0.7417, TNR=0.8122, J=0.5539, MCC=0.5555, ConfusionMatrix=
[[2989  691]
 [ 935 2685]]
Epoch 1, Phase val, Loss=0.5068, Acc=0.7666, AUC=0.8066, TPR=0.6804, TNR=0.7820, J=0.4624, MCC=0.3660, ConfusionMatrix=
[[1700  474]
 [ 124  264]]
Epoch 1, Phase test, Loss=0.5506, Acc=0.7361, AUC=0.7887, TPR=0.7177, TNR=0.7392, J=0.4570, MCC=0.3447, ConfusionMatrix=
[[1596  563]
 [ 105  267]]
Epoch 1 complete in 37.61

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4290, Acc=0.8058, AUC=0.8846, TPR=0.7978, TNR=0.8138, J=0.6116, MCC=0.6116, ConfusionMatrix=
[[2955  676]
 [ 742 2927]]
Epoch 2, Phase val, Loss=0.5201, Acc=0.7853, AUC=0.7934, TPR=0.6469, TNR=0.8100, J=0.4569, MCC=0.3738, ConfusionMatrix=
[[1761  413]
 [ 137  251]]
Epoch 2, Phase test, Loss=0.5298, Acc=0.7669, AUC=0.7703, TPR=0.6371, TNR=0.7893, J=0.4264, MCC=0.3387, ConfusionMatrix=
[[1704  455]
 [ 135  237]]
Epoch 2 complete in 38.07

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3822, Acc=0.8348, AUC=0.9098, TPR=0.8334, TNR=0.8362, J=0.6696, MCC=0.6696, ConfusionMatrix=
[[3033  594]
 [ 612 3061]]
Epoch 3, Phase val, Loss=0.4974, Acc=0.7904, AUC=0.7989, TPR=0.6598, TNR=0.8137, J=0.4735, MCC=0.3879, ConfusionMatrix=
[[1769  405]
 [ 132  256]]
Epoch 3, Phase test, Loss=0.5420, Acc=0.7760, AUC=0.7731, TPR=0.6747, TNR=0.7934, J=0.4682, MCC=0.3711, ConfusionMatrix=
[[1713  446]
 [ 121  251]]
Epoch 3 complete in 36.22

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3394, Acc=0.8559, AUC=0.9291, TPR=0.8579, TNR=0.8539, J=0.7118, MCC=0.7118, ConfusionMatrix=
[[3139  537]
 [ 515 3109]]
Epoch 4, Phase val, Loss=0.5149, Acc=0.8115, AUC=0.7968, TPR=0.5619, TNR=0.8560, J=0.4179, MCC=0.3696, ConfusionMatrix=
[[1861  313]
 [ 170  218]]
Epoch 4, Phase test, Loss=0.5330, Acc=0.7989, AUC=0.7760, TPR=0.5860, TNR=0.8356, J=0.4216, MCC=0.3567, ConfusionMatrix=
[[1804  355]
 [ 154  218]]
Epoch 4 complete in 39.35

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3317, Acc=0.8611, AUC=0.9322, TPR=0.8605, TNR=0.8617, J=0.7222, MCC=0.7222, ConfusionMatrix=
[[3171  509]
 [ 505 3115]]
Epoch 5, Phase val, Loss=0.4533, Acc=0.8361, AUC=0.7973, TPR=0.5232, TNR=0.8919, J=0.4151, MCC=0.3953, ConfusionMatrix=
[[1939  235]
 [ 185  203]]
Epoch 5, Phase test, Loss=0.4629, Acc=0.8285, AUC=0.7615, TPR=0.4812, TNR=0.8884, J=0.3696, MCC=0.3517, ConfusionMatrix=
[[1918  241]
 [ 193  179]]
Epoch 5 complete in 36.36

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2907, Acc=0.8808, AUC=0.9473, TPR=0.8919, TNR=0.8698, J=0.7617, MCC=0.7618, ConfusionMatrix=
[[3180  476]
 [ 394 3250]]
Epoch 6, Phase val, Loss=0.5429, Acc=0.8029, AUC=0.7642, TPR=0.5490, TNR=0.8482, J=0.3972, MCC=0.3484, ConfusionMatrix=
[[1844  330]
 [ 175  213]]
Epoch 6, Phase test, Loss=0.5665, Acc=0.7874, AUC=0.7440, TPR=0.5645, TNR=0.8258, J=0.3904, MCC=0.3277, ConfusionMatrix=
[[1783  376]
 [ 162  210]]
Epoch 6 complete in 36.62

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2668, Acc=0.8873, AUC=0.9559, TPR=0.8975, TNR=0.8771, J=0.7746, MCC=0.7747, ConfusionMatrix=
[[3212  450]
 [ 373 3265]]
Epoch 7, Phase val, Loss=0.6112, Acc=0.8041, AUC=0.7962, TPR=0.6340, TNR=0.8344, J=0.4684, MCC=0.3952, ConfusionMatrix=
[[1814  360]
 [ 142  246]]
Epoch 7, Phase test, Loss=0.6358, Acc=0.7866, AUC=0.7734, TPR=0.6075, TNR=0.8175, J=0.4250, MCC=0.3499, ConfusionMatrix=
[[1765  394]
 [ 146  226]]
Epoch 7 complete in 36.39

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2252, Acc=0.9123, AUC=0.9681, TPR=0.9241, TNR=0.9002, J=0.8243, MCC=0.8248, ConfusionMatrix=
[[3237  359]
 [ 281 3423]]
Epoch 8, Phase val, Loss=0.5815, Acc=0.7818, AUC=0.7866, TPR=0.6392, TNR=0.8073, J=0.4464, MCC=0.3647, ConfusionMatrix=
[[1755  419]
 [ 140  248]]
Epoch 8, Phase test, Loss=0.6797, Acc=0.7562, AUC=0.7751, TPR=0.6640, TNR=0.7721, J=0.4361, MCC=0.3396, ConfusionMatrix=
[[1667  492]
 [ 125  247]]
Epoch 8 complete in 37.43

Early Stop!
Training complete in 5m 36s
The best model val AUC=0.811064335777, test AUC=0.788471116158.
Finish training resnet18-conv1x1-avgpool

Start training resnet18fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6572, Acc=0.6222, AUC=0.6747, TPR=0.7059, TNR=0.5408, J=0.2467, MCC=0.2500, ConfusionMatrix=
[[2002 1700]
 [1058 2540]]
Epoch 0, Phase val, Loss=0.5926, Acc=0.7361, AUC=0.7065, TPR=0.4665, TNR=0.7843, J=0.2508, MCC=0.2066, ConfusionMatrix=
[[1705  469]
 [ 207  181]]
New Best AUC=0.7065. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5951, Acc=0.7305, AUC=0.7102, TPR=0.5296, TNR=0.7652, J=0.2947, MCC=0.2329, ConfusionMatrix=
[[1652  507]
 [ 175  197]]
Epoch 0 complete in 27.52

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5911, Acc=0.6862, AUC=0.7538, TPR=0.6509, TNR=0.7205, J=0.3714, MCC=0.3724, ConfusionMatrix=
[[2665 1034]
 [1257 2344]]
Epoch 1, Phase val, Loss=0.5679, Acc=0.7397, AUC=0.7327, TPR=0.5026, TNR=0.7820, J=0.2845, MCC=0.2322, ConfusionMatrix=
[[1700  474]
 [ 193  195]]
New Best AUC=0.7327. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5806, Acc=0.7333, AUC=0.7376, TPR=0.5887, TNR=0.7582, J=0.3469, MCC=0.2700, ConfusionMatrix=
[[1637  522]
 [ 153  219]]
Epoch 1 complete in 29.32

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5687, Acc=0.7134, AUC=0.7794, TPR=0.6828, TNR=0.7455, J=0.4283, MCC=0.4288, ConfusionMatrix=
[[2657  907]
 [1185 2551]]
Epoch 2, Phase val, Loss=0.5523, Acc=0.7545, AUC=0.7578, TPR=0.5825, TNR=0.7852, J=0.3677, MCC=0.2967, ConfusionMatrix=
[[1707  467]
 [ 162  226]]
New Best AUC=0.7578. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5661, Acc=0.7416, AUC=0.7395, TPR=0.5995, TNR=0.7661, J=0.3656, MCC=0.2860, ConfusionMatrix=
[[1654  505]
 [ 149  223]]
Epoch 2 complete in 28.35

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5637, Acc=0.7121, AUC=0.7830, TPR=0.6651, TNR=0.7576, J=0.4226, MCC=0.4247, ConfusionMatrix=
[[2809  899]
 [1203 2389]]
Epoch 3, Phase val, Loss=0.5680, Acc=0.7346, AUC=0.7460, TPR=0.5902, TNR=0.7603, J=0.3506, MCC=0.2762, ConfusionMatrix=
[[1653  521]
 [ 159  229]]
Epoch 3, Phase test, Loss=0.5817, Acc=0.7215, AUC=0.7308, TPR=0.6344, TNR=0.7365, J=0.3709, MCC=0.2820, ConfusionMatrix=
[[1590  569]
 [ 136  236]]
Epoch 3 complete in 26.16

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5554, Acc=0.7153, AUC=0.7896, TPR=0.6856, TNR=0.7454, J=0.4310, MCC=0.4317, ConfusionMatrix=
[[2705  924]
 [1154 2517]]
Epoch 4, Phase val, Loss=0.5920, Acc=0.7389, AUC=0.7504, TPR=0.6031, TNR=0.7631, J=0.3662, MCC=0.2886, ConfusionMatrix=
[[1659  515]
 [ 154  234]]
Epoch 4, Phase test, Loss=0.5987, Acc=0.7195, AUC=0.7323, TPR=0.6022, TNR=0.7397, J=0.3418, MCC=0.2616, ConfusionMatrix=
[[1597  562]
 [ 148  224]]
Epoch 4 complete in 25.92

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5697, Acc=0.7075, AUC=0.7774, TPR=0.6554, TNR=0.7583, J=0.4137, MCC=0.4161, ConfusionMatrix=
[[2805  894]
 [1241 2360]]
Epoch 5, Phase val, Loss=0.5489, Acc=0.7658, AUC=0.7595, TPR=0.5979, TNR=0.7958, J=0.3937, MCC=0.3202, ConfusionMatrix=
[[1730  444]
 [ 156  232]]
New Best AUC=0.7595. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5532, Acc=0.7574, AUC=0.7339, TPR=0.5806, TNR=0.7879, J=0.3685, MCC=0.2952, ConfusionMatrix=
[[1701  458]
 [ 156  216]]
Epoch 5 complete in 29.71

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5578, Acc=0.7177, AUC=0.7873, TPR=0.6873, TNR=0.7475, J=0.4348, MCC=0.4357, ConfusionMatrix=
[[2753  930]
 [1131 2486]]
Epoch 6, Phase val, Loss=0.4704, Acc=0.8107, AUC=0.7464, TPR=0.4278, TNR=0.8790, J=0.3069, MCC=0.2946, ConfusionMatrix=
[[1911  263]
 [ 222  166]]
Epoch 6, Phase test, Loss=0.4723, Acc=0.8159, AUC=0.7287, TPR=0.4328, TNR=0.8819, J=0.3147, MCC=0.3007, ConfusionMatrix=
[[1904  255]
 [ 211  161]]
Epoch 6 complete in 26.83

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5584, Acc=0.7225, AUC=0.7866, TPR=0.6877, TNR=0.7573, J=0.4449, MCC=0.4460, ConfusionMatrix=
[[2764  886]
 [1140 2510]]
Epoch 7, Phase val, Loss=0.5655, Acc=0.7506, AUC=0.7563, TPR=0.6186, TNR=0.7741, J=0.3927, MCC=0.3118, ConfusionMatrix=
[[1683  491]
 [ 148  240]]
Epoch 7, Phase test, Loss=0.5805, Acc=0.7301, AUC=0.7344, TPR=0.6129, TNR=0.7503, J=0.3633, MCC=0.2799, ConfusionMatrix=
[[1620  539]
 [ 144  228]]
Epoch 7 complete in 26.97

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5443, Acc=0.7323, AUC=0.8011, TPR=0.6931, TNR=0.7716, J=0.4646, MCC=0.4661, ConfusionMatrix=
[[2817  834]
 [1120 2529]]
Epoch 8, Phase val, Loss=0.5535, Acc=0.7568, AUC=0.7607, TPR=0.5954, TNR=0.7856, J=0.3810, MCC=0.3069, ConfusionMatrix=
[[1708  466]
 [ 157  231]]
New Best AUC=0.7607. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.5816, Acc=0.7361, AUC=0.7300, TPR=0.5968, TNR=0.7601, J=0.3568, MCC=0.2778, ConfusionMatrix=
[[1641  518]
 [ 150  222]]
Epoch 8 complete in 26.56

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5465, Acc=0.7297, AUC=0.7975, TPR=0.7005, TNR=0.7598, J=0.4602, MCC=0.4609, ConfusionMatrix=
[[2736  865]
 [1108 2591]]
Epoch 9, Phase val, Loss=0.6171, Acc=0.7151, AUC=0.7635, TPR=0.6469, TNR=0.7272, J=0.3741, MCC=0.2854, ConfusionMatrix=
[[1581  593]
 [ 137  251]]
New Best AUC=0.7635. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.6321, Acc=0.6922, AUC=0.7346, TPR=0.6478, TNR=0.6999, J=0.3477, MCC=0.2579, ConfusionMatrix=
[[1511  648]
 [ 131  241]]
Epoch 9 complete in 26.63

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5450, Acc=0.7286, AUC=0.7999, TPR=0.6956, TNR=0.7616, J=0.4571, MCC=0.4582, ConfusionMatrix=
[[2785  872]
 [1109 2534]]
Epoch 10, Phase val, Loss=0.5890, Acc=0.7420, AUC=0.7625, TPR=0.6392, TNR=0.7603, J=0.3995, MCC=0.3125, ConfusionMatrix=
[[1653  521]
 [ 140  248]]
Epoch 10, Phase test, Loss=0.5995, Acc=0.7139, AUC=0.7416, TPR=0.6183, TNR=0.7304, J=0.3487, MCC=0.2645, ConfusionMatrix=
[[1577  582]
 [ 142  230]]
Epoch 10 complete in 26.56

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5430, Acc=0.7290, AUC=0.8027, TPR=0.6885, TNR=0.7701, J=0.4586, MCC=0.4600, ConfusionMatrix=
[[2794  834]
 [1144 2528]]
Epoch 11, Phase val, Loss=0.5468, Acc=0.7642, AUC=0.7644, TPR=0.5825, TNR=0.7967, J=0.3792, MCC=0.3096, ConfusionMatrix=
[[1732  442]
 [ 162  226]]
New Best AUC=0.7644. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.5621, Acc=0.7515, AUC=0.7366, TPR=0.5833, TNR=0.7805, J=0.3638, MCC=0.2891, ConfusionMatrix=
[[1685  474]
 [ 155  217]]
Epoch 11 complete in 28.61

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5499, Acc=0.7340, AUC=0.7957, TPR=0.6971, TNR=0.7713, J=0.4685, MCC=0.4696, ConfusionMatrix=
[[2796  829]
 [1113 2562]]
Epoch 12, Phase val, Loss=0.5878, Acc=0.7358, AUC=0.7621, TPR=0.6160, TNR=0.7571, J=0.3731, MCC=0.2920, ConfusionMatrix=
[[1646  528]
 [ 149  239]]
Epoch 12, Phase test, Loss=0.6021, Acc=0.7147, AUC=0.7317, TPR=0.6156, TNR=0.7318, J=0.3474, MCC=0.2639, ConfusionMatrix=
[[1580  579]
 [ 143  229]]
Epoch 12 complete in 26.54

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5440, Acc=0.7307, AUC=0.8019, TPR=0.6953, TNR=0.7658, J=0.4612, MCC=0.4624, ConfusionMatrix=
[[2803  857]
 [1109 2531]]
Epoch 13, Phase val, Loss=0.5410, Acc=0.7681, AUC=0.7624, TPR=0.5593, TNR=0.8054, J=0.3647, MCC=0.3020, ConfusionMatrix=
[[1751  423]
 [ 171  217]]
Epoch 13, Phase test, Loss=0.5516, Acc=0.7542, AUC=0.7333, TPR=0.5511, TNR=0.7893, J=0.3403, MCC=0.2745, ConfusionMatrix=
[[1704  455]
 [ 167  205]]
Epoch 13 complete in 24.93

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5381, Acc=0.7367, AUC=0.8068, TPR=0.7102, TNR=0.7632, J=0.4734, MCC=0.4741, ConfusionMatrix=
[[2785  864]
 [1058 2593]]
Epoch 14, Phase val, Loss=0.4998, Acc=0.7916, AUC=0.7622, TPR=0.5258, TNR=0.8390, J=0.3648, MCC=0.3176, ConfusionMatrix=
[[1824  350]
 [ 184  204]]
Epoch 14, Phase test, Loss=0.5113, Acc=0.7791, AUC=0.7278, TPR=0.5027, TNR=0.8268, J=0.3295, MCC=0.2809, ConfusionMatrix=
[[1785  374]
 [ 185  187]]
Epoch 14 complete in 26.03

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5459, Acc=0.7384, AUC=0.7999, TPR=0.7139, TNR=0.7635, J=0.4774, MCC=0.4778, ConfusionMatrix=
[[2747  851]
 [1059 2643]]
Epoch 15, Phase val, Loss=0.5102, Acc=0.7861, AUC=0.7745, TPR=0.5490, TNR=0.8284, J=0.3774, MCC=0.3221, ConfusionMatrix=
[[1801  373]
 [ 175  213]]
New Best AUC=0.7745. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 15, Phase test, Loss=0.5253, Acc=0.7661, AUC=0.7314, TPR=0.5269, TNR=0.8073, J=0.3342, MCC=0.2764, ConfusionMatrix=
[[1743  416]
 [ 176  196]]
Epoch 15 complete in 26.11

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5434, Acc=0.7307, AUC=0.8004, TPR=0.6773, TNR=0.7826, J=0.4600, MCC=0.4628, ConfusionMatrix=
[[2895  804]
 [1162 2439]]
Epoch 16, Phase val, Loss=0.5577, Acc=0.7642, AUC=0.7650, TPR=0.5876, TNR=0.7958, J=0.3834, MCC=0.3124, ConfusionMatrix=
[[1730  444]
 [ 160  228]]
Epoch 16, Phase test, Loss=0.5806, Acc=0.7404, AUC=0.7341, TPR=0.6102, TNR=0.7629, J=0.3731, MCC=0.2905, ConfusionMatrix=
[[1647  512]
 [ 145  227]]
Epoch 16 complete in 26.08

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5402, Acc=0.7359, AUC=0.8036, TPR=0.7014, TNR=0.7711, J=0.4726, MCC=0.4735, ConfusionMatrix=
[[2783  826]
 [1102 2589]]
Epoch 17, Phase val, Loss=0.5938, Acc=0.7295, AUC=0.7640, TPR=0.6418, TNR=0.7452, J=0.3869, MCC=0.2990, ConfusionMatrix=
[[1620  554]
 [ 139  249]]
Epoch 17, Phase test, Loss=0.6147, Acc=0.7136, AUC=0.7318, TPR=0.6129, TNR=0.7309, J=0.3438, MCC=0.2610, ConfusionMatrix=
[[1578  581]
 [ 144  228]]
Epoch 17 complete in 25.51

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5441, Acc=0.7322, AUC=0.8032, TPR=0.6923, TNR=0.7701, J=0.4624, MCC=0.4642, ConfusionMatrix=
[[2881  860]
 [1095 2464]]
Epoch 18, Phase val, Loss=0.5799, Acc=0.7283, AUC=0.7636, TPR=0.6314, TNR=0.7456, J=0.3771, MCC=0.2919, ConfusionMatrix=
[[1621  553]
 [ 143  245]]
Epoch 18, Phase test, Loss=0.6006, Acc=0.7060, AUC=0.7297, TPR=0.6075, TNR=0.7230, J=0.3305, MCC=0.2498, ConfusionMatrix=
[[1561  598]
 [ 146  226]]
Epoch 18 complete in 25.18

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.5313, Acc=0.7411, AUC=0.8133, TPR=0.6995, TNR=0.7808, J=0.4803, MCC=0.4822, ConfusionMatrix=
[[2917  819]
 [1071 2493]]
Epoch 19, Phase val, Loss=0.5278, Acc=0.7736, AUC=0.7562, TPR=0.5258, TNR=0.8178, J=0.3436, MCC=0.2909, ConfusionMatrix=
[[1778  396]
 [ 184  204]]
Epoch 19, Phase test, Loss=0.5334, Acc=0.7685, AUC=0.7334, TPR=0.5403, TNR=0.8078, J=0.3481, MCC=0.2872, ConfusionMatrix=
[[1744  415]
 [ 171  201]]
Epoch 19 complete in 26.57

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.5326, Acc=0.7395, AUC=0.8082, TPR=0.7035, TNR=0.7753, J=0.4787, MCC=0.4800, ConfusionMatrix=
[[2836  822]
 [1080 2562]]
Epoch 20, Phase val, Loss=0.6167, Acc=0.7186, AUC=0.7697, TPR=0.6495, TNR=0.7309, J=0.3804, MCC=0.2908, ConfusionMatrix=
[[1589  585]
 [ 136  252]]
Epoch 20, Phase test, Loss=0.6356, Acc=0.6981, AUC=0.7367, TPR=0.6425, TNR=0.7077, J=0.3502, MCC=0.2611, ConfusionMatrix=
[[1528  631]
 [ 133  239]]
Epoch 20 complete in 27.33

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.5429, Acc=0.7348, AUC=0.8019, TPR=0.6984, TNR=0.7711, J=0.4695, MCC=0.4708, ConfusionMatrix=
[[2817  836]
 [1100 2547]]
Epoch 21, Phase val, Loss=0.5422, Acc=0.7697, AUC=0.7707, TPR=0.5644, TNR=0.8063, J=0.3708, MCC=0.3070, ConfusionMatrix=
[[1753  421]
 [ 169  219]]
Epoch 21, Phase test, Loss=0.5498, Acc=0.7566, AUC=0.7314, TPR=0.5726, TNR=0.7883, J=0.3609, MCC=0.2897, ConfusionMatrix=
[[1702  457]
 [ 159  213]]
Epoch 21 complete in 26.45

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.5389, Acc=0.7363, AUC=0.8051, TPR=0.7090, TNR=0.7647, J=0.4736, MCC=0.4741, ConfusionMatrix=
[[2739  843]
 [1082 2636]]
Epoch 22, Phase val, Loss=0.5649, Acc=0.7619, AUC=0.7728, TPR=0.6160, TNR=0.7879, J=0.4039, MCC=0.3249, ConfusionMatrix=
[[1713  461]
 [ 149  239]]
Epoch 22, Phase test, Loss=0.5736, Acc=0.7361, AUC=0.7369, TPR=0.5941, TNR=0.7605, J=0.3546, MCC=0.2763, ConfusionMatrix=
[[1642  517]
 [ 151  221]]
Epoch 22 complete in 24.88

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.5471, Acc=0.7268, AUC=0.7991, TPR=0.6926, TNR=0.7610, J=0.4536, MCC=0.4547, ConfusionMatrix=
[[2780  873]
 [1121 2526]]
Epoch 23, Phase val, Loss=0.5318, Acc=0.7760, AUC=0.7671, TPR=0.5490, TNR=0.8165, J=0.3654, MCC=0.3072, ConfusionMatrix=
[[1775  399]
 [ 175  213]]
Epoch 23, Phase test, Loss=0.5398, Acc=0.7641, AUC=0.7346, TPR=0.5484, TNR=0.8013, J=0.3497, MCC=0.2859, ConfusionMatrix=
[[1730  429]
 [ 168  204]]
Epoch 23 complete in 26.55

Early Stop!
Training complete in 10m 41s
The best model val AUC=0.774494020239, test AUC=0.731434306006.
Finish training resnet18fixed-conv1x1ab-maxpool

Start training resnet18fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6538, Acc=0.6288, AUC=0.6870, TPR=0.7730, TNR=0.4812, J=0.2542, MCC=0.2660, ConfusionMatrix=
[[1736 1872]
 [ 838 2854]]
Epoch 0, Phase val, Loss=0.6402, Acc=0.6725, AUC=0.7273, TPR=0.6649, TNR=0.6739, J=0.3388, MCC=0.2506, ConfusionMatrix=
[[1465  709]
 [ 130  258]]
New Best AUC=0.7273. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6702, Acc=0.6393, AUC=0.7046, TPR=0.6694, TNR=0.6341, J=0.3034, MCC=0.2184, ConfusionMatrix=
[[1369  790]
 [ 123  249]]
Epoch 0 complete in 26.26

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5813, Acc=0.7007, AUC=0.7650, TPR=0.6797, TNR=0.7214, J=0.4011, MCC=0.4015, ConfusionMatrix=
[[2649 1023]
 [1162 2466]]
Epoch 1, Phase val, Loss=0.5454, Acc=0.7611, AUC=0.7403, TPR=0.5284, TNR=0.8027, J=0.3310, MCC=0.2750, ConfusionMatrix=
[[1745  429]
 [ 183  205]]
New Best AUC=0.7403. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5707, Acc=0.7396, AUC=0.7255, TPR=0.5457, TNR=0.7730, J=0.3187, MCC=0.2531, ConfusionMatrix=
[[1669  490]
 [ 169  203]]
Epoch 1 complete in 27.48

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5646, Acc=0.7121, AUC=0.7818, TPR=0.6936, TNR=0.7308, J=0.4245, MCC=0.4247, ConfusionMatrix=
[[2642  973]
 [1129 2556]]
Epoch 2, Phase val, Loss=0.5264, Acc=0.7721, AUC=0.7409, TPR=0.4845, TNR=0.8234, J=0.3079, MCC=0.2651, ConfusionMatrix=
[[1790  384]
 [ 200  188]]
New Best AUC=0.7409. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5479, Acc=0.7491, AUC=0.7333, TPR=0.5349, TNR=0.7860, J=0.3210, MCC=0.2587, ConfusionMatrix=
[[1697  462]
 [ 173  199]]
Epoch 2 complete in 27.87

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5674, Acc=0.7073, AUC=0.7784, TPR=0.6644, TNR=0.7512, J=0.4157, MCC=0.4170, ConfusionMatrix=
[[2706  896]
 [1241 2457]]
Epoch 3, Phase val, Loss=0.6003, Acc=0.7237, AUC=0.7526, TPR=0.6289, TNR=0.7406, J=0.3694, MCC=0.2850, ConfusionMatrix=
[[1610  564]
 [ 144  244]]
New Best AUC=0.7526. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6192, Acc=0.7053, AUC=0.7360, TPR=0.6210, TNR=0.7198, J=0.3407, MCC=0.2565, ConfusionMatrix=
[[1554  605]
 [ 141  231]]
Epoch 3 complete in 25.60

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5556, Acc=0.7219, AUC=0.7904, TPR=0.6908, TNR=0.7533, J=0.4441, MCC=0.4449, ConfusionMatrix=
[[2739  897]
 [1133 2531]]
Epoch 4, Phase val, Loss=0.4903, Acc=0.8029, AUC=0.7488, TPR=0.4304, TNR=0.8694, J=0.2998, MCC=0.2822, ConfusionMatrix=
[[1890  284]
 [ 221  167]]
Epoch 4, Phase test, Loss=0.4976, Acc=0.7981, AUC=0.7367, TPR=0.4758, TNR=0.8536, J=0.3294, MCC=0.2945, ConfusionMatrix=
[[1843  316]
 [ 195  177]]
Epoch 4 complete in 25.98

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5637, Acc=0.7158, AUC=0.7845, TPR=0.6740, TNR=0.7567, J=0.4308, MCC=0.4324, ConfusionMatrix=
[[2787  896]
 [1179 2438]]
Epoch 5, Phase val, Loss=0.5595, Acc=0.7537, AUC=0.7536, TPR=0.5979, TNR=0.7815, J=0.3794, MCC=0.3043, ConfusionMatrix=
[[1699  475]
 [ 156  232]]
New Best AUC=0.7536. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5738, Acc=0.7380, AUC=0.7438, TPR=0.5968, TNR=0.7624, J=0.3592, MCC=0.2802, ConfusionMatrix=
[[1646  513]
 [ 150  222]]
Epoch 5 complete in 26.55

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5563, Acc=0.7188, AUC=0.7887, TPR=0.6773, TNR=0.7595, J=0.4368, MCC=0.4384, ConfusionMatrix=
[[2798  886]
 [1167 2449]]
Epoch 6, Phase val, Loss=0.6996, Acc=0.6565, AUC=0.7512, TPR=0.7216, TNR=0.6449, J=0.3665, MCC=0.2671, ConfusionMatrix=
[[1402  772]
 [ 108  280]]
Epoch 6, Phase test, Loss=0.7247, Acc=0.6258, AUC=0.7403, TPR=0.7392, TNR=0.6063, J=0.3455, MCC=0.2462, ConfusionMatrix=
[[1309  850]
 [  97  275]]
Epoch 6 complete in 26.94

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5516, Acc=0.7259, AUC=0.7947, TPR=0.7064, TNR=0.7461, J=0.4525, MCC=0.4526, ConfusionMatrix=
[[2674  910]
 [1091 2625]]
Epoch 7, Phase val, Loss=0.5679, Acc=0.7365, AUC=0.7561, TPR=0.6134, TNR=0.7585, J=0.3719, MCC=0.2915, ConfusionMatrix=
[[1649  525]
 [ 150  238]]
New Best AUC=0.7561. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5854, Acc=0.7238, AUC=0.7410, TPR=0.6129, TNR=0.7429, J=0.3558, MCC=0.2726, ConfusionMatrix=
[[1604  555]
 [ 144  228]]
Epoch 7 complete in 27.97

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5462, Acc=0.7293, AUC=0.7965, TPR=0.6944, TNR=0.7640, J=0.4584, MCC=0.4596, ConfusionMatrix=
[[2797  864]
 [1112 2527]]
Epoch 8, Phase val, Loss=0.5068, Acc=0.7877, AUC=0.7601, TPR=0.5129, TNR=0.8367, J=0.3496, MCC=0.3044, ConfusionMatrix=
[[1819  355]
 [ 189  199]]
New Best AUC=0.7601. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.5168, Acc=0.7866, AUC=0.7361, TPR=0.5430, TNR=0.8286, J=0.3716, MCC=0.3146, ConfusionMatrix=
[[1789  370]
 [ 170  202]]
Epoch 8 complete in 27.91

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5542, Acc=0.7219, AUC=0.7911, TPR=0.6898, TNR=0.7548, J=0.4446, MCC=0.4453, ConfusionMatrix=
[[2724  885]
 [1145 2546]]
Epoch 9, Phase val, Loss=0.5651, Acc=0.7361, AUC=0.7614, TPR=0.6160, TNR=0.7576, J=0.3736, MCC=0.2925, ConfusionMatrix=
[[1647  527]
 [ 149  239]]
New Best AUC=0.7614. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.5872, Acc=0.7211, AUC=0.7327, TPR=0.6183, TNR=0.7388, J=0.3570, MCC=0.2725, ConfusionMatrix=
[[1595  564]
 [ 142  230]]
Epoch 9 complete in 26.09

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5474, Acc=0.7334, AUC=0.7987, TPR=0.6854, TNR=0.7789, J=0.4643, MCC=0.4668, ConfusionMatrix=
[[2920  829]
 [1117 2434]]
Epoch 10, Phase val, Loss=0.4797, Acc=0.8111, AUC=0.7630, TPR=0.4845, TNR=0.8694, J=0.3539, MCC=0.3273, ConfusionMatrix=
[[1890  284]
 [ 200  188]]
New Best AUC=0.7630. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.4866, Acc=0.8009, AUC=0.7386, TPR=0.4946, TNR=0.8536, J=0.3483, MCC=0.3097, ConfusionMatrix=
[[1843  316]
 [ 188  184]]
Epoch 10 complete in 26.57

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5499, Acc=0.7277, AUC=0.7955, TPR=0.6910, TNR=0.7645, J=0.4555, MCC=0.4567, ConfusionMatrix=
[[2785  858]
 [1130 2527]]
Epoch 11, Phase val, Loss=0.6170, Acc=0.7229, AUC=0.7671, TPR=0.6521, TNR=0.7355, J=0.3876, MCC=0.2971, ConfusionMatrix=
[[1599  575]
 [ 135  253]]
New Best AUC=0.7671. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.6344, Acc=0.6962, AUC=0.7439, TPR=0.6586, TNR=0.7026, J=0.3612, MCC=0.2681, ConfusionMatrix=
[[1517  642]
 [ 127  245]]
Epoch 11 complete in 27.58

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5406, Acc=0.7347, AUC=0.8017, TPR=0.6906, TNR=0.7785, J=0.4691, MCC=0.4710, ConfusionMatrix=
[[2847  810]
 [1127 2516]]
Epoch 12, Phase val, Loss=0.6151, Acc=0.7260, AUC=0.7670, TPR=0.6753, TNR=0.7351, J=0.4103, MCC=0.3135, ConfusionMatrix=
[[1598  576]
 [ 126  262]]
Epoch 12, Phase test, Loss=0.6346, Acc=0.7021, AUC=0.7384, TPR=0.6290, TNR=0.7147, J=0.3437, MCC=0.2577, ConfusionMatrix=
[[1543  616]
 [ 138  234]]
Epoch 12 complete in 26.07

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5486, Acc=0.7319, AUC=0.8010, TPR=0.7080, TNR=0.7569, J=0.4649, MCC=0.4651, ConfusionMatrix=
[[2702  868]
 [1089 2641]]
Epoch 13, Phase val, Loss=0.5633, Acc=0.7541, AUC=0.7664, TPR=0.6160, TNR=0.7787, J=0.3947, MCC=0.3148, ConfusionMatrix=
[[1693  481]
 [ 149  239]]
Epoch 13, Phase test, Loss=0.5775, Acc=0.7404, AUC=0.7396, TPR=0.5941, TNR=0.7656, J=0.3597, MCC=0.2815, ConfusionMatrix=
[[1653  506]
 [ 151  221]]
Epoch 13 complete in 27.15

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5500, Acc=0.7295, AUC=0.7961, TPR=0.6945, TNR=0.7641, J=0.4586, MCC=0.4598, ConfusionMatrix=
[[2802  865]
 [1110 2523]]
Epoch 14, Phase val, Loss=0.5191, Acc=0.7830, AUC=0.7640, TPR=0.5490, TNR=0.8247, J=0.3737, MCC=0.3175, ConfusionMatrix=
[[1793  381]
 [ 175  213]]
Epoch 14, Phase test, Loss=0.5400, Acc=0.7641, AUC=0.7352, TPR=0.5645, TNR=0.7985, J=0.3630, MCC=0.2950, ConfusionMatrix=
[[1724  435]
 [ 162  210]]
Epoch 14 complete in 25.66

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5302, Acc=0.7403, AUC=0.8106, TPR=0.6992, TNR=0.7805, J=0.4797, MCC=0.4814, ConfusionMatrix=
[[2880  810]
 [1086 2524]]
Epoch 15, Phase val, Loss=0.5564, Acc=0.7564, AUC=0.7605, TPR=0.5747, TNR=0.7889, J=0.3636, MCC=0.2949, ConfusionMatrix=
[[1715  459]
 [ 165  223]]
Epoch 15, Phase test, Loss=0.5764, Acc=0.7444, AUC=0.7358, TPR=0.5995, TNR=0.7693, J=0.3688, MCC=0.2893, ConfusionMatrix=
[[1661  498]
 [ 149  223]]
Epoch 15 complete in 26.40

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5337, Acc=0.7414, AUC=0.8132, TPR=0.7096, TNR=0.7738, J=0.4833, MCC=0.4842, ConfusionMatrix=
[[2798  818]
 [1070 2614]]
Epoch 16, Phase val, Loss=0.5880, Acc=0.7319, AUC=0.7643, TPR=0.6392, TNR=0.7484, J=0.3876, MCC=0.3003, ConfusionMatrix=
[[1627  547]
 [ 140  248]]
Epoch 16, Phase test, Loss=0.6141, Acc=0.7076, AUC=0.7331, TPR=0.6452, TNR=0.7184, J=0.3635, MCC=0.2727, ConfusionMatrix=
[[1551  608]
 [ 132  240]]
Epoch 16 complete in 25.46

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5442, Acc=0.7288, AUC=0.8003, TPR=0.7095, TNR=0.7483, J=0.4579, MCC=0.4581, ConfusionMatrix=
[[2709  911]
 [1069 2611]]
Epoch 17, Phase val, Loss=0.4952, Acc=0.8021, AUC=0.7544, TPR=0.5052, TNR=0.8551, J=0.3603, MCC=0.3232, ConfusionMatrix=
[[1859  315]
 [ 192  196]]
Epoch 17, Phase test, Loss=0.5039, Acc=0.8005, AUC=0.7344, TPR=0.5161, TNR=0.8495, J=0.3656, MCC=0.3211, ConfusionMatrix=
[[1834  325]
 [ 180  192]]
Epoch 17 complete in 28.21

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5401, Acc=0.7390, AUC=0.8041, TPR=0.7080, TNR=0.7710, J=0.4789, MCC=0.4796, ConfusionMatrix=
[[2777  825]
 [1080 2618]]
Epoch 18, Phase val, Loss=0.5426, Acc=0.7646, AUC=0.7598, TPR=0.5696, TNR=0.7994, J=0.3690, MCC=0.3030, ConfusionMatrix=
[[1738  436]
 [ 167  221]]
Epoch 18, Phase test, Loss=0.5582, Acc=0.7471, AUC=0.7285, TPR=0.5860, TNR=0.7749, J=0.3609, MCC=0.2852, ConfusionMatrix=
[[1673  486]
 [ 154  218]]
Epoch 18 complete in 26.00

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.5440, Acc=0.7356, AUC=0.8024, TPR=0.6932, TNR=0.7772, J=0.4704, MCC=0.4723, ConfusionMatrix=
[[2864  821]
 [1109 2506]]
Epoch 19, Phase val, Loss=0.6144, Acc=0.7205, AUC=0.7624, TPR=0.6521, TNR=0.7328, J=0.3848, MCC=0.2944, ConfusionMatrix=
[[1593  581]
 [ 135  253]]
Epoch 19, Phase test, Loss=0.6229, Acc=0.7041, AUC=0.7381, TPR=0.6452, TNR=0.7142, J=0.3594, MCC=0.2689, ConfusionMatrix=
[[1542  617]
 [ 132  240]]
Epoch 19 complete in 26.75

Early Stop!
Training complete in 8m 55s
The best model val AUC=0.767107047677, test AUC=0.743875350496.
Finish training resnet18fixed-conv1x1ab-maxpool

Start training resnet18fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6508, Acc=0.6385, AUC=0.6907, TPR=0.7812, TNR=0.5008, J=0.2821, MCC=0.2934, ConfusionMatrix=
[[1861 1855]
 [ 784 2800]]
Epoch 0, Phase val, Loss=0.7049, Acc=0.6003, AUC=0.7305, TPR=0.7680, TNR=0.5704, J=0.3384, MCC=0.2428, ConfusionMatrix=
[[1240  934]
 [  90  298]]
New Best AUC=0.7305. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7279, Acc=0.5685, AUC=0.7287, TPR=0.7608, TNR=0.5354, J=0.2962, MCC=0.2098, ConfusionMatrix=
[[1156 1003]
 [  89  283]]
Epoch 0 complete in 26.63

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5721, Acc=0.7089, AUC=0.7756, TPR=0.6975, TNR=0.7205, J=0.4180, MCC=0.4181, ConfusionMatrix=
[[2604 1010]
 [1115 2571]]
Epoch 1, Phase val, Loss=0.4923, Acc=0.7963, AUC=0.7435, TPR=0.4485, TNR=0.8583, J=0.3068, MCC=0.2814, ConfusionMatrix=
[[1866  308]
 [ 214  174]]
New Best AUC=0.7435. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5047, Acc=0.7945, AUC=0.7332, TPR=0.5000, TNR=0.8453, J=0.3453, MCC=0.3026, ConfusionMatrix=
[[1825  334]
 [ 186  186]]
Epoch 1 complete in 26.36

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5793, Acc=0.6982, AUC=0.7632, TPR=0.6451, TNR=0.7500, J=0.3951, MCC=0.3975, ConfusionMatrix=
[[2772  924]
 [1279 2325]]
Epoch 2, Phase val, Loss=0.5757, Acc=0.7482, AUC=0.7521, TPR=0.5747, TNR=0.7792, J=0.3540, MCC=0.2844, ConfusionMatrix=
[[1694  480]
 [ 165  223]]
New Best AUC=0.7521. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5870, Acc=0.7163, AUC=0.7472, TPR=0.6183, TNR=0.7332, J=0.3515, MCC=0.2671, ConfusionMatrix=
[[1583  576]
 [ 142  230]]
Epoch 2 complete in 27.61

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5483, Acc=0.7288, AUC=0.7959, TPR=0.6805, TNR=0.7758, J=0.4563, MCC=0.4586, ConfusionMatrix=
[[2869  829]
 [1151 2451]]
Epoch 3, Phase val, Loss=0.5391, Acc=0.7826, AUC=0.7672, TPR=0.5696, TNR=0.8206, J=0.3902, MCC=0.3282, ConfusionMatrix=
[[1784  390]
 [ 167  221]]
New Best AUC=0.7672. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5505, Acc=0.7546, AUC=0.7359, TPR=0.5565, TNR=0.7888, J=0.3452, MCC=0.2780, ConfusionMatrix=
[[1703  456]
 [ 165  207]]
Epoch 3 complete in 27.40

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5525, Acc=0.7170, AUC=0.7913, TPR=0.6814, TNR=0.7540, J=0.4353, MCC=0.4362, ConfusionMatrix=
[[2700  881]
 [1185 2534]]
Epoch 4, Phase val, Loss=0.5281, Acc=0.7935, AUC=0.7646, TPR=0.5309, TNR=0.8404, J=0.3713, MCC=0.3235, ConfusionMatrix=
[[1827  347]
 [ 182  206]]
Epoch 4, Phase test, Loss=0.5370, Acc=0.7728, AUC=0.7368, TPR=0.5538, TNR=0.8106, J=0.3643, MCC=0.3008, ConfusionMatrix=
[[1750  409]
 [ 166  206]]
Epoch 4 complete in 26.92

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5461, Acc=0.7268, AUC=0.7989, TPR=0.6854, TNR=0.7677, J=0.4531, MCC=0.4548, ConfusionMatrix=
[[2822  854]
 [1140 2484]]
Epoch 5, Phase val, Loss=0.6481, Acc=0.6959, AUC=0.7573, TPR=0.6495, TNR=0.7042, J=0.3537, MCC=0.2660, ConfusionMatrix=
[[1531  643]
 [ 136  252]]
Epoch 5, Phase test, Loss=0.6585, Acc=0.6796, AUC=0.7433, TPR=0.6828, TNR=0.6790, J=0.3618, MCC=0.2647, ConfusionMatrix=
[[1466  693]
 [ 118  254]]
Epoch 5 complete in 27.75

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5588, Acc=0.7203, AUC=0.7864, TPR=0.6676, TNR=0.7732, J=0.4408, MCC=0.4432, ConfusionMatrix=
[[2816  826]
 [1216 2442]]
Epoch 6, Phase val, Loss=0.6862, Acc=0.6702, AUC=0.7617, TPR=0.7268, TNR=0.6601, J=0.3869, MCC=0.2833, ConfusionMatrix=
[[1435  739]
 [ 106  282]]
Epoch 6, Phase test, Loss=0.7034, Acc=0.6389, AUC=0.7473, TPR=0.7177, TNR=0.6253, J=0.3430, MCC=0.2457, ConfusionMatrix=
[[1350  809]
 [ 105  267]]
Epoch 6 complete in 27.84

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5481, Acc=0.7290, AUC=0.7987, TPR=0.6927, TNR=0.7646, J=0.4573, MCC=0.4586, ConfusionMatrix=
[[2822  869]
 [1109 2500]]
Epoch 7, Phase val, Loss=0.6106, Acc=0.7307, AUC=0.7581, TPR=0.6289, TNR=0.7489, J=0.3777, MCC=0.2932, ConfusionMatrix=
[[1628  546]
 [ 144  244]]
Epoch 7, Phase test, Loss=0.6242, Acc=0.7060, AUC=0.7451, TPR=0.6640, TNR=0.7133, J=0.3773, MCC=0.2816, ConfusionMatrix=
[[1540  619]
 [ 125  247]]
Epoch 7 complete in 25.41

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5458, Acc=0.7323, AUC=0.8013, TPR=0.7027, TNR=0.7621, J=0.4648, MCC=0.4656, ConfusionMatrix=
[[2774  866]
 [1088 2572]]
Epoch 8, Phase val, Loss=0.5723, Acc=0.7443, AUC=0.7627, TPR=0.6134, TNR=0.7677, J=0.3811, MCC=0.3011, ConfusionMatrix=
[[1669  505]
 [ 150  238]]
Epoch 8, Phase test, Loss=0.5846, Acc=0.7392, AUC=0.7460, TPR=0.6317, TNR=0.7578, J=0.3895, MCC=0.3011, ConfusionMatrix=
[[1636  523]
 [ 137  235]]
Epoch 8 complete in 26.46

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5529, Acc=0.7247, AUC=0.7907, TPR=0.6845, TNR=0.7654, J=0.4498, MCC=0.4512, ConfusionMatrix=
[[2776  851]
 [1159 2514]]
Epoch 9, Phase val, Loss=0.5996, Acc=0.7416, AUC=0.7625, TPR=0.6443, TNR=0.7590, J=0.4033, MCC=0.3149, ConfusionMatrix=
[[1650  524]
 [ 138  250]]
Epoch 9, Phase test, Loss=0.6058, Acc=0.7211, AUC=0.7441, TPR=0.6478, TNR=0.7337, J=0.3815, MCC=0.2890, ConfusionMatrix=
[[1584  575]
 [ 131  241]]
Epoch 9 complete in 29.35

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5481, Acc=0.7259, AUC=0.7976, TPR=0.6954, TNR=0.7571, J=0.4525, MCC=0.4532, ConfusionMatrix=
[[2731  876]
 [1125 2568]]
Epoch 10, Phase val, Loss=0.5494, Acc=0.7748, AUC=0.7523, TPR=0.5747, TNR=0.8105, J=0.3852, MCC=0.3198, ConfusionMatrix=
[[1762  412]
 [ 165  223]]
Epoch 10, Phase test, Loss=0.5514, Acc=0.7621, AUC=0.7395, TPR=0.5699, TNR=0.7953, J=0.3652, MCC=0.2954, ConfusionMatrix=
[[1717  442]
 [ 160  212]]
Epoch 10 complete in 27.88

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5433, Acc=0.7325, AUC=0.8021, TPR=0.7014, TNR=0.7643, J=0.4656, MCC=0.4664, ConfusionMatrix=
[[2759  851]
 [1102 2588]]
Epoch 11, Phase val, Loss=0.5471, Acc=0.7631, AUC=0.7562, TPR=0.5747, TNR=0.7967, J=0.3714, MCC=0.3037, ConfusionMatrix=
[[1732  442]
 [ 165  223]]
Epoch 11, Phase test, Loss=0.5497, Acc=0.7610, AUC=0.7443, TPR=0.5780, TNR=0.7925, J=0.3705, MCC=0.2983, ConfusionMatrix=
[[1711  448]
 [ 157  215]]
Epoch 11 complete in 26.68

Early Stop!
Training complete in 5m 26s
The best model val AUC=0.767158025019, test AUC=0.735931609118.
Finish training resnet18fixed-conv1x1ab-maxpool

Start training resnet18fixed-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6468, Acc=0.6403, AUC=0.7041, TPR=0.8427, TNR=0.4324, J=0.2750, MCC=0.3021, ConfusionMatrix=
[[1557 2044]
 [ 582 3117]]
Epoch 0, Phase val, Loss=0.6158, Acc=0.6948, AUC=0.7303, TPR=0.5902, TNR=0.7134, J=0.3036, MCC=0.2310, ConfusionMatrix=
[[1551  623]
 [ 159  229]]
New Best AUC=0.7303. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6373, Acc=0.6835, AUC=0.7163, TPR=0.6210, TNR=0.6943, J=0.3153, MCC=0.2337, ConfusionMatrix=
[[1499  660]
 [ 141  231]]
Epoch 0 complete in 27.77

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5813, Acc=0.7030, AUC=0.7654, TPR=0.6690, TNR=0.7364, J=0.4054, MCC=0.4064, ConfusionMatrix=
[[2713  971]
 [1197 2419]]
Epoch 1, Phase val, Loss=0.5492, Acc=0.7623, AUC=0.7574, TPR=0.5232, TNR=0.8050, J=0.3282, MCC=0.2736, ConfusionMatrix=
[[1750  424]
 [ 185  203]]
New Best AUC=0.7574. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5611, Acc=0.7487, AUC=0.7321, TPR=0.5296, TNR=0.7865, J=0.3160, MCC=0.2551, ConfusionMatrix=
[[1698  461]
 [ 175  197]]
Epoch 1 complete in 29.53

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5656, Acc=0.7247, AUC=0.7830, TPR=0.6840, TNR=0.7648, J=0.4487, MCC=0.4503, ConfusionMatrix=
[[2812  865]
 [1145 2478]]
Epoch 2, Phase val, Loss=0.5598, Acc=0.7521, AUC=0.7524, TPR=0.5670, TNR=0.7852, J=0.3522, MCC=0.2850, ConfusionMatrix=
[[1707  467]
 [ 168  220]]
Epoch 2, Phase test, Loss=0.5708, Acc=0.7377, AUC=0.7300, TPR=0.5699, TNR=0.7666, J=0.3365, MCC=0.2645, ConfusionMatrix=
[[1655  504]
 [ 160  212]]
Epoch 2 complete in 26.82

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5564, Acc=0.7215, AUC=0.7890, TPR=0.6883, TNR=0.7552, J=0.4436, MCC=0.4444, ConfusionMatrix=
[[2734  886]
 [1147 2533]]
Epoch 3, Phase val, Loss=0.5525, Acc=0.7709, AUC=0.7562, TPR=0.5541, TNR=0.8096, J=0.3637, MCC=0.3029, ConfusionMatrix=
[[1760  414]
 [ 173  215]]
Epoch 3, Phase test, Loss=0.5552, Acc=0.7499, AUC=0.7337, TPR=0.5699, TNR=0.7809, J=0.3508, MCC=0.2796, ConfusionMatrix=
[[1686  473]
 [ 160  212]]
Epoch 3 complete in 29.09

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5480, Acc=0.7274, AUC=0.7974, TPR=0.6805, TNR=0.7728, J=0.4533, MCC=0.4555, ConfusionMatrix=
[[2867  843]
 [1147 2443]]
Epoch 4, Phase val, Loss=0.5979, Acc=0.7291, AUC=0.7652, TPR=0.6418, TNR=0.7447, J=0.3865, MCC=0.2985, ConfusionMatrix=
[[1619  555]
 [ 139  249]]
New Best AUC=0.7652. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.6100, Acc=0.7068, AUC=0.7389, TPR=0.6156, TNR=0.7226, J=0.3381, MCC=0.2552, ConfusionMatrix=
[[1560  599]
 [ 143  229]]
Epoch 4 complete in 26.48

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5578, Acc=0.7205, AUC=0.7865, TPR=0.6762, TNR=0.7647, J=0.4409, MCC=0.4427, ConfusionMatrix=
[[2798  861]
 [1179 2462]]
Epoch 5, Phase val, Loss=0.5402, Acc=0.7701, AUC=0.7583, TPR=0.5180, TNR=0.8151, J=0.3331, MCC=0.2815, ConfusionMatrix=
[[1772  402]
 [ 187  201]]
Epoch 5, Phase test, Loss=0.5433, Acc=0.7606, AUC=0.7349, TPR=0.5484, TNR=0.7971, J=0.3455, MCC=0.2812, ConfusionMatrix=
[[1721  438]
 [ 168  204]]
Epoch 5 complete in 27.28

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5592, Acc=0.7174, AUC=0.7865, TPR=0.6884, TNR=0.7471, J=0.4355, MCC=0.4361, ConfusionMatrix=
[[2694  912]
 [1151 2543]]
Epoch 6, Phase val, Loss=0.6006, Acc=0.7338, AUC=0.7716, TPR=0.6495, TNR=0.7489, J=0.3983, MCC=0.3083, ConfusionMatrix=
[[1628  546]
 [ 136  252]]
New Best AUC=0.7716. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.6163, Acc=0.7037, AUC=0.7354, TPR=0.6237, TNR=0.7175, J=0.3411, MCC=0.2563, ConfusionMatrix=
[[1549  610]
 [ 140  232]]
Epoch 6 complete in 30.83

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5485, Acc=0.7319, AUC=0.7978, TPR=0.7145, TNR=0.7499, J=0.4644, MCC=0.4645, ConfusionMatrix=
[[2693  898]
 [1059 2650]]
Epoch 7, Phase val, Loss=0.5177, Acc=0.7826, AUC=0.7638, TPR=0.5103, TNR=0.8312, J=0.3415, MCC=0.2953, ConfusionMatrix=
[[1807  367]
 [ 190  198]]
Epoch 7, Phase test, Loss=0.5210, Acc=0.7815, AUC=0.7372, TPR=0.5349, TNR=0.8240, J=0.3589, MCC=0.3026, ConfusionMatrix=
[[1779  380]
 [ 173  199]]
Epoch 7 complete in 26.65

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5501, Acc=0.7282, AUC=0.7944, TPR=0.6764, TNR=0.7802, J=0.4566, MCC=0.4591, ConfusionMatrix=
[[2843  801]
 [1183 2473]]
Epoch 8, Phase val, Loss=0.5011, Acc=0.7955, AUC=0.7549, TPR=0.4845, TNR=0.8510, J=0.3355, MCC=0.3008, ConfusionMatrix=
[[1850  324]
 [ 200  188]]
Epoch 8, Phase test, Loss=0.5064, Acc=0.7977, AUC=0.7358, TPR=0.5134, TNR=0.8467, J=0.3601, MCC=0.3152, ConfusionMatrix=
[[1828  331]
 [ 181  191]]
Epoch 8 complete in 25.84

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5483, Acc=0.7303, AUC=0.7971, TPR=0.6896, TNR=0.7702, J=0.4598, MCC=0.4615, ConfusionMatrix=
[[2836  846]
 [1123 2495]]
Epoch 9, Phase val, Loss=0.5773, Acc=0.7475, AUC=0.7561, TPR=0.6057, TNR=0.7728, J=0.3784, MCC=0.3007, ConfusionMatrix=
[[1680  494]
 [ 153  235]]
Epoch 9, Phase test, Loss=0.5820, Acc=0.7313, AUC=0.7406, TPR=0.6237, TNR=0.7499, J=0.3735, MCC=0.2873, ConfusionMatrix=
[[1619  540]
 [ 140  232]]
Epoch 9 complete in 28.96

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5480, Acc=0.7275, AUC=0.7972, TPR=0.6874, TNR=0.7673, J=0.4547, MCC=0.4562, ConfusionMatrix=
[[2813  853]
 [1136 2498]]
Epoch 10, Phase val, Loss=0.5923, Acc=0.7373, AUC=0.7629, TPR=0.6314, TNR=0.7562, J=0.3877, MCC=0.3025, ConfusionMatrix=
[[1644  530]
 [ 143  245]]
Epoch 10, Phase test, Loss=0.6006, Acc=0.7159, AUC=0.7430, TPR=0.6344, TNR=0.7300, J=0.3644, MCC=0.2758, ConfusionMatrix=
[[1576  583]
 [ 136  236]]
Epoch 10 complete in 27.12

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5539, Acc=0.7227, AUC=0.7904, TPR=0.6819, TNR=0.7636, J=0.4455, MCC=0.4470, ConfusionMatrix=
[[2787  863]
 [1161 2489]]
Epoch 11, Phase val, Loss=0.5331, Acc=0.7810, AUC=0.7640, TPR=0.5412, TNR=0.8238, J=0.3651, MCC=0.3103, ConfusionMatrix=
[[1791  383]
 [ 178  210]]
Epoch 11, Phase test, Loss=0.5351, Acc=0.7712, AUC=0.7444, TPR=0.5645, TNR=0.8069, J=0.3714, MCC=0.3046, ConfusionMatrix=
[[1742  417]
 [ 162  210]]
Epoch 11 complete in 26.20

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5554, Acc=0.7189, AUC=0.7926, TPR=0.6898, TNR=0.7488, J=0.4386, MCC=0.4392, ConfusionMatrix=
[[2697  905]
 [1147 2551]]
Epoch 12, Phase val, Loss=0.5722, Acc=0.7506, AUC=0.7755, TPR=0.6418, TNR=0.7700, J=0.4118, MCC=0.3245, ConfusionMatrix=
[[1674  500]
 [ 139  249]]
New Best AUC=0.7755. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_bestAUC.pth
Epoch 12, Phase test, Loss=0.5865, Acc=0.7203, AUC=0.7457, TPR=0.6210, TNR=0.7374, J=0.3583, MCC=0.2731, ConfusionMatrix=
[[1592  567]
 [ 141  231]]
Epoch 12 complete in 28.45

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5441, Acc=0.7329, AUC=0.8015, TPR=0.7015, TNR=0.7639, J=0.4654, MCC=0.4664, ConfusionMatrix=
[[2802  866]
 [1084 2548]]
Epoch 13, Phase val, Loss=0.4848, Acc=0.7986, AUC=0.7617, TPR=0.4845, TNR=0.8546, J=0.3392, MCC=0.3059, ConfusionMatrix=
[[1858  316]
 [ 200  188]]
Epoch 13, Phase test, Loss=0.4919, Acc=0.8028, AUC=0.7433, TPR=0.5161, TNR=0.8522, J=0.3684, MCC=0.3249, ConfusionMatrix=
[[1840  319]
 [ 180  192]]
Epoch 13 complete in 26.23

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5403, Acc=0.7325, AUC=0.8020, TPR=0.7046, TNR=0.7611, J=0.4657, MCC=0.4662, ConfusionMatrix=
[[2740  860]
 [1093 2607]]
Epoch 14, Phase val, Loss=0.5055, Acc=0.7916, AUC=0.7614, TPR=0.5052, TNR=0.8427, J=0.3478, MCC=0.3061, ConfusionMatrix=
[[1832  342]
 [ 192  196]]
Epoch 14, Phase test, Loss=0.5112, Acc=0.7930, AUC=0.7420, TPR=0.5565, TNR=0.8337, J=0.3902, MCC=0.3316, ConfusionMatrix=
[[1800  359]
 [ 165  207]]
Epoch 14 complete in 27.23

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5414, Acc=0.7312, AUC=0.8015, TPR=0.6883, TNR=0.7750, J=0.4633, MCC=0.4649, ConfusionMatrix=
[[2801  813]
 [1149 2537]]
Epoch 15, Phase val, Loss=0.6731, Acc=0.6792, AUC=0.7508, TPR=0.6881, TNR=0.6776, J=0.3657, MCC=0.2704, ConfusionMatrix=
[[1473  701]
 [ 121  267]]
Epoch 15, Phase test, Loss=0.6870, Acc=0.6646, AUC=0.7410, TPR=0.6882, TNR=0.6605, J=0.3487, MCC=0.2530, ConfusionMatrix=
[[1426  733]
 [ 116  256]]
Epoch 15 complete in 26.08

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5393, Acc=0.7310, AUC=0.8032, TPR=0.7063, TNR=0.7570, J=0.4633, MCC=0.4635, ConfusionMatrix=
[[2688  863]
 [1101 2648]]
Epoch 16, Phase val, Loss=0.6548, Acc=0.6928, AUC=0.7630, TPR=0.7113, TNR=0.6895, J=0.4009, MCC=0.2974, ConfusionMatrix=
[[1499  675]
 [ 112  276]]
Epoch 16, Phase test, Loss=0.6807, Acc=0.6586, AUC=0.7423, TPR=0.6909, TNR=0.6531, J=0.3439, MCC=0.2489, ConfusionMatrix=
[[1410  749]
 [ 115  257]]
Epoch 16 complete in 26.03

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5407, Acc=0.7329, AUC=0.8023, TPR=0.7014, TNR=0.7639, J=0.4653, MCC=0.4663, ConfusionMatrix=
[[2809  868]
 [1082 2541]]
Epoch 17, Phase val, Loss=0.4825, Acc=0.8037, AUC=0.7639, TPR=0.4613, TNR=0.8648, J=0.3261, MCC=0.3013, ConfusionMatrix=
[[1880  294]
 [ 209  179]]
Epoch 17, Phase test, Loss=0.4907, Acc=0.8048, AUC=0.7394, TPR=0.5188, TNR=0.8541, J=0.3729, MCC=0.3297, ConfusionMatrix=
[[1844  315]
 [ 179  193]]
Epoch 17 complete in 26.59

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5447, Acc=0.7308, AUC=0.8013, TPR=0.6962, TNR=0.7665, J=0.4627, MCC=0.4636, ConfusionMatrix=
[[2757  840]
 [1125 2578]]
Epoch 18, Phase val, Loss=0.5914, Acc=0.7326, AUC=0.7581, TPR=0.6314, TNR=0.7507, J=0.3821, MCC=0.2969, ConfusionMatrix=
[[1632  542]
 [ 143  245]]
Epoch 18, Phase test, Loss=0.6046, Acc=0.7084, AUC=0.7445, TPR=0.6290, TNR=0.7221, J=0.3511, MCC=0.2645, ConfusionMatrix=
[[1559  600]
 [ 138  234]]
Epoch 18 complete in 30.54

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.5354, Acc=0.7416, AUC=0.8092, TPR=0.7176, TNR=0.7662, J=0.4838, MCC=0.4842, ConfusionMatrix=
[[2769  845]
 [1041 2645]]
Epoch 19, Phase val, Loss=0.6411, Acc=0.7022, AUC=0.7690, TPR=0.6985, TNR=0.7029, J=0.4013, MCC=0.3001, ConfusionMatrix=
[[1528  646]
 [ 117  271]]
Epoch 19, Phase test, Loss=0.6686, Acc=0.6653, AUC=0.7436, TPR=0.6935, TNR=0.6605, J=0.3540, MCC=0.2568, ConfusionMatrix=
[[1426  733]
 [ 114  258]]
Epoch 19 complete in 26.47

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.5393, Acc=0.7367, AUC=0.8051, TPR=0.6965, TNR=0.7761, J=0.4727, MCC=0.4743, ConfusionMatrix=
[[2860  825]
 [1097 2518]]
Epoch 20, Phase val, Loss=0.5335, Acc=0.7705, AUC=0.7641, TPR=0.5747, TNR=0.8054, J=0.3802, MCC=0.3138, ConfusionMatrix=
[[1751  423]
 [ 165  223]]
Epoch 20, Phase test, Loss=0.5493, Acc=0.7558, AUC=0.7423, TPR=0.5995, TNR=0.7828, J=0.3822, MCC=0.3037, ConfusionMatrix=
[[1690  469]
 [ 149  223]]
Epoch 20 complete in 26.73

Early Stop!
Training complete in 9m 37s
The best model val AUC=0.775489856694, test AUC=0.745650863851.
Finish training resnet18fixed-conv1x1ab-maxpool

Start training resnet18fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6498, Acc=0.6389, AUC=0.6865, TPR=0.6415, TNR=0.6364, J=0.2779, MCC=0.2778, ConfusionMatrix=
[[2349 1342]
 [1294 2315]]
Epoch 0, Phase val, Loss=0.7469, Acc=0.4727, AUC=0.7198, TPR=0.8634, TNR=0.4029, J=0.2663, MCC=0.1986, ConfusionMatrix=
[[ 876 1298]
 [  53  335]]
New Best AUC=0.7198. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7624, Acc=0.4686, AUC=0.6948, TPR=0.8683, TNR=0.3997, J=0.2680, MCC=0.1977, ConfusionMatrix=
[[ 863 1296]
 [  49  323]]
Epoch 0 complete in 30.45

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5923, Acc=0.6849, AUC=0.7548, TPR=0.7394, TNR=0.6298, J=0.3692, MCC=0.3715, ConfusionMatrix=
[[2285 1343]
 [ 957 2715]]
Epoch 1, Phase val, Loss=0.6037, Acc=0.6565, AUC=0.7402, TPR=0.7268, TNR=0.6440, J=0.3708, MCC=0.2700, ConfusionMatrix=
[[1400  774]
 [ 106  282]]
New Best AUC=0.7402. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6257, Acc=0.6250, AUC=0.7258, TPR=0.6882, TNR=0.6142, J=0.3023, MCC=0.2162, ConfusionMatrix=
[[1326  833]
 [ 116  256]]
Epoch 1 complete in 28.06

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5692, Acc=0.7067, AUC=0.7774, TPR=0.7472, TNR=0.6649, J=0.4121, MCC=0.4137, ConfusionMatrix=
[[2389 1204]
 [ 937 2770]]
Epoch 2, Phase val, Loss=0.5451, Acc=0.7108, AUC=0.7430, TPR=0.5928, TNR=0.7318, J=0.3246, MCC=0.2500, ConfusionMatrix=
[[1591  583]
 [ 158  230]]
New Best AUC=0.7430. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5644, Acc=0.6934, AUC=0.7294, TPR=0.6183, TNR=0.7063, J=0.3246, MCC=0.2424, ConfusionMatrix=
[[1525  634]
 [ 142  230]]
Epoch 2 complete in 28.02

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5541, Acc=0.7233, AUC=0.7935, TPR=0.7480, TNR=0.6976, J=0.4456, MCC=0.4463, ConfusionMatrix=
[[2496 1082]
 [ 938 2784]]
Epoch 3, Phase val, Loss=0.4596, Acc=0.7810, AUC=0.7367, TPR=0.4098, TNR=0.8473, J=0.2571, MCC=0.2341, ConfusionMatrix=
[[1842  332]
 [ 229  159]]
Epoch 3, Phase test, Loss=0.4738, Acc=0.7847, AUC=0.7255, TPR=0.4677, TNR=0.8393, J=0.3070, MCC=0.2689, ConfusionMatrix=
[[1812  347]
 [ 198  174]]
Epoch 3 complete in 28.16

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5645, Acc=0.7145, AUC=0.7822, TPR=0.7238, TNR=0.7050, J=0.4288, MCC=0.4289, ConfusionMatrix=
[[2545 1065]
 [1019 2671]]
Epoch 4, Phase val, Loss=0.4750, Acc=0.7728, AUC=0.7407, TPR=0.4304, TNR=0.8339, J=0.2644, MCC=0.2343, ConfusionMatrix=
[[1813  361]
 [ 221  167]]
Epoch 4, Phase test, Loss=0.4905, Acc=0.7768, AUC=0.7256, TPR=0.4892, TNR=0.8263, J=0.3156, MCC=0.2697, ConfusionMatrix=
[[1784  375]
 [ 190  182]]
Epoch 4 complete in 27.11

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5527, Acc=0.7203, AUC=0.7914, TPR=0.7427, TNR=0.6973, J=0.4401, MCC=0.4406, ConfusionMatrix=
[[2518 1093]
 [ 949 2740]]
Epoch 5, Phase val, Loss=0.5321, Acc=0.7252, AUC=0.7492, TPR=0.5541, TNR=0.7557, J=0.3099, MCC=0.2445, ConfusionMatrix=
[[1643  531]
 [ 173  215]]
New Best AUC=0.7492. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5534, Acc=0.7151, AUC=0.7289, TPR=0.5753, TNR=0.7392, J=0.3145, MCC=0.2414, ConfusionMatrix=
[[1596  563]
 [ 158  214]]
Epoch 5 complete in 27.29

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5702, Acc=0.7044, AUC=0.7756, TPR=0.7088, TNR=0.6999, J=0.4088, MCC=0.4088, ConfusionMatrix=
[[2552 1094]
 [1064 2590]]
Epoch 6, Phase val, Loss=0.4761, Acc=0.7787, AUC=0.7373, TPR=0.4175, TNR=0.8431, J=0.2607, MCC=0.2352, ConfusionMatrix=
[[1833  341]
 [ 226  162]]
Epoch 6, Phase test, Loss=0.4948, Acc=0.7803, AUC=0.7233, TPR=0.4892, TNR=0.8305, J=0.3197, MCC=0.2749, ConfusionMatrix=
[[1793  366]
 [ 190  182]]
Epoch 6 complete in 27.09

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5622, Acc=0.7121, AUC=0.7820, TPR=0.7259, TNR=0.6982, J=0.4241, MCC=0.4243, ConfusionMatrix=
[[2550 1102]
 [1000 2648]]
Epoch 7, Phase val, Loss=0.5392, Acc=0.7143, AUC=0.7374, TPR=0.5515, TNR=0.7433, J=0.2949, MCC=0.2304, ConfusionMatrix=
[[1616  558]
 [ 174  214]]
Epoch 7, Phase test, Loss=0.5540, Acc=0.7124, AUC=0.7289, TPR=0.5833, TNR=0.7346, J=0.3179, MCC=0.2430, ConfusionMatrix=
[[1586  573]
 [ 155  217]]
Epoch 7 complete in 26.32

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5556, Acc=0.7188, AUC=0.7901, TPR=0.7286, TNR=0.7088, J=0.4375, MCC=0.4376, ConfusionMatrix=
[[2578 1059]
 [ 994 2669]]
Epoch 8, Phase val, Loss=0.5739, Acc=0.6932, AUC=0.7465, TPR=0.6211, TNR=0.7061, J=0.3272, MCC=0.2470, ConfusionMatrix=
[[1535  639]
 [ 147  241]]
Epoch 8, Phase test, Loss=0.5957, Acc=0.6693, AUC=0.7334, TPR=0.6290, TNR=0.6762, J=0.3053, MCC=0.2241, ConfusionMatrix=
[[1460  699]
 [ 138  234]]
Epoch 8 complete in 27.17

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5358, Acc=0.7377, AUC=0.8085, TPR=0.7330, TNR=0.7421, J=0.4751, MCC=0.4750, ConfusionMatrix=
[[2783  967]
 [ 948 2602]]
Epoch 9, Phase val, Loss=0.4957, Acc=0.7545, AUC=0.7349, TPR=0.4665, TNR=0.8059, J=0.2724, MCC=0.2302, ConfusionMatrix=
[[1752  422]
 [ 207  181]]
Epoch 9, Phase test, Loss=0.5092, Acc=0.7637, AUC=0.7252, TPR=0.5269, TNR=0.8045, J=0.3314, MCC=0.2732, ConfusionMatrix=
[[1737  422]
 [ 176  196]]
Epoch 9 complete in 27.74

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5442, Acc=0.7333, AUC=0.8007, TPR=0.7362, TNR=0.7304, J=0.4666, MCC=0.4666, ConfusionMatrix=
[[2666  984]
 [ 963 2687]]
Epoch 10, Phase val, Loss=0.5546, Acc=0.7143, AUC=0.7351, TPR=0.5515, TNR=0.7433, J=0.2949, MCC=0.2304, ConfusionMatrix=
[[1616  558]
 [ 174  214]]
Epoch 10, Phase test, Loss=0.5727, Acc=0.7049, AUC=0.7312, TPR=0.6102, TNR=0.7212, J=0.3314, MCC=0.2500, ConfusionMatrix=
[[1557  602]
 [ 145  227]]
Epoch 10 complete in 26.69

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5464, Acc=0.7240, AUC=0.7975, TPR=0.7425, TNR=0.7051, J=0.4476, MCC=0.4480, ConfusionMatrix=
[[2549 1066]
 [ 949 2736]]
Epoch 11, Phase val, Loss=0.5967, Acc=0.6838, AUC=0.7428, TPR=0.6366, TNR=0.6923, J=0.3289, MCC=0.2460, ConfusionMatrix=
[[1505  669]
 [ 141  247]]
Epoch 11, Phase test, Loss=0.6227, Acc=0.6488, AUC=0.7304, TPR=0.6586, TNR=0.6471, J=0.3057, MCC=0.2211, ConfusionMatrix=
[[1397  762]
 [ 127  245]]
Epoch 11 complete in 27.14

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5541, Acc=0.7195, AUC=0.7915, TPR=0.7215, TNR=0.7175, J=0.4389, MCC=0.4389, ConfusionMatrix=
[[2636 1038]
 [1010 2616]]
Epoch 12, Phase val, Loss=0.4632, Acc=0.7814, AUC=0.7353, TPR=0.3969, TNR=0.8500, J=0.2470, MCC=0.2269, ConfusionMatrix=
[[1848  326]
 [ 234  154]]
Epoch 12, Phase test, Loss=0.4765, Acc=0.7910, AUC=0.7224, TPR=0.4570, TNR=0.8485, J=0.3055, MCC=0.2723, ConfusionMatrix=
[[1832  327]
 [ 202  170]]
Epoch 12 complete in 27.07

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5436, Acc=0.7223, AUC=0.7997, TPR=0.7267, TNR=0.7180, J=0.4447, MCC=0.4447, ConfusionMatrix=
[[2630 1033]
 [ 994 2643]]
Epoch 13, Phase val, Loss=0.5327, Acc=0.7240, AUC=0.7394, TPR=0.5335, TNR=0.7580, J=0.2916, MCC=0.2313, ConfusionMatrix=
[[1648  526]
 [ 181  207]]
Epoch 13, Phase test, Loss=0.5516, Acc=0.7124, AUC=0.7266, TPR=0.5699, TNR=0.7369, J=0.3068, MCC=0.2353, ConfusionMatrix=
[[1591  568]
 [ 160  212]]
Epoch 13 complete in 25.21

Early Stop!
Training complete in 6m 24s
The best model val AUC=0.749202145316, test AUC=0.72890301663.
Finish training resnet18fixed-conv1x1ab-avgpool

Start training resnet18fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6547, Acc=0.6318, AUC=0.6871, TPR=0.8312, TNR=0.4253, J=0.2564, MCC=0.2812, ConfusionMatrix=
[[1525 2061]
 [ 627 3087]]
Epoch 0, Phase val, Loss=0.5988, Acc=0.6514, AUC=0.6966, TPR=0.5979, TNR=0.6610, J=0.2589, MCC=0.1914, ConfusionMatrix=
[[1437  737]
 [ 156  232]]
New Best AUC=0.6966. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6075, Acc=0.6373, AUC=0.6798, TPR=0.6022, TNR=0.6434, J=0.2455, MCC=0.1780, ConfusionMatrix=
[[1389  770]
 [ 148  224]]
Epoch 0 complete in 25.91

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5969, Acc=0.6890, AUC=0.7503, TPR=0.7105, TNR=0.6682, J=0.3787, MCC=0.3789, ConfusionMatrix=
[[2473 1228]
 [1042 2557]]
Epoch 1, Phase val, Loss=0.6167, Acc=0.6429, AUC=0.7397, TPR=0.7500, TNR=0.6237, J=0.3737, MCC=0.2704, ConfusionMatrix=
[[1356  818]
 [  97  291]]
New Best AUC=0.7397. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6440, Acc=0.6049, AUC=0.7203, TPR=0.7231, TNR=0.5845, J=0.3076, MCC=0.2185, ConfusionMatrix=
[[1262  897]
 [ 103  269]]
Epoch 1 complete in 29.76

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5786, Acc=0.7014, AUC=0.7682, TPR=0.7323, TNR=0.6710, J=0.4033, MCC=0.4040, ConfusionMatrix=
[[2472 1212]
 [ 968 2648]]
Epoch 2, Phase val, Loss=0.5034, Acc=0.7467, AUC=0.7384, TPR=0.4923, TNR=0.7921, J=0.2844, MCC=0.2351, ConfusionMatrix=
[[1722  452]
 [ 197  191]]
Epoch 2, Phase test, Loss=0.5201, Acc=0.7444, AUC=0.7253, TPR=0.5296, TNR=0.7814, J=0.3110, MCC=0.2497, ConfusionMatrix=
[[1687  472]
 [ 175  197]]
Epoch 2 complete in 26.33

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5756, Acc=0.7063, AUC=0.7701, TPR=0.7297, TNR=0.6823, J=0.4120, MCC=0.4125, ConfusionMatrix=
[[2457 1144]
 [1000 2699]]
Epoch 3, Phase val, Loss=0.5480, Acc=0.7108, AUC=0.7317, TPR=0.5464, TNR=0.7401, J=0.2865, MCC=0.2234, ConfusionMatrix=
[[1609  565]
 [ 176  212]]
Epoch 3, Phase test, Loss=0.5729, Acc=0.6895, AUC=0.7239, TPR=0.6156, TNR=0.7022, J=0.3178, MCC=0.2368, ConfusionMatrix=
[[1516  643]
 [ 143  229]]
Epoch 3 complete in 25.89

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5684, Acc=0.7153, AUC=0.7793, TPR=0.7066, TNR=0.7239, J=0.4305, MCC=0.4306, ConfusionMatrix=
[[2669 1018]
 [1060 2553]]
Epoch 4, Phase val, Loss=0.5834, Acc=0.6827, AUC=0.7391, TPR=0.6263, TNR=0.6927, J=0.3190, MCC=0.2389, ConfusionMatrix=
[[1506  668]
 [ 145  243]]
Epoch 4, Phase test, Loss=0.6020, Acc=0.6665, AUC=0.7297, TPR=0.6532, TNR=0.6688, J=0.3221, MCC=0.2351, ConfusionMatrix=
[[1444  715]
 [ 129  243]]
Epoch 4 complete in 26.03

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5463, Acc=0.7279, AUC=0.7993, TPR=0.7614, TNR=0.6935, J=0.4549, MCC=0.4562, ConfusionMatrix=
[[2496 1103]
 [ 883 2818]]
Epoch 5, Phase val, Loss=0.6057, Acc=0.6706, AUC=0.7373, TPR=0.6675, TNR=0.6711, J=0.3386, MCC=0.2501, ConfusionMatrix=
[[1459  715]
 [ 129  259]]
Epoch 5, Phase test, Loss=0.6288, Acc=0.6511, AUC=0.7297, TPR=0.6828, TNR=0.6457, J=0.3285, MCC=0.2372, ConfusionMatrix=
[[1394  765]
 [ 118  254]]
Epoch 5 complete in 26.52

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5528, Acc=0.7262, AUC=0.7937, TPR=0.7340, TNR=0.7183, J=0.4524, MCC=0.4524, ConfusionMatrix=
[[2632 1032]
 [ 967 2669]]
Epoch 6, Phase val, Loss=0.5282, Acc=0.7295, AUC=0.7311, TPR=0.5155, TNR=0.7677, J=0.2832, MCC=0.2273, ConfusionMatrix=
[[1669  505]
 [ 188  200]]
Epoch 6, Phase test, Loss=0.5513, Acc=0.7092, AUC=0.7216, TPR=0.5618, TNR=0.7346, J=0.2964, MCC=0.2272, ConfusionMatrix=
[[1586  573]
 [ 163  209]]
Epoch 6 complete in 27.63

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5473, Acc=0.7274, AUC=0.7988, TPR=0.7397, TNR=0.7151, J=0.4548, MCC=0.4550, ConfusionMatrix=
[[2613 1041]
 [ 949 2697]]
Epoch 7, Phase val, Loss=0.6508, Acc=0.6417, AUC=0.7313, TPR=0.7062, TNR=0.6302, J=0.3364, MCC=0.2442, ConfusionMatrix=
[[1370  804]
 [ 114  274]]
Epoch 7, Phase test, Loss=0.6900, Acc=0.5990, AUC=0.7263, TPR=0.7258, TNR=0.5771, J=0.3029, MCC=0.2150, ConfusionMatrix=
[[1246  913]
 [ 102  270]]
Epoch 7 complete in 26.90

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5481, Acc=0.7245, AUC=0.7977, TPR=0.7275, TNR=0.7216, J=0.4491, MCC=0.4491, ConfusionMatrix=
[[2649 1022]
 [ 989 2640]]
Epoch 8, Phase val, Loss=0.4887, Acc=0.7662, AUC=0.7372, TPR=0.4639, TNR=0.8201, J=0.2841, MCC=0.2447, ConfusionMatrix=
[[1783  391]
 [ 208  180]]
Epoch 8, Phase test, Loss=0.5070, Acc=0.7621, AUC=0.7290, TPR=0.5269, TNR=0.8027, J=0.3296, MCC=0.2710, ConfusionMatrix=
[[1733  426]
 [ 176  196]]
Epoch 8 complete in 26.59

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5517, Acc=0.7163, AUC=0.7926, TPR=0.7198, TNR=0.7128, J=0.4326, MCC=0.4326, ConfusionMatrix=
[[2604 1049]
 [1022 2625]]
Epoch 9, Phase val, Loss=0.5153, Acc=0.7377, AUC=0.7398, TPR=0.5155, TNR=0.7774, J=0.2928, MCC=0.2373, ConfusionMatrix=
[[1690  484]
 [ 188  200]]
New Best AUC=0.7398. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.5358, Acc=0.7369, AUC=0.7304, TPR=0.5565, TNR=0.7679, J=0.3244, MCC=0.2559, ConfusionMatrix=
[[1658  501]
 [ 165  207]]
Epoch 9 complete in 26.52

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5511, Acc=0.7262, AUC=0.7948, TPR=0.7348, TNR=0.7176, J=0.4524, MCC=0.4525, ConfusionMatrix=
[[2633 1036]
 [ 963 2668]]
Epoch 10, Phase val, Loss=0.7397, Acc=0.5835, AUC=0.7401, TPR=0.8144, TNR=0.5423, J=0.3568, MCC=0.2558, ConfusionMatrix=
[[1179  995]
 [  72  316]]
New Best AUC=0.7401. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.7805, Acc=0.5389, AUC=0.7334, TPR=0.7903, TNR=0.4956, J=0.2859, MCC=0.2034, ConfusionMatrix=
[[1070 1089]
 [  78  294]]
Epoch 10 complete in 28.92

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5429, Acc=0.7312, AUC=0.8020, TPR=0.7392, TNR=0.7235, J=0.4627, MCC=0.4627, ConfusionMatrix=
[[2679 1024]
 [ 938 2659]]
Epoch 11, Phase val, Loss=0.4816, Acc=0.7732, AUC=0.7419, TPR=0.4742, TNR=0.8266, J=0.3008, MCC=0.2608, ConfusionMatrix=
[[1797  377]
 [ 204  184]]
New Best AUC=0.7419. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.4995, Acc=0.7716, AUC=0.7361, TPR=0.5161, TNR=0.8157, J=0.3318, MCC=0.2779, ConfusionMatrix=
[[1761  398]
 [ 180  192]]
Epoch 11 complete in 26.89

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5520, Acc=0.7222, AUC=0.7933, TPR=0.7315, TNR=0.7128, J=0.4443, MCC=0.4444, ConfusionMatrix=
[[2594 1045]
 [ 983 2678]]
Epoch 12, Phase val, Loss=0.5086, Acc=0.7521, AUC=0.7329, TPR=0.4845, TNR=0.7999, J=0.2844, MCC=0.2377, ConfusionMatrix=
[[1739  435]
 [ 200  188]]
Epoch 12, Phase test, Loss=0.5277, Acc=0.7448, AUC=0.7312, TPR=0.5484, TNR=0.7786, J=0.3270, MCC=0.2610, ConfusionMatrix=
[[1681  478]
 [ 168  204]]
Epoch 12 complete in 27.80

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5545, Acc=0.7123, AUC=0.7885, TPR=0.7084, TNR=0.7161, J=0.4246, MCC=0.4246, ConfusionMatrix=
[[2639 1046]
 [1054 2561]]
Epoch 13, Phase val, Loss=0.6219, Acc=0.6612, AUC=0.7415, TPR=0.6727, TNR=0.6592, J=0.3318, MCC=0.2438, ConfusionMatrix=
[[1433  741]
 [ 127  261]]
Epoch 13, Phase test, Loss=0.6525, Acc=0.6290, AUC=0.7301, TPR=0.7097, TNR=0.6151, J=0.3248, MCC=0.2321, ConfusionMatrix=
[[1328  831]
 [ 108  264]]
Epoch 13 complete in 27.27

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5412, Acc=0.7260, AUC=0.8036, TPR=0.7387, TNR=0.7131, J=0.4518, MCC=0.4520, ConfusionMatrix=
[[2577 1037]
 [ 963 2723]]
Epoch 14, Phase val, Loss=0.5197, Acc=0.7385, AUC=0.7414, TPR=0.5155, TNR=0.7783, J=0.2938, MCC=0.2383, ConfusionMatrix=
[[1692  482]
 [ 188  200]]
Epoch 14, Phase test, Loss=0.5427, Acc=0.7266, AUC=0.7307, TPR=0.5806, TNR=0.7517, J=0.3324, MCC=0.2575, ConfusionMatrix=
[[1623  536]
 [ 156  216]]
Epoch 14 complete in 26.74

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5427, Acc=0.7316, AUC=0.8021, TPR=0.7505, TNR=0.7126, J=0.4630, MCC=0.4634, ConfusionMatrix=
[[2583 1042]
 [ 917 2758]]
Epoch 15, Phase val, Loss=0.5176, Acc=0.7397, AUC=0.7353, TPR=0.5180, TNR=0.7792, J=0.2973, MCC=0.2412, ConfusionMatrix=
[[1694  480]
 [ 187  201]]
Epoch 15, Phase test, Loss=0.5349, Acc=0.7400, AUC=0.7305, TPR=0.5699, TNR=0.7693, J=0.3392, MCC=0.2674, ConfusionMatrix=
[[1661  498]
 [ 160  212]]
Epoch 15 complete in 26.53

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5421, Acc=0.7297, AUC=0.8021, TPR=0.7284, TNR=0.7310, J=0.4594, MCC=0.4594, ConfusionMatrix=
[[2677  985]
 [ 988 2650]]
Epoch 16, Phase val, Loss=0.6000, Acc=0.6756, AUC=0.7335, TPR=0.6211, TNR=0.6854, J=0.3065, MCC=0.2288, ConfusionMatrix=
[[1490  684]
 [ 147  241]]
Epoch 16, Phase test, Loss=0.6207, Acc=0.6582, AUC=0.7302, TPR=0.6613, TNR=0.6577, J=0.3190, MCC=0.2317, ConfusionMatrix=
[[1420  739]
 [ 126  246]]
Epoch 16 complete in 27.93

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5490, Acc=0.7230, AUC=0.7946, TPR=0.7427, TNR=0.7026, J=0.4453, MCC=0.4457, ConfusionMatrix=
[[2518 1066]
 [ 956 2760]]
Epoch 17, Phase val, Loss=0.6289, Acc=0.6612, AUC=0.7278, TPR=0.6495, TNR=0.6633, J=0.3128, MCC=0.2305, ConfusionMatrix=
[[1442  732]
 [ 136  252]]
Epoch 17, Phase test, Loss=0.6583, Acc=0.6243, AUC=0.7237, TPR=0.6801, TNR=0.6146, J=0.2947, MCC=0.2109, ConfusionMatrix=
[[1327  832]
 [ 119  253]]
Epoch 17 complete in 27.15

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5457, Acc=0.7255, AUC=0.7982, TPR=0.7336, TNR=0.7174, J=0.4510, MCC=0.4510, ConfusionMatrix=
[[2622 1033]
 [ 971 2674]]
Epoch 18, Phase val, Loss=0.4738, Acc=0.7763, AUC=0.7419, TPR=0.4665, TNR=0.8316, J=0.2981, MCC=0.2608, ConfusionMatrix=
[[1808  366]
 [ 207  181]]
New Best AUC=0.7419. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 18, Phase test, Loss=0.4850, Acc=0.7748, AUC=0.7279, TPR=0.4839, TNR=0.8249, J=0.3088, MCC=0.2637, ConfusionMatrix=
[[1781  378]
 [ 192  180]]
Epoch 18 complete in 29.44

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.5388, Acc=0.7279, AUC=0.8040, TPR=0.7427, TNR=0.7125, J=0.4552, MCC=0.4554, ConfusionMatrix=
[[2540 1025]
 [ 961 2774]]
Epoch 19, Phase val, Loss=0.4952, Acc=0.7537, AUC=0.7470, TPR=0.4897, TNR=0.8008, J=0.2905, MCC=0.2428, ConfusionMatrix=
[[1741  433]
 [ 198  190]]
New Best AUC=0.7470. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 19, Phase test, Loss=0.5086, Acc=0.7570, AUC=0.7334, TPR=0.5269, TNR=0.7967, J=0.3235, MCC=0.2643, ConfusionMatrix=
[[1720  439]
 [ 176  196]]
Epoch 19 complete in 30.96

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.5278, Acc=0.7399, AUC=0.8147, TPR=0.7512, TNR=0.7285, J=0.4796, MCC=0.4798, ConfusionMatrix=
[[2648  987]
 [ 912 2753]]
Epoch 20, Phase val, Loss=0.5412, Acc=0.7166, AUC=0.7350, TPR=0.5258, TNR=0.7507, J=0.2765, MCC=0.2182, ConfusionMatrix=
[[1632  542]
 [ 184  204]]
Epoch 20, Phase test, Loss=0.5590, Acc=0.7108, AUC=0.7291, TPR=0.5780, TNR=0.7337, J=0.3116, MCC=0.2381, ConfusionMatrix=
[[1584  575]
 [ 157  215]]
Epoch 20 complete in 27.31

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.5328, Acc=0.7314, AUC=0.8105, TPR=0.7381, TNR=0.7247, J=0.4628, MCC=0.4628, ConfusionMatrix=
[[2656 1009]
 [ 952 2683]]
Epoch 21, Phase val, Loss=0.4788, Acc=0.7639, AUC=0.7393, TPR=0.4510, TNR=0.8197, J=0.2707, MCC=0.2338, ConfusionMatrix=
[[1782  392]
 [ 213  175]]
Epoch 21, Phase test, Loss=0.4895, Acc=0.7744, AUC=0.7315, TPR=0.4973, TNR=0.8221, J=0.3195, MCC=0.2710, ConfusionMatrix=
[[1775  384]
 [ 187  185]]
Epoch 21 complete in 28.31

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.5376, Acc=0.7308, AUC=0.8051, TPR=0.7437, TNR=0.7176, J=0.4612, MCC=0.4614, ConfusionMatrix=
[[2579 1015]
 [ 950 2756]]
Epoch 22, Phase val, Loss=0.5365, Acc=0.7233, AUC=0.7291, TPR=0.5206, TNR=0.7594, J=0.2800, MCC=0.2229, ConfusionMatrix=
[[1651  523]
 [ 186  202]]
Epoch 22, Phase test, Loss=0.5567, Acc=0.7151, AUC=0.7254, TPR=0.5753, TNR=0.7392, J=0.3145, MCC=0.2414, ConfusionMatrix=
[[1596  563]
 [ 158  214]]
Epoch 22 complete in 28.08

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.5324, Acc=0.7332, AUC=0.8111, TPR=0.7415, TNR=0.7248, J=0.4663, MCC=0.4663, ConfusionMatrix=
[[2641 1003]
 [ 945 2711]]
Epoch 23, Phase val, Loss=0.5913, Acc=0.6885, AUC=0.7349, TPR=0.6289, TNR=0.6992, J=0.3280, MCC=0.2465, ConfusionMatrix=
[[1520  654]
 [ 144  244]]
Epoch 23, Phase test, Loss=0.6141, Acc=0.6618, AUC=0.7295, TPR=0.6398, TNR=0.6656, J=0.3054, MCC=0.2228, ConfusionMatrix=
[[1437  722]
 [ 134  238]]
Epoch 23 complete in 27.45

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.5264, Acc=0.7381, AUC=0.8156, TPR=0.7369, TNR=0.7393, J=0.4762, MCC=0.4762, ConfusionMatrix=
[[2705  954]
 [ 958 2683]]
Epoch 24, Phase val, Loss=0.5983, Acc=0.6862, AUC=0.7416, TPR=0.6418, TNR=0.6941, J=0.3359, MCC=0.2513, ConfusionMatrix=
[[1509  665]
 [ 139  249]]
Epoch 24, Phase test, Loss=0.6232, Acc=0.6634, AUC=0.7304, TPR=0.6586, TNR=0.6642, J=0.3228, MCC=0.2351, ConfusionMatrix=
[[1434  725]
 [ 127  245]]
Epoch 24 complete in 26.84

Epoch 25 starting with learning_rate: [0.005]
Epoch 25, Phase train, Loss=0.5397, Acc=0.7288, AUC=0.8032, TPR=0.7297, TNR=0.7279, J=0.4576, MCC=0.4575, ConfusionMatrix=
[[2696 1008]
 [ 972 2624]]
Epoch 25, Phase val, Loss=0.6261, Acc=0.6647, AUC=0.7444, TPR=0.6907, TNR=0.6601, J=0.3508, MCC=0.2575, ConfusionMatrix=
[[1435  739]
 [ 120  268]]
Epoch 25, Phase test, Loss=0.6522, Acc=0.6326, AUC=0.7313, TPR=0.7043, TNR=0.6202, J=0.3245, MCC=0.2323, ConfusionMatrix=
[[1339  820]
 [ 110  262]]
Epoch 25 complete in 29.98

Epoch 26 starting with learning_rate: [0.005]
Epoch 26, Phase train, Loss=0.5279, Acc=0.7379, AUC=0.8142, TPR=0.7432, TNR=0.7327, J=0.4759, MCC=0.4759, ConfusionMatrix=
[[2684  979]
 [ 934 2703]]
Epoch 26, Phase val, Loss=0.5154, Acc=0.7408, AUC=0.7422, TPR=0.5361, TNR=0.7774, J=0.3135, MCC=0.2531, ConfusionMatrix=
[[1690  484]
 [ 180  208]]
Epoch 26, Phase test, Loss=0.5302, Acc=0.7424, AUC=0.7313, TPR=0.5591, TNR=0.7740, J=0.3331, MCC=0.2642, ConfusionMatrix=
[[1671  488]
 [ 164  208]]
Epoch 26 complete in 27.05

Epoch 27 starting with learning_rate: [0.005]
Epoch 27, Phase train, Loss=0.5421, Acc=0.7252, AUC=0.8016, TPR=0.7289, TNR=0.7215, J=0.4505, MCC=0.4505, ConfusionMatrix=
[[2656 1025]
 [ 981 2638]]
Epoch 27, Phase val, Loss=0.5441, Acc=0.7178, AUC=0.7428, TPR=0.5644, TNR=0.7452, J=0.3096, MCC=0.2418, ConfusionMatrix=
[[1620  554]
 [ 169  219]]
Epoch 27, Phase test, Loss=0.5641, Acc=0.7029, AUC=0.7311, TPR=0.5914, TNR=0.7221, J=0.3135, MCC=0.2372, ConfusionMatrix=
[[1559  600]
 [ 152  220]]
Epoch 27 complete in 26.76

Early Stop!
Training complete in 12m 49s
The best model val AUC=0.746970997449, test AUC=0.733366702028.
Finish training resnet18fixed-conv1x1ab-avgpool

Start training resnet18fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6523, Acc=0.6151, AUC=0.6735, TPR=0.6135, TNR=0.6166, J=0.2301, MCC=0.2301, ConfusionMatrix=
[[2253 1401]
 [1409 2237]]
Epoch 0, Phase val, Loss=0.5740, Acc=0.6760, AUC=0.6963, TPR=0.5670, TNR=0.6955, J=0.2625, MCC=0.1981, ConfusionMatrix=
[[1512  662]
 [ 168  220]]
New Best AUC=0.6963. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5834, Acc=0.6578, AUC=0.6758, TPR=0.5672, TNR=0.6735, J=0.2407, MCC=0.1773, ConfusionMatrix=
[[1454  705]
 [ 161  211]]
Epoch 0 complete in 31.32

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5996, Acc=0.6875, AUC=0.7464, TPR=0.7249, TNR=0.6505, J=0.3754, MCC=0.3764, ConfusionMatrix=
[[2384 1281]
 [1000 2635]]
Epoch 1, Phase val, Loss=0.6199, Acc=0.6390, AUC=0.7323, TPR=0.7397, TNR=0.6210, J=0.3607, MCC=0.2609, ConfusionMatrix=
[[1350  824]
 [ 101  287]]
New Best AUC=0.7323. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6435, Acc=0.6029, AUC=0.7157, TPR=0.7070, TNR=0.5850, J=0.2920, MCC=0.2075, ConfusionMatrix=
[[1263  896]
 [ 109  263]]
Epoch 1 complete in 28.94

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5735, Acc=0.7051, AUC=0.7741, TPR=0.7490, TNR=0.6599, J=0.4089, MCC=0.4107, ConfusionMatrix=
[[2375 1224]
 [ 929 2772]]
Epoch 2, Phase val, Loss=0.6229, Acc=0.6475, AUC=0.7385, TPR=0.7088, TNR=0.6366, J=0.3454, MCC=0.2512, ConfusionMatrix=
[[1384  790]
 [ 113  275]]
New Best AUC=0.7385. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6509, Acc=0.6140, AUC=0.7219, TPR=0.7070, TNR=0.5980, J=0.3050, MCC=0.2172, ConfusionMatrix=
[[1291  868]
 [ 109  263]]
Epoch 2 complete in 29.09

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5611, Acc=0.7189, AUC=0.7858, TPR=0.7403, TNR=0.6971, J=0.4374, MCC=0.4379, ConfusionMatrix=
[[2520 1095]
 [ 957 2728]]
Epoch 3, Phase val, Loss=0.4925, Acc=0.7490, AUC=0.7444, TPR=0.4845, TNR=0.7962, J=0.2808, MCC=0.2336, ConfusionMatrix=
[[1731  443]
 [ 200  188]]
New Best AUC=0.7444. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5089, Acc=0.7558, AUC=0.7295, TPR=0.5215, TNR=0.7962, J=0.3177, MCC=0.2596, ConfusionMatrix=
[[1719  440]
 [ 178  194]]
Epoch 3 complete in 29.89

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5669, Acc=0.7116, AUC=0.7788, TPR=0.7227, TNR=0.7003, J=0.4230, MCC=0.4231, ConfusionMatrix=
[[2521 1079]
 [1026 2674]]
Epoch 4, Phase val, Loss=0.6231, Acc=0.6534, AUC=0.7450, TPR=0.7165, TNR=0.6421, J=0.3586, MCC=0.2612, ConfusionMatrix=
[[1396  778]
 [ 110  278]]
New Best AUC=0.7450. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.6457, Acc=0.6231, AUC=0.7337, TPR=0.7124, TNR=0.6077, J=0.3201, MCC=0.2283, ConfusionMatrix=
[[1312  847]
 [ 107  265]]
Epoch 4 complete in 27.37

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5557, Acc=0.7204, AUC=0.7902, TPR=0.7333, TNR=0.7075, J=0.4407, MCC=0.4409, ConfusionMatrix=
[[2573 1064]
 [ 977 2686]]
Epoch 5, Phase val, Loss=0.5492, Acc=0.7061, AUC=0.7314, TPR=0.5722, TNR=0.7300, J=0.3022, MCC=0.2330, ConfusionMatrix=
[[1587  587]
 [ 166  222]]
Epoch 5, Phase test, Loss=0.5720, Acc=0.6895, AUC=0.7252, TPR=0.5887, TNR=0.7068, J=0.2955, MCC=0.2214, ConfusionMatrix=
[[1526  633]
 [ 153  219]]
Epoch 5 complete in 27.95

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5429, Acc=0.7263, AUC=0.8031, TPR=0.7485, TNR=0.7033, J=0.4519, MCC=0.4524, ConfusionMatrix=
[[2525 1065]
 [ 933 2777]]
Epoch 6, Phase val, Loss=0.5322, Acc=0.7248, AUC=0.7441, TPR=0.5722, TNR=0.7521, J=0.3242, MCC=0.2544, ConfusionMatrix=
[[1635  539]
 [ 166  222]]
Epoch 6, Phase test, Loss=0.5543, Acc=0.7116, AUC=0.7341, TPR=0.5860, TNR=0.7332, J=0.3192, MCC=0.2436, ConfusionMatrix=
[[1583  576]
 [ 154  218]]
Epoch 6 complete in 26.82

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5539, Acc=0.7155, AUC=0.7885, TPR=0.7026, TNR=0.7276, J=0.4302, MCC=0.4304, ConfusionMatrix=
[[2733 1023]
 [1054 2490]]
Epoch 7, Phase val, Loss=0.5203, Acc=0.7350, AUC=0.7371, TPR=0.5155, TNR=0.7741, J=0.2896, MCC=0.2339, ConfusionMatrix=
[[1683  491]
 [ 188  200]]
Epoch 7, Phase test, Loss=0.5391, Acc=0.7270, AUC=0.7307, TPR=0.5484, TNR=0.7578, J=0.3061, MCC=0.2396, ConfusionMatrix=
[[1636  523]
 [ 168  204]]
Epoch 7 complete in 28.26

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5553, Acc=0.7218, AUC=0.7913, TPR=0.7151, TNR=0.7282, J=0.4433, MCC=0.4434, ConfusionMatrix=
[[2701 1008]
 [1023 2568]]
Epoch 8, Phase val, Loss=0.4783, Acc=0.7658, AUC=0.7400, TPR=0.4485, TNR=0.8224, J=0.2709, MCC=0.2350, ConfusionMatrix=
[[1788  386]
 [ 214  174]]
Epoch 8, Phase test, Loss=0.4958, Acc=0.7685, AUC=0.7270, TPR=0.4892, TNR=0.8166, J=0.3058, MCC=0.2580, ConfusionMatrix=
[[1763  396]
 [ 190  182]]
Epoch 8 complete in 28.05

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5458, Acc=0.7252, AUC=0.8002, TPR=0.7345, TNR=0.7158, J=0.4503, MCC=0.4504, ConfusionMatrix=
[[2594 1030]
 [ 976 2700]]
Epoch 9, Phase val, Loss=0.4699, Acc=0.7732, AUC=0.7445, TPR=0.4562, TNR=0.8298, J=0.2860, MCC=0.2502, ConfusionMatrix=
[[1804  370]
 [ 211  177]]
Epoch 9, Phase test, Loss=0.4827, Acc=0.7823, AUC=0.7314, TPR=0.4919, TNR=0.8323, J=0.3243, MCC=0.2793, ConfusionMatrix=
[[1797  362]
 [ 189  183]]
Epoch 9 complete in 29.13

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5448, Acc=0.7315, AUC=0.8002, TPR=0.7296, TNR=0.7333, J=0.4630, MCC=0.4630, ConfusionMatrix=
[[2706  984]
 [ 976 2634]]
Epoch 10, Phase val, Loss=0.5071, Acc=0.7498, AUC=0.7398, TPR=0.5000, TNR=0.7944, J=0.2944, MCC=0.2437, ConfusionMatrix=
[[1727  447]
 [ 194  194]]
Epoch 10, Phase test, Loss=0.5241, Acc=0.7380, AUC=0.7263, TPR=0.5323, TNR=0.7735, J=0.3058, MCC=0.2435, ConfusionMatrix=
[[1670  489]
 [ 174  198]]
Epoch 10 complete in 26.81

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5495, Acc=0.7207, AUC=0.7947, TPR=0.7203, TNR=0.7211, J=0.4414, MCC=0.4414, ConfusionMatrix=
[[2655 1027]
 [1012 2606]]
Epoch 11, Phase val, Loss=0.6735, Acc=0.6265, AUC=0.7401, TPR=0.7320, TNR=0.6076, J=0.3396, MCC=0.2450, ConfusionMatrix=
[[1321  853]
 [ 104  284]]
Epoch 11, Phase test, Loss=0.7043, Acc=0.5903, AUC=0.7298, TPR=0.7473, TNR=0.5632, J=0.3105, MCC=0.2200, ConfusionMatrix=
[[1216  943]
 [  94  278]]
Epoch 11 complete in 30.14

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5445, Acc=0.7275, AUC=0.7989, TPR=0.7300, TNR=0.7251, J=0.4551, MCC=0.4551, ConfusionMatrix=
[[2651 1005]
 [ 984 2660]]
Epoch 12, Phase val, Loss=0.5000, Acc=0.7549, AUC=0.7350, TPR=0.4742, TNR=0.8050, J=0.2792, MCC=0.2353, ConfusionMatrix=
[[1750  424]
 [ 204  184]]
Epoch 12, Phase test, Loss=0.5151, Acc=0.7499, AUC=0.7228, TPR=0.5108, TNR=0.7911, J=0.3019, MCC=0.2458, ConfusionMatrix=
[[1708  451]
 [ 182  190]]
Epoch 12 complete in 29.22

Early Stop!
Training complete in 6m 13s
The best model val AUC=0.745043342596, test AUC=0.733697898768.
Finish training resnet18fixed-conv1x1ab-avgpool

Start training resnet18fixed-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6514, Acc=0.6355, AUC=0.6839, TPR=0.7270, TNR=0.5436, J=0.2707, MCC=0.2753, ConfusionMatrix=
[[1981 1663]
 [ 998 2658]]
Epoch 0, Phase val, Loss=0.6639, Acc=0.5621, AUC=0.7150, TPR=0.8170, TNR=0.5166, J=0.3336, MCC=0.2397, ConfusionMatrix=
[[1123 1051]
 [  71  317]]
New Best AUC=0.7150. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6733, Acc=0.5492, AUC=0.6855, TPR=0.7634, TNR=0.5123, J=0.2757, MCC=0.1956, ConfusionMatrix=
[[1106 1053]
 [  88  284]]
Epoch 0 complete in 28.28

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5915, Acc=0.6929, AUC=0.7586, TPR=0.7588, TNR=0.6256, J=0.3844, MCC=0.3881, ConfusionMatrix=
[[2261 1353]
 [ 889 2797]]
Epoch 1, Phase val, Loss=0.5034, Acc=0.7475, AUC=0.7301, TPR=0.4459, TNR=0.8013, J=0.2472, MCC=0.2086, ConfusionMatrix=
[[1742  432]
 [ 215  173]]
New Best AUC=0.7301. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5165, Acc=0.7424, AUC=0.7174, TPR=0.5161, TNR=0.7814, J=0.2975, MCC=0.2395, ConfusionMatrix=
[[1687  472]
 [ 180  192]]
Epoch 1 complete in 31.85

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5675, Acc=0.7115, AUC=0.7807, TPR=0.7343, TNR=0.6884, J=0.4227, MCC=0.4232, ConfusionMatrix=
[[2497 1130]
 [ 976 2697]]
Epoch 2, Phase val, Loss=0.5950, Acc=0.6671, AUC=0.7327, TPR=0.6469, TNR=0.6707, J=0.3176, MCC=0.2348, ConfusionMatrix=
[[1458  716]
 [ 137  251]]
New Best AUC=0.7327. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6174, Acc=0.6531, AUC=0.7271, TPR=0.6774, TNR=0.6489, J=0.3263, MCC=0.2360, ConfusionMatrix=
[[1401  758]
 [ 120  252]]
Epoch 2 complete in 30.89

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5594, Acc=0.7186, AUC=0.7883, TPR=0.7508, TNR=0.6852, J=0.4360, MCC=0.4371, ConfusionMatrix=
[[2453 1127]
 [ 927 2793]]
Epoch 3, Phase val, Loss=0.4584, Acc=0.7881, AUC=0.7347, TPR=0.3892, TNR=0.8592, J=0.2484, MCC=0.2326, ConfusionMatrix=
[[1868  306]
 [ 237  151]]
New Best AUC=0.7347. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.4638, Acc=0.7949, AUC=0.7321, TPR=0.4677, TNR=0.8513, J=0.3191, MCC=0.2848, ConfusionMatrix=
[[1838  321]
 [ 198  174]]
Epoch 3 complete in 31.09

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5650, Acc=0.7166, AUC=0.7824, TPR=0.7399, TNR=0.6928, J=0.4327, MCC=0.4332, ConfusionMatrix=
[[2503 1110]
 [ 959 2728]]
Epoch 4, Phase val, Loss=0.4814, Acc=0.7685, AUC=0.7371, TPR=0.4356, TNR=0.8280, J=0.2635, MCC=0.2312, ConfusionMatrix=
[[1800  374]
 [ 219  169]]
New Best AUC=0.7371. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4924, Acc=0.7736, AUC=0.7305, TPR=0.4973, TNR=0.8212, J=0.3185, MCC=0.2698, ConfusionMatrix=
[[1773  386]
 [ 187  185]]
Epoch 4 complete in 28.80

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5521, Acc=0.7204, AUC=0.7937, TPR=0.7264, TNR=0.7144, J=0.4408, MCC=0.4409, ConfusionMatrix=
[[2609 1043]
 [ 998 2650]]
Epoch 5, Phase val, Loss=0.7993, Acc=0.5422, AUC=0.7463, TPR=0.8557, TNR=0.4862, J=0.3419, MCC=0.2472, ConfusionMatrix=
[[1057 1117]
 [  56  332]]
New Best AUC=0.7463. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.8464, Acc=0.4955, AUC=0.7329, TPR=0.8360, TNR=0.4368, J=0.2728, MCC=0.1974, ConfusionMatrix=
[[ 943 1216]
 [  61  311]]
Epoch 5 complete in 28.13

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5622, Acc=0.7140, AUC=0.7839, TPR=0.7216, TNR=0.7064, J=0.4280, MCC=0.4280, ConfusionMatrix=
[[2586 1075]
 [1013 2626]]
Epoch 6, Phase val, Loss=0.4391, Acc=0.8107, AUC=0.7278, TPR=0.3247, TNR=0.8974, J=0.2222, MCC=0.2322, ConfusionMatrix=
[[1951  223]
 [ 262  126]]
Epoch 6, Phase test, Loss=0.4462, Acc=0.8143, AUC=0.7255, TPR=0.4059, TNR=0.8847, J=0.2906, MCC=0.2821, ConfusionMatrix=
[[1910  249]
 [ 221  151]]
Epoch 6 complete in 28.90

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5492, Acc=0.7237, AUC=0.7955, TPR=0.7216, TNR=0.7258, J=0.4474, MCC=0.4474, ConfusionMatrix=
[[2668 1008]
 [1009 2615]]
Epoch 7, Phase val, Loss=0.6548, Acc=0.6327, AUC=0.7339, TPR=0.7088, TNR=0.6191, J=0.3279, MCC=0.2374, ConfusionMatrix=
[[1346  828]
 [ 113  275]]
Epoch 7, Phase test, Loss=0.6894, Acc=0.5966, AUC=0.7307, TPR=0.7366, TNR=0.5725, J=0.3090, MCC=0.2192, ConfusionMatrix=
[[1236  923]
 [  98  274]]
Epoch 7 complete in 29.21

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5486, Acc=0.7238, AUC=0.7962, TPR=0.7387, TNR=0.7089, J=0.4476, MCC=0.4478, ConfusionMatrix=
[[2581 1060]
 [ 956 2703]]
Epoch 8, Phase val, Loss=0.5657, Acc=0.6959, AUC=0.7373, TPR=0.5928, TNR=0.7144, J=0.3071, MCC=0.2338, ConfusionMatrix=
[[1553  621]
 [ 158  230]]
Epoch 8, Phase test, Loss=0.5843, Acc=0.6902, AUC=0.7339, TPR=0.6452, TNR=0.6980, J=0.3432, MCC=0.2544, ConfusionMatrix=
[[1507  652]
 [ 132  240]]
Epoch 8 complete in 26.83

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5419, Acc=0.7332, AUC=0.8036, TPR=0.7343, TNR=0.7321, J=0.4663, MCC=0.4663, ConfusionMatrix=
[[2713  993]
 [ 955 2639]]
Epoch 9, Phase val, Loss=0.6178, Acc=0.6557, AUC=0.7363, TPR=0.6624, TNR=0.6546, J=0.3169, MCC=0.2326, ConfusionMatrix=
[[1423  751]
 [ 131  257]]
Epoch 9, Phase test, Loss=0.6443, Acc=0.6401, AUC=0.7313, TPR=0.6962, TNR=0.6304, J=0.3266, MCC=0.2345, ConfusionMatrix=
[[1361  798]
 [ 113  259]]
Epoch 9 complete in 30.33

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5486, Acc=0.7229, AUC=0.7966, TPR=0.7223, TNR=0.7235, J=0.4457, MCC=0.4457, ConfusionMatrix=
[[2671 1021]
 [1002 2606]]
Epoch 10, Phase val, Loss=0.5725, Acc=0.6971, AUC=0.7462, TPR=0.6289, TNR=0.7093, J=0.3382, MCC=0.2556, ConfusionMatrix=
[[1542  632]
 [ 144  244]]
Epoch 10, Phase test, Loss=0.5952, Acc=0.6788, AUC=0.7354, TPR=0.6586, TNR=0.6823, J=0.3409, MCC=0.2503, ConfusionMatrix=
[[1473  686]
 [ 127  245]]
Epoch 10 complete in 27.71

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5495, Acc=0.7142, AUC=0.7934, TPR=0.7245, TNR=0.7040, J=0.4285, MCC=0.4286, ConfusionMatrix=
[[2574 1082]
 [1004 2640]]
Epoch 11, Phase val, Loss=0.4812, Acc=0.7654, AUC=0.7289, TPR=0.4278, TNR=0.8257, J=0.2535, MCC=0.2221, ConfusionMatrix=
[[1795  379]
 [ 222  166]]
Epoch 11, Phase test, Loss=0.4958, Acc=0.7693, AUC=0.7242, TPR=0.5108, TNR=0.8138, J=0.3246, MCC=0.2715, ConfusionMatrix=
[[1757  402]
 [ 182  190]]
Epoch 11 complete in 28.43

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5466, Acc=0.7234, AUC=0.7972, TPR=0.7237, TNR=0.7231, J=0.4469, MCC=0.4468, ConfusionMatrix=
[[2648 1014]
 [1005 2633]]
Epoch 12, Phase val, Loss=0.5483, Acc=0.7116, AUC=0.7362, TPR=0.5593, TNR=0.7387, J=0.2980, MCC=0.2317, ConfusionMatrix=
[[1606  568]
 [ 171  217]]
Epoch 12, Phase test, Loss=0.5708, Acc=0.7060, AUC=0.7292, TPR=0.5914, TNR=0.7258, J=0.3172, MCC=0.2406, ConfusionMatrix=
[[1567  592]
 [ 152  220]]
Epoch 12 complete in 30.35

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5471, Acc=0.7248, AUC=0.7972, TPR=0.7265, TNR=0.7231, J=0.4496, MCC=0.4496, ConfusionMatrix=
[[2669 1022]
 [ 987 2622]]
Epoch 13, Phase val, Loss=0.6129, Acc=0.6635, AUC=0.7374, TPR=0.6624, TNR=0.6638, J=0.3261, MCC=0.2402, ConfusionMatrix=
[[1443  731]
 [ 131  257]]
Epoch 13, Phase test, Loss=0.6407, Acc=0.6357, AUC=0.7275, TPR=0.6909, TNR=0.6262, J=0.3171, MCC=0.2274, ConfusionMatrix=
[[1352  807]
 [ 115  257]]
Epoch 13 complete in 29.14

Early Stop!
Training complete in 6m 50s
The best model val AUC=0.746346228625, test AUC=0.732867416715.
Finish training resnet18fixed-conv1x1ab-avgpool

Start training resnet18fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6555, Acc=0.6112, AUC=0.6535, TPR=0.6373, TNR=0.5856, J=0.2229, MCC=0.2232, ConfusionMatrix=
[[2155 1525]
 [1313 2307]]
Epoch 0, Phase val, Loss=0.5785, Acc=0.7260, AUC=0.7057, TPR=0.4742, TNR=0.7709, J=0.2452, MCC=0.1988, ConfusionMatrix=
[[1676  498]
 [ 204  184]]
New Best AUC=0.7057. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5818, Acc=0.7203, AUC=0.7092, TPR=0.5376, TNR=0.7517, J=0.2894, MCC=0.2256, ConfusionMatrix=
[[1623  536]
 [ 172  200]]
Epoch 0 complete in 28.79

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5839, Acc=0.6990, AUC=0.7644, TPR=0.6484, TNR=0.7490, J=0.3974, MCC=0.3995, ConfusionMatrix=
[[2752  922]
 [1275 2351]]
Epoch 1, Phase val, Loss=0.5171, Acc=0.7912, AUC=0.7302, TPR=0.4536, TNR=0.8514, J=0.3050, MCC=0.2761, ConfusionMatrix=
[[1851  323]
 [ 212  176]]
New Best AUC=0.7302. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5216, Acc=0.7847, AUC=0.7139, TPR=0.4489, TNR=0.8425, J=0.2914, MCC=0.2578, ConfusionMatrix=
[[1819  340]
 [ 205  167]]
Epoch 1 complete in 29.68

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5680, Acc=0.7122, AUC=0.7818, TPR=0.6501, TNR=0.7735, J=0.4236, MCC=0.4270, ConfusionMatrix=
[[2841  832]
 [1269 2358]]
Epoch 2, Phase val, Loss=0.4974, Acc=0.7963, AUC=0.7429, TPR=0.4072, TNR=0.8657, J=0.2729, MCC=0.2571, ConfusionMatrix=
[[1882  292]
 [ 230  158]]
New Best AUC=0.7429. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5051, Acc=0.8005, AUC=0.7271, TPR=0.4597, TNR=0.8592, J=0.3189, MCC=0.2892, ConfusionMatrix=
[[1855  304]
 [ 201  171]]
Epoch 2 complete in 27.09

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5762, Acc=0.7056, AUC=0.7741, TPR=0.6409, TNR=0.7706, J=0.4114, MCC=0.4149, ConfusionMatrix=
[[2808  836]
 [1313 2343]]
Epoch 3, Phase val, Loss=0.5740, Acc=0.7600, AUC=0.7518, TPR=0.5387, TNR=0.7994, J=0.3381, MCC=0.2793, ConfusionMatrix=
[[1738  436]
 [ 179  209]]
New Best AUC=0.7518. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5754, Acc=0.7515, AUC=0.7123, TPR=0.5108, TNR=0.7930, J=0.3037, MCC=0.2478, ConfusionMatrix=
[[1712  447]
 [ 182  190]]
Epoch 3 complete in 28.62

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5772, Acc=0.7082, AUC=0.7715, TPR=0.6337, TNR=0.7826, J=0.4163, MCC=0.4210, ConfusionMatrix=
[[2859  794]
 [1336 2311]]
Epoch 4, Phase val, Loss=0.6442, Acc=0.7139, AUC=0.7493, TPR=0.6314, TNR=0.7286, J=0.3601, MCC=0.2754, ConfusionMatrix=
[[1584  590]
 [ 143  245]]
Epoch 4, Phase test, Loss=0.6463, Acc=0.7025, AUC=0.7290, TPR=0.6183, TNR=0.7170, J=0.3353, MCC=0.2520, ConfusionMatrix=
[[1548  611]
 [ 142  230]]
Epoch 4 complete in 28.77

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5591, Acc=0.7186, AUC=0.7881, TPR=0.6622, TNR=0.7745, J=0.4367, MCC=0.4396, ConfusionMatrix=
[[2841  827]
 [1227 2405]]
Epoch 5, Phase val, Loss=0.7484, Acc=0.6589, AUC=0.7644, TPR=0.7320, TNR=0.6458, J=0.3778, MCC=0.2752, ConfusionMatrix=
[[1404  770]
 [ 104  284]]
New Best AUC=0.7644. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.7607, Acc=0.6243, AUC=0.7263, TPR=0.7016, TNR=0.6109, J=0.3125, MCC=0.2232, ConfusionMatrix=
[[1319  840]
 [ 111  261]]
Epoch 5 complete in 29.18

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5689, Acc=0.7073, AUC=0.7776, TPR=0.6536, TNR=0.7618, J=0.4154, MCC=0.4177, ConfusionMatrix=
[[2757  862]
 [1275 2406]]
Epoch 6, Phase val, Loss=0.4660, Acc=0.8224, AUC=0.7239, TPR=0.2887, TNR=0.9177, J=0.2063, MCC=0.2331, ConfusionMatrix=
[[1995  179]
 [ 276  112]]
Epoch 6, Phase test, Loss=0.4669, Acc=0.8289, AUC=0.7006, TPR=0.3360, TNR=0.9138, J=0.2499, MCC=0.2695, ConfusionMatrix=
[[1973  186]
 [ 247  125]]
Epoch 6 complete in 28.25

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5871, Acc=0.7022, AUC=0.7630, TPR=0.6436, TNR=0.7611, J=0.4048, MCC=0.4075, ConfusionMatrix=
[[2769  869]
 [1305 2357]]
Epoch 7, Phase val, Loss=0.5609, Acc=0.7666, AUC=0.7537, TPR=0.5851, TNR=0.7990, J=0.3840, MCC=0.3142, ConfusionMatrix=
[[1737  437]
 [ 161  227]]
Epoch 7, Phase test, Loss=0.5738, Acc=0.7456, AUC=0.7170, TPR=0.5430, TNR=0.7805, J=0.3235, MCC=0.2589, ConfusionMatrix=
[[1685  474]
 [ 170  202]]
Epoch 7 complete in 28.38

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5534, Acc=0.7190, AUC=0.7903, TPR=0.6660, TNR=0.7726, J=0.4386, MCC=0.4410, ConfusionMatrix=
[[2806  826]
 [1225 2443]]
Epoch 8, Phase val, Loss=0.4740, Acc=0.8275, AUC=0.7415, TPR=0.4098, TNR=0.9020, J=0.3118, MCC=0.3173, ConfusionMatrix=
[[1961  213]
 [ 229  159]]
Epoch 8, Phase test, Loss=0.4831, Acc=0.8269, AUC=0.7096, TPR=0.3575, TNR=0.9078, J=0.2654, MCC=0.2783, ConfusionMatrix=
[[1960  199]
 [ 239  133]]
Epoch 8 complete in 25.52

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5721, Acc=0.7166, AUC=0.7831, TPR=0.6696, TNR=0.7645, J=0.4342, MCC=0.4359, ConfusionMatrix=
[[2760  850]
 [1219 2471]]
Epoch 9, Phase val, Loss=0.6201, Acc=0.7311, AUC=0.7577, TPR=0.6572, TNR=0.7443, J=0.4015, MCC=0.3094, ConfusionMatrix=
[[1618  556]
 [ 133  255]]
Epoch 9, Phase test, Loss=0.6313, Acc=0.7037, AUC=0.7333, TPR=0.6344, TNR=0.7156, J=0.3500, MCC=0.2624, ConfusionMatrix=
[[1545  614]
 [ 136  236]]
Epoch 9 complete in 29.23

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5641, Acc=0.7159, AUC=0.7872, TPR=0.6610, TNR=0.7706, J=0.4316, MCC=0.4342, ConfusionMatrix=
[[2818  839]
 [1235 2408]]
Epoch 10, Phase val, Loss=0.6066, Acc=0.7416, AUC=0.7403, TPR=0.5593, TNR=0.7741, J=0.3334, MCC=0.2673, ConfusionMatrix=
[[1683  491]
 [ 171  217]]
Epoch 10, Phase test, Loss=0.5954, Acc=0.7341, AUC=0.7297, TPR=0.5780, TNR=0.7610, J=0.3390, MCC=0.2648, ConfusionMatrix=
[[1643  516]
 [ 157  215]]
Epoch 10 complete in 30.45

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5712, Acc=0.7125, AUC=0.7799, TPR=0.6668, TNR=0.7590, J=0.4257, MCC=0.4274, ConfusionMatrix=
[[2746  872]
 [1227 2455]]
Epoch 11, Phase val, Loss=0.5115, Acc=0.7935, AUC=0.7428, TPR=0.4046, TNR=0.8629, J=0.2676, MCC=0.2510, ConfusionMatrix=
[[1876  298]
 [ 231  157]]
Epoch 11, Phase test, Loss=0.5063, Acc=0.7949, AUC=0.7281, TPR=0.4489, TNR=0.8546, J=0.3035, MCC=0.2739, ConfusionMatrix=
[[1845  314]
 [ 205  167]]
Epoch 11 complete in 30.44

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5641, Acc=0.7159, AUC=0.7830, TPR=0.6387, TNR=0.7905, J=0.4292, MCC=0.4346, ConfusionMatrix=
[[2935  778]
 [1296 2291]]
Epoch 12, Phase val, Loss=0.5515, Acc=0.7830, AUC=0.7446, TPR=0.4794, TNR=0.8372, J=0.3165, MCC=0.2782, ConfusionMatrix=
[[1820  354]
 [ 202  186]]
Epoch 12, Phase test, Loss=0.5503, Acc=0.7835, AUC=0.7316, TPR=0.5403, TNR=0.8254, J=0.3657, MCC=0.3085, ConfusionMatrix=
[[1782  377]
 [ 171  201]]
Epoch 12 complete in 29.90

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5580, Acc=0.7226, AUC=0.7899, TPR=0.6538, TNR=0.7891, J=0.4429, MCC=0.4474, ConfusionMatrix=
[[2929  783]
 [1242 2346]]
Epoch 13, Phase val, Loss=0.6024, Acc=0.7440, AUC=0.7563, TPR=0.6005, TNR=0.7695, J=0.3701, MCC=0.2934, ConfusionMatrix=
[[1673  501]
 [ 155  233]]
Epoch 13, Phase test, Loss=0.5963, Acc=0.7369, AUC=0.7438, TPR=0.6156, TNR=0.7578, J=0.3733, MCC=0.2893, ConfusionMatrix=
[[1636  523]
 [ 143  229]]
Epoch 13 complete in 28.07

Early Stop!
Training complete in 6m 42s
The best model val AUC=0.7644396286, test AUC=0.726257178005.
Finish training resnet18fixed-conv1x1-maxpool

Start training resnet18fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6569, Acc=0.6056, AUC=0.6549, TPR=0.5900, TNR=0.6214, J=0.2114, MCC=0.2115, ConfusionMatrix=
[[2257 1375]
 [1504 2164]]
Epoch 0, Phase val, Loss=0.6131, Acc=0.7143, AUC=0.7248, TPR=0.6082, TNR=0.7332, J=0.3415, MCC=0.2627, ConfusionMatrix=
[[1594  580]
 [ 152  236]]
New Best AUC=0.7248. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6131, Acc=0.6760, AUC=0.7049, TPR=0.6129, TNR=0.6869, J=0.2998, MCC=0.2215, ConfusionMatrix=
[[1483  676]
 [ 144  228]]
Epoch 0 complete in 37.88

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5941, Acc=0.6919, AUC=0.7549, TPR=0.6492, TNR=0.7345, J=0.3837, MCC=0.3852, ConfusionMatrix=
[[2684  970]
 [1279 2367]]
Epoch 1, Phase val, Loss=0.6012, Acc=0.7455, AUC=0.7356, TPR=0.5644, TNR=0.7778, J=0.3423, MCC=0.2751, ConfusionMatrix=
[[1691  483]
 [ 169  219]]
New Best AUC=0.7356. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5972, Acc=0.7262, AUC=0.7278, TPR=0.5349, TNR=0.7591, J=0.2941, MCC=0.2309, ConfusionMatrix=
[[1639  520]
 [ 173  199]]
Epoch 1 complete in 30.88

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5697, Acc=0.7075, AUC=0.7769, TPR=0.6596, TNR=0.7569, J=0.4165, MCC=0.4182, ConfusionMatrix=
[[2721  874]
 [1261 2444]]
Epoch 2, Phase val, Loss=0.5356, Acc=0.7779, AUC=0.7131, TPR=0.4433, TNR=0.8376, J=0.2809, MCC=0.2495, ConfusionMatrix=
[[1821  353]
 [ 216  172]]
Epoch 2, Phase test, Loss=0.5245, Acc=0.7906, AUC=0.7221, TPR=0.4839, TNR=0.8434, J=0.3273, MCC=0.2873, ConfusionMatrix=
[[1821  338]
 [ 192  180]]
Epoch 2 complete in 43.43

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5822, Acc=0.6970, AUC=0.7675, TPR=0.6301, TNR=0.7623, J=0.3924, MCC=0.3961, ConfusionMatrix=
[[2816  878]
 [1334 2272]]
Epoch 3, Phase val, Loss=0.6626, Acc=0.7018, AUC=0.7231, TPR=0.5928, TNR=0.7213, J=0.3140, MCC=0.2401, ConfusionMatrix=
[[1568  606]
 [ 158  230]]
Epoch 3, Phase test, Loss=0.6585, Acc=0.6815, AUC=0.7190, TPR=0.6102, TNR=0.6938, J=0.3041, MCC=0.2256, ConfusionMatrix=
[[1498  661]
 [ 145  227]]
Epoch 3 complete in 42.65

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5795, Acc=0.7086, AUC=0.7727, TPR=0.6640, TNR=0.7538, J=0.4178, MCC=0.4194, ConfusionMatrix=
[[2734  893]
 [1234 2439]]
Epoch 4, Phase val, Loss=0.4692, Acc=0.8142, AUC=0.7330, TPR=0.3557, TNR=0.8960, J=0.2517, MCC=0.2585, ConfusionMatrix=
[[1948  226]
 [ 250  138]]
Epoch 4, Phase test, Loss=0.4754, Acc=0.8115, AUC=0.7008, TPR=0.3602, TNR=0.8893, J=0.2495, MCC=0.2492, ConfusionMatrix=
[[1920  239]
 [ 238  134]]
Epoch 4 complete in 34.16

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5751, Acc=0.7048, AUC=0.7738, TPR=0.6437, TNR=0.7665, J=0.4102, MCC=0.4132, ConfusionMatrix=
[[2784  848]
 [1307 2361]]
Epoch 5, Phase val, Loss=0.5568, Acc=0.7627, AUC=0.7198, TPR=0.4562, TNR=0.8174, J=0.2736, MCC=0.2352, ConfusionMatrix=
[[1777  397]
 [ 211  177]]
Epoch 5, Phase test, Loss=0.5470, Acc=0.7728, AUC=0.7213, TPR=0.5242, TNR=0.8157, J=0.3398, MCC=0.2841, ConfusionMatrix=
[[1761  398]
 [ 177  195]]
Epoch 5 complete in 25.22

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5785, Acc=0.7075, AUC=0.7758, TPR=0.6509, TNR=0.7621, J=0.4131, MCC=0.4159, ConfusionMatrix=
[[2832  884]
 [1251 2333]]
Epoch 6, Phase val, Loss=0.5753, Acc=0.7529, AUC=0.7293, TPR=0.5103, TNR=0.7962, J=0.3065, MCC=0.2537, ConfusionMatrix=
[[1731  443]
 [ 190  198]]
Epoch 6, Phase test, Loss=0.5761, Acc=0.7456, AUC=0.7286, TPR=0.5699, TNR=0.7758, J=0.3457, MCC=0.2742, ConfusionMatrix=
[[1675  484]
 [ 160  212]]
Epoch 6 complete in 25.90

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5614, Acc=0.7136, AUC=0.7870, TPR=0.6740, TNR=0.7537, J=0.4277, MCC=0.4290, ConfusionMatrix=
[[2730  892]
 [1199 2479]]
Epoch 7, Phase val, Loss=0.5959, Acc=0.7518, AUC=0.7576, TPR=0.5902, TNR=0.7806, J=0.3708, MCC=0.2975, ConfusionMatrix=
[[1697  477]
 [ 159  229]]
New Best AUC=0.7576. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.6144, Acc=0.7349, AUC=0.7341, TPR=0.5941, TNR=0.7591, J=0.3532, MCC=0.2749, ConfusionMatrix=
[[1639  520]
 [ 151  221]]
Epoch 7 complete in 25.52

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5580, Acc=0.7192, AUC=0.7855, TPR=0.6628, TNR=0.7759, J=0.4388, MCC=0.4415, ConfusionMatrix=
[[2822  815]
 [1235 2428]]
Epoch 8, Phase val, Loss=0.5207, Acc=0.7939, AUC=0.7384, TPR=0.4768, TNR=0.8505, J=0.3273, MCC=0.2939, ConfusionMatrix=
[[1849  325]
 [ 203  185]]
Epoch 8, Phase test, Loss=0.5270, Acc=0.7855, AUC=0.7313, TPR=0.4973, TNR=0.8351, J=0.3324, MCC=0.2871, ConfusionMatrix=
[[1803  356]
 [ 187  185]]
Epoch 8 complete in 24.78

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5664, Acc=0.7105, AUC=0.7838, TPR=0.6534, TNR=0.7685, J=0.4219, MCC=0.4246, ConfusionMatrix=
[[2785  839]
 [1274 2402]]
Epoch 9, Phase val, Loss=0.5724, Acc=0.7771, AUC=0.7514, TPR=0.5335, TNR=0.8206, J=0.3541, MCC=0.3003, ConfusionMatrix=
[[1784  390]
 [ 181  207]]
Epoch 9, Phase test, Loss=0.5637, Acc=0.7641, AUC=0.7331, TPR=0.5323, TNR=0.8041, J=0.3363, MCC=0.2768, ConfusionMatrix=
[[1736  423]
 [ 174  198]]
Epoch 9 complete in 25.36

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5749, Acc=0.7071, AUC=0.7754, TPR=0.6547, TNR=0.7596, J=0.4143, MCC=0.4166, ConfusionMatrix=
[[2771  877]
 [1261 2391]]
Epoch 10, Phase val, Loss=0.5386, Acc=0.7834, AUC=0.7363, TPR=0.4974, TNR=0.8344, J=0.3318, MCC=0.2891, ConfusionMatrix=
[[1814  360]
 [ 195  193]]
Epoch 10, Phase test, Loss=0.5389, Acc=0.7859, AUC=0.7276, TPR=0.5081, TNR=0.8337, J=0.3418, MCC=0.2938, ConfusionMatrix=
[[1800  359]
 [ 183  189]]
Epoch 10 complete in 24.90

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5773, Acc=0.6992, AUC=0.7714, TPR=0.6219, TNR=0.7762, J=0.3981, MCC=0.4030, ConfusionMatrix=
[[2837  818]
 [1378 2267]]
Epoch 11, Phase val, Loss=0.8674, Acc=0.6050, AUC=0.7544, TPR=0.7809, TNR=0.5736, J=0.3545, MCC=0.2544, ConfusionMatrix=
[[1247  927]
 [  85  303]]
Epoch 11, Phase test, Loss=0.8895, Acc=0.5816, AUC=0.7294, TPR=0.7554, TNR=0.5516, J=0.3070, MCC=0.2174, ConfusionMatrix=
[[1191  968]
 [  91  281]]
Epoch 11 complete in 25.67

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5748, Acc=0.7107, AUC=0.7778, TPR=0.6624, TNR=0.7591, J=0.4215, MCC=0.4235, ConfusionMatrix=
[[2767  878]
 [1234 2421]]
Epoch 12, Phase val, Loss=0.5687, Acc=0.7584, AUC=0.7301, TPR=0.5412, TNR=0.7971, J=0.3384, MCC=0.2786, ConfusionMatrix=
[[1733  441]
 [ 178  210]]
Epoch 12, Phase test, Loss=0.5734, Acc=0.7570, AUC=0.7222, TPR=0.5565, TNR=0.7916, J=0.3480, MCC=0.2811, ConfusionMatrix=
[[1709  450]
 [ 165  207]]
Epoch 12 complete in 24.74

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5625, Acc=0.7174, AUC=0.7850, TPR=0.6767, TNR=0.7595, J=0.4362, MCC=0.4374, ConfusionMatrix=
[[2725  863]
 [1200 2512]]
Epoch 13, Phase val, Loss=0.5988, Acc=0.7369, AUC=0.7322, TPR=0.5747, TNR=0.7659, J=0.3406, MCC=0.2703, ConfusionMatrix=
[[1665  509]
 [ 165  223]]
Epoch 13, Phase test, Loss=0.6049, Acc=0.7301, AUC=0.7227, TPR=0.5618, TNR=0.7591, J=0.3210, MCC=0.2510, ConfusionMatrix=
[[1639  520]
 [ 163  209]]
Epoch 13 complete in 24.81

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5623, Acc=0.7162, AUC=0.7876, TPR=0.6845, TNR=0.7492, J=0.4337, MCC=0.4343, ConfusionMatrix=
[[2676  896]
 [1176 2552]]
Epoch 14, Phase val, Loss=0.6513, Acc=0.7155, AUC=0.7385, TPR=0.6211, TNR=0.7323, J=0.3534, MCC=0.2713, ConfusionMatrix=
[[1592  582]
 [ 147  241]]
Epoch 14, Phase test, Loss=0.6614, Acc=0.6966, AUC=0.7219, TPR=0.5806, TNR=0.7165, J=0.2972, MCC=0.2243, ConfusionMatrix=
[[1547  612]
 [ 156  216]]
Epoch 14 complete in 25.82

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5868, Acc=0.6988, AUC=0.7642, TPR=0.6397, TNR=0.7587, J=0.3984, MCC=0.4011, ConfusionMatrix=
[[2748  874]
 [1325 2353]]
Epoch 15, Phase val, Loss=0.4696, Acc=0.8232, AUC=0.7096, TPR=0.3170, TNR=0.9135, J=0.2305, MCC=0.2531, ConfusionMatrix=
[[1986  188]
 [ 265  123]]
Epoch 15, Phase test, Loss=0.4727, Acc=0.8262, AUC=0.6965, TPR=0.3468, TNR=0.9088, J=0.2555, MCC=0.2701, ConfusionMatrix=
[[1962  197]
 [ 243  129]]
Epoch 15 complete in 24.85

Early Stop!
Training complete in 7m 47s
The best model val AUC=0.757627633039, test AUC=0.734119987848.
Finish training resnet18fixed-conv1x1-maxpool

Start training resnet18fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6342, Acc=0.6366, AUC=0.6917, TPR=0.6748, TNR=0.5969, J=0.2718, MCC=0.2727, ConfusionMatrix=
[[2140 1445]
 [1208 2507]]
Epoch 0, Phase val, Loss=0.6469, Acc=0.6772, AUC=0.7194, TPR=0.5954, TNR=0.6918, J=0.2872, MCC=0.2156, ConfusionMatrix=
[[1504  670]
 [ 157  231]]
New Best AUC=0.7194. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6639, Acc=0.6614, AUC=0.7091, TPR=0.6317, TNR=0.6665, J=0.2982, MCC=0.2179, ConfusionMatrix=
[[1439  720]
 [ 137  235]]
Epoch 0 complete in 26.07

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5887, Acc=0.6926, AUC=0.7591, TPR=0.6550, TNR=0.7314, J=0.3863, MCC=0.3873, ConfusionMatrix=
[[2630  966]
 [1278 2426]]
Epoch 1, Phase val, Loss=0.5695, Acc=0.7482, AUC=0.7266, TPR=0.5103, TNR=0.7907, J=0.3010, MCC=0.2476, ConfusionMatrix=
[[1719  455]
 [ 190  198]]
New Best AUC=0.7266. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5896, Acc=0.7325, AUC=0.7113, TPR=0.5780, TNR=0.7591, J=0.3371, MCC=0.2629, ConfusionMatrix=
[[1639  520]
 [ 157  215]]
Epoch 1 complete in 25.48

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5839, Acc=0.7034, AUC=0.7693, TPR=0.6433, TNR=0.7629, J=0.4062, MCC=0.4093, ConfusionMatrix=
[[2799  870]
 [1295 2336]]
Epoch 2, Phase val, Loss=0.5592, Acc=0.7596, AUC=0.7463, TPR=0.5258, TNR=0.8013, J=0.3271, MCC=0.2714, ConfusionMatrix=
[[1742  432]
 [ 184  204]]
New Best AUC=0.7463. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5735, Acc=0.7420, AUC=0.7111, TPR=0.5215, TNR=0.7800, J=0.3015, MCC=0.2421, ConfusionMatrix=
[[1684  475]
 [ 178  194]]
Epoch 2 complete in 26.59

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5799, Acc=0.7026, AUC=0.7709, TPR=0.6646, TNR=0.7409, J=0.4055, MCC=0.4066, ConfusionMatrix=
[[2694  942]
 [1229 2435]]
Epoch 3, Phase val, Loss=0.5482, Acc=0.7681, AUC=0.7372, TPR=0.4871, TNR=0.8183, J=0.3054, MCC=0.2610, ConfusionMatrix=
[[1779  395]
 [ 199  189]]
Epoch 3, Phase test, Loss=0.5515, Acc=0.7716, AUC=0.7226, TPR=0.5430, TNR=0.8110, J=0.3540, MCC=0.2931, ConfusionMatrix=
[[1751  408]
 [ 170  202]]
Epoch 3 complete in 25.39

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5993, Acc=0.6867, AUC=0.7576, TPR=0.6131, TNR=0.7580, J=0.3712, MCC=0.3754, ConfusionMatrix=
[[2810  897]
 [1390 2203]]
Epoch 4, Phase val, Loss=0.6124, Acc=0.7268, AUC=0.7421, TPR=0.6082, TNR=0.7479, J=0.3562, MCC=0.2771, ConfusionMatrix=
[[1626  548]
 [ 152  236]]
Epoch 4, Phase test, Loss=0.6112, Acc=0.7199, AUC=0.7251, TPR=0.6075, TNR=0.7392, J=0.3468, MCC=0.2651, ConfusionMatrix=
[[1596  563]
 [ 146  226]]
Epoch 4 complete in 24.92

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5904, Acc=0.6900, AUC=0.7600, TPR=0.6454, TNR=0.7353, J=0.3807, MCC=0.3821, ConfusionMatrix=
[[2664  959]
 [1304 2373]]
Epoch 5, Phase val, Loss=0.5626, Acc=0.7670, AUC=0.7433, TPR=0.5077, TNR=0.8132, J=0.3210, MCC=0.2712, ConfusionMatrix=
[[1768  406]
 [ 191  197]]
Epoch 5, Phase test, Loss=0.5742, Acc=0.7542, AUC=0.7217, TPR=0.5645, TNR=0.7869, J=0.3515, MCC=0.2821, ConfusionMatrix=
[[1699  460]
 [ 162  210]]
Epoch 5 complete in 25.81

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5678, Acc=0.7129, AUC=0.7801, TPR=0.6540, TNR=0.7729, J=0.4269, MCC=0.4297, ConfusionMatrix=
[[2794  821]
 [1275 2410]]
Epoch 6, Phase val, Loss=0.7239, Acc=0.6807, AUC=0.7623, TPR=0.6959, TNR=0.6780, J=0.3739, MCC=0.2763, ConfusionMatrix=
[[1474  700]
 [ 118  270]]
New Best AUC=0.7623. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.7600, Acc=0.6416, AUC=0.7277, TPR=0.6747, TNR=0.6359, J=0.3107, MCC=0.2237, ConfusionMatrix=
[[1373  786]
 [ 121  251]]
Epoch 6 complete in 25.57

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5738, Acc=0.7104, AUC=0.7794, TPR=0.6587, TNR=0.7618, J=0.4205, MCC=0.4228, ConfusionMatrix=
[[2789  872]
 [1242 2397]]
Epoch 7, Phase val, Loss=0.6014, Acc=0.7416, AUC=0.7412, TPR=0.5722, TNR=0.7718, J=0.3440, MCC=0.2746, ConfusionMatrix=
[[1678  496]
 [ 166  222]]
Epoch 7, Phase test, Loss=0.5977, Acc=0.7250, AUC=0.7249, TPR=0.5726, TNR=0.7513, J=0.3239, MCC=0.2511, ConfusionMatrix=
[[1622  537]
 [ 159  213]]
Epoch 7 complete in 25.71

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5601, Acc=0.7184, AUC=0.7871, TPR=0.6612, TNR=0.7745, J=0.4358, MCC=0.4387, ConfusionMatrix=
[[2851  830]
 [1226 2393]]
Epoch 8, Phase val, Loss=0.5654, Acc=0.7763, AUC=0.7294, TPR=0.4948, TNR=0.8266, J=0.3214, MCC=0.2772, ConfusionMatrix=
[[1797  377]
 [ 196  192]]
Epoch 8, Phase test, Loss=0.5629, Acc=0.7681, AUC=0.7181, TPR=0.5000, TNR=0.8143, J=0.3143, MCC=0.2637, ConfusionMatrix=
[[1758  401]
 [ 186  186]]
Epoch 8 complete in 25.09

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5788, Acc=0.7085, AUC=0.7699, TPR=0.6578, TNR=0.7606, J=0.4185, MCC=0.4204, ConfusionMatrix=
[[2736  861]
 [1267 2436]]
Epoch 9, Phase val, Loss=0.7857, Acc=0.6358, AUC=0.7355, TPR=0.7010, TNR=0.6242, J=0.3252, MCC=0.2358, ConfusionMatrix=
[[1357  817]
 [ 116  272]]
Epoch 9, Phase test, Loss=0.7831, Acc=0.6235, AUC=0.7310, TPR=0.7097, TNR=0.6086, J=0.3183, MCC=0.2271, ConfusionMatrix=
[[1314  845]
 [ 108  264]]
Epoch 9 complete in 25.49

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5541, Acc=0.7192, AUC=0.7913, TPR=0.6624, TNR=0.7759, J=0.4382, MCC=0.4411, ConfusionMatrix=
[[2835  819]
 [1231 2415]]
Epoch 10, Phase val, Loss=0.7176, Acc=0.6983, AUC=0.7448, TPR=0.6598, TNR=0.7052, J=0.3649, MCC=0.2743, ConfusionMatrix=
[[1533  641]
 [ 132  256]]
Epoch 10, Phase test, Loss=0.7171, Acc=0.6760, AUC=0.7367, TPR=0.6559, TNR=0.6795, J=0.3354, MCC=0.2460, ConfusionMatrix=
[[1467  692]
 [ 128  244]]
Epoch 10 complete in 24.89

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5835, Acc=0.7022, AUC=0.7689, TPR=0.6459, TNR=0.7585, J=0.4044, MCC=0.4070, ConfusionMatrix=
[[2767  881]
 [1293 2359]]
Epoch 11, Phase val, Loss=0.4834, Acc=0.8212, AUC=0.7001, TPR=0.3428, TNR=0.9066, J=0.2494, MCC=0.2649, ConfusionMatrix=
[[1971  203]
 [ 255  133]]
Epoch 11, Phase test, Loss=0.4773, Acc=0.8305, AUC=0.6786, TPR=0.3737, TNR=0.9092, J=0.2829, MCC=0.2956, ConfusionMatrix=
[[1963  196]
 [ 233  139]]
Epoch 11 complete in 24.75

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5558, Acc=0.7230, AUC=0.7921, TPR=0.6522, TNR=0.7909, J=0.4431, MCC=0.4480, ConfusionMatrix=
[[2947  779]
 [1243 2331]]
Epoch 12, Phase val, Loss=0.5542, Acc=0.7705, AUC=0.7402, TPR=0.5103, TNR=0.8169, J=0.3272, MCC=0.2776, ConfusionMatrix=
[[1776  398]
 [ 190  198]]
Epoch 12, Phase test, Loss=0.5512, Acc=0.7578, AUC=0.7243, TPR=0.5376, TNR=0.7957, J=0.3334, MCC=0.2714, ConfusionMatrix=
[[1718  441]
 [ 172  200]]
Epoch 12 complete in 25.52

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5589, Acc=0.7223, AUC=0.7913, TPR=0.6802, TNR=0.7660, J=0.4462, MCC=0.4475, ConfusionMatrix=
[[2746  839]
 [1188 2527]]
Epoch 13, Phase val, Loss=0.5012, Acc=0.8119, AUC=0.7281, TPR=0.4098, TNR=0.8836, J=0.2934, MCC=0.2863, ConfusionMatrix=
[[1921  253]
 [ 229  159]]
Epoch 13, Phase test, Loss=0.4978, Acc=0.7989, AUC=0.7168, TPR=0.4489, TNR=0.8592, J=0.3081, MCC=0.2803, ConfusionMatrix=
[[1855  304]
 [ 205  167]]
Epoch 13 complete in 24.61

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5755, Acc=0.7118, AUC=0.7772, TPR=0.6444, TNR=0.7775, J=0.4219, MCC=0.4260, ConfusionMatrix=
[[2873  822]
 [1282 2323]]
Epoch 14, Phase val, Loss=0.4674, Acc=0.8224, AUC=0.7231, TPR=0.3454, TNR=0.9075, J=0.2529, MCC=0.2689, ConfusionMatrix=
[[1973  201]
 [ 254  134]]
Epoch 14, Phase test, Loss=0.4656, Acc=0.8285, AUC=0.7164, TPR=0.4113, TNR=0.9004, J=0.3117, MCC=0.3131, ConfusionMatrix=
[[1944  215]
 [ 219  153]]
Epoch 14 complete in 25.26

Early Stop!
Training complete in 6m 21s
The best model val AUC=0.762289096065, test AUC=0.727675347508.
Finish training resnet18fixed-conv1x1-maxpool

Start training resnet18fixed-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6461, Acc=0.6225, AUC=0.6703, TPR=0.6164, TNR=0.6285, J=0.2449, MCC=0.2450, ConfusionMatrix=
[[2291 1354]
 [1402 2253]]
Epoch 0, Phase val, Loss=0.5961, Acc=0.7077, AUC=0.7259, TPR=0.5644, TNR=0.7332, J=0.2976, MCC=0.2303, ConfusionMatrix=
[[1594  580]
 [ 169  219]]
New Best AUC=0.7259. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6004, Acc=0.7045, AUC=0.7390, TPR=0.6129, TNR=0.7202, J=0.3331, MCC=0.2511, ConfusionMatrix=
[[1555  604]
 [ 144  228]]
Epoch 0 complete in 25.55

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5931, Acc=0.6852, AUC=0.7537, TPR=0.6452, TNR=0.7263, J=0.3715, MCC=0.3725, ConfusionMatrix=
[[2616  986]
 [1312 2386]]
Epoch 1, Phase val, Loss=0.6556, Acc=0.7030, AUC=0.7568, TPR=0.6881, TNR=0.7056, J=0.3938, MCC=0.2952, ConfusionMatrix=
[[1534  640]
 [ 121  267]]
New Best AUC=0.7568. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6846, Acc=0.6551, AUC=0.7402, TPR=0.6828, TNR=0.6503, J=0.3331, MCC=0.2409, ConfusionMatrix=
[[1404  755]
 [ 118  254]]
Epoch 1 complete in 26.35

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5793, Acc=0.7032, AUC=0.7683, TPR=0.6428, TNR=0.7617, J=0.4045, MCC=0.4077, ConfusionMatrix=
[[2822  883]
 [1284 2311]]
Epoch 2, Phase val, Loss=0.5635, Acc=0.7588, AUC=0.7365, TPR=0.5155, TNR=0.8022, J=0.3177, MCC=0.2645, ConfusionMatrix=
[[1744  430]
 [ 188  200]]
Epoch 2, Phase test, Loss=0.5726, Acc=0.7440, AUC=0.7319, TPR=0.5430, TNR=0.7786, J=0.3216, MCC=0.2569, ConfusionMatrix=
[[1681  478]
 [ 170  202]]
Epoch 2 complete in 25.06

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5814, Acc=0.7011, AUC=0.7698, TPR=0.6565, TNR=0.7469, J=0.4034, MCC=0.4049, ConfusionMatrix=
[[2689  911]
 [1271 2429]]
Epoch 3, Phase val, Loss=0.6070, Acc=0.7354, AUC=0.7410, TPR=0.5361, TNR=0.7709, J=0.3070, MCC=0.2463, ConfusionMatrix=
[[1676  498]
 [ 180  208]]
Epoch 3, Phase test, Loss=0.6201, Acc=0.7155, AUC=0.7297, TPR=0.5645, TNR=0.7415, J=0.3061, MCC=0.2357, ConfusionMatrix=
[[1601  558]
 [ 162  210]]
Epoch 3 complete in 24.99

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5716, Acc=0.7123, AUC=0.7767, TPR=0.6621, TNR=0.7621, J=0.4241, MCC=0.4264, ConfusionMatrix=
[[2796  873]
 [1227 2404]]
Epoch 4, Phase val, Loss=0.6754, Acc=0.7139, AUC=0.7551, TPR=0.6624, TNR=0.7231, J=0.3855, MCC=0.2927, ConfusionMatrix=
[[1572  602]
 [ 131  257]]
Epoch 4, Phase test, Loss=0.6882, Acc=0.6701, AUC=0.7349, TPR=0.6478, TNR=0.6739, J=0.3218, MCC=0.2355, ConfusionMatrix=
[[1455  704]
 [ 131  241]]
Epoch 4 complete in 25.90

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.6099, Acc=0.6819, AUC=0.7402, TPR=0.6086, TNR=0.7559, J=0.3645, MCC=0.3684, ConfusionMatrix=
[[2747  887]
 [1435 2231]]
Epoch 5, Phase val, Loss=0.6265, Acc=0.7225, AUC=0.7248, TPR=0.5438, TNR=0.7544, J=0.2982, MCC=0.2354, ConfusionMatrix=
[[1640  534]
 [ 177  211]]
Epoch 5, Phase test, Loss=0.6123, Acc=0.7270, AUC=0.7214, TPR=0.5941, TNR=0.7499, J=0.3440, MCC=0.2656, ConfusionMatrix=
[[1619  540]
 [ 151  221]]
Epoch 5 complete in 25.08

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5688, Acc=0.7103, AUC=0.7774, TPR=0.6480, TNR=0.7707, J=0.4188, MCC=0.4222, ConfusionMatrix=
[[2854  849]
 [1266 2331]]
Epoch 6, Phase val, Loss=0.5535, Acc=0.7646, AUC=0.7127, TPR=0.4691, TNR=0.8174, J=0.2865, MCC=0.2455, ConfusionMatrix=
[[1777  397]
 [ 206  182]]
Epoch 6, Phase test, Loss=0.5459, Acc=0.7618, AUC=0.7002, TPR=0.4785, TNR=0.8106, J=0.2891, MCC=0.2425, ConfusionMatrix=
[[1750  409]
 [ 194  178]]
Epoch 6 complete in 25.65

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5662, Acc=0.7155, AUC=0.7835, TPR=0.6645, TNR=0.7684, J=0.4330, MCC=0.4349, ConfusionMatrix=
[[2751  829]
 [1248 2472]]
Epoch 7, Phase val, Loss=0.6998, Acc=0.6795, AUC=0.7472, TPR=0.6753, TNR=0.6803, J=0.3556, MCC=0.2635, ConfusionMatrix=
[[1479  695]
 [ 126  262]]
Epoch 7, Phase test, Loss=0.7282, Acc=0.6503, AUC=0.7161, TPR=0.6667, TNR=0.6475, J=0.3142, MCC=0.2272, ConfusionMatrix=
[[1398  761]
 [ 124  248]]
Epoch 7 complete in 24.98

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5696, Acc=0.7142, AUC=0.7816, TPR=0.6592, TNR=0.7687, J=0.4279, MCC=0.4306, ConfusionMatrix=
[[2821  849]
 [1237 2393]]
Epoch 8, Phase val, Loss=0.5885, Acc=0.7545, AUC=0.7483, TPR=0.5696, TNR=0.7875, J=0.3571, MCC=0.2895, ConfusionMatrix=
[[1712  462]
 [ 167  221]]
Epoch 8, Phase test, Loss=0.5951, Acc=0.7396, AUC=0.7203, TPR=0.5645, TNR=0.7698, J=0.3343, MCC=0.2638, ConfusionMatrix=
[[1662  497]
 [ 162  210]]
Epoch 8 complete in 24.82

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5679, Acc=0.7111, AUC=0.7792, TPR=0.6533, TNR=0.7687, J=0.4221, MCC=0.4249, ConfusionMatrix=
[[2809  845]
 [1264 2382]]
Epoch 9, Phase val, Loss=0.5084, Acc=0.7986, AUC=0.7347, TPR=0.4433, TNR=0.8620, J=0.3053, MCC=0.2823, ConfusionMatrix=
[[1874  300]
 [ 216  172]]
Epoch 9, Phase test, Loss=0.5086, Acc=0.7918, AUC=0.7058, TPR=0.4301, TNR=0.8541, J=0.2842, MCC=0.2577, ConfusionMatrix=
[[1844  315]
 [ 212  160]]
Epoch 9 complete in 25.69

Early Stop!
Training complete in 4m 14s
The best model val AUC=0.756847561149, test AUC=0.740219735341.
Finish training resnet18fixed-conv1x1-maxpool

Start training resnet18fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6117, Acc=0.6563, AUC=0.7227, TPR=0.6834, TNR=0.6299, J=0.3133, MCC=0.3137, ConfusionMatrix=
[[2330 1369]
 [1140 2461]]
Epoch 0, Phase val, Loss=0.4392, Acc=0.8052, AUC=0.7258, TPR=0.3067, TNR=0.8942, J=0.2009, MCC=0.2100, ConfusionMatrix=
[[1944  230]
 [ 269  119]]
New Best AUC=0.7258. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4424, Acc=0.8107, AUC=0.7212, TPR=0.3817, TNR=0.8847, J=0.2664, MCC=0.2610, ConfusionMatrix=
[[1910  249]
 [ 230  142]]
Epoch 0 complete in 25.88

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5799, Acc=0.6992, AUC=0.7691, TPR=0.7022, TNR=0.6963, J=0.3984, MCC=0.3984, ConfusionMatrix=
[[2579 1125]
 [1071 2525]]
Epoch 1, Phase val, Loss=0.5973, Acc=0.6827, AUC=0.7439, TPR=0.6649, TNR=0.6858, J=0.3508, MCC=0.2609, ConfusionMatrix=
[[1491  683]
 [ 130  258]]
New Best AUC=0.7439. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6209, Acc=0.6590, AUC=0.7318, TPR=0.6774, TNR=0.6559, J=0.3333, MCC=0.2416, ConfusionMatrix=
[[1416  743]
 [ 120  252]]
Epoch 1 complete in 26.36

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5696, Acc=0.7033, AUC=0.7764, TPR=0.7166, TNR=0.6899, J=0.4066, MCC=0.4067, ConfusionMatrix=
[[2519 1132]
 [1034 2615]]
Epoch 2, Phase val, Loss=0.6077, Acc=0.6729, AUC=0.7366, TPR=0.6675, TNR=0.6739, J=0.3414, MCC=0.2524, ConfusionMatrix=
[[1465  709]
 [ 129  259]]
Epoch 2, Phase test, Loss=0.6387, Acc=0.6416, AUC=0.7251, TPR=0.7070, TNR=0.6304, J=0.3374, MCC=0.2421, ConfusionMatrix=
[[1361  798]
 [ 109  263]]
Epoch 2 complete in 25.00

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5680, Acc=0.7059, AUC=0.7793, TPR=0.7162, TNR=0.6955, J=0.4116, MCC=0.4117, ConfusionMatrix=
[[2519 1103]
 [1044 2634]]
Epoch 3, Phase val, Loss=0.5353, Acc=0.7276, AUC=0.7271, TPR=0.5284, TNR=0.7631, J=0.2915, MCC=0.2324, ConfusionMatrix=
[[1659  515]
 [ 183  205]]
Epoch 3, Phase test, Loss=0.5528, Acc=0.7183, AUC=0.7297, TPR=0.5780, TNR=0.7425, J=0.3204, MCC=0.2465, ConfusionMatrix=
[[1603  556]
 [ 157  215]]
Epoch 3 complete in 25.69

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5599, Acc=0.7125, AUC=0.7858, TPR=0.7268, TNR=0.6979, J=0.4247, MCC=0.4249, ConfusionMatrix=
[[2530 1095]
 [1004 2671]]
Epoch 4, Phase val, Loss=0.4932, Acc=0.7549, AUC=0.7342, TPR=0.4691, TNR=0.8059, J=0.2750, MCC=0.2322, ConfusionMatrix=
[[1752  422]
 [ 206  182]]
Epoch 4, Phase test, Loss=0.5023, Acc=0.7645, AUC=0.7281, TPR=0.5349, TNR=0.8041, J=0.3390, MCC=0.2788, ConfusionMatrix=
[[1736  423]
 [ 173  199]]
Epoch 4 complete in 25.09

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5485, Acc=0.7253, AUC=0.7963, TPR=0.7216, TNR=0.7289, J=0.4505, MCC=0.4505, ConfusionMatrix=
[[2716 1010]
 [ 995 2579]]
Epoch 5, Phase val, Loss=0.5640, Acc=0.7061, AUC=0.7295, TPR=0.5644, TNR=0.7314, J=0.2958, MCC=0.2286, ConfusionMatrix=
[[1590  584]
 [ 169  219]]
Epoch 5, Phase test, Loss=0.5879, Acc=0.6922, AUC=0.7269, TPR=0.6075, TNR=0.7068, J=0.3143, MCC=0.2351, ConfusionMatrix=
[[1526  633]
 [ 146  226]]
Epoch 5 complete in 24.81

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5559, Acc=0.7170, AUC=0.7897, TPR=0.7198, TNR=0.7142, J=0.4340, MCC=0.4340, ConfusionMatrix=
[[2619 1048]
 [1018 2615]]
Epoch 6, Phase val, Loss=0.4860, Acc=0.7533, AUC=0.7399, TPR=0.4536, TNR=0.8068, J=0.2604, MCC=0.2210, ConfusionMatrix=
[[1754  420]
 [ 212  176]]
Epoch 6, Phase test, Loss=0.4960, Acc=0.7728, AUC=0.7281, TPR=0.5054, TNR=0.8189, J=0.3243, MCC=0.2734, ConfusionMatrix=
[[1768  391]
 [ 184  188]]
Epoch 6 complete in 26.00

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5527, Acc=0.7175, AUC=0.7926, TPR=0.7207, TNR=0.7145, J=0.4351, MCC=0.4351, ConfusionMatrix=
[[2635 1053]
 [1009 2603]]
Epoch 7, Phase val, Loss=0.5658, Acc=0.7069, AUC=0.7373, TPR=0.5954, TNR=0.7268, J=0.3221, MCC=0.2471, ConfusionMatrix=
[[1580  594]
 [ 157  231]]
Epoch 7, Phase test, Loss=0.5898, Acc=0.6855, AUC=0.7252, TPR=0.6156, TNR=0.6975, J=0.3131, MCC=0.2327, ConfusionMatrix=
[[1506  653]
 [ 143  229]]
Epoch 7 complete in 24.88

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5389, Acc=0.7300, AUC=0.8047, TPR=0.7356, TNR=0.7243, J=0.4599, MCC=0.4600, ConfusionMatrix=
[[2625  999]
 [ 972 2704]]
Epoch 8, Phase val, Loss=0.5716, Acc=0.6967, AUC=0.7388, TPR=0.5902, TNR=0.7157, J=0.3059, MCC=0.2331, ConfusionMatrix=
[[1556  618]
 [ 159  229]]
Epoch 8, Phase test, Loss=0.5852, Acc=0.6879, AUC=0.7287, TPR=0.6048, TNR=0.7022, J=0.3070, MCC=0.2290, ConfusionMatrix=
[[1516  643]
 [ 147  225]]
Epoch 8 complete in 25.72

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5524, Acc=0.7230, AUC=0.7941, TPR=0.7339, TNR=0.7121, J=0.4460, MCC=0.4461, ConfusionMatrix=
[[2597 1050]
 [ 972 2681]]
Epoch 9, Phase val, Loss=0.5451, Acc=0.7272, AUC=0.7329, TPR=0.5387, TNR=0.7608, J=0.2995, MCC=0.2379, ConfusionMatrix=
[[1654  520]
 [ 179  209]]
Epoch 9, Phase test, Loss=0.5621, Acc=0.7175, AUC=0.7237, TPR=0.5753, TNR=0.7420, J=0.3173, MCC=0.2441, ConfusionMatrix=
[[1602  557]
 [ 158  214]]
Epoch 9 complete in 25.06

Early Stop!
Training complete in 4m 14s
The best model val AUC=0.743932510741, test AUC=0.731810326366.
Finish training resnet18fixed-conv1x1-avgpool

Start training resnet18fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6128, Acc=0.6659, AUC=0.7256, TPR=0.7095, TNR=0.6210, J=0.3305, MCC=0.3320, ConfusionMatrix=
[[2235 1364]
 [1075 2626]]
Epoch 0, Phase val, Loss=0.5956, Acc=0.6694, AUC=0.7203, TPR=0.6418, TNR=0.6743, J=0.3161, MCC=0.2342, ConfusionMatrix=
[[1466  708]
 [ 139  249]]
New Best AUC=0.7203. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6152, Acc=0.6397, AUC=0.7145, TPR=0.6344, TNR=0.6406, J=0.2750, MCC=0.1988, ConfusionMatrix=
[[1383  776]
 [ 136  236]]
Epoch 0 complete in 26.58

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5705, Acc=0.7089, AUC=0.7763, TPR=0.7263, TNR=0.6909, J=0.4172, MCC=0.4175, ConfusionMatrix=
[[2479 1109]
 [1016 2696]]
Epoch 1, Phase val, Loss=0.5955, Acc=0.6628, AUC=0.7421, TPR=0.6675, TNR=0.6619, J=0.3294, MCC=0.2424, ConfusionMatrix=
[[1439  735]
 [ 129  259]]
New Best AUC=0.7421. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6135, Acc=0.6563, AUC=0.7292, TPR=0.6694, TNR=0.6540, J=0.3234, MCC=0.2344, ConfusionMatrix=
[[1412  747]
 [ 123  249]]
Epoch 1 complete in 25.57

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5571, Acc=0.7149, AUC=0.7889, TPR=0.7228, TNR=0.7072, J=0.4300, MCC=0.4300, ConfusionMatrix=
[[2606 1079]
 [1002 2613]]
Epoch 2, Phase val, Loss=0.5751, Acc=0.6897, AUC=0.7357, TPR=0.6134, TNR=0.7033, J=0.3167, MCC=0.2389, ConfusionMatrix=
[[1529  645]
 [ 150  238]]
Epoch 2, Phase test, Loss=0.5894, Acc=0.6823, AUC=0.7261, TPR=0.6317, TNR=0.6911, J=0.3228, MCC=0.2386, ConfusionMatrix=
[[1492  667]
 [ 137  235]]
Epoch 2 complete in 24.93

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5641, Acc=0.7096, AUC=0.7807, TPR=0.7203, TNR=0.6987, J=0.4190, MCC=0.4192, ConfusionMatrix=
[[2535 1093]
 [1027 2645]]
Epoch 3, Phase val, Loss=0.5057, Acc=0.7549, AUC=0.7407, TPR=0.5284, TNR=0.7953, J=0.3237, MCC=0.2666, ConfusionMatrix=
[[1729  445]
 [ 183  205]]
Epoch 3, Phase test, Loss=0.5225, Acc=0.7554, AUC=0.7233, TPR=0.5403, TNR=0.7925, J=0.3328, MCC=0.2699, ConfusionMatrix=
[[1711  448]
 [ 171  201]]
Epoch 3 complete in 25.81

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5601, Acc=0.7119, AUC=0.7851, TPR=0.7191, TNR=0.7047, J=0.4238, MCC=0.4238, ConfusionMatrix=
[[2565 1075]
 [1028 2632]]
Epoch 4, Phase val, Loss=0.5223, Acc=0.7303, AUC=0.7416, TPR=0.5464, TNR=0.7631, J=0.3095, MCC=0.2461, ConfusionMatrix=
[[1659  515]
 [ 176  212]]
Epoch 4, Phase test, Loss=0.5344, Acc=0.7294, AUC=0.7334, TPR=0.5645, TNR=0.7578, J=0.3223, MCC=0.2516, ConfusionMatrix=
[[1636  523]
 [ 162  210]]
Epoch 4 complete in 24.90

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5677, Acc=0.7108, AUC=0.7803, TPR=0.7107, TNR=0.7110, J=0.4216, MCC=0.4216, ConfusionMatrix=
[[2605 1059]
 [1052 2584]]
Epoch 5, Phase val, Loss=0.6386, Acc=0.6456, AUC=0.7307, TPR=0.6546, TNR=0.6440, J=0.2986, MCC=0.2184, ConfusionMatrix=
[[1400  774]
 [ 134  254]]
Epoch 5, Phase test, Loss=0.6701, Acc=0.6128, AUC=0.7311, TPR=0.6882, TNR=0.5998, J=0.2880, MCC=0.2053, ConfusionMatrix=
[[1295  864]
 [ 116  256]]
Epoch 5 complete in 25.84

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5579, Acc=0.7156, AUC=0.7879, TPR=0.7169, TNR=0.7143, J=0.4313, MCC=0.4312, ConfusionMatrix=
[[2638 1055]
 [1021 2586]]
Epoch 6, Phase val, Loss=0.6980, Acc=0.6253, AUC=0.7427, TPR=0.7655, TNR=0.6003, J=0.3657, MCC=0.2633, ConfusionMatrix=
[[1305  869]
 [  91  297]]
New Best AUC=0.7427. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.7344, Acc=0.5725, AUC=0.7312, TPR=0.7500, TNR=0.5419, J=0.2919, MCC=0.2067, ConfusionMatrix=
[[1170  989]
 [  93  279]]
Epoch 6 complete in 25.15

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5456, Acc=0.7251, AUC=0.7998, TPR=0.7338, TNR=0.7163, J=0.4501, MCC=0.4502, ConfusionMatrix=
[[2608 1033]
 [ 974 2685]]
Epoch 7, Phase val, Loss=0.4699, Acc=0.7799, AUC=0.7443, TPR=0.4485, TNR=0.8390, J=0.2875, MCC=0.2555, ConfusionMatrix=
[[1824  350]
 [ 214  174]]
New Best AUC=0.7443. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.4787, Acc=0.7898, AUC=0.7299, TPR=0.4866, TNR=0.8421, J=0.3286, MCC=0.2876, ConfusionMatrix=
[[1818  341]
 [ 191  181]]
Epoch 7 complete in 26.29

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5522, Acc=0.7219, AUC=0.7926, TPR=0.7339, TNR=0.7094, J=0.4433, MCC=0.4434, ConfusionMatrix=
[[2532 1037]
 [ 993 2738]]
Epoch 8, Phase val, Loss=0.6905, Acc=0.6194, AUC=0.7306, TPR=0.7036, TNR=0.6044, J=0.3080, MCC=0.2223, ConfusionMatrix=
[[1314  860]
 [ 115  273]]
Epoch 8, Phase test, Loss=0.7208, Acc=0.5879, AUC=0.7245, TPR=0.7258, TNR=0.5642, J=0.2900, MCC=0.2055, ConfusionMatrix=
[[1218  941]
 [ 102  270]]
Epoch 8 complete in 25.10

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5589, Acc=0.7173, AUC=0.7893, TPR=0.7342, TNR=0.6995, J=0.4338, MCC=0.4341, ConfusionMatrix=
[[2498 1073]
 [ 991 2738]]
Epoch 9, Phase val, Loss=0.5484, Acc=0.7123, AUC=0.7252, TPR=0.5284, TNR=0.7452, J=0.2735, MCC=0.2147, ConfusionMatrix=
[[1620  554]
 [ 183  205]]
Epoch 9, Phase test, Loss=0.5693, Acc=0.7064, AUC=0.7209, TPR=0.5833, TNR=0.7277, J=0.3110, MCC=0.2364, ConfusionMatrix=
[[1571  588]
 [ 155  217]]
Epoch 9 complete in 25.07

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5637, Acc=0.7105, AUC=0.7817, TPR=0.7112, TNR=0.7099, J=0.4211, MCC=0.4211, ConfusionMatrix=
[[2631 1075]
 [1038 2556]]
Epoch 10, Phase val, Loss=0.5522, Acc=0.7139, AUC=0.7371, TPR=0.5567, TNR=0.7420, J=0.2987, MCC=0.2329, ConfusionMatrix=
[[1613  561]
 [ 172  216]]
Epoch 10, Phase test, Loss=0.5719, Acc=0.7045, AUC=0.7272, TPR=0.5941, TNR=0.7235, J=0.3176, MCC=0.2404, ConfusionMatrix=
[[1562  597]
 [ 151  221]]
Epoch 10 complete in 25.65

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5477, Acc=0.7329, AUC=0.7997, TPR=0.7334, TNR=0.7324, J=0.4658, MCC=0.4658, ConfusionMatrix=
[[2668  975]
 [ 975 2682]]
Epoch 11, Phase val, Loss=0.6909, Acc=0.6296, AUC=0.7310, TPR=0.7242, TNR=0.6127, J=0.3369, MCC=0.2434, ConfusionMatrix=
[[1332  842]
 [ 107  281]]
Epoch 11, Phase test, Loss=0.7216, Acc=0.5851, AUC=0.7255, TPR=0.7392, TNR=0.5586, J=0.2978, MCC=0.2110, ConfusionMatrix=
[[1206  953]
 [  97  275]]
Epoch 11 complete in 24.65

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5684, Acc=0.7059, AUC=0.7806, TPR=0.7024, TNR=0.7092, J=0.4116, MCC=0.4115, ConfusionMatrix=
[[2658 1090]
 [1057 2495]]
Epoch 12, Phase val, Loss=0.5721, Acc=0.7057, AUC=0.7366, TPR=0.6108, TNR=0.7226, J=0.3335, MCC=0.2546, ConfusionMatrix=
[[1571  603]
 [ 151  237]]
Epoch 12, Phase test, Loss=0.5959, Acc=0.6800, AUC=0.7285, TPR=0.6022, TNR=0.6934, J=0.2955, MCC=0.2194, ConfusionMatrix=
[[1497  662]
 [ 148  224]]
Epoch 12 complete in 25.33

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5458, Acc=0.7207, AUC=0.7983, TPR=0.7205, TNR=0.7208, J=0.4414, MCC=0.4414, ConfusionMatrix=
[[2621 1015]
 [1024 2640]]
Epoch 13, Phase val, Loss=0.6955, Acc=0.6179, AUC=0.7273, TPR=0.7165, TNR=0.6003, J=0.3168, MCC=0.2284, ConfusionMatrix=
[[1305  869]
 [ 110  278]]
Epoch 13, Phase test, Loss=0.7221, Acc=0.5915, AUC=0.7267, TPR=0.7446, TNR=0.5651, J=0.3097, MCC=0.2195, ConfusionMatrix=
[[1220  939]
 [  95  277]]
Epoch 13 complete in 25.02

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5556, Acc=0.7129, AUC=0.7895, TPR=0.7174, TNR=0.7084, J=0.4258, MCC=0.4258, ConfusionMatrix=
[[2604 1072]
 [1024 2600]]
Epoch 14, Phase val, Loss=0.6167, Acc=0.6671, AUC=0.7284, TPR=0.6211, TNR=0.6753, J=0.2964, MCC=0.2201, ConfusionMatrix=
[[1468  706]
 [ 147  241]]
Epoch 14, Phase test, Loss=0.6386, Acc=0.6543, AUC=0.7341, TPR=0.6694, TNR=0.6517, J=0.3210, MCC=0.2325, ConfusionMatrix=
[[1407  752]
 [ 123  249]]
Epoch 14 complete in 24.87

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5327, Acc=0.7285, AUC=0.8089, TPR=0.7334, TNR=0.7236, J=0.4570, MCC=0.4570, ConfusionMatrix=
[[2647 1011]
 [ 971 2671]]
Epoch 15, Phase val, Loss=0.6278, Acc=0.6717, AUC=0.7434, TPR=0.6675, TNR=0.6725, J=0.3400, MCC=0.2512, ConfusionMatrix=
[[1462  712]
 [ 129  259]]
Epoch 15, Phase test, Loss=0.6572, Acc=0.6333, AUC=0.7273, TPR=0.6801, TNR=0.6253, J=0.3054, MCC=0.2191, ConfusionMatrix=
[[1350  809]
 [ 119  253]]
Epoch 15 complete in 26.38

Early Stop!
Training complete in 6m 47s
The best model val AUC=0.744321361166, test AUC=0.729886646048.
Finish training resnet18fixed-conv1x1-avgpool

Start training resnet18fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5989, Acc=0.6749, AUC=0.7424, TPR=0.7245, TNR=0.6246, J=0.3490, MCC=0.3509, ConfusionMatrix=
[[2261 1359]
 [1014 2666]]
Epoch 0, Phase val, Loss=0.5874, Acc=0.6741, AUC=0.7271, TPR=0.6443, TNR=0.6794, J=0.3237, MCC=0.2404, ConfusionMatrix=
[[1477  697]
 [ 138  250]]
New Best AUC=0.7271. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6218, Acc=0.6397, AUC=0.7155, TPR=0.6613, TNR=0.6359, J=0.2972, MCC=0.2142, ConfusionMatrix=
[[1373  786]
 [ 126  246]]
Epoch 0 complete in 25.40

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5752, Acc=0.7026, AUC=0.7712, TPR=0.7256, TNR=0.6794, J=0.4050, MCC=0.4055, ConfusionMatrix=
[[2469 1165]
 [1006 2660]]
Epoch 1, Phase val, Loss=0.4990, Acc=0.7525, AUC=0.7347, TPR=0.4794, TNR=0.8013, J=0.2807, MCC=0.2352, ConfusionMatrix=
[[1742  432]
 [ 202  186]]
New Best AUC=0.7347. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5141, Acc=0.7491, AUC=0.7279, TPR=0.5269, TNR=0.7874, J=0.3143, MCC=0.2541, ConfusionMatrix=
[[1700  459]
 [ 176  196]]
Epoch 1 complete in 25.88

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5685, Acc=0.7136, AUC=0.7788, TPR=0.7173, TNR=0.7099, J=0.4272, MCC=0.4272, ConfusionMatrix=
[[2608 1066]
 [1025 2601]]
Epoch 2, Phase val, Loss=0.5507, Acc=0.7178, AUC=0.7345, TPR=0.5799, TNR=0.7424, J=0.3223, MCC=0.2506, ConfusionMatrix=
[[1614  560]
 [ 163  225]]
Epoch 2, Phase test, Loss=0.5704, Acc=0.6970, AUC=0.7299, TPR=0.6022, TNR=0.7133, J=0.3154, MCC=0.2370, ConfusionMatrix=
[[1540  619]
 [ 148  224]]
Epoch 2 complete in 24.66

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5717, Acc=0.7122, AUC=0.7747, TPR=0.7233, TNR=0.7008, J=0.4241, MCC=0.4243, ConfusionMatrix=
[[2530 1080]
 [1021 2669]]
Epoch 3, Phase val, Loss=0.5774, Acc=0.6909, AUC=0.7337, TPR=0.6031, TNR=0.7065, J=0.3096, MCC=0.2342, ConfusionMatrix=
[[1536  638]
 [ 154  234]]
Epoch 3, Phase test, Loss=0.6000, Acc=0.6701, AUC=0.7228, TPR=0.6263, TNR=0.6776, J=0.3040, MCC=0.2233, ConfusionMatrix=
[[1463  696]
 [ 139  233]]
Epoch 3 complete in 25.61

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5697, Acc=0.7022, AUC=0.7754, TPR=0.6893, TNR=0.7144, J=0.4037, MCC=0.4038, ConfusionMatrix=
[[2679 1071]
 [1103 2447]]
Epoch 4, Phase val, Loss=0.5811, Acc=0.6846, AUC=0.7333, TPR=0.6005, TNR=0.6996, J=0.3001, MCC=0.2262, ConfusionMatrix=
[[1521  653]
 [ 155  233]]
Epoch 4, Phase test, Loss=0.6000, Acc=0.6788, AUC=0.7305, TPR=0.6586, TNR=0.6823, J=0.3409, MCC=0.2503, ConfusionMatrix=
[[1473  686]
 [ 127  245]]
Epoch 4 complete in 25.12

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5432, Acc=0.7221, AUC=0.7994, TPR=0.7379, TNR=0.7059, J=0.4438, MCC=0.4441, ConfusionMatrix=
[[2554 1064]
 [ 965 2717]]
Epoch 5, Phase val, Loss=0.5112, Acc=0.7440, AUC=0.7336, TPR=0.4871, TNR=0.7898, J=0.2769, MCC=0.2286, ConfusionMatrix=
[[1717  457]
 [ 199  189]]
Epoch 5, Phase test, Loss=0.5282, Acc=0.7365, AUC=0.7268, TPR=0.5430, TNR=0.7698, J=0.3128, MCC=0.2477, ConfusionMatrix=
[[1662  497]
 [ 170  202]]
Epoch 5 complete in 24.84

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5427, Acc=0.7270, AUC=0.8019, TPR=0.7388, TNR=0.7153, J=0.4541, MCC=0.4542, ConfusionMatrix=
[[2625 1045]
 [ 948 2682]]
Epoch 6, Phase val, Loss=0.4762, Acc=0.7709, AUC=0.7391, TPR=0.4588, TNR=0.8266, J=0.2853, MCC=0.2483, ConfusionMatrix=
[[1797  377]
 [ 210  178]]
New Best AUC=0.7391. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.4947, Acc=0.7649, AUC=0.7235, TPR=0.5000, TNR=0.8106, J=0.3106, MCC=0.2593, ConfusionMatrix=
[[1750  409]
 [ 186  186]]
Epoch 6 complete in 26.17

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5689, Acc=0.7107, AUC=0.7795, TPR=0.7277, TNR=0.6937, J=0.4214, MCC=0.4216, ConfusionMatrix=
[[2532 1118]
 [ 994 2656]]
Epoch 7, Phase val, Loss=0.5174, Acc=0.7412, AUC=0.7393, TPR=0.5180, TNR=0.7810, J=0.2991, MCC=0.2432, ConfusionMatrix=
[[1698  476]
 [ 187  201]]
New Best AUC=0.7393. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5394, Acc=0.7199, AUC=0.7246, TPR=0.5376, TNR=0.7513, J=0.2889, MCC=0.2252, ConfusionMatrix=
[[1622  537]
 [ 172  200]]
Epoch 7 complete in 25.37

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5575, Acc=0.7132, AUC=0.7883, TPR=0.7116, TNR=0.7147, J=0.4263, MCC=0.4263, ConfusionMatrix=
[[2628 1049]
 [1045 2578]]
Epoch 8, Phase val, Loss=0.4683, Acc=0.7834, AUC=0.7368, TPR=0.4304, TNR=0.8464, J=0.2768, MCC=0.2502, ConfusionMatrix=
[[1840  334]
 [ 221  167]]
Epoch 8, Phase test, Loss=0.4775, Acc=0.7851, AUC=0.7286, TPR=0.4892, TNR=0.8360, J=0.3253, MCC=0.2819, ConfusionMatrix=
[[1805  354]
 [ 190  182]]
Epoch 8 complete in 25.30

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5617, Acc=0.7125, AUC=0.7851, TPR=0.7138, TNR=0.7111, J=0.4249, MCC=0.4249, ConfusionMatrix=
[[2602 1057]
 [1042 2599]]
Epoch 9, Phase val, Loss=0.4813, Acc=0.7693, AUC=0.7305, TPR=0.4278, TNR=0.8303, J=0.2581, MCC=0.2276, ConfusionMatrix=
[[1805  369]
 [ 222  166]]
Epoch 9, Phase test, Loss=0.4905, Acc=0.7681, AUC=0.7268, TPR=0.5000, TNR=0.8143, J=0.3143, MCC=0.2637, ConfusionMatrix=
[[1758  401]
 [ 186  186]]
Epoch 9 complete in 25.05

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5616, Acc=0.7096, AUC=0.7844, TPR=0.7087, TNR=0.7104, J=0.4192, MCC=0.4191, ConfusionMatrix=
[[2620 1068]
 [1052 2560]]
Epoch 10, Phase val, Loss=0.5676, Acc=0.7061, AUC=0.7341, TPR=0.6005, TNR=0.7249, J=0.3254, MCC=0.2492, ConfusionMatrix=
[[1576  598]
 [ 155  233]]
Epoch 10, Phase test, Loss=0.5943, Acc=0.6831, AUC=0.7293, TPR=0.6290, TNR=0.6925, J=0.3215, MCC=0.2379, ConfusionMatrix=
[[1495  664]
 [ 138  234]]
Epoch 10 complete in 25.91

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5524, Acc=0.7181, AUC=0.7917, TPR=0.7170, TNR=0.7191, J=0.4362, MCC=0.4362, ConfusionMatrix=
[[2637 1030]
 [1028 2605]]
Epoch 11, Phase val, Loss=0.5521, Acc=0.7205, AUC=0.7273, TPR=0.5438, TNR=0.7521, J=0.2959, MCC=0.2331, ConfusionMatrix=
[[1635  539]
 [ 177  211]]
Epoch 11, Phase test, Loss=0.5716, Acc=0.7037, AUC=0.7192, TPR=0.5780, TNR=0.7253, J=0.3033, MCC=0.2304, ConfusionMatrix=
[[1566  593]
 [ 157  215]]
Epoch 11 complete in 25.08

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5411, Acc=0.7289, AUC=0.8036, TPR=0.7395, TNR=0.7185, J=0.4580, MCC=0.4580, ConfusionMatrix=
[[2644 1036]
 [ 943 2677]]
Epoch 12, Phase val, Loss=0.5817, Acc=0.6920, AUC=0.7386, TPR=0.6186, TNR=0.7052, J=0.3237, MCC=0.2443, ConfusionMatrix=
[[1533  641]
 [ 148  240]]
Epoch 12, Phase test, Loss=0.6053, Acc=0.6764, AUC=0.7321, TPR=0.6478, TNR=0.6813, J=0.3292, MCC=0.2418, ConfusionMatrix=
[[1471  688]
 [ 131  241]]
Epoch 12 complete in 24.88

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5483, Acc=0.7226, AUC=0.7980, TPR=0.7127, TNR=0.7321, J=0.4448, MCC=0.4449, ConfusionMatrix=
[[2727  998]
 [1027 2548]]
Epoch 13, Phase val, Loss=0.5954, Acc=0.6913, AUC=0.7352, TPR=0.6366, TNR=0.7010, J=0.3376, MCC=0.2537, ConfusionMatrix=
[[1524  650]
 [ 141  247]]
Epoch 13, Phase test, Loss=0.6173, Acc=0.6725, AUC=0.7280, TPR=0.6505, TNR=0.6762, J=0.3268, MCC=0.2394, ConfusionMatrix=
[[1460  699]
 [ 130  242]]
Epoch 13 complete in 25.68

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5448, Acc=0.7229, AUC=0.7994, TPR=0.7435, TNR=0.7020, J=0.4455, MCC=0.4459, ConfusionMatrix=
[[2546 1081]
 [ 942 2731]]
Epoch 14, Phase val, Loss=0.4465, Acc=0.7963, AUC=0.7360, TPR=0.3943, TNR=0.8680, J=0.2623, MCC=0.2493, ConfusionMatrix=
[[1887  287]
 [ 235  153]]
Epoch 14, Phase test, Loss=0.4513, Acc=0.8021, AUC=0.7266, TPR=0.4355, TNR=0.8652, J=0.3007, MCC=0.2778, ConfusionMatrix=
[[1868  291]
 [ 210  162]]
Epoch 14 complete in 24.70

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5682, Acc=0.7112, AUC=0.7824, TPR=0.7055, TNR=0.7168, J=0.4223, MCC=0.4223, ConfusionMatrix=
[[2650 1047]
 [1061 2542]]
Epoch 15, Phase val, Loss=0.5559, Acc=0.7291, AUC=0.7247, TPR=0.5722, TNR=0.7571, J=0.3293, MCC=0.2594, ConfusionMatrix=
[[1646  528]
 [ 166  222]]
Epoch 15, Phase test, Loss=0.5721, Acc=0.7108, AUC=0.7230, TPR=0.5941, TNR=0.7309, J=0.3250, MCC=0.2473, ConfusionMatrix=
[[1578  581]
 [ 151  221]]
Epoch 15 complete in 25.38

Early Stop!
Training complete in 6m 45s
The best model val AUC=0.739311355381, test AUC=0.724593723697.
Finish training resnet18fixed-conv1x1-avgpool

Start training resnet18fixed-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6099, Acc=0.6601, AUC=0.7253, TPR=0.6978, TNR=0.6231, J=0.3208, MCC=0.3217, ConfusionMatrix=
[[2291 1386]
 [1095 2528]]
Epoch 0, Phase val, Loss=0.5687, Acc=0.6971, AUC=0.7254, TPR=0.6263, TNR=0.7098, J=0.3360, MCC=0.2541, ConfusionMatrix=
[[1543  631]
 [ 145  243]]
New Best AUC=0.7254. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5925, Acc=0.6740, AUC=0.7176, TPR=0.6317, TNR=0.6813, J=0.3131, MCC=0.2303, ConfusionMatrix=
[[1471  688]
 [ 137  235]]
Epoch 0 complete in 25.50

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5661, Acc=0.7085, AUC=0.7797, TPR=0.7245, TNR=0.6922, J=0.4167, MCC=0.4170, ConfusionMatrix=
[[2505 1114]
 [1014 2667]]
Epoch 1, Phase val, Loss=0.5813, Acc=0.6948, AUC=0.7454, TPR=0.6546, TNR=0.7019, J=0.3566, MCC=0.2676, ConfusionMatrix=
[[1526  648]
 [ 134  254]]
New Best AUC=0.7454. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6036, Acc=0.6614, AUC=0.7311, TPR=0.6586, TNR=0.6619, J=0.3205, MCC=0.2332, ConfusionMatrix=
[[1429  730]
 [ 127  245]]
Epoch 1 complete in 26.31

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5564, Acc=0.7164, AUC=0.7889, TPR=0.7186, TNR=0.7143, J=0.4329, MCC=0.4329, ConfusionMatrix=
[[2633 1053]
 [1017 2597]]
Epoch 2, Phase val, Loss=0.6300, Acc=0.6612, AUC=0.7433, TPR=0.7088, TNR=0.6527, J=0.3615, MCC=0.2643, ConfusionMatrix=
[[1419  755]
 [ 113  275]]
Epoch 2, Phase test, Loss=0.6612, Acc=0.6227, AUC=0.7300, TPR=0.7097, TNR=0.6077, J=0.3174, MCC=0.2264, ConfusionMatrix=
[[1312  847]
 [ 108  264]]
Epoch 2 complete in 24.95

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5642, Acc=0.7145, AUC=0.7831, TPR=0.7309, TNR=0.6984, J=0.4293, MCC=0.4295, ConfusionMatrix=
[[2568 1109]
 [ 975 2648]]
Epoch 3, Phase val, Loss=0.4357, Acc=0.8048, AUC=0.7323, TPR=0.3454, TNR=0.8868, J=0.2322, MCC=0.2342, ConfusionMatrix=
[[1928  246]
 [ 254  134]]
Epoch 3, Phase test, Loss=0.4440, Acc=0.8202, AUC=0.7228, TPR=0.4194, TNR=0.8893, J=0.3087, MCC=0.3011, ConfusionMatrix=
[[1920  239]
 [ 216  156]]
Epoch 3 complete in 24.84

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5751, Acc=0.7067, AUC=0.7738, TPR=0.7068, TNR=0.7067, J=0.4134, MCC=0.4134, ConfusionMatrix=
[[2580 1071]
 [1070 2579]]
Epoch 4, Phase val, Loss=0.5694, Acc=0.7069, AUC=0.7220, TPR=0.5593, TNR=0.7332, J=0.2925, MCC=0.2265, ConfusionMatrix=
[[1594  580]
 [ 171  217]]
Epoch 4, Phase test, Loss=0.5965, Acc=0.6760, AUC=0.7262, TPR=0.6237, TNR=0.6850, J=0.3087, MCC=0.2277, ConfusionMatrix=
[[1479  680]
 [ 140  232]]
Epoch 4 complete in 25.63

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5596, Acc=0.7155, AUC=0.7873, TPR=0.7104, TNR=0.7205, J=0.4308, MCC=0.4308, ConfusionMatrix=
[[2670 1036]
 [1041 2553]]
Epoch 5, Phase val, Loss=0.5967, Acc=0.6901, AUC=0.7399, TPR=0.6392, TNR=0.6992, J=0.3383, MCC=0.2540, ConfusionMatrix=
[[1520  654]
 [ 140  248]]
Epoch 5, Phase test, Loss=0.6150, Acc=0.6594, AUC=0.7329, TPR=0.6559, TNR=0.6600, J=0.3159, MCC=0.2297, ConfusionMatrix=
[[1425  734]
 [ 128  244]]
Epoch 5 complete in 24.78

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5649, Acc=0.7074, AUC=0.7817, TPR=0.7135, TNR=0.7013, J=0.4148, MCC=0.4148, ConfusionMatrix=
[[2559 1090]
 [1046 2605]]
Epoch 6, Phase val, Loss=0.7100, Acc=0.6011, AUC=0.7448, TPR=0.7964, TNR=0.5662, J=0.3626, MCC=0.2601, ConfusionMatrix=
[[1231  943]
 [  79  309]]
Epoch 6, Phase test, Loss=0.7462, Acc=0.5614, AUC=0.7362, TPR=0.7823, TNR=0.5234, J=0.3056, MCC=0.2167, ConfusionMatrix=
[[1130 1029]
 [  81  291]]
Epoch 6 complete in 25.45

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5500, Acc=0.7260, AUC=0.7962, TPR=0.7345, TNR=0.7175, J=0.4521, MCC=0.4521, ConfusionMatrix=
[[2619 1031]
 [ 969 2681]]
Epoch 7, Phase val, Loss=0.5778, Acc=0.6916, AUC=0.7371, TPR=0.5954, TNR=0.7088, J=0.3042, MCC=0.2307, ConfusionMatrix=
[[1541  633]
 [ 157  231]]
Epoch 7, Phase test, Loss=0.5993, Acc=0.6839, AUC=0.7292, TPR=0.6505, TNR=0.6897, J=0.3402, MCC=0.2509, ConfusionMatrix=
[[1489  670]
 [ 130  242]]
Epoch 7 complete in 24.98

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5533, Acc=0.7173, AUC=0.7908, TPR=0.7273, TNR=0.7072, J=0.4345, MCC=0.4346, ConfusionMatrix=
[[2580 1068]
 [ 996 2656]]
Epoch 8, Phase val, Loss=0.4893, Acc=0.7701, AUC=0.7371, TPR=0.4948, TNR=0.8192, J=0.3141, MCC=0.2682, ConfusionMatrix=
[[1781  393]
 [ 196  192]]
Epoch 8, Phase test, Loss=0.5031, Acc=0.7685, AUC=0.7326, TPR=0.5215, TNR=0.8110, J=0.3325, MCC=0.2765, ConfusionMatrix=
[[1751  408]
 [ 178  194]]
Epoch 8 complete in 24.93

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5439, Acc=0.7293, AUC=0.8008, TPR=0.7405, TNR=0.7180, J=0.4585, MCC=0.4586, ConfusionMatrix=
[[2607 1024]
 [ 952 2717]]
Epoch 9, Phase val, Loss=0.6803, Acc=0.6327, AUC=0.7467, TPR=0.7345, TNR=0.6145, J=0.3491, MCC=0.2522, ConfusionMatrix=
[[1336  838]
 [ 103  285]]
New Best AUC=0.7467. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.6992, Acc=0.6057, AUC=0.7388, TPR=0.7608, TNR=0.5790, J=0.3397, MCC=0.2410, ConfusionMatrix=
[[1250  909]
 [  89  283]]
Epoch 9 complete in 26.25

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5398, Acc=0.7292, AUC=0.8048, TPR=0.7336, TNR=0.7249, J=0.4584, MCC=0.4584, ConfusionMatrix=
[[2674 1015]
 [ 962 2649]]
Epoch 10, Phase val, Loss=0.5498, Acc=0.7151, AUC=0.7397, TPR=0.5593, TNR=0.7429, J=0.3021, MCC=0.2357, ConfusionMatrix=
[[1615  559]
 [ 171  217]]
Epoch 10, Phase test, Loss=0.5760, Acc=0.7001, AUC=0.7329, TPR=0.6317, TNR=0.7119, J=0.3436, MCC=0.2571, ConfusionMatrix=
[[1537  622]
 [ 137  235]]
Epoch 10 complete in 24.73

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5487, Acc=0.7281, AUC=0.7978, TPR=0.7380, TNR=0.7181, J=0.4561, MCC=0.4562, ConfusionMatrix=
[[2611 1025]
 [ 960 2704]]
Epoch 11, Phase val, Loss=0.4601, Acc=0.7896, AUC=0.7256, TPR=0.3969, TNR=0.8597, J=0.2566, MCC=0.2399, ConfusionMatrix=
[[1869  305]
 [ 234  154]]
Epoch 11, Phase test, Loss=0.4748, Acc=0.7870, AUC=0.7210, TPR=0.4489, TNR=0.8453, J=0.2942, MCC=0.2615, ConfusionMatrix=
[[1825  334]
 [ 205  167]]
Epoch 11 complete in 25.65

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5530, Acc=0.7177, AUC=0.7928, TPR=0.7119, TNR=0.7233, J=0.4352, MCC=0.4352, ConfusionMatrix=
[[2679 1025]
 [1036 2560]]
Epoch 12, Phase val, Loss=0.4409, Acc=0.8044, AUC=0.7195, TPR=0.3531, TNR=0.8850, J=0.2381, MCC=0.2383, ConfusionMatrix=
[[1924  250]
 [ 251  137]]
Epoch 12, Phase test, Loss=0.4454, Acc=0.8131, AUC=0.7185, TPR=0.4167, TNR=0.8814, J=0.2981, MCC=0.2862, ConfusionMatrix=
[[1903  256]
 [ 217  155]]
Epoch 12 complete in 24.96

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5720, Acc=0.7101, AUC=0.7791, TPR=0.7127, TNR=0.7075, J=0.4202, MCC=0.4202, ConfusionMatrix=
[[2562 1059]
 [1057 2622]]
Epoch 13, Phase val, Loss=0.5652, Acc=0.7080, AUC=0.7397, TPR=0.5876, TNR=0.7295, J=0.3172, MCC=0.2440, ConfusionMatrix=
[[1586  588]
 [ 160  228]]
Epoch 13, Phase test, Loss=0.5942, Acc=0.6827, AUC=0.7311, TPR=0.6317, TNR=0.6915, J=0.3232, MCC=0.2390, ConfusionMatrix=
[[1493  666]
 [ 137  235]]
Epoch 13 complete in 25.68

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5389, Acc=0.7332, AUC=0.8045, TPR=0.7418, TNR=0.7242, J=0.4660, MCC=0.4661, ConfusionMatrix=
[[2597  989]
 [ 959 2755]]
Epoch 14, Phase val, Loss=0.4022, Acc=0.8279, AUC=0.7293, TPR=0.2423, TNR=0.9324, J=0.1747, MCC=0.2145, ConfusionMatrix=
[[2027  147]
 [ 294   94]]
Epoch 14, Phase test, Loss=0.4042, Acc=0.8388, AUC=0.7183, TPR=0.3172, TNR=0.9287, J=0.2459, MCC=0.2811, ConfusionMatrix=
[[2005  154]
 [ 254  118]]
Epoch 14 complete in 24.97

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5563, Acc=0.7177, AUC=0.7899, TPR=0.7205, TNR=0.7148, J=0.4353, MCC=0.4353, ConfusionMatrix=
[[2609 1041]
 [1020 2630]]
Epoch 15, Phase val, Loss=0.4973, Acc=0.7650, AUC=0.7273, TPR=0.4588, TNR=0.8197, J=0.2785, MCC=0.2400, ConfusionMatrix=
[[1782  392]
 [ 210  178]]
Epoch 15, Phase test, Loss=0.5118, Acc=0.7594, AUC=0.7212, TPR=0.4946, TNR=0.8050, J=0.2996, MCC=0.2488, ConfusionMatrix=
[[1738  421]
 [ 188  184]]
Epoch 15 complete in 24.67

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5473, Acc=0.7221, AUC=0.7963, TPR=0.7239, TNR=0.7202, J=0.4441, MCC=0.4441, ConfusionMatrix=
[[2644 1027]
 [1002 2627]]
Epoch 16, Phase val, Loss=0.4858, Acc=0.7744, AUC=0.7343, TPR=0.4742, TNR=0.8280, J=0.3022, MCC=0.2625, ConfusionMatrix=
[[1800  374]
 [ 204  184]]
Epoch 16, Phase test, Loss=0.5011, Acc=0.7641, AUC=0.7273, TPR=0.4973, TNR=0.8101, J=0.3074, MCC=0.2567, ConfusionMatrix=
[[1749  410]
 [ 187  185]]
Epoch 16 complete in 25.79

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5454, Acc=0.7240, AUC=0.7977, TPR=0.7214, TNR=0.7265, J=0.4480, MCC=0.4480, ConfusionMatrix=
[[2649  997]
 [1018 2636]]
Epoch 17, Phase val, Loss=0.6809, Acc=0.6339, AUC=0.7426, TPR=0.7294, TNR=0.6168, J=0.3462, MCC=0.2503, ConfusionMatrix=
[[1341  833]
 [ 105  283]]
Epoch 17, Phase test, Loss=0.7027, Acc=0.6081, AUC=0.7354, TPR=0.7500, TNR=0.5836, J=0.3336, MCC=0.2368, ConfusionMatrix=
[[1260  899]
 [  93  279]]
Epoch 17 complete in 25.01

Early Stop!
Training complete in 7m 35s
The best model val AUC=0.746741006648, test AUC=0.738801565838.
Finish training resnet18fixed-conv1x1-avgpool

Start training resnet18scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6007, Acc=0.6648, AUC=0.7317, TPR=0.6453, TNR=0.6841, J=0.3295, MCC=0.3297, ConfusionMatrix=
[[2506 1157]
 [1290 2347]]
Epoch 0, Phase val, Loss=0.4745, Acc=0.8368, AUC=0.7635, TPR=0.3686, TNR=0.9204, J=0.2890, MCC=0.3150, ConfusionMatrix=
[[2001  173]
 [ 245  143]]
New Best AUC=0.7635. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4810, Acc=0.8499, AUC=0.7372, TPR=0.4059, TNR=0.9264, J=0.3323, MCC=0.3589, ConfusionMatrix=
[[2000  159]
 [ 221  151]]
Epoch 0 complete in 36.73

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5399, Acc=0.7325, AUC=0.8055, TPR=0.6477, TNR=0.8187, J=0.4664, MCC=0.4730, ConfusionMatrix=
[[2963  656]
 [1297 2384]]
Epoch 1, Phase val, Loss=0.4481, Acc=0.8361, AUC=0.7964, TPR=0.5026, TNR=0.8956, J=0.3982, MCC=0.3848, ConfusionMatrix=
[[1947  227]
 [ 193  195]]
New Best AUC=0.7964. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4574, Acc=0.8447, AUC=0.7632, TPR=0.4624, TNR=0.9106, J=0.3730, MCC=0.3759, ConfusionMatrix=
[[1966  193]
 [ 200  172]]
Epoch 1 complete in 36.95

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5271, Acc=0.7423, AUC=0.8142, TPR=0.6835, TNR=0.8004, J=0.4839, MCC=0.4874, ConfusionMatrix=
[[2940  733]
 [1148 2479]]
Epoch 2, Phase val, Loss=0.6051, Acc=0.7564, AUC=0.7953, TPR=0.6881, TNR=0.7686, J=0.4568, MCC=0.3571, ConfusionMatrix=
[[1671  503]
 [ 121  267]]
Epoch 2, Phase test, Loss=0.6095, Acc=0.7424, AUC=0.7740, TPR=0.6532, TNR=0.7578, J=0.4110, MCC=0.3168, ConfusionMatrix=
[[1636  523]
 [ 129  243]]
Epoch 2 complete in 37.54

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4961, Acc=0.7644, AUC=0.8380, TPR=0.7113, TNR=0.8174, J=0.5287, MCC=0.5317, ConfusionMatrix=
[[2986  667]
 [1053 2594]]
Epoch 3, Phase val, Loss=0.4946, Acc=0.8021, AUC=0.8079, TPR=0.6753, TNR=0.8247, J=0.5000, MCC=0.4134, ConfusionMatrix=
[[1793  381]
 [ 126  262]]
New Best AUC=0.8079. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5095, Acc=0.7922, AUC=0.7904, TPR=0.6505, TNR=0.8166, J=0.4671, MCC=0.3809, ConfusionMatrix=
[[1763  396]
 [ 130  242]]
Epoch 3 complete in 36.66

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4864, Acc=0.7740, AUC=0.8482, TPR=0.7231, TNR=0.8230, J=0.5461, MCC=0.5493, ConfusionMatrix=
[[3060  658]
 [ 992 2590]]
Epoch 4, Phase val, Loss=0.5785, Acc=0.7537, AUC=0.8022, TPR=0.7345, TNR=0.7571, J=0.4917, MCC=0.3787, ConfusionMatrix=
[[1646  528]
 [ 103  285]]
Epoch 4, Phase test, Loss=0.5852, Acc=0.7467, AUC=0.7899, TPR=0.7043, TNR=0.7541, J=0.4584, MCC=0.3499, ConfusionMatrix=
[[1628  531]
 [ 110  262]]
Epoch 4 complete in 36.45

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4865, Acc=0.7733, AUC=0.8468, TPR=0.7304, TNR=0.8164, J=0.5467, MCC=0.5487, ConfusionMatrix=
[[2974  669]
 [ 986 2671]]
Epoch 5, Phase val, Loss=0.4740, Acc=0.8091, AUC=0.8027, TPR=0.6263, TNR=0.8418, J=0.4681, MCC=0.3992, ConfusionMatrix=
[[1830  344]
 [ 145  243]]
Epoch 5, Phase test, Loss=0.4734, Acc=0.7965, AUC=0.7875, TPR=0.6398, TNR=0.8235, J=0.4633, MCC=0.3817, ConfusionMatrix=
[[1778  381]
 [ 134  238]]
Epoch 5 complete in 36.25

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4806, Acc=0.7811, AUC=0.8506, TPR=0.7373, TNR=0.8231, J=0.5604, MCC=0.5630, ConfusionMatrix=
[[3066  659]
 [ 939 2636]]
Epoch 6, Phase val, Loss=0.8552, Acc=0.6542, AUC=0.8113, TPR=0.8376, TNR=0.6214, J=0.4591, MCC=0.3309, ConfusionMatrix=
[[1351  823]
 [  63  325]]
New Best AUC=0.8113. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.8918, Acc=0.6175, AUC=0.7843, TPR=0.7796, TNR=0.5896, J=0.3692, MCC=0.2621, ConfusionMatrix=
[[1273  886]
 [  82  290]]
Epoch 6 complete in 37.54

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4733, Acc=0.7859, AUC=0.8575, TPR=0.7549, TNR=0.8174, J=0.5723, MCC=0.5732, ConfusionMatrix=
[[2959  661]
 [ 902 2778]]
Epoch 7, Phase val, Loss=0.4519, Acc=0.8091, AUC=0.8222, TPR=0.6340, TNR=0.8404, J=0.4744, MCC=0.4032, ConfusionMatrix=
[[1827  347]
 [ 142  246]]
New Best AUC=0.8222. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.4761, Acc=0.8040, AUC=0.8002, TPR=0.6505, TNR=0.8305, J=0.4810, MCC=0.3987, ConfusionMatrix=
[[1793  366]
 [ 130  242]]
Epoch 7 complete in 36.97

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4789, Acc=0.7816, AUC=0.8527, TPR=0.7495, TNR=0.8138, J=0.5633, MCC=0.5645, ConfusionMatrix=
[[2968  679]
 [ 915 2738]]
Epoch 8, Phase val, Loss=0.3874, Acc=0.8450, AUC=0.7975, TPR=0.4124, TNR=0.9223, J=0.3346, MCC=0.3586, ConfusionMatrix=
[[2005  169]
 [ 228  160]]
Epoch 8, Phase test, Loss=0.3836, Acc=0.8613, AUC=0.7790, TPR=0.4274, TNR=0.9361, J=0.3635, MCC=0.3999, ConfusionMatrix=
[[2021  138]
 [ 213  159]]
Epoch 8 complete in 36.29

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4513, Acc=0.7985, AUC=0.8709, TPR=0.7614, TNR=0.8346, J=0.5961, MCC=0.5980, ConfusionMatrix=
[[3084  611]
 [ 860 2745]]
Epoch 9, Phase val, Loss=0.6901, Acc=0.6905, AUC=0.8031, TPR=0.7990, TNR=0.6711, J=0.4701, MCC=0.3440, ConfusionMatrix=
[[1459  715]
 [  78  310]]
Epoch 9, Phase test, Loss=0.7212, Acc=0.6677, AUC=0.7957, TPR=0.7688, TNR=0.6503, J=0.4191, MCC=0.3016, ConfusionMatrix=
[[1404  755]
 [  86  286]]
Epoch 9 complete in 36.47

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4459, Acc=0.8007, AUC=0.8742, TPR=0.7784, TNR=0.8235, J=0.6019, MCC=0.6023, ConfusionMatrix=
[[2968  636]
 [ 819 2877]]
Epoch 10, Phase val, Loss=0.5396, Acc=0.7869, AUC=0.8021, TPR=0.6598, TNR=0.8096, J=0.4694, MCC=0.3829, ConfusionMatrix=
[[1760  414]
 [ 132  256]]
Epoch 10, Phase test, Loss=0.5448, Acc=0.7764, AUC=0.7866, TPR=0.6640, TNR=0.7957, J=0.4597, MCC=0.3659, ConfusionMatrix=
[[1718  441]
 [ 125  247]]
Epoch 10 complete in 36.34

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4385, Acc=0.8073, AUC=0.8796, TPR=0.7939, TNR=0.8211, J=0.6150, MCC=0.6150, ConfusionMatrix=
[[2946  642]
 [ 765 2947]]
Epoch 11, Phase val, Loss=0.4321, Acc=0.8220, AUC=0.7855, TPR=0.5206, TNR=0.8758, J=0.3964, MCC=0.3666, ConfusionMatrix=
[[1904  270]
 [ 186  202]]
Epoch 11, Phase test, Loss=0.4300, Acc=0.8285, AUC=0.7766, TPR=0.5565, TNR=0.8754, J=0.4319, MCC=0.3913, ConfusionMatrix=
[[1890  269]
 [ 165  207]]
Epoch 11 complete in 38.09

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4348, Acc=0.8079, AUC=0.8806, TPR=0.7783, TNR=0.8379, J=0.6162, MCC=0.6172, ConfusionMatrix=
[[3040  588]
 [ 814 2858]]
Epoch 12, Phase val, Loss=0.4250, Acc=0.8407, AUC=0.7995, TPR=0.5696, TNR=0.8891, J=0.4587, MCC=0.4277, ConfusionMatrix=
[[1933  241]
 [ 167  221]]
Epoch 12, Phase test, Loss=0.4381, Acc=0.8341, AUC=0.7801, TPR=0.5538, TNR=0.8824, J=0.4361, MCC=0.4004, ConfusionMatrix=
[[1905  254]
 [ 166  206]]
Epoch 12 complete in 36.52

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4238, Acc=0.8151, AUC=0.8875, TPR=0.7878, TNR=0.8425, J=0.6303, MCC=0.6312, ConfusionMatrix=
[[3066  573]
 [ 777 2884]]
Epoch 13, Phase val, Loss=0.4561, Acc=0.8220, AUC=0.7749, TPR=0.5309, TNR=0.8740, J=0.4049, MCC=0.3720, ConfusionMatrix=
[[1900  274]
 [ 182  206]]
Epoch 13, Phase test, Loss=0.4721, Acc=0.8222, AUC=0.7670, TPR=0.5645, TNR=0.8666, J=0.4311, MCC=0.3840, ConfusionMatrix=
[[1871  288]
 [ 162  210]]
Epoch 13 complete in 36.33

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4303, Acc=0.8115, AUC=0.8837, TPR=0.7980, TNR=0.8250, J=0.6231, MCC=0.6233, ConfusionMatrix=
[[3004  637]
 [ 739 2920]]
Epoch 14, Phase val, Loss=0.5112, Acc=0.7845, AUC=0.8027, TPR=0.6907, TNR=0.8013, J=0.4920, MCC=0.3958, ConfusionMatrix=
[[1742  432]
 [ 120  268]]
Epoch 14, Phase test, Loss=0.5396, Acc=0.7586, AUC=0.7787, TPR=0.6720, TNR=0.7735, J=0.4455, MCC=0.3470, ConfusionMatrix=
[[1670  489]
 [ 122  250]]
Epoch 14 complete in 36.48

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4235, Acc=0.8136, AUC=0.8871, TPR=0.7838, TNR=0.8430, J=0.6267, MCC=0.6280, ConfusionMatrix=
[[3097  577]
 [ 784 2842]]
Epoch 15, Phase val, Loss=0.8835, Acc=0.6202, AUC=0.7932, TPR=0.8557, TNR=0.5782, J=0.4339, MCC=0.3112, ConfusionMatrix=
[[1257  917]
 [  56  332]]
Epoch 15, Phase test, Loss=0.9568, Acc=0.5618, AUC=0.7824, TPR=0.8333, TNR=0.5151, J=0.3484, MCC=0.2474, ConfusionMatrix=
[[1112 1047]
 [  62  310]]
Epoch 15 complete in 36.48

Early Stop!
Training complete in 9m 48s
The best model val AUC=0.82217443261, test AUC=0.800175061134.
Finish training resnet18scratch-conv1x1ab-maxpool

Start training resnet18scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5990, Acc=0.6597, AUC=0.7402, TPR=0.6647, TNR=0.6548, J=0.3194, MCC=0.3195, ConfusionMatrix=
[[2386 1258]
 [1226 2430]]
Epoch 0, Phase val, Loss=0.7462, Acc=0.5909, AUC=0.7854, TPR=0.8299, TNR=0.5483, J=0.3782, MCC=0.2712, ConfusionMatrix=
[[1192  982]
 [  66  322]]
New Best AUC=0.7854. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7710, Acc=0.5555, AUC=0.7675, TPR=0.8172, TNR=0.5104, J=0.3276, MCC=0.2327, ConfusionMatrix=
[[1102 1057]
 [  68  304]]
Epoch 0 complete in 37.56

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5418, Acc=0.7247, AUC=0.8006, TPR=0.6444, TNR=0.8044, J=0.4488, MCC=0.4548, ConfusionMatrix=
[[2945  716]
 [1294 2345]]
Epoch 1, Phase val, Loss=0.9291, Acc=0.5640, AUC=0.7935, TPR=0.8789, TNR=0.5078, J=0.3867, MCC=0.2787, ConfusionMatrix=
[[1104 1070]
 [  47  341]]
New Best AUC=0.7935. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.9469, Acc=0.5373, AUC=0.7726, TPR=0.8360, TNR=0.4859, J=0.3219, MCC=0.2297, ConfusionMatrix=
[[1049 1110]
 [  61  311]]
Epoch 1 complete in 36.72

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5252, Acc=0.7481, AUC=0.8182, TPR=0.6930, TNR=0.8053, J=0.4983, MCC=0.5009, ConfusionMatrix=
[[2883  697]
 [1142 2578]]
Epoch 2, Phase val, Loss=0.4798, Acc=0.8181, AUC=0.7873, TPR=0.5490, TNR=0.8661, J=0.4151, MCC=0.3743, ConfusionMatrix=
[[1883  291]
 [ 175  213]]
Epoch 2, Phase test, Loss=0.4838, Acc=0.8222, AUC=0.7861, TPR=0.5618, TNR=0.8671, J=0.4289, MCC=0.3826, ConfusionMatrix=
[[1872  287]
 [ 163  209]]
Epoch 2 complete in 36.26

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5021, Acc=0.7668, AUC=0.8343, TPR=0.7127, TNR=0.8187, J=0.5314, MCC=0.5350, ConfusionMatrix=
[[3053  676]
 [1026 2545]]
Epoch 3, Phase val, Loss=0.4991, Acc=0.8025, AUC=0.8065, TPR=0.6469, TNR=0.8303, J=0.4772, MCC=0.3994, ConfusionMatrix=
[[1805  369]
 [ 137  251]]
New Best AUC=0.8065. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5175, Acc=0.7859, AUC=0.7835, TPR=0.6237, TNR=0.8138, J=0.4375, MCC=0.3575, ConfusionMatrix=
[[1757  402]
 [ 140  232]]
Epoch 3 complete in 37.82

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4721, Acc=0.7848, AUC=0.8587, TPR=0.7549, TNR=0.8154, J=0.5703, MCC=0.5711, ConfusionMatrix=
[[2941  666]
 [ 905 2788]]
Epoch 4, Phase val, Loss=0.6637, Acc=0.6632, AUC=0.7938, TPR=0.8093, TNR=0.6371, J=0.4464, MCC=0.3232, ConfusionMatrix=
[[1385  789]
 [  74  314]]
Epoch 4, Phase test, Loss=0.6745, Acc=0.6464, AUC=0.7855, TPR=0.7876, TNR=0.6220, J=0.4097, MCC=0.2924, ConfusionMatrix=
[[1343  816]
 [  79  293]]
Epoch 4 complete in 36.20

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4773, Acc=0.7812, AUC=0.8539, TPR=0.7432, TNR=0.8194, J=0.5626, MCC=0.5642, ConfusionMatrix=
[[2986  658]
 [ 939 2717]]
Epoch 5, Phase val, Loss=0.4866, Acc=0.8126, AUC=0.8033, TPR=0.6057, TNR=0.8496, J=0.4553, MCC=0.3944, ConfusionMatrix=
[[1847  327]
 [ 153  235]]
Epoch 5, Phase test, Loss=0.4652, Acc=0.8392, AUC=0.7870, TPR=0.5699, TNR=0.8856, J=0.4555, MCC=0.4186, ConfusionMatrix=
[[1912  247]
 [ 160  212]]
Epoch 5 complete in 36.26

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4861, Acc=0.7755, AUC=0.8476, TPR=0.7394, TNR=0.8125, J=0.5519, MCC=0.5530, ConfusionMatrix=
[[2929  676]
 [ 963 2732]]
Epoch 6, Phase val, Loss=0.5100, Acc=0.7974, AUC=0.7969, TPR=0.6134, TNR=0.8303, J=0.4437, MCC=0.3741, ConfusionMatrix=
[[1805  369]
 [ 150  238]]
Epoch 6, Phase test, Loss=0.5089, Acc=0.8021, AUC=0.7855, TPR=0.6452, TNR=0.8291, J=0.4742, MCC=0.3928, ConfusionMatrix=
[[1790  369]
 [ 132  240]]
Epoch 6 complete in 36.28

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4644, Acc=0.7893, AUC=0.8632, TPR=0.7556, TNR=0.8218, J=0.5775, MCC=0.5791, ConfusionMatrix=
[[3053  662]
 [ 876 2709]]
Epoch 7, Phase val, Loss=0.4759, Acc=0.7865, AUC=0.7899, TPR=0.6186, TNR=0.8165, J=0.4350, MCC=0.3604, ConfusionMatrix=
[[1775  399]
 [ 148  240]]
Epoch 7, Phase test, Loss=0.4605, Acc=0.8052, AUC=0.7847, TPR=0.6183, TNR=0.8374, J=0.4557, MCC=0.3837, ConfusionMatrix=
[[1808  351]
 [ 142  230]]
Epoch 7 complete in 36.28

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4691, Acc=0.7874, AUC=0.8593, TPR=0.7471, TNR=0.8272, J=0.5743, MCC=0.5763, ConfusionMatrix=
[[3039  635]
 [ 917 2709]]
Epoch 8, Phase val, Loss=0.4659, Acc=0.8154, AUC=0.7510, TPR=0.5129, TNR=0.8694, J=0.3823, MCC=0.3503, ConfusionMatrix=
[[1890  284]
 [ 189  199]]
Epoch 8, Phase test, Loss=0.4728, Acc=0.8175, AUC=0.7397, TPR=0.4973, TNR=0.8726, J=0.3699, MCC=0.3397, ConfusionMatrix=
[[1884  275]
 [ 187  185]]
Epoch 8 complete in 37.34

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4476, Acc=0.7984, AUC=0.8746, TPR=0.7813, TNR=0.8161, J=0.5974, MCC=0.5974, ConfusionMatrix=
[[2924  659]
 [ 813 2904]]
Epoch 9, Phase val, Loss=0.4693, Acc=0.7966, AUC=0.7849, TPR=0.5696, TNR=0.8372, J=0.4068, MCC=0.3495, ConfusionMatrix=
[[1820  354]
 [ 167  221]]
Epoch 9, Phase test, Loss=0.4640, Acc=0.8040, AUC=0.7722, TPR=0.5591, TNR=0.8462, J=0.4054, MCC=0.3504, ConfusionMatrix=
[[1827  332]
 [ 164  208]]
Epoch 9 complete in 36.27

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4397, Acc=0.8018, AUC=0.8777, TPR=0.7735, TNR=0.8302, J=0.6036, MCC=0.6046, ConfusionMatrix=
[[3026  619]
 [ 828 2827]]
Epoch 10, Phase val, Loss=0.4787, Acc=0.8185, AUC=0.7923, TPR=0.6031, TNR=0.8569, J=0.4600, MCC=0.4030, ConfusionMatrix=
[[1863  311]
 [ 154  234]]
Epoch 10, Phase test, Loss=0.4810, Acc=0.8155, AUC=0.7732, TPR=0.5995, TNR=0.8527, J=0.4522, MCC=0.3905, ConfusionMatrix=
[[1841  318]
 [ 149  223]]
Epoch 10 complete in 36.40

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4339, Acc=0.8056, AUC=0.8817, TPR=0.7796, TNR=0.8313, J=0.6109, MCC=0.6118, ConfusionMatrix=
[[3055  620]
 [ 799 2826]]
Epoch 11, Phase val, Loss=0.4496, Acc=0.8247, AUC=0.7675, TPR=0.5052, TNR=0.8818, J=0.3869, MCC=0.3636, ConfusionMatrix=
[[1917  257]
 [ 192  196]]
Epoch 11, Phase test, Loss=0.4524, Acc=0.8435, AUC=0.7584, TPR=0.5108, TNR=0.9009, J=0.4116, MCC=0.3980, ConfusionMatrix=
[[1945  214]
 [ 182  190]]
Epoch 11 complete in 36.21

Early Stop!
Training complete in 7m 20s
The best model val AUC=0.806524388509, test AUC=0.783493204241.
Finish training resnet18scratch-conv1x1ab-maxpool

Start training resnet18scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6013, Acc=0.6547, AUC=0.7313, TPR=0.6570, TNR=0.6523, J=0.3093, MCC=0.3093, ConfusionMatrix=
[[2362 1259]
 [1262 2417]]
Epoch 0, Phase val, Loss=0.7029, Acc=0.5913, AUC=0.7689, TPR=0.8093, TNR=0.5524, J=0.3617, MCC=0.2593, ConfusionMatrix=
[[1201  973]
 [  74  314]]
New Best AUC=0.7689. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7284, Acc=0.5678, AUC=0.7679, TPR=0.8145, TNR=0.5252, J=0.3398, MCC=0.2409, ConfusionMatrix=
[[1134 1025]
 [  69  303]]
Epoch 0 complete in 37.04

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5502, Acc=0.7325, AUC=0.8016, TPR=0.6709, TNR=0.7962, J=0.4671, MCC=0.4703, ConfusionMatrix=
[[2856  731]
 [1222 2491]]
Epoch 1, Phase val, Loss=0.5636, Acc=0.7057, AUC=0.7944, TPR=0.7423, TNR=0.6992, J=0.4414, MCC=0.3282, ConfusionMatrix=
[[1520  654]
 [ 100  288]]
New Best AUC=0.7944. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5641, Acc=0.7171, AUC=0.7719, TPR=0.7070, TNR=0.7189, J=0.4258, MCC=0.3175, ConfusionMatrix=
[[1552  607]
 [ 109  263]]
Epoch 1 complete in 38.05

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5128, Acc=0.7555, AUC=0.8251, TPR=0.6956, TNR=0.8155, J=0.5111, MCC=0.5147, ConfusionMatrix=
[[2974  673]
 [1112 2541]]
Epoch 2, Phase val, Loss=0.4996, Acc=0.8072, AUC=0.8103, TPR=0.6108, TNR=0.8422, J=0.4531, MCC=0.3881, ConfusionMatrix=
[[1831  343]
 [ 151  237]]
New Best AUC=0.8103. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5146, Acc=0.8068, AUC=0.7865, TPR=0.6263, TNR=0.8379, J=0.4642, MCC=0.3904, ConfusionMatrix=
[[1809  350]
 [ 139  233]]
Epoch 2 complete in 36.65

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5115, Acc=0.7619, AUC=0.8283, TPR=0.7177, TNR=0.8069, J=0.5246, MCC=0.5265, ConfusionMatrix=
[[2920  699]
 [1039 2642]]
Epoch 3, Phase val, Loss=0.6777, Acc=0.6534, AUC=0.8089, TPR=0.8402, TNR=0.6201, J=0.4603, MCC=0.3317, ConfusionMatrix=
[[1348  826]
 [  62  326]]
Epoch 3, Phase test, Loss=0.6927, Acc=0.6211, AUC=0.7904, TPR=0.7876, TNR=0.5924, J=0.3800, MCC=0.2699, ConfusionMatrix=
[[1279  880]
 [  79  293]]
Epoch 3 complete in 36.07

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4981, Acc=0.7659, AUC=0.8391, TPR=0.7160, TNR=0.8153, J=0.5312, MCC=0.5340, ConfusionMatrix=
[[2992  678]
 [1031 2599]]
Epoch 4, Phase val, Loss=0.5077, Acc=0.7701, AUC=0.8053, TPR=0.6727, TNR=0.7875, J=0.4602, MCC=0.3665, ConfusionMatrix=
[[1712  462]
 [ 127  261]]
Epoch 4, Phase test, Loss=0.5213, Acc=0.7843, AUC=0.7790, TPR=0.6747, TNR=0.8031, J=0.4779, MCC=0.3824, ConfusionMatrix=
[[1734  425]
 [ 121  251]]
Epoch 4 complete in 36.30

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4967, Acc=0.7736, AUC=0.8398, TPR=0.7594, TNR=0.7882, J=0.5475, MCC=0.5476, ConfusionMatrix=
[[2835  762]
 [ 891 2812]]
Epoch 5, Phase val, Loss=0.4855, Acc=0.7939, AUC=0.8091, TPR=0.7062, TNR=0.8096, J=0.5158, MCC=0.4172, ConfusionMatrix=
[[1760  414]
 [ 114  274]]
Epoch 5, Phase test, Loss=0.4987, Acc=0.7839, AUC=0.7950, TPR=0.6801, TNR=0.8018, J=0.4819, MCC=0.3847, ConfusionMatrix=
[[1731  428]
 [ 119  253]]
Epoch 5 complete in 36.25

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4810, Acc=0.7748, AUC=0.8506, TPR=0.7380, TNR=0.8112, J=0.5492, MCC=0.5508, ConfusionMatrix=
[[2977  693]
 [ 951 2679]]
Epoch 6, Phase val, Loss=1.8072, Acc=0.4219, AUC=0.7526, TPR=0.9227, TNR=0.3326, J=0.2552, MCC=0.2009, ConfusionMatrix=
[[ 723 1451]
 [  30  358]]
Epoch 6, Phase test, Loss=1.8878, Acc=0.4089, AUC=0.7421, TPR=0.9113, TNR=0.3224, J=0.2337, MCC=0.1827, ConfusionMatrix=
[[ 696 1463]
 [  33  339]]
Epoch 6 complete in 37.08

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4728, Acc=0.7785, AUC=0.8564, TPR=0.7529, TNR=0.8044, J=0.5573, MCC=0.5579, ConfusionMatrix=
[[2919  710]
 [ 907 2764]]
Epoch 7, Phase val, Loss=0.4284, Acc=0.8193, AUC=0.8053, TPR=0.5593, TNR=0.8657, J=0.4250, MCC=0.3818, ConfusionMatrix=
[[1882  292]
 [ 171  217]]
Epoch 7, Phase test, Loss=0.4331, Acc=0.8317, AUC=0.7891, TPR=0.5726, TNR=0.8763, J=0.4489, MCC=0.4055, ConfusionMatrix=
[[1892  267]
 [ 159  213]]
Epoch 7 complete in 36.28

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4613, Acc=0.7899, AUC=0.8635, TPR=0.7615, TNR=0.8187, J=0.5802, MCC=0.5810, ConfusionMatrix=
[[2962  656]
 [ 878 2804]]
Epoch 8, Phase val, Loss=0.5792, Acc=0.7420, AUC=0.7909, TPR=0.7036, TNR=0.7489, J=0.4525, MCC=0.3478, ConfusionMatrix=
[[1628  546]
 [ 115  273]]
Epoch 8, Phase test, Loss=0.6108, Acc=0.7301, AUC=0.7812, TPR=0.6559, TNR=0.7429, J=0.3989, MCC=0.3039, ConfusionMatrix=
[[1604  555]
 [ 128  244]]
Epoch 8 complete in 36.27

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4419, Acc=0.8010, AUC=0.8760, TPR=0.7724, TNR=0.8300, J=0.6023, MCC=0.6032, ConfusionMatrix=
[[3007  616]
 [ 837 2840]]
Epoch 9, Phase val, Loss=0.5774, Acc=0.7654, AUC=0.8087, TPR=0.7191, TNR=0.7737, J=0.4928, MCC=0.3851, ConfusionMatrix=
[[1682  492]
 [ 109  279]]
Epoch 9, Phase test, Loss=0.5623, Acc=0.7554, AUC=0.7982, TPR=0.7151, TNR=0.7624, J=0.4774, MCC=0.3663, ConfusionMatrix=
[[1646  513]
 [ 106  266]]
Epoch 9 complete in 36.16

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4557, Acc=0.7919, AUC=0.8679, TPR=0.7673, TNR=0.8164, J=0.5837, MCC=0.5845, ConfusionMatrix=
[[2988  672]
 [ 847 2793]]
Epoch 10, Phase val, Loss=0.4184, Acc=0.8345, AUC=0.7846, TPR=0.4742, TNR=0.8988, J=0.3730, MCC=0.3669, ConfusionMatrix=
[[1954  220]
 [ 204  184]]
Epoch 10, Phase test, Loss=0.4034, Acc=0.8507, AUC=0.7789, TPR=0.5081, TNR=0.9097, J=0.4177, MCC=0.4123, ConfusionMatrix=
[[1964  195]
 [ 183  189]]
Epoch 10 complete in 36.27

Early Stop!
Training complete in 6m 42s
The best model val AUC=0.810308567039, test AUC=0.786491406316.
Finish training resnet18scratch-conv1x1ab-maxpool

Start training resnet18scratch-conv1x1ab-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6077, Acc=0.6595, AUC=0.7276, TPR=0.6477, TNR=0.6715, J=0.3191, MCC=0.3192, ConfusionMatrix=
[[2426 1187]
 [1299 2388]]
Epoch 0, Phase val, Loss=0.7564, Acc=0.6366, AUC=0.7853, TPR=0.7835, TNR=0.6104, J=0.3939, MCC=0.2839, ConfusionMatrix=
[[1327  847]
 [  84  304]]
New Best AUC=0.7853. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7827, Acc=0.6215, AUC=0.7796, TPR=0.7876, TNR=0.5929, J=0.3805, MCC=0.2702, ConfusionMatrix=
[[1280  879]
 [  79  293]]
Epoch 0 complete in 36.98

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5369, Acc=0.7352, AUC=0.8069, TPR=0.6482, TNR=0.8198, J=0.4680, MCC=0.4756, ConfusionMatrix=
[[3034  667]
 [1266 2333]]
Epoch 1, Phase val, Loss=0.4440, Acc=0.8384, AUC=0.7981, TPR=0.4716, TNR=0.9039, J=0.3755, MCC=0.3739, ConfusionMatrix=
[[1965  209]
 [ 205  183]]
New Best AUC=0.7981. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4580, Acc=0.8574, AUC=0.7671, TPR=0.5081, TNR=0.9176, J=0.4256, MCC=0.4280, ConfusionMatrix=
[[1981  178]
 [ 183  189]]
Epoch 1 complete in 36.64

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5292, Acc=0.7479, AUC=0.8168, TPR=0.6857, TNR=0.8091, J=0.4948, MCC=0.4989, ConfusionMatrix=
[[2980  703]
 [1137 2480]]
Epoch 2, Phase val, Loss=0.4006, Acc=0.8474, AUC=0.7235, TPR=0.1675, TNR=0.9687, J=0.1362, MCC=0.2202, ConfusionMatrix=
[[2106   68]
 [ 323   65]]
Epoch 2, Phase test, Loss=0.4010, Acc=0.8475, AUC=0.7053, TPR=0.1882, TNR=0.9611, J=0.1493, MCC=0.2211, ConfusionMatrix=
[[2075   84]
 [ 302   70]]
Epoch 2 complete in 36.32

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5043, Acc=0.7604, AUC=0.8326, TPR=0.7100, TNR=0.8117, J=0.5216, MCC=0.5241, ConfusionMatrix=
[[2939  682]
 [1067 2612]]
Epoch 3, Phase val, Loss=0.5001, Acc=0.7806, AUC=0.8063, TPR=0.6392, TNR=0.8059, J=0.4451, MCC=0.3631, ConfusionMatrix=
[[1752  422]
 [ 140  248]]
New Best AUC=0.8063. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5153, Acc=0.7859, AUC=0.7858, TPR=0.6586, TNR=0.8078, J=0.4664, MCC=0.3761, ConfusionMatrix=
[[1744  415]
 [ 127  245]]
Epoch 3 complete in 37.77

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5087, Acc=0.7593, AUC=0.8312, TPR=0.7198, TNR=0.7988, J=0.5186, MCC=0.5202, ConfusionMatrix=
[[2918  735]
 [1022 2625]]
Epoch 4, Phase val, Loss=0.5028, Acc=0.7947, AUC=0.8080, TPR=0.6392, TNR=0.8224, J=0.4616, MCC=0.3835, ConfusionMatrix=
[[1788  386]
 [ 140  248]]
New Best AUC=0.8080. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5078, Acc=0.7894, AUC=0.7907, TPR=0.6344, TNR=0.8161, J=0.4505, MCC=0.3684, ConfusionMatrix=
[[1762  397]
 [ 136  236]]
Epoch 4 complete in 36.54

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4891, Acc=0.7749, AUC=0.8447, TPR=0.7333, TNR=0.8156, J=0.5489, MCC=0.5510, ConfusionMatrix=
[[3012  681]
 [ 962 2645]]
Epoch 5, Phase val, Loss=0.5817, Acc=0.7283, AUC=0.8063, TPR=0.7474, TNR=0.7249, J=0.4724, MCC=0.3558, ConfusionMatrix=
[[1576  598]
 [  98  290]]
Epoch 5, Phase test, Loss=0.6006, Acc=0.7092, AUC=0.7943, TPR=0.7339, TNR=0.7050, J=0.4388, MCC=0.3238, ConfusionMatrix=
[[1522  637]
 [  99  273]]
Epoch 5 complete in 36.26

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4722, Acc=0.7845, AUC=0.8570, TPR=0.7476, TNR=0.8201, J=0.5677, MCC=0.5696, ConfusionMatrix=
[[3049  669]
 [ 904 2678]]
Epoch 6, Phase val, Loss=0.5412, Acc=0.7689, AUC=0.7959, TPR=0.6495, TNR=0.7902, J=0.4397, MCC=0.3525, ConfusionMatrix=
[[1718  456]
 [ 136  252]]
Epoch 6, Phase test, Loss=0.5557, Acc=0.7550, AUC=0.7698, TPR=0.6532, TNR=0.7726, J=0.4258, MCC=0.3323, ConfusionMatrix=
[[1668  491]
 [ 129  243]]
Epoch 6 complete in 36.24

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4691, Acc=0.7818, AUC=0.8589, TPR=0.7575, TNR=0.8066, J=0.5640, MCC=0.5646, ConfusionMatrix=
[[2915  699]
 [ 894 2792]]
Epoch 7, Phase val, Loss=0.5034, Acc=0.7990, AUC=0.7878, TPR=0.6237, TNR=0.8303, J=0.4540, MCC=0.3819, ConfusionMatrix=
[[1805  369]
 [ 146  242]]
Epoch 7, Phase test, Loss=0.5013, Acc=0.7934, AUC=0.7780, TPR=0.6371, TNR=0.8203, J=0.4574, MCC=0.3756, ConfusionMatrix=
[[1771  388]
 [ 135  237]]
Epoch 7 complete in 36.23

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4644, Acc=0.7944, AUC=0.8631, TPR=0.7647, TNR=0.8234, J=0.5881, MCC=0.5893, ConfusionMatrix=
[[3040  652]
 [ 849 2759]]
Epoch 8, Phase val, Loss=0.4452, Acc=0.8169, AUC=0.7859, TPR=0.5773, TNR=0.8597, J=0.4370, MCC=0.3870, ConfusionMatrix=
[[1869  305]
 [ 164  224]]
Epoch 8, Phase test, Loss=0.4335, Acc=0.8289, AUC=0.7830, TPR=0.5941, TNR=0.8694, J=0.4635, MCC=0.4112, ConfusionMatrix=
[[1877  282]
 [ 151  221]]
Epoch 8 complete in 37.30

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4614, Acc=0.7942, AUC=0.8647, TPR=0.7613, TNR=0.8265, J=0.5879, MCC=0.5893, ConfusionMatrix=
[[3045  639]
 [ 863 2753]]
Epoch 9, Phase val, Loss=0.3896, Acc=0.8474, AUC=0.7539, TPR=0.3041, TNR=0.9443, J=0.2485, MCC=0.3063, ConfusionMatrix=
[[2053  121]
 [ 270  118]]
Epoch 9, Phase test, Loss=0.3726, Acc=0.8613, AUC=0.7744, TPR=0.3522, TNR=0.9491, J=0.3012, MCC=0.3634, ConfusionMatrix=
[[2049  110]
 [ 241  131]]
Epoch 9 complete in 36.22

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4608, Acc=0.7916, AUC=0.8656, TPR=0.7617, TNR=0.8213, J=0.5830, MCC=0.5842, ConfusionMatrix=
[[3011  655]
 [ 866 2768]]
Epoch 10, Phase val, Loss=0.5754, Acc=0.7315, AUC=0.7909, TPR=0.7191, TNR=0.7337, J=0.4527, MCC=0.3439, ConfusionMatrix=
[[1595  579]
 [ 109  279]]
Epoch 10, Phase test, Loss=0.5955, Acc=0.7203, AUC=0.7925, TPR=0.7204, TNR=0.7202, J=0.4407, MCC=0.3283, ConfusionMatrix=
[[1555  604]
 [ 104  268]]
Epoch 10 complete in 36.42

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4547, Acc=0.7942, AUC=0.8684, TPR=0.7731, TNR=0.8150, J=0.5880, MCC=0.5887, ConfusionMatrix=
[[3008  683]
 [ 819 2790]]
Epoch 11, Phase val, Loss=0.4415, Acc=0.8150, AUC=0.7688, TPR=0.4974, TNR=0.8717, J=0.3691, MCC=0.3413, ConfusionMatrix=
[[1895  279]
 [ 195  193]]
Epoch 11, Phase test, Loss=0.4269, Acc=0.8317, AUC=0.7750, TPR=0.5430, TNR=0.8814, J=0.4244, MCC=0.3904, ConfusionMatrix=
[[1903  256]
 [ 170  202]]
Epoch 11 complete in 36.19

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4472, Acc=0.8030, AUC=0.8732, TPR=0.7783, TNR=0.8276, J=0.6059, MCC=0.6067, ConfusionMatrix=
[[3029  631]
 [ 807 2833]]
Epoch 12, Phase val, Loss=0.4599, Acc=0.8126, AUC=0.7768, TPR=0.5696, TNR=0.8560, J=0.4256, MCC=0.3756, ConfusionMatrix=
[[1861  313]
 [ 167  221]]
Epoch 12, Phase test, Loss=0.4534, Acc=0.8127, AUC=0.7681, TPR=0.5699, TNR=0.8546, J=0.4245, MCC=0.3704, ConfusionMatrix=
[[1845  314]
 [ 160  212]]
Epoch 12 complete in 36.21

Early Stop!
Training complete in 7m 55s
The best model val AUC=0.808013401113, test AUC=0.790702336307.
Finish training resnet18scratch-conv1x1ab-maxpool

Start training resnet18scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6151, Acc=0.6462, AUC=0.7322, TPR=0.7756, TNR=0.5145, J=0.2901, MCC=0.3007, ConfusionMatrix=
[[1862 1757]
 [ 826 2855]]
Epoch 0, Phase val, Loss=0.7340, Acc=0.6393, AUC=0.7617, TPR=0.7784, TNR=0.6145, J=0.3929, MCC=0.2834, ConfusionMatrix=
[[1336  838]
 [  86  302]]
New Best AUC=0.7617. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7293, Acc=0.6029, AUC=0.7507, TPR=0.7366, TNR=0.5799, J=0.3165, MCC=0.2246, ConfusionMatrix=
[[1252  907]
 [  98  274]]
Epoch 0 complete in 38.03

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5415, Acc=0.7321, AUC=0.8058, TPR=0.6835, TNR=0.7788, J=0.4623, MCC=0.4647, ConfusionMatrix=
[[2897  823]
 [1133 2447]]
Epoch 1, Phase val, Loss=0.4728, Acc=0.8255, AUC=0.7899, TPR=0.4562, TNR=0.8914, J=0.3476, MCC=0.3389, ConfusionMatrix=
[[1938  236]
 [ 211  177]]
New Best AUC=0.7899. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4532, Acc=0.8412, AUC=0.7774, TPR=0.4919, TNR=0.9013, J=0.3933, MCC=0.3833, ConfusionMatrix=
[[1946  213]
 [ 189  183]]
Epoch 1 complete in 36.84

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5158, Acc=0.7507, AUC=0.8260, TPR=0.6897, TNR=0.8108, J=0.5004, MCC=0.5044, ConfusionMatrix=
[[2982  696]
 [1124 2498]]
Epoch 2, Phase val, Loss=0.4536, Acc=0.8271, AUC=0.7828, TPR=0.4381, TNR=0.8965, J=0.3346, MCC=0.3322, ConfusionMatrix=
[[1949  225]
 [ 218  170]]
Epoch 2, Phase test, Loss=0.4415, Acc=0.8424, AUC=0.7654, TPR=0.4301, TNR=0.9134, J=0.3435, MCC=0.3536, ConfusionMatrix=
[[1972  187]
 [ 212  160]]
Epoch 2 complete in 36.30

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5257, Acc=0.7441, AUC=0.8170, TPR=0.6928, TNR=0.7958, J=0.4886, MCC=0.4911, ConfusionMatrix=
[[2895  743]
 [1125 2537]]
Epoch 3, Phase val, Loss=0.6497, Acc=0.6959, AUC=0.7985, TPR=0.7371, TNR=0.6886, J=0.4257, MCC=0.3151, ConfusionMatrix=
[[1497  677]
 [ 102  286]]
New Best AUC=0.7985. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6495, Acc=0.6768, AUC=0.7809, TPR=0.7339, TNR=0.6670, J=0.4008, MCC=0.2907, ConfusionMatrix=
[[1440  719]
 [  99  273]]
Epoch 3 complete in 36.73

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5047, Acc=0.7586, AUC=0.8331, TPR=0.7309, TNR=0.7871, J=0.5180, MCC=0.5186, ConfusionMatrix=
[[2836  767]
 [ 995 2702]]
Epoch 4, Phase val, Loss=0.5756, Acc=0.7373, AUC=0.8072, TPR=0.7423, TNR=0.7364, J=0.4787, MCC=0.3633, ConfusionMatrix=
[[1601  573]
 [ 100  288]]
New Best AUC=0.8072. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5735, Acc=0.7380, AUC=0.7907, TPR=0.7097, TNR=0.7429, J=0.4526, MCC=0.3426, ConfusionMatrix=
[[1604  555]
 [ 108  264]]
Epoch 4 complete in 36.57

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4967, Acc=0.7704, AUC=0.8406, TPR=0.7212, TNR=0.8200, J=0.5413, MCC=0.5438, ConfusionMatrix=
[[2980  654]
 [1022 2644]]
Epoch 5, Phase val, Loss=0.5502, Acc=0.7888, AUC=0.8099, TPR=0.6675, TNR=0.8105, J=0.4780, MCC=0.3897, ConfusionMatrix=
[[1762  412]
 [ 129  259]]
New Best AUC=0.8099. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5462, Acc=0.7728, AUC=0.7881, TPR=0.6586, TNR=0.7925, J=0.4511, MCC=0.3582, ConfusionMatrix=
[[1711  448]
 [ 127  245]]
Epoch 5 complete in 37.68

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5084, Acc=0.7601, AUC=0.8317, TPR=0.7070, TNR=0.8129, J=0.5199, MCC=0.5230, ConfusionMatrix=
[[2977  685]
 [1066 2572]]
Epoch 6, Phase val, Loss=0.6213, Acc=0.7307, AUC=0.8030, TPR=0.7345, TNR=0.7300, J=0.4645, MCC=0.3514, ConfusionMatrix=
[[1587  587]
 [ 103  285]]
Epoch 6, Phase test, Loss=0.6316, Acc=0.7183, AUC=0.7888, TPR=0.7285, TNR=0.7165, J=0.4450, MCC=0.3306, ConfusionMatrix=
[[1547  612]
 [ 101  271]]
Epoch 6 complete in 36.29

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5053, Acc=0.7571, AUC=0.8321, TPR=0.7095, TNR=0.8040, J=0.5135, MCC=0.5160, ConfusionMatrix=
[[2958  721]
 [1052 2569]]
Epoch 7, Phase val, Loss=0.4681, Acc=0.8216, AUC=0.8060, TPR=0.5696, TNR=0.8666, J=0.4362, MCC=0.3913, ConfusionMatrix=
[[1884  290]
 [ 167  221]]
Epoch 7, Phase test, Loss=0.4701, Acc=0.8183, AUC=0.7888, TPR=0.5833, TNR=0.8587, J=0.4421, MCC=0.3869, ConfusionMatrix=
[[1854  305]
 [ 155  217]]
Epoch 7 complete in 36.43

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4803, Acc=0.7779, AUC=0.8533, TPR=0.7377, TNR=0.8180, J=0.5557, MCC=0.5576, ConfusionMatrix=
[[2993  666]
 [ 955 2686]]
Epoch 8, Phase val, Loss=0.4412, Acc=0.8154, AUC=0.7723, TPR=0.4871, TNR=0.8740, J=0.3611, MCC=0.3364, ConfusionMatrix=
[[1900  274]
 [ 199  189]]
Epoch 8, Phase test, Loss=0.4315, Acc=0.8242, AUC=0.7551, TPR=0.4785, TNR=0.8837, J=0.3622, MCC=0.3419, ConfusionMatrix=
[[1908  251]
 [ 194  178]]
Epoch 8 complete in 37.50

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4966, Acc=0.7645, AUC=0.8387, TPR=0.7110, TNR=0.8174, J=0.5283, MCC=0.5315, ConfusionMatrix=
[[3003  671]
 [1048 2578]]
Epoch 9, Phase val, Loss=0.4484, Acc=0.8189, AUC=0.8042, TPR=0.5902, TNR=0.8597, J=0.4499, MCC=0.3971, ConfusionMatrix=
[[1869  305]
 [ 159  229]]
Epoch 9, Phase test, Loss=0.4559, Acc=0.8206, AUC=0.7757, TPR=0.5376, TNR=0.8694, J=0.4070, MCC=0.3670, ConfusionMatrix=
[[1877  282]
 [ 172  200]]
Epoch 9 complete in 36.07

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4755, Acc=0.7838, AUC=0.8529, TPR=0.7265, TNR=0.8389, J=0.5654, MCC=0.5697, ConfusionMatrix=
[[3124  600]
 [ 978 2598]]
Epoch 10, Phase val, Loss=0.4589, Acc=0.8201, AUC=0.7972, TPR=0.5387, TNR=0.8703, J=0.4089, MCC=0.3725, ConfusionMatrix=
[[1892  282]
 [ 179  209]]
Epoch 10, Phase test, Loss=0.4590, Acc=0.8242, AUC=0.7736, TPR=0.5376, TNR=0.8736, J=0.4112, MCC=0.3735, ConfusionMatrix=
[[1886  273]
 [ 172  200]]
Epoch 10 complete in 36.33

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4692, Acc=0.7867, AUC=0.8590, TPR=0.7281, TNR=0.8442, J=0.5723, MCC=0.5766, ConfusionMatrix=
[[3111  574]
 [ 983 2632]]
Epoch 11, Phase val, Loss=0.5335, Acc=0.7814, AUC=0.8120, TPR=0.6778, TNR=0.7999, J=0.4777, MCC=0.3847, ConfusionMatrix=
[[1739  435]
 [ 125  263]]
New Best AUC=0.8120. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.5433, Acc=0.7760, AUC=0.7965, TPR=0.6855, TNR=0.7916, J=0.4771, MCC=0.3768, ConfusionMatrix=
[[1709  450]
 [ 117  255]]
Epoch 11 complete in 37.05

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4579, Acc=0.7867, AUC=0.8645, TPR=0.7368, TNR=0.8355, J=0.5722, MCC=0.5754, ConfusionMatrix=
[[3087  608]
 [ 949 2656]]
Epoch 12, Phase val, Loss=0.4213, Acc=0.8279, AUC=0.7815, TPR=0.4562, TNR=0.8942, J=0.3504, MCC=0.3436, ConfusionMatrix=
[[1944  230]
 [ 211  177]]
Epoch 12, Phase test, Loss=0.4233, Acc=0.8412, AUC=0.7709, TPR=0.5188, TNR=0.8967, J=0.4155, MCC=0.3970, ConfusionMatrix=
[[1936  223]
 [ 179  193]]
Epoch 12 complete in 36.21

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4654, Acc=0.7862, AUC=0.8614, TPR=0.7559, TNR=0.8179, J=0.5739, MCC=0.5743, ConfusionMatrix=
[[2911  648]
 [ 913 2828]]
Epoch 13, Phase val, Loss=0.6405, Acc=0.7322, AUC=0.7932, TPR=0.7268, TNR=0.7332, J=0.4600, MCC=0.3490, ConfusionMatrix=
[[1594  580]
 [ 106  282]]
Epoch 13, Phase test, Loss=0.6073, Acc=0.7353, AUC=0.7864, TPR=0.6882, TNR=0.7434, J=0.4316, MCC=0.3276, ConfusionMatrix=
[[1605  554]
 [ 116  256]]
Epoch 13 complete in 37.20

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4508, Acc=0.7951, AUC=0.8716, TPR=0.7478, TNR=0.8410, J=0.5888, MCC=0.5918, ConfusionMatrix=
[[3115  589]
 [ 907 2689]]
Epoch 14, Phase val, Loss=0.5730, Acc=0.7553, AUC=0.7995, TPR=0.7010, TNR=0.7649, J=0.4660, MCC=0.3626, ConfusionMatrix=
[[1663  511]
 [ 116  272]]
Epoch 14, Phase test, Loss=0.5840, Acc=0.7396, AUC=0.7823, TPR=0.7016, TNR=0.7462, J=0.4478, MCC=0.3400, ConfusionMatrix=
[[1611  548]
 [ 111  261]]
Epoch 14 complete in 36.05

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4526, Acc=0.7992, AUC=0.8706, TPR=0.7768, TNR=0.8222, J=0.5990, MCC=0.5993, ConfusionMatrix=
[[2959  640]
 [ 826 2875]]
Epoch 15, Phase val, Loss=0.4613, Acc=0.8162, AUC=0.7702, TPR=0.5052, TNR=0.8717, J=0.3768, MCC=0.3476, ConfusionMatrix=
[[1895  279]
 [ 192  196]]
Epoch 15, Phase test, Loss=0.4511, Acc=0.8183, AUC=0.7659, TPR=0.5215, TNR=0.8694, J=0.3909, MCC=0.3542, ConfusionMatrix=
[[1877  282]
 [ 178  194]]
Epoch 15 complete in 36.30

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4132, Acc=0.8226, AUC=0.8928, TPR=0.7958, TNR=0.8497, J=0.6455, MCC=0.6463, ConfusionMatrix=
[[3086  546]
 [ 749 2919]]
Epoch 16, Phase val, Loss=0.5937, Acc=0.7732, AUC=0.7859, TPR=0.6649, TNR=0.7925, J=0.4575, MCC=0.3666, ConfusionMatrix=
[[1723  451]
 [ 130  258]]
Epoch 16, Phase test, Loss=0.6096, Acc=0.7400, AUC=0.7599, TPR=0.6317, TNR=0.7587, J=0.3904, MCC=0.3020, ConfusionMatrix=
[[1638  521]
 [ 137  235]]
Epoch 16 complete in 36.25

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4366, Acc=0.8071, AUC=0.8808, TPR=0.7755, TNR=0.8397, J=0.6151, MCC=0.6160, ConfusionMatrix=
[[3022  577]
 [ 831 2870]]
Epoch 17, Phase val, Loss=0.5405, Acc=0.7580, AUC=0.7934, TPR=0.6701, TNR=0.7737, J=0.4438, MCC=0.3494, ConfusionMatrix=
[[1682  492]
 [ 128  260]]
Epoch 17, Phase test, Loss=0.5279, Acc=0.7693, AUC=0.7666, TPR=0.6398, TNR=0.7916, J=0.4314, MCC=0.3433, ConfusionMatrix=
[[1709  450]
 [ 134  238]]
Epoch 17 complete in 36.32

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4219, Acc=0.8192, AUC=0.8884, TPR=0.8017, TNR=0.8373, J=0.6390, MCC=0.6391, ConfusionMatrix=
[[3001  583]
 [ 737 2979]]
Epoch 18, Phase val, Loss=0.5125, Acc=0.7923, AUC=0.8003, TPR=0.6598, TNR=0.8160, J=0.4758, MCC=0.3908, ConfusionMatrix=
[[1774  400]
 [ 132  256]]
Epoch 18, Phase test, Loss=0.5359, Acc=0.7748, AUC=0.7801, TPR=0.6747, TNR=0.7920, J=0.4668, MCC=0.3695, ConfusionMatrix=
[[1710  449]
 [ 121  251]]
Epoch 18 complete in 37.45

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4135, Acc=0.8152, AUC=0.8933, TPR=0.7887, TNR=0.8415, J=0.6302, MCC=0.6312, ConfusionMatrix=
[[3084  581]
 [ 768 2867]]
Epoch 19, Phase val, Loss=1.3075, Acc=0.5886, AUC=0.8019, TPR=0.8686, TNR=0.5386, J=0.4072, MCC=0.2923, ConfusionMatrix=
[[1171 1003]
 [  51  337]]
Epoch 19, Phase test, Loss=1.3879, Acc=0.5354, AUC=0.7792, TPR=0.8387, TNR=0.4831, J=0.3218, MCC=0.2298, ConfusionMatrix=
[[1043 1116]
 [  60  312]]
Epoch 19 complete in 36.26

Early Stop!
Training complete in 12m 14s
The best model val AUC=0.811997932454, test AUC=0.796535632287.
Finish training resnet18scratch-conv1x1ab-avgpool

Start training resnet18scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6048, Acc=0.6527, AUC=0.7337, TPR=0.7870, TNR=0.5127, J=0.2997, MCC=0.3122, ConfusionMatrix=
[[1832 1741]
 [ 794 2933]]
Epoch 0, Phase val, Loss=0.6866, Acc=0.6659, AUC=0.7697, TPR=0.7423, TNR=0.6523, J=0.3945, MCC=0.2878, ConfusionMatrix=
[[1418  756]
 [ 100  288]]
New Best AUC=0.7697. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6880, Acc=0.6412, AUC=0.7585, TPR=0.7231, TNR=0.6271, J=0.3503, MCC=0.2509, ConfusionMatrix=
[[1354  805]
 [ 103  269]]
Epoch 0 complete in 36.73

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5329, Acc=0.7336, AUC=0.8089, TPR=0.6897, TNR=0.7769, J=0.4666, MCC=0.4685, ConfusionMatrix=
[[2852  819]
 [1126 2503]]
Epoch 1, Phase val, Loss=0.4926, Acc=0.8205, AUC=0.7794, TPR=0.4794, TNR=0.8813, J=0.3607, MCC=0.3416, ConfusionMatrix=
[[1916  258]
 [ 202  186]]
New Best AUC=0.7794. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4860, Acc=0.8266, AUC=0.7621, TPR=0.4839, TNR=0.8856, J=0.3695, MCC=0.3493, ConfusionMatrix=
[[1912  247]
 [ 192  180]]
Epoch 1 complete in 36.66

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5203, Acc=0.7433, AUC=0.8219, TPR=0.6926, TNR=0.7960, J=0.4886, MCC=0.4907, ConfusionMatrix=
[[2849  730]
 [1144 2577]]
Epoch 2, Phase val, Loss=0.5279, Acc=0.7892, AUC=0.7929, TPR=0.6134, TNR=0.8206, J=0.4340, MCC=0.3617, ConfusionMatrix=
[[1784  390]
 [ 150  238]]
New Best AUC=0.7929. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5275, Acc=0.7772, AUC=0.7799, TPR=0.6183, TNR=0.8045, J=0.4228, MCC=0.3423, ConfusionMatrix=
[[1737  422]
 [ 142  230]]
Epoch 2 complete in 36.91

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5218, Acc=0.7458, AUC=0.8219, TPR=0.6964, TNR=0.7954, J=0.4918, MCC=0.4941, ConfusionMatrix=
[[2896  745]
 [1111 2548]]
Epoch 3, Phase val, Loss=0.5081, Acc=0.7970, AUC=0.7862, TPR=0.6031, TNR=0.8316, J=0.4347, MCC=0.3680, ConfusionMatrix=
[[1808  366]
 [ 154  234]]
Epoch 3, Phase test, Loss=0.5076, Acc=0.7965, AUC=0.7744, TPR=0.5914, TNR=0.8319, J=0.4233, MCC=0.3559, ConfusionMatrix=
[[1796  363]
 [ 152  220]]
Epoch 3 complete in 36.87

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5038, Acc=0.7541, AUC=0.8345, TPR=0.7001, TNR=0.8103, J=0.5104, MCC=0.5129, ConfusionMatrix=
[[2900  679]
 [1116 2605]]
Epoch 4, Phase val, Loss=0.4923, Acc=0.8240, AUC=0.7912, TPR=0.5309, TNR=0.8763, J=0.4072, MCC=0.3756, ConfusionMatrix=
[[1905  269]
 [ 182  206]]
Epoch 4, Phase test, Loss=0.4785, Acc=0.8147, AUC=0.7823, TPR=0.5511, TNR=0.8601, J=0.4112, MCC=0.3638, ConfusionMatrix=
[[1857  302]
 [ 167  205]]
Epoch 4 complete in 36.33

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4958, Acc=0.7685, AUC=0.8405, TPR=0.7202, TNR=0.8159, J=0.5361, MCC=0.5388, ConfusionMatrix=
[[3005  678]
 [1012 2605]]
Epoch 5, Phase val, Loss=0.7103, Acc=0.6682, AUC=0.8001, TPR=0.7732, TNR=0.6495, J=0.4227, MCC=0.3076, ConfusionMatrix=
[[1412  762]
 [  88  300]]
New Best AUC=0.8001. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.7369, Acc=0.6409, AUC=0.7907, TPR=0.7661, TNR=0.6193, J=0.3854, MCC=0.2751, ConfusionMatrix=
[[1337  822]
 [  87  285]]
Epoch 5 complete in 36.89

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5122, Acc=0.7501, AUC=0.8273, TPR=0.6909, TNR=0.8101, J=0.5010, MCC=0.5044, ConfusionMatrix=
[[2939  689]
 [1135 2537]]
Epoch 6, Phase val, Loss=0.7400, Acc=0.6807, AUC=0.8003, TPR=0.7835, TNR=0.6624, J=0.4459, MCC=0.3256, ConfusionMatrix=
[[1440  734]
 [  84  304]]
New Best AUC=0.8003. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.7575, Acc=0.6484, AUC=0.7889, TPR=0.7527, TNR=0.6304, J=0.3831, MCC=0.2743, ConfusionMatrix=
[[1361  798]
 [  92  280]]
Epoch 6 complete in 36.87

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4761, Acc=0.7786, AUC=0.8541, TPR=0.7353, TNR=0.8229, J=0.5581, MCC=0.5600, ConfusionMatrix=
[[2973  640]
 [ 976 2711]]
Epoch 7, Phase val, Loss=0.7004, Acc=0.7080, AUC=0.7838, TPR=0.7294, TNR=0.7042, J=0.4336, MCC=0.3236, ConfusionMatrix=
[[1531  643]
 [ 105  283]]
Epoch 7, Phase test, Loss=0.7038, Acc=0.7021, AUC=0.7776, TPR=0.7258, TNR=0.6980, J=0.4238, MCC=0.3118, ConfusionMatrix=
[[1507  652]
 [ 102  270]]
Epoch 7 complete in 37.21

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4939, Acc=0.7715, AUC=0.8402, TPR=0.7141, TNR=0.8289, J=0.5431, MCC=0.5467, ConfusionMatrix=
[[3024  624]
 [1044 2608]]
Epoch 8, Phase val, Loss=0.5630, Acc=0.7740, AUC=0.7862, TPR=0.6340, TNR=0.7990, J=0.4330, MCC=0.3510, ConfusionMatrix=
[[1737  437]
 [ 142  246]]
Epoch 8, Phase test, Loss=0.5481, Acc=0.7645, AUC=0.7822, TPR=0.6075, TNR=0.7916, J=0.3991, MCC=0.3194, ConfusionMatrix=
[[1709  450]
 [ 146  226]]
Epoch 8 complete in 36.32

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4875, Acc=0.7740, AUC=0.8481, TPR=0.7236, TNR=0.8238, J=0.5475, MCC=0.5504, ConfusionMatrix=
[[3021  646]
 [1004 2629]]
Epoch 9, Phase val, Loss=0.4317, Acc=0.8365, AUC=0.7975, TPR=0.5232, TNR=0.8924, J=0.4156, MCC=0.3961, ConfusionMatrix=
[[1940  234]
 [ 185  203]]
Epoch 9, Phase test, Loss=0.4136, Acc=0.8400, AUC=0.7842, TPR=0.5108, TNR=0.8967, J=0.4075, MCC=0.3904, ConfusionMatrix=
[[1936  223]
 [ 182  190]]
Epoch 9 complete in 36.46

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4807, Acc=0.7767, AUC=0.8497, TPR=0.7328, TNR=0.8208, J=0.5536, MCC=0.5557, ConfusionMatrix=
[[2990  653]
 [ 977 2680]]
Epoch 10, Phase val, Loss=0.3943, Acc=0.8489, AUC=0.7846, TPR=0.3144, TNR=0.9443, J=0.2588, MCC=0.3166, ConfusionMatrix=
[[2053  121]
 [ 266  122]]
Epoch 10, Phase test, Loss=0.3691, Acc=0.8672, AUC=0.7859, TPR=0.3871, TNR=0.9500, J=0.3371, MCC=0.3986, ConfusionMatrix=
[[2051  108]
 [ 228  144]]
Epoch 10 complete in 36.25

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4674, Acc=0.7895, AUC=0.8598, TPR=0.7260, TNR=0.8494, J=0.5755, MCC=0.5809, ConfusionMatrix=
[[3187  565]
 [ 972 2576]]
Epoch 11, Phase val, Loss=0.5003, Acc=0.8099, AUC=0.7883, TPR=0.5593, TNR=0.8546, J=0.4139, MCC=0.3656, ConfusionMatrix=
[[1858  316]
 [ 171  217]]
Epoch 11, Phase test, Loss=0.4722, Acc=0.8135, AUC=0.7921, TPR=0.5780, TNR=0.8541, J=0.4321, MCC=0.3760, ConfusionMatrix=
[[1844  315]
 [ 157  215]]
Epoch 11 complete in 37.06

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4867, Acc=0.7742, AUC=0.8454, TPR=0.7413, TNR=0.8082, J=0.5495, MCC=0.5504, ConfusionMatrix=
[[2907  690]
 [ 958 2745]]
Epoch 12, Phase val, Loss=0.4024, Acc=0.8482, AUC=0.7868, TPR=0.3737, TNR=0.9328, J=0.3066, MCC=0.3463, ConfusionMatrix=
[[2028  146]
 [ 243  145]]
Epoch 12, Phase test, Loss=0.3773, Acc=0.8653, AUC=0.7888, TPR=0.4651, TNR=0.9342, J=0.3993, MCC=0.4283, ConfusionMatrix=
[[2017  142]
 [ 199  173]]
Epoch 12 complete in 36.18

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4715, Acc=0.7888, AUC=0.8566, TPR=0.7509, TNR=0.8281, J=0.5790, MCC=0.5801, ConfusionMatrix=
[[2967  616]
 [ 926 2791]]
Epoch 13, Phase val, Loss=0.4978, Acc=0.8208, AUC=0.8016, TPR=0.5954, TNR=0.8611, J=0.4564, MCC=0.4031, ConfusionMatrix=
[[1872  302]
 [ 157  231]]
New Best AUC=0.8016. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 13, Phase test, Loss=0.4840, Acc=0.8254, AUC=0.7932, TPR=0.5914, TNR=0.8657, J=0.4571, MCC=0.4035, ConfusionMatrix=
[[1869  290]
 [ 152  220]]
Epoch 13 complete in 36.98

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4552, Acc=0.7923, AUC=0.8685, TPR=0.7613, TNR=0.8240, J=0.5853, MCC=0.5862, ConfusionMatrix=
[[2978  636]
 [ 880 2806]]
Epoch 14, Phase val, Loss=0.7138, Acc=0.6971, AUC=0.8057, TPR=0.7809, TNR=0.6822, J=0.4631, MCC=0.3407, ConfusionMatrix=
[[1483  691]
 [  85  303]]
New Best AUC=0.8057. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 14, Phase test, Loss=0.7354, Acc=0.6622, AUC=0.7847, TPR=0.7446, TNR=0.6480, J=0.3926, MCC=0.2827, ConfusionMatrix=
[[1399  760]
 [  95  277]]
Epoch 14 complete in 36.96

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4614, Acc=0.7860, AUC=0.8647, TPR=0.7566, TNR=0.8160, J=0.5726, MCC=0.5734, ConfusionMatrix=
[[2949  665]
 [ 897 2789]]
Epoch 15, Phase val, Loss=0.5906, Acc=0.7806, AUC=0.7814, TPR=0.6366, TNR=0.8063, J=0.4429, MCC=0.3617, ConfusionMatrix=
[[1753  421]
 [ 141  247]]
Epoch 15, Phase test, Loss=0.6191, Acc=0.7432, AUC=0.7703, TPR=0.6720, TNR=0.7554, J=0.4275, MCC=0.3280, ConfusionMatrix=
[[1631  528]
 [ 122  250]]
Epoch 15 complete in 36.11

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4446, Acc=0.7977, AUC=0.8753, TPR=0.7634, TNR=0.8320, J=0.5954, MCC=0.5968, ConfusionMatrix=
[[3036  613]
 [ 864 2787]]
Epoch 16, Phase val, Loss=0.4003, Acc=0.8443, AUC=0.7664, TPR=0.3918, TNR=0.9250, J=0.3168, MCC=0.3458, ConfusionMatrix=
[[2011  163]
 [ 236  152]]
Epoch 16, Phase test, Loss=0.3947, Acc=0.8542, AUC=0.7562, TPR=0.4220, TNR=0.9287, J=0.3507, MCC=0.3783, ConfusionMatrix=
[[2005  154]
 [ 215  157]]
Epoch 16 complete in 37.30

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4390, Acc=0.8042, AUC=0.8787, TPR=0.7819, TNR=0.8266, J=0.6085, MCC=0.6091, ConfusionMatrix=
[[3017  633]
 [ 796 2854]]
Epoch 17, Phase val, Loss=0.6377, Acc=0.7287, AUC=0.7857, TPR=0.7552, TNR=0.7240, J=0.4792, MCC=0.3605, ConfusionMatrix=
[[1574  600]
 [  95  293]]
Epoch 17, Phase test, Loss=0.6575, Acc=0.6954, AUC=0.7789, TPR=0.7285, TNR=0.6897, J=0.4182, MCC=0.3064, ConfusionMatrix=
[[1489  670]
 [ 101  271]]
Epoch 17 complete in 36.14

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4223, Acc=0.8168, AUC=0.8877, TPR=0.7855, TNR=0.8472, J=0.6327, MCC=0.6342, ConfusionMatrix=
[[3144  567]
 [ 770 2819]]
Epoch 18, Phase val, Loss=0.3898, Acc=0.8548, AUC=0.7625, TPR=0.4072, TNR=0.9347, J=0.3419, MCC=0.3812, ConfusionMatrix=
[[2032  142]
 [ 230  158]]
Epoch 18, Phase test, Loss=0.3716, Acc=0.8597, AUC=0.7648, TPR=0.3710, TNR=0.9440, J=0.3149, MCC=0.3679, ConfusionMatrix=
[[2038  121]
 [ 234  138]]
Epoch 18 complete in 36.25

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4184, Acc=0.8173, AUC=0.8913, TPR=0.7854, TNR=0.8498, J=0.6352, MCC=0.6362, ConfusionMatrix=
[[3071  543]
 [ 791 2895]]
Epoch 19, Phase val, Loss=0.4350, Acc=0.8193, AUC=0.7759, TPR=0.4691, TNR=0.8818, J=0.3509, MCC=0.3338, ConfusionMatrix=
[[1917  257]
 [ 206  182]]
Epoch 19, Phase test, Loss=0.4198, Acc=0.8380, AUC=0.7671, TPR=0.5108, TNR=0.8944, J=0.4051, MCC=0.3863, ConfusionMatrix=
[[1931  228]
 [ 182  190]]
Epoch 19 complete in 36.26

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4085, Acc=0.8156, AUC=0.8974, TPR=0.7904, TNR=0.8410, J=0.6314, MCC=0.6322, ConfusionMatrix=
[[3058  578]
 [ 768 2896]]
Epoch 20, Phase val, Loss=1.0499, Acc=0.6429, AUC=0.7806, TPR=0.7912, TNR=0.6164, J=0.4076, MCC=0.2940, ConfusionMatrix=
[[1340  834]
 [  81  307]]
Epoch 20, Phase test, Loss=1.0866, Acc=0.5836, AUC=0.7618, TPR=0.7849, TNR=0.5489, J=0.3338, MCC=0.2364, ConfusionMatrix=
[[1185  974]
 [  80  292]]
Epoch 20 complete in 36.31

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4060, Acc=0.8251, AUC=0.8985, TPR=0.8039, TNR=0.8459, J=0.6499, MCC=0.6505, ConfusionMatrix=
[[3108  566]
 [ 711 2915]]
Epoch 21, Phase val, Loss=0.5479, Acc=0.8029, AUC=0.7709, TPR=0.6057, TNR=0.8381, J=0.4438, MCC=0.3785, ConfusionMatrix=
[[1822  352]
 [ 153  235]]
Epoch 21, Phase test, Loss=0.5209, Acc=0.7957, AUC=0.7653, TPR=0.5726, TNR=0.8342, J=0.4068, MCC=0.3446, ConfusionMatrix=
[[1801  358]
 [ 159  213]]
Epoch 21 complete in 36.99

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4013, Acc=0.8285, AUC=0.9016, TPR=0.8084, TNR=0.8493, J=0.6577, MCC=0.6579, ConfusionMatrix=
[[3044  540]
 [ 712 3004]]
Epoch 22, Phase val, Loss=0.7986, Acc=0.7112, AUC=0.7753, TPR=0.7216, TNR=0.7093, J=0.4309, MCC=0.3226, ConfusionMatrix=
[[1542  632]
 [ 108  280]]
Epoch 22, Phase test, Loss=0.7862, Acc=0.6954, AUC=0.7803, TPR=0.7419, TNR=0.6874, J=0.4293, MCC=0.3139, ConfusionMatrix=
[[1484  675]
 [  96  276]]
Epoch 22 complete in 36.20

Early Stop!
Training complete in 14m 2s
The best model val AUC=0.805732461423, test AUC=0.784654883035.
Finish training resnet18scratch-conv1x1ab-avgpool

Start training resnet18scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6113, Acc=0.6586, AUC=0.7391, TPR=0.7569, TNR=0.5627, J=0.3195, MCC=0.3255, ConfusionMatrix=
[[2078 1615]
 [ 877 2730]]
Epoch 0, Phase val, Loss=0.5190, Acc=0.7920, AUC=0.7645, TPR=0.5335, TNR=0.8381, J=0.3716, MCC=0.3225, ConfusionMatrix=
[[1822  352]
 [ 181  207]]
New Best AUC=0.7645. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5050, Acc=0.7894, AUC=0.7544, TPR=0.5349, TNR=0.8333, J=0.3682, MCC=0.3143, ConfusionMatrix=
[[1799  360]
 [ 173  199]]
Epoch 0 complete in 36.56

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5409, Acc=0.7305, AUC=0.8020, TPR=0.6869, TNR=0.7739, J=0.4608, MCC=0.4626, ConfusionMatrix=
[[2834  828]
 [1139 2499]]
Epoch 1, Phase val, Loss=0.4803, Acc=0.8002, AUC=0.7565, TPR=0.4433, TNR=0.8638, J=0.3071, MCC=0.2850, ConfusionMatrix=
[[1878  296]
 [ 216  172]]
Epoch 1, Phase test, Loss=0.4725, Acc=0.8048, AUC=0.7404, TPR=0.4677, TNR=0.8629, J=0.3306, MCC=0.3011, ConfusionMatrix=
[[1863  296]
 [ 198  174]]
Epoch 1 complete in 36.38

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5299, Acc=0.7508, AUC=0.8176, TPR=0.6995, TNR=0.8025, J=0.5020, MCC=0.5046, ConfusionMatrix=
[[2918  718]
 [1101 2563]]
Epoch 2, Phase val, Loss=0.5896, Acc=0.7658, AUC=0.7990, TPR=0.6675, TNR=0.7833, J=0.4509, MCC=0.3581, ConfusionMatrix=
[[1703  471]
 [ 129  259]]
New Best AUC=0.7990. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5875, Acc=0.7479, AUC=0.7775, TPR=0.6586, TNR=0.7633, J=0.4219, MCC=0.3264, ConfusionMatrix=
[[1648  511]
 [ 127  245]]
Epoch 2 complete in 36.67

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5157, Acc=0.7571, AUC=0.8262, TPR=0.7031, TNR=0.8107, J=0.5138, MCC=0.5169, ConfusionMatrix=
[[2972  694]
 [1079 2555]]
Epoch 3, Phase val, Loss=0.4248, Acc=0.8384, AUC=0.7923, TPR=0.3840, TNR=0.9195, J=0.3035, MCC=0.3274, ConfusionMatrix=
[[1999  175]
 [ 239  149]]
Epoch 3, Phase test, Loss=0.4127, Acc=0.8558, AUC=0.7741, TPR=0.4086, TNR=0.9328, J=0.3414, MCC=0.3757, ConfusionMatrix=
[[2014  145]
 [ 220  152]]
Epoch 3 complete in 37.18

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5059, Acc=0.7642, AUC=0.8332, TPR=0.7198, TNR=0.8084, J=0.5282, MCC=0.5303, ConfusionMatrix=
[[2961  702]
 [1019 2618]]
Epoch 4, Phase val, Loss=0.4933, Acc=0.8123, AUC=0.8026, TPR=0.5825, TNR=0.8533, J=0.4357, MCC=0.3817, ConfusionMatrix=
[[1855  319]
 [ 162  226]]
New Best AUC=0.8026. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.5041, Acc=0.8104, AUC=0.7759, TPR=0.5914, TNR=0.8481, J=0.4395, MCC=0.3778, ConfusionMatrix=
[[1831  328]
 [ 152  220]]
Epoch 4 complete in 36.88

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5071, Acc=0.7614, AUC=0.8311, TPR=0.7118, TNR=0.8123, J=0.5241, MCC=0.5263, ConfusionMatrix=
[[2925  676]
 [1066 2633]]
Epoch 5, Phase val, Loss=0.5172, Acc=0.8021, AUC=0.7981, TPR=0.5851, TNR=0.8408, J=0.4259, MCC=0.3664, ConfusionMatrix=
[[1828  346]
 [ 161  227]]
Epoch 5, Phase test, Loss=0.5121, Acc=0.8096, AUC=0.7852, TPR=0.5941, TNR=0.8467, J=0.4408, MCC=0.3779, ConfusionMatrix=
[[1828  331]
 [ 151  221]]
Epoch 5 complete in 36.31

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5021, Acc=0.7733, AUC=0.8351, TPR=0.7143, TNR=0.8303, J=0.5446, MCC=0.5488, ConfusionMatrix=
[[3082  630]
 [1025 2563]]
Epoch 6, Phase val, Loss=0.6279, Acc=0.7155, AUC=0.8059, TPR=0.7655, TNR=0.7065, J=0.4720, MCC=0.3515, ConfusionMatrix=
[[1536  638]
 [  91  297]]
New Best AUC=0.8059. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.6277, Acc=0.7187, AUC=0.7924, TPR=0.7554, TNR=0.7124, J=0.4677, MCC=0.3458, ConfusionMatrix=
[[1538  621]
 [  91  281]]
Epoch 6 complete in 36.67

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5029, Acc=0.7640, AUC=0.8346, TPR=0.7197, TNR=0.8094, J=0.5292, MCC=0.5309, ConfusionMatrix=
[[2914  686]
 [1037 2663]]
Epoch 7, Phase val, Loss=0.5103, Acc=0.7787, AUC=0.7862, TPR=0.5825, TNR=0.8137, J=0.3962, MCC=0.3296, ConfusionMatrix=
[[1769  405]
 [ 162  226]]
Epoch 7, Phase test, Loss=0.5115, Acc=0.7811, AUC=0.7665, TPR=0.6075, TNR=0.8110, J=0.4186, MCC=0.3420, ConfusionMatrix=
[[1751  408]
 [ 146  226]]
Epoch 7 complete in 37.31

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4916, Acc=0.7678, AUC=0.8421, TPR=0.7270, TNR=0.8097, J=0.5367, MCC=0.5382, ConfusionMatrix=
[[2915  685]
 [1010 2690]]
Epoch 8, Phase val, Loss=0.4952, Acc=0.8103, AUC=0.8037, TPR=0.5979, TNR=0.8482, J=0.4461, MCC=0.3865, ConfusionMatrix=
[[1844  330]
 [ 156  232]]
Epoch 8, Phase test, Loss=0.5087, Acc=0.7953, AUC=0.7894, TPR=0.6102, TNR=0.8272, J=0.4374, MCC=0.3642, ConfusionMatrix=
[[1786  373]
 [ 145  227]]
Epoch 8 complete in 36.24

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4950, Acc=0.7689, AUC=0.8412, TPR=0.7180, TNR=0.8195, J=0.5375, MCC=0.5404, ConfusionMatrix=
[[3001  661]
 [1026 2612]]
Epoch 9, Phase val, Loss=0.4952, Acc=0.8095, AUC=0.8123, TPR=0.6443, TNR=0.8390, J=0.4833, MCC=0.4091, ConfusionMatrix=
[[1824  350]
 [ 138  250]]
New Best AUC=0.8123. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.5100, Acc=0.8009, AUC=0.7941, TPR=0.6640, TNR=0.8245, J=0.4884, MCC=0.4008, ConfusionMatrix=
[[1780  379]
 [ 125  247]]
Epoch 9 complete in 36.84

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4877, Acc=0.7759, AUC=0.8458, TPR=0.7178, TNR=0.8320, J=0.5498, MCC=0.5540, ConfusionMatrix=
[[3090  624]
 [1012 2574]]
Epoch 10, Phase val, Loss=0.4208, Acc=0.8279, AUC=0.7884, TPR=0.4253, TNR=0.8997, J=0.3250, MCC=0.3267, ConfusionMatrix=
[[1956  218]
 [ 223  165]]
Epoch 10, Phase test, Loss=0.4102, Acc=0.8526, AUC=0.7989, TPR=0.4919, TNR=0.9148, J=0.4067, MCC=0.4090, ConfusionMatrix=
[[1975  184]
 [ 189  183]]
Epoch 10 complete in 36.32

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4858, Acc=0.7759, AUC=0.8462, TPR=0.7354, TNR=0.8160, J=0.5515, MCC=0.5534, ConfusionMatrix=
[[2990  674]
 [ 962 2674]]
Epoch 11, Phase val, Loss=0.4437, Acc=0.8263, AUC=0.8023, TPR=0.5232, TNR=0.8804, J=0.4036, MCC=0.3760, ConfusionMatrix=
[[1914  260]
 [ 185  203]]
Epoch 11, Phase test, Loss=0.4435, Acc=0.8380, AUC=0.7893, TPR=0.5672, TNR=0.8847, J=0.4519, MCC=0.4149, ConfusionMatrix=
[[1910  249]
 [ 161  211]]
Epoch 11 complete in 37.31

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4777, Acc=0.7805, AUC=0.8518, TPR=0.7405, TNR=0.8208, J=0.5613, MCC=0.5631, ConfusionMatrix=
[[2987  652]
 [ 950 2711]]
Epoch 12, Phase val, Loss=0.5129, Acc=0.7931, AUC=0.8057, TPR=0.6598, TNR=0.8169, J=0.4767, MCC=0.3920, ConfusionMatrix=
[[1776  398]
 [ 132  256]]
Epoch 12, Phase test, Loss=0.5153, Acc=0.7997, AUC=0.8047, TPR=0.6747, TNR=0.8212, J=0.4959, MCC=0.4046, ConfusionMatrix=
[[1773  386]
 [ 121  251]]
Epoch 12 complete in 36.39

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4623, Acc=0.7896, AUC=0.8644, TPR=0.7372, TNR=0.8405, J=0.5778, MCC=0.5813, ConfusionMatrix=
[[3110  590]
 [ 946 2654]]
Epoch 13, Phase val, Loss=0.4726, Acc=0.8169, AUC=0.8050, TPR=0.6082, TNR=0.8542, J=0.4624, MCC=0.4029, ConfusionMatrix=
[[1857  317]
 [ 152  236]]
Epoch 13, Phase test, Loss=0.4788, Acc=0.8234, AUC=0.7952, TPR=0.6183, TNR=0.8587, J=0.4770, MCC=0.4137, ConfusionMatrix=
[[1854  305]
 [ 142  230]]
Epoch 13 complete in 36.23

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4572, Acc=0.7927, AUC=0.8658, TPR=0.7550, TNR=0.8309, J=0.5859, MCC=0.5874, ConfusionMatrix=
[[3017  614]
 [ 899 2770]]
Epoch 14, Phase val, Loss=0.4186, Acc=0.8384, AUC=0.7848, TPR=0.4639, TNR=0.9052, J=0.3692, MCC=0.3699, ConfusionMatrix=
[[1968  206]
 [ 208  180]]
Epoch 14, Phase test, Loss=0.4124, Acc=0.8479, AUC=0.7654, TPR=0.5161, TNR=0.9050, J=0.4212, MCC=0.4101, ConfusionMatrix=
[[1954  205]
 [ 180  192]]
Epoch 14 complete in 36.23

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4509, Acc=0.7978, AUC=0.8707, TPR=0.7512, TNR=0.8437, J=0.5949, MCC=0.5977, ConfusionMatrix=
[[3103  575]
 [ 901 2721]]
Epoch 15, Phase val, Loss=0.4092, Acc=0.8443, AUC=0.7907, TPR=0.4768, TNR=0.9098, J=0.3866, MCC=0.3896, ConfusionMatrix=
[[1978  196]
 [ 203  185]]
Epoch 15, Phase test, Loss=0.4265, Acc=0.8404, AUC=0.7631, TPR=0.4677, TNR=0.9046, J=0.3723, MCC=0.3691, ConfusionMatrix=
[[1953  206]
 [ 198  174]]
Epoch 15 complete in 36.25

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4404, Acc=0.8056, AUC=0.8778, TPR=0.7707, TNR=0.8405, J=0.6113, MCC=0.6127, ConfusionMatrix=
[[3067  582]
 [ 837 2814]]
Epoch 16, Phase val, Loss=1.1137, Acc=0.6214, AUC=0.7949, TPR=0.8557, TNR=0.5796, J=0.4352, MCC=0.3122, ConfusionMatrix=
[[1260  914]
 [  56  332]]
Epoch 16, Phase test, Loss=1.1774, Acc=0.5630, AUC=0.7760, TPR=0.8199, TNR=0.5188, J=0.3387, MCC=0.2403, ConfusionMatrix=
[[1120 1039]
 [  67  305]]
Epoch 16 complete in 36.89

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4512, Acc=0.7967, AUC=0.8714, TPR=0.7589, TNR=0.8354, J=0.5943, MCC=0.5957, ConfusionMatrix=
[[3014  594]
 [ 890 2802]]
Epoch 17, Phase val, Loss=0.4757, Acc=0.8084, AUC=0.7857, TPR=0.5232, TNR=0.8592, J=0.3824, MCC=0.3436, ConfusionMatrix=
[[1868  306]
 [ 185  203]]
Epoch 17, Phase test, Loss=0.4825, Acc=0.8032, AUC=0.7747, TPR=0.5672, TNR=0.8439, J=0.4111, MCC=0.3534, ConfusionMatrix=
[[1822  337]
 [ 161  211]]
Epoch 17 complete in 36.29

Early Stop!
Training complete in 10m 59s
The best model val AUC=0.812275936798, test AUC=0.794112666657.
Finish training resnet18scratch-conv1x1ab-avgpool

Start training resnet18scratch-conv1x1ab-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6156, Acc=0.6492, AUC=0.7323, TPR=0.7549, TNR=0.5437, J=0.2985, MCC=0.3054, ConfusionMatrix=
[[1986 1667]
 [ 894 2753]]
Epoch 0, Phase val, Loss=0.7679, Acc=0.6116, AUC=0.7647, TPR=0.8067, TNR=0.5768, J=0.3835, MCC=0.2752, ConfusionMatrix=
[[1254  920]
 [  75  313]]
New Best AUC=0.7647. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7570, Acc=0.5713, AUC=0.7597, TPR=0.7769, TNR=0.5359, J=0.3128, MCC=0.2215, ConfusionMatrix=
[[1157 1002]
 [  83  289]]
Epoch 0 complete in 37.10

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5405, Acc=0.7377, AUC=0.8051, TPR=0.6820, TNR=0.7924, J=0.4744, MCC=0.4775, ConfusionMatrix=
[[2916  764]
 [1151 2469]]
Epoch 1, Phase val, Loss=0.7226, Acc=0.6612, AUC=0.7824, TPR=0.7655, TNR=0.6426, J=0.4081, MCC=0.2965, ConfusionMatrix=
[[1397  777]
 [  91  297]]
New Best AUC=0.7824. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7178, Acc=0.6326, AUC=0.7720, TPR=0.7661, TNR=0.6095, J=0.3757, MCC=0.2676, ConfusionMatrix=
[[1316  843]
 [  87  285]]
Epoch 1 complete in 36.71

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5292, Acc=0.7497, AUC=0.8179, TPR=0.7105, TNR=0.7894, J=0.4999, MCC=0.5014, ConfusionMatrix=
[[2864  764]
 [1063 2609]]
Epoch 2, Phase val, Loss=0.5178, Acc=0.8056, AUC=0.7940, TPR=0.5902, TNR=0.8441, J=0.4343, MCC=0.3748, ConfusionMatrix=
[[1835  339]
 [ 159  229]]
New Best AUC=0.7940. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5171, Acc=0.7898, AUC=0.7717, TPR=0.5699, TNR=0.8277, J=0.3976, MCC=0.3342, ConfusionMatrix=
[[1787  372]
 [ 160  212]]
Epoch 2 complete in 36.91

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5097, Acc=0.7570, AUC=0.8292, TPR=0.6864, TNR=0.8265, J=0.5129, MCC=0.5183, ConfusionMatrix=
[[3039  638]
 [1136 2487]]
Epoch 3, Phase val, Loss=0.5240, Acc=0.7709, AUC=0.7816, TPR=0.6314, TNR=0.7958, J=0.4272, MCC=0.3454, ConfusionMatrix=
[[1730  444]
 [ 143  245]]
Epoch 3, Phase test, Loss=0.5384, Acc=0.7550, AUC=0.7556, TPR=0.5806, TNR=0.7851, J=0.3657, MCC=0.2921, ConfusionMatrix=
[[1695  464]
 [ 156  216]]
Epoch 3 complete in 37.06

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5199, Acc=0.7530, AUC=0.8224, TPR=0.7094, TNR=0.7969, J=0.5063, MCC=0.5082, ConfusionMatrix=
[[2900  739]
 [1064 2597]]
Epoch 4, Phase val, Loss=0.6288, Acc=0.7077, AUC=0.8034, TPR=0.7448, TNR=0.7010, J=0.4459, MCC=0.3317, ConfusionMatrix=
[[1524  650]
 [  99  289]]
New Best AUC=0.8034. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.6417, Acc=0.6974, AUC=0.7912, TPR=0.7446, TNR=0.6892, J=0.4338, MCC=0.3174, ConfusionMatrix=
[[1488  671]
 [  95  277]]
Epoch 4 complete in 36.77

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5122, Acc=0.7562, AUC=0.8284, TPR=0.7075, TNR=0.8053, J=0.5128, MCC=0.5152, ConfusionMatrix=
[[2924  707]
 [1073 2596]]
Epoch 5, Phase val, Loss=0.6711, Acc=0.6811, AUC=0.8039, TPR=0.7706, TNR=0.6651, J=0.4358, MCC=0.3187, ConfusionMatrix=
[[1446  728]
 [  89  299]]
New Best AUC=0.8039. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.6792, Acc=0.6772, AUC=0.7901, TPR=0.7661, TNR=0.6619, J=0.4280, MCC=0.3092, ConfusionMatrix=
[[1429  730]
 [  87  285]]
Epoch 5 complete in 36.62

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5036, Acc=0.7632, AUC=0.8351, TPR=0.7106, TNR=0.8154, J=0.5260, MCC=0.5290, ConfusionMatrix=
[[2986  676]
 [1053 2585]]
Epoch 6, Phase val, Loss=0.4835, Acc=0.8025, AUC=0.8053, TPR=0.5825, TNR=0.8418, J=0.4242, MCC=0.3657, ConfusionMatrix=
[[1830  344]
 [ 162  226]]
New Best AUC=0.8053. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.4768, Acc=0.8159, AUC=0.7829, TPR=0.5968, TNR=0.8536, J=0.4504, MCC=0.3898, ConfusionMatrix=
[[1843  316]
 [ 150  222]]
Epoch 6 complete in 36.93

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4980, Acc=0.7679, AUC=0.8396, TPR=0.7148, TNR=0.8210, J=0.5358, MCC=0.5389, ConfusionMatrix=
[[3000  654]
 [1040 2606]]
Epoch 7, Phase val, Loss=0.4788, Acc=0.8052, AUC=0.7961, TPR=0.5773, TNR=0.8459, J=0.4232, MCC=0.3673, ConfusionMatrix=
[[1839  335]
 [ 164  224]]
Epoch 7, Phase test, Loss=0.4631, Acc=0.8127, AUC=0.7917, TPR=0.5780, TNR=0.8532, J=0.4311, MCC=0.3747, ConfusionMatrix=
[[1842  317]
 [ 157  215]]
Epoch 7 complete in 37.25

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4844, Acc=0.7784, AUC=0.8481, TPR=0.7380, TNR=0.8207, J=0.5587, MCC=0.5599, ConfusionMatrix=
[[2925  639]
 [ 979 2757]]
Epoch 8, Phase val, Loss=0.5153, Acc=0.7920, AUC=0.8033, TPR=0.6495, TNR=0.8174, J=0.4669, MCC=0.3848, ConfusionMatrix=
[[1777  397]
 [ 136  252]]
Epoch 8, Phase test, Loss=0.5264, Acc=0.7914, AUC=0.7905, TPR=0.6855, TNR=0.8096, J=0.4951, MCC=0.3981, ConfusionMatrix=
[[1748  411]
 [ 117  255]]
Epoch 8 complete in 36.42

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4841, Acc=0.7799, AUC=0.8485, TPR=0.7390, TNR=0.8212, J=0.5603, MCC=0.5620, ConfusionMatrix=
[[2977  648]
 [ 959 2716]]
Epoch 9, Phase val, Loss=0.4165, Acc=0.8349, AUC=0.8119, TPR=0.4820, TNR=0.8979, J=0.3798, MCC=0.3718, ConfusionMatrix=
[[1952  222]
 [ 201  187]]
New Best AUC=0.8119. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_bestAUC.pth
Epoch 9, Phase test, Loss=0.4188, Acc=0.8459, AUC=0.7922, TPR=0.5511, TNR=0.8967, J=0.4478, MCC=0.4230, ConfusionMatrix=
[[1936  223]
 [ 167  205]]
Epoch 9 complete in 36.84

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4896, Acc=0.7670, AUC=0.8453, TPR=0.7326, TNR=0.8030, J=0.5356, MCC=0.5364, ConfusionMatrix=
[[2862  702]
 [ 999 2737]]
Epoch 10, Phase val, Loss=0.4505, Acc=0.8286, AUC=0.8078, TPR=0.5851, TNR=0.8721, J=0.4572, MCC=0.4120, ConfusionMatrix=
[[1896  278]
 [ 161  227]]
Epoch 10, Phase test, Loss=0.4508, Acc=0.8226, AUC=0.7794, TPR=0.5565, TNR=0.8685, J=0.4249, MCC=0.3805, ConfusionMatrix=
[[1875  284]
 [ 165  207]]
Epoch 10 complete in 36.47

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4735, Acc=0.7773, AUC=0.8558, TPR=0.7347, TNR=0.8191, J=0.5538, MCC=0.5560, ConfusionMatrix=
[[3016  666]
 [ 960 2658]]
Epoch 11, Phase val, Loss=0.6627, Acc=0.7112, AUC=0.7904, TPR=0.7216, TNR=0.7093, J=0.4309, MCC=0.3226, ConfusionMatrix=
[[1542  632]
 [ 108  280]]
Epoch 11, Phase test, Loss=0.6965, Acc=0.6934, AUC=0.7800, TPR=0.7366, TNR=0.6860, J=0.4225, MCC=0.3088, ConfusionMatrix=
[[1481  678]
 [  98  274]]
Epoch 11 complete in 37.59

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4723, Acc=0.7796, AUC=0.8566, TPR=0.7432, TNR=0.8178, J=0.5610, MCC=0.5619, ConfusionMatrix=
[[2913  649]
 [ 960 2778]]
Epoch 12, Phase val, Loss=0.5742, Acc=0.7717, AUC=0.8093, TPR=0.7191, TNR=0.7810, J=0.5001, MCC=0.3932, ConfusionMatrix=
[[1698  476]
 [ 109  279]]
Epoch 12, Phase test, Loss=0.6116, Acc=0.7404, AUC=0.7818, TPR=0.6855, TNR=0.7499, J=0.4354, MCC=0.3321, ConfusionMatrix=
[[1619  540]
 [ 117  255]]
Epoch 12 complete in 36.34

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4613, Acc=0.7929, AUC=0.8643, TPR=0.7567, TNR=0.8289, J=0.5856, MCC=0.5872, ConfusionMatrix=
[[3032  626]
 [ 886 2756]]
Epoch 13, Phase val, Loss=0.4282, Acc=0.8345, AUC=0.7740, TPR=0.4588, TNR=0.9016, J=0.3603, MCC=0.3588, ConfusionMatrix=
[[1960  214]
 [ 210  178]]
Epoch 13, Phase test, Loss=0.4080, Acc=0.8439, AUC=0.7556, TPR=0.4651, TNR=0.9092, J=0.3743, MCC=0.3755, ConfusionMatrix=
[[1963  196]
 [ 199  173]]
Epoch 13 complete in 36.50

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4614, Acc=0.7914, AUC=0.8660, TPR=0.7471, TNR=0.8341, J=0.5811, MCC=0.5838, ConfusionMatrix=
[[3101  617]
 [ 906 2676]]
Epoch 14, Phase val, Loss=0.4030, Acc=0.8341, AUC=0.7548, TPR=0.3789, TNR=0.9154, J=0.2942, MCC=0.3145, ConfusionMatrix=
[[1990  184]
 [ 241  147]]
Epoch 14, Phase test, Loss=0.3864, Acc=0.8392, AUC=0.7659, TPR=0.3925, TNR=0.9162, J=0.3086, MCC=0.3258, ConfusionMatrix=
[[1978  181]
 [ 226  146]]
Epoch 14 complete in 36.23

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4632, Acc=0.7911, AUC=0.8650, TPR=0.7673, TNR=0.8148, J=0.5821, MCC=0.5828, ConfusionMatrix=
[[2982  678]
 [ 847 2793]]
Epoch 15, Phase val, Loss=0.7521, Acc=0.6581, AUC=0.7827, TPR=0.7526, TNR=0.6412, J=0.3938, MCC=0.2862, ConfusionMatrix=
[[1394  780]
 [  96  292]]
Epoch 15, Phase test, Loss=0.7704, Acc=0.6523, AUC=0.7732, TPR=0.7608, TNR=0.6336, J=0.3944, MCC=0.2825, ConfusionMatrix=
[[1368  791]
 [  89  283]]
Epoch 15 complete in 36.51

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4273, Acc=0.8079, AUC=0.8846, TPR=0.7715, TNR=0.8443, J=0.6158, MCC=0.6175, ConfusionMatrix=
[[3085  569]
 [ 833 2813]]
Epoch 16, Phase val, Loss=0.5300, Acc=0.7810, AUC=0.7979, TPR=0.6211, TNR=0.8096, J=0.4307, MCC=0.3539, ConfusionMatrix=
[[1760  414]
 [ 147  241]]
Epoch 16, Phase test, Loss=0.5141, Acc=0.7803, AUC=0.7928, TPR=0.6801, TNR=0.7976, J=0.4777, MCC=0.3798, ConfusionMatrix=
[[1722  437]
 [ 119  253]]
Epoch 16 complete in 37.45

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4238, Acc=0.8149, AUC=0.8879, TPR=0.7869, TNR=0.8428, J=0.6297, MCC=0.6308, ConfusionMatrix=
[[3083  575]
 [ 776 2866]]
Epoch 17, Phase val, Loss=0.5315, Acc=0.7549, AUC=0.7818, TPR=0.6546, TNR=0.7728, J=0.4274, MCC=0.3370, ConfusionMatrix=
[[1680  494]
 [ 134  254]]
Epoch 17, Phase test, Loss=0.5102, Acc=0.7720, AUC=0.7880, TPR=0.6694, TNR=0.7897, J=0.4591, MCC=0.3629, ConfusionMatrix=
[[1705  454]
 [ 123  249]]
Epoch 17 complete in 36.32

Early Stop!
Training complete in 11m 2s
The best model val AUC=0.811920873681, test AUC=0.792247506064.
Finish training resnet18scratch-conv1x1ab-avgpool

Start training resnet18scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6042, Acc=0.6618, AUC=0.7308, TPR=0.5717, TNR=0.7492, J=0.3209, MCC=0.3264, ConfusionMatrix=
[[2775  929]
 [1540 2056]]
Epoch 0, Phase val, Loss=0.4790, Acc=0.8013, AUC=0.7526, TPR=0.4485, TNR=0.8643, J=0.3128, MCC=0.2899, ConfusionMatrix=
[[1879  295]
 [ 214  174]]
New Best AUC=0.7526. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4764, Acc=0.8021, AUC=0.7285, TPR=0.4274, TNR=0.8666, J=0.2940, MCC=0.2730, ConfusionMatrix=
[[1871  288]
 [ 213  159]]
Epoch 0 complete in 36.42

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5454, Acc=0.7255, AUC=0.7985, TPR=0.6614, TNR=0.7896, J=0.4510, MCC=0.4547, ConfusionMatrix=
[[2882  768]
 [1236 2414]]
Epoch 1, Phase val, Loss=0.5382, Acc=0.7744, AUC=0.7981, TPR=0.6392, TNR=0.7985, J=0.4377, MCC=0.3544, ConfusionMatrix=
[[1736  438]
 [ 140  248]]
New Best AUC=0.7981. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5470, Acc=0.7890, AUC=0.7564, TPR=0.5672, TNR=0.8272, J=0.3944, MCC=0.3315, ConfusionMatrix=
[[1786  373]
 [ 161  211]]
Epoch 1 complete in 36.85

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5374, Acc=0.7319, AUC=0.8086, TPR=0.6675, TNR=0.7960, J=0.4634, MCC=0.4674, ConfusionMatrix=
[[2914  747]
 [1210 2429]]
Epoch 2, Phase val, Loss=0.8640, Acc=0.5734, AUC=0.7910, TPR=0.8582, TNR=0.5225, J=0.3808, MCC=0.2737, ConfusionMatrix=
[[1136 1038]
 [  55  333]]
Epoch 2, Phase test, Loss=0.9061, Acc=0.5524, AUC=0.7666, TPR=0.8387, TNR=0.5030, J=0.3417, MCC=0.2431, ConfusionMatrix=
[[1086 1073]
 [  60  312]]
Epoch 2 complete in 36.19

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5097, Acc=0.7558, AUC=0.8288, TPR=0.7248, TNR=0.7859, J=0.5108, MCC=0.5119, ConfusionMatrix=
[[2904  791]
 [ 992 2613]]
Epoch 3, Phase val, Loss=0.3794, Acc=0.8517, AUC=0.7924, TPR=0.4639, TNR=0.9209, J=0.3848, MCC=0.4007, ConfusionMatrix=
[[2002  172]
 [ 208  180]]
Epoch 3, Phase test, Loss=0.3959, Acc=0.8522, AUC=0.7593, TPR=0.4731, TNR=0.9176, J=0.3907, MCC=0.3988, ConfusionMatrix=
[[1981  178]
 [ 196  176]]
Epoch 3 complete in 37.04

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5092, Acc=0.7566, AUC=0.8297, TPR=0.7236, TNR=0.7896, J=0.5132, MCC=0.5143, ConfusionMatrix=
[[2882  768]
 [1009 2641]]
Epoch 4, Phase val, Loss=0.4790, Acc=0.8169, AUC=0.7933, TPR=0.6108, TNR=0.8537, J=0.4646, MCC=0.4043, ConfusionMatrix=
[[1856  318]
 [ 151  237]]
Epoch 4, Phase test, Loss=0.4980, Acc=0.7973, AUC=0.7696, TPR=0.5726, TNR=0.8360, J=0.4086, MCC=0.3470, ConfusionMatrix=
[[1805  354]
 [ 159  213]]
Epoch 4 complete in 36.28

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4833, Acc=0.7807, AUC=0.8496, TPR=0.7428, TNR=0.8178, J=0.5606, MCC=0.5624, ConfusionMatrix=
[[3016  672]
 [ 929 2683]]
Epoch 5, Phase val, Loss=0.4662, Acc=0.8087, AUC=0.7956, TPR=0.6134, TNR=0.8436, J=0.4570, MCC=0.3920, ConfusionMatrix=
[[1834  340]
 [ 150  238]]
Epoch 5, Phase test, Loss=0.4840, Acc=0.7969, AUC=0.7621, TPR=0.5699, TNR=0.8360, J=0.4059, MCC=0.3450, ConfusionMatrix=
[[1805  354]
 [ 160  212]]
Epoch 5 complete in 36.11

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4869, Acc=0.7722, AUC=0.8474, TPR=0.7416, TNR=0.8030, J=0.5446, MCC=0.5455, ConfusionMatrix=
[[2922  717]
 [ 946 2715]]
Epoch 6, Phase val, Loss=0.5831, Acc=0.7463, AUC=0.7997, TPR=0.7036, TNR=0.7539, J=0.4575, MCC=0.3530, ConfusionMatrix=
[[1639  535]
 [ 115  273]]
New Best AUC=0.7997. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.6133, Acc=0.7345, AUC=0.7725, TPR=0.6801, TNR=0.7439, J=0.4240, MCC=0.3222, ConfusionMatrix=
[[1606  553]
 [ 119  253]]
Epoch 6 complete in 36.65

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4951, Acc=0.7678, AUC=0.8416, TPR=0.7373, TNR=0.7984, J=0.5356, MCC=0.5366, ConfusionMatrix=
[[2914  736]
 [ 959 2691]]
Epoch 7, Phase val, Loss=0.4530, Acc=0.8002, AUC=0.8024, TPR=0.6546, TNR=0.8261, J=0.4808, MCC=0.3998, ConfusionMatrix=
[[1796  378]
 [ 134  254]]
New Best AUC=0.8024. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.4777, Acc=0.7906, AUC=0.7840, TPR=0.6263, TNR=0.8189, J=0.4452, MCC=0.3658, ConfusionMatrix=
[[1768  391]
 [ 139  233]]
Epoch 7 complete in 36.49

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4656, Acc=0.7849, AUC=0.8612, TPR=0.7648, TNR=0.8046, J=0.5694, MCC=0.5700, ConfusionMatrix=
[[2973  722]
 [ 848 2757]]
Epoch 8, Phase val, Loss=0.4033, Acc=0.8400, AUC=0.7928, TPR=0.5129, TNR=0.8983, J=0.4112, MCC=0.3982, ConfusionMatrix=
[[1953  221]
 [ 189  199]]
Epoch 8, Phase test, Loss=0.4069, Acc=0.8499, AUC=0.7765, TPR=0.5269, TNR=0.9055, J=0.4324, MCC=0.4197, ConfusionMatrix=
[[1955  204]
 [ 176  196]]
Epoch 8 complete in 37.11

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4526, Acc=0.7885, AUC=0.8701, TPR=0.7734, TNR=0.8037, J=0.5772, MCC=0.5774, ConfusionMatrix=
[[2916  712]
 [ 832 2840]]
Epoch 9, Phase val, Loss=0.6140, Acc=0.7319, AUC=0.7919, TPR=0.7088, TNR=0.7360, J=0.4447, MCC=0.3387, ConfusionMatrix=
[[1600  574]
 [ 113  275]]
Epoch 9, Phase test, Loss=0.6425, Acc=0.7132, AUC=0.7729, TPR=0.6909, TNR=0.7170, J=0.4079, MCC=0.3042, ConfusionMatrix=
[[1548  611]
 [ 115  257]]
Epoch 9 complete in 36.13

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4503, Acc=0.7964, AUC=0.8723, TPR=0.7809, TNR=0.8123, J=0.5932, MCC=0.5934, ConfusionMatrix=
[[2934  678]
 [ 808 2880]]
Epoch 10, Phase val, Loss=0.5346, Acc=0.7541, AUC=0.7981, TPR=0.6881, TNR=0.7659, J=0.4540, MCC=0.3542, ConfusionMatrix=
[[1665  509]
 [ 121  267]]
Epoch 10, Phase test, Loss=0.5685, Acc=0.7357, AUC=0.7587, TPR=0.6344, TNR=0.7531, J=0.3875, MCC=0.2984, ConfusionMatrix=
[[1626  533]
 [ 136  236]]
Epoch 10 complete in 36.02

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4224, Acc=0.8171, AUC=0.8891, TPR=0.8066, TNR=0.8275, J=0.6341, MCC=0.6343, ConfusionMatrix=
[[3042  634]
 [ 701 2923]]
Epoch 11, Phase val, Loss=0.5181, Acc=0.7760, AUC=0.7795, TPR=0.6546, TNR=0.7976, J=0.4522, MCC=0.3648, ConfusionMatrix=
[[1734  440]
 [ 134  254]]
Epoch 11, Phase test, Loss=0.5478, Acc=0.7420, AUC=0.7566, TPR=0.6398, TNR=0.7596, J=0.3994, MCC=0.3089, ConfusionMatrix=
[[1640  519]
 [ 134  238]]
Epoch 11 complete in 36.08

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4141, Acc=0.8227, AUC=0.8933, TPR=0.8239, TNR=0.8216, J=0.6455, MCC=0.6455, ConfusionMatrix=
[[2984  648]
 [ 646 3022]]
Epoch 12, Phase val, Loss=0.4378, Acc=0.8220, AUC=0.7814, TPR=0.5567, TNR=0.8694, J=0.4261, MCC=0.3854, ConfusionMatrix=
[[1890  284]
 [ 172  216]]
Epoch 12, Phase test, Loss=0.4356, Acc=0.8281, AUC=0.7783, TPR=0.5565, TNR=0.8749, J=0.4314, MCC=0.3906, ConfusionMatrix=
[[1889  270]
 [ 165  207]]
Epoch 12 complete in 36.93

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4050, Acc=0.8290, AUC=0.8985, TPR=0.8275, TNR=0.8306, J=0.6581, MCC=0.6581, ConfusionMatrix=
[[3030  618]
 [ 630 3022]]
Epoch 13, Phase val, Loss=0.4265, Acc=0.8283, AUC=0.7971, TPR=0.5851, TNR=0.8717, J=0.4567, MCC=0.4112, ConfusionMatrix=
[[1895  279]
 [ 161  227]]
Epoch 13, Phase test, Loss=0.4427, Acc=0.8210, AUC=0.7747, TPR=0.5780, TNR=0.8629, J=0.4409, MCC=0.3889, ConfusionMatrix=
[[1863  296]
 [ 157  215]]
Epoch 13 complete in 36.02

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.3807, Acc=0.8321, AUC=0.9104, TPR=0.8288, TNR=0.8353, J=0.6641, MCC=0.6641, ConfusionMatrix=
[[3033  598]
 [ 628 3041]]
Epoch 14, Phase val, Loss=0.6441, Acc=0.7166, AUC=0.8103, TPR=0.7732, TNR=0.7065, J=0.4797, MCC=0.3570, ConfusionMatrix=
[[1536  638]
 [  88  300]]
New Best AUC=0.8103. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 14, Phase test, Loss=0.6796, Acc=0.6938, AUC=0.7797, TPR=0.7285, TNR=0.6878, J=0.4163, MCC=0.3048, ConfusionMatrix=
[[1485  674]
 [ 101  271]]
Epoch 14 complete in 36.66

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.3879, Acc=0.8340, AUC=0.9069, TPR=0.8307, TNR=0.8373, J=0.6680, MCC=0.6680, ConfusionMatrix=
[[3036  590]
 [ 622 3052]]
Epoch 15, Phase val, Loss=0.4005, Acc=0.8415, AUC=0.7668, TPR=0.4820, TNR=0.9057, J=0.3877, MCC=0.3860, ConfusionMatrix=
[[1969  205]
 [ 201  187]]
Epoch 15, Phase test, Loss=0.3981, Acc=0.8475, AUC=0.7748, TPR=0.4812, TNR=0.9106, J=0.3918, MCC=0.3918, ConfusionMatrix=
[[1966  193]
 [ 193  179]]
Epoch 15 complete in 35.97

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.3963, Acc=0.8314, AUC=0.9025, TPR=0.8311, TNR=0.8316, J=0.6627, MCC=0.6627, ConfusionMatrix=
[[3028  613]
 [ 618 3041]]
Epoch 16, Phase val, Loss=0.5747, Acc=0.7584, AUC=0.7652, TPR=0.6392, TNR=0.7797, J=0.4188, MCC=0.3331, ConfusionMatrix=
[[1695  479]
 [ 140  248]]
Epoch 16, Phase test, Loss=0.5936, Acc=0.7396, AUC=0.7576, TPR=0.6667, TNR=0.7522, J=0.4189, MCC=0.3209, ConfusionMatrix=
[[1624  535]
 [ 124  248]]
Epoch 16 complete in 36.98

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.3659, Acc=0.8427, AUC=0.9170, TPR=0.8532, TNR=0.8318, J=0.6850, MCC=0.6853, ConfusionMatrix=
[[2972  601]
 [ 547 3180]]
Epoch 17, Phase val, Loss=0.4588, Acc=0.8009, AUC=0.7803, TPR=0.5541, TNR=0.8450, J=0.3991, MCC=0.3480, ConfusionMatrix=
[[1837  337]
 [ 173  215]]
Epoch 17, Phase test, Loss=0.4689, Acc=0.8005, AUC=0.7715, TPR=0.5806, TNR=0.8384, J=0.4190, MCC=0.3563, ConfusionMatrix=
[[1810  349]
 [ 156  216]]
Epoch 17 complete in 35.99

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.3405, Acc=0.8588, AUC=0.9284, TPR=0.8680, TNR=0.8492, J=0.7172, MCC=0.7174, ConfusionMatrix=
[[3041  540]
 [ 491 3228]]
Epoch 18, Phase val, Loss=0.5474, Acc=0.7670, AUC=0.7879, TPR=0.6314, TNR=0.7912, J=0.4226, MCC=0.3401, ConfusionMatrix=
[[1720  454]
 [ 143  245]]
Epoch 18, Phase test, Loss=0.5772, Acc=0.7527, AUC=0.7795, TPR=0.6667, TNR=0.7675, J=0.4342, MCC=0.3366, ConfusionMatrix=
[[1657  502]
 [ 124  248]]
Epoch 18 complete in 35.88

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.3328, Acc=0.8659, AUC=0.9316, TPR=0.8753, TNR=0.8562, J=0.7315, MCC=0.7317, ConfusionMatrix=
[[3078  517]
 [ 462 3243]]
Epoch 19, Phase val, Loss=0.4891, Acc=0.7966, AUC=0.7994, TPR=0.6031, TNR=0.8312, J=0.4343, MCC=0.3674, ConfusionMatrix=
[[1807  367]
 [ 154  234]]
Epoch 19, Phase test, Loss=0.5088, Acc=0.8100, AUC=0.7730, TPR=0.6156, TNR=0.8434, J=0.4590, MCC=0.3898, ConfusionMatrix=
[[1821  338]
 [ 143  229]]
Epoch 19 complete in 36.25

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.3251, Acc=0.8684, AUC=0.9348, TPR=0.8736, TNR=0.8632, J=0.7367, MCC=0.7368, ConfusionMatrix=
[[3161  501]
 [ 460 3178]]
Epoch 20, Phase val, Loss=0.4099, Acc=0.8357, AUC=0.7712, TPR=0.4253, TNR=0.9089, J=0.3342, MCC=0.3435, ConfusionMatrix=
[[1976  198]
 [ 223  165]]
Epoch 20, Phase test, Loss=0.3937, Acc=0.8487, AUC=0.7665, TPR=0.4247, TNR=0.9217, J=0.3465, MCC=0.3657, ConfusionMatrix=
[[1990  169]
 [ 214  158]]
Epoch 20 complete in 35.97

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.3100, Acc=0.8707, AUC=0.9404, TPR=0.8792, TNR=0.8624, J=0.7416, MCC=0.7415, ConfusionMatrix=
[[3191  509]
 [ 435 3165]]
Epoch 21, Phase val, Loss=0.4270, Acc=0.8353, AUC=0.7880, TPR=0.4665, TNR=0.9011, J=0.3676, MCC=0.3645, ConfusionMatrix=
[[1959  215]
 [ 207  181]]
Epoch 21, Phase test, Loss=0.4573, Acc=0.8309, AUC=0.7408, TPR=0.4839, TNR=0.8907, J=0.3746, MCC=0.3579, ConfusionMatrix=
[[1923  236]
 [ 192  180]]
Epoch 21 complete in 37.18

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.2987, Acc=0.8816, AUC=0.9445, TPR=0.8886, TNR=0.8748, J=0.7634, MCC=0.7634, ConfusionMatrix=
[[3228  462]
 [ 402 3208]]
Epoch 22, Phase val, Loss=0.5038, Acc=0.7986, AUC=0.7974, TPR=0.5979, TNR=0.8344, J=0.4323, MCC=0.3677, ConfusionMatrix=
[[1814  360]
 [ 156  232]]
Epoch 22, Phase test, Loss=0.5283, Acc=0.8060, AUC=0.7750, TPR=0.6183, TNR=0.8384, J=0.4566, MCC=0.3849, ConfusionMatrix=
[[1810  349]
 [ 142  230]]
Epoch 22 complete in 35.95

Early Stop!
Training complete in 13m 57s
The best model val AUC=0.810313309117, test AUC=0.779678216219.
Finish training resnet18scratch-conv1x1-maxpool

Start training resnet18scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6165, Acc=0.6379, AUC=0.7115, TPR=0.5779, TNR=0.6969, J=0.2747, MCC=0.2768, ConfusionMatrix=
[[2568 1117]
 [1526 2089]]
Epoch 0, Phase val, Loss=0.7305, Acc=0.6397, AUC=0.7614, TPR=0.7397, TNR=0.6219, J=0.3616, MCC=0.2616, ConfusionMatrix=
[[1352  822]
 [ 101  287]]
New Best AUC=0.7614. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7309, Acc=0.6168, AUC=0.7346, TPR=0.7043, TNR=0.6017, J=0.3060, MCC=0.2181, ConfusionMatrix=
[[1299  860]
 [ 110  262]]
Epoch 0 complete in 36.39

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5510, Acc=0.7196, AUC=0.7944, TPR=0.6763, TNR=0.7638, J=0.4400, MCC=0.4415, ConfusionMatrix=
[[2761  854]
 [1193 2492]]
Epoch 1, Phase val, Loss=0.7730, Acc=0.6667, AUC=0.7752, TPR=0.7706, TNR=0.6481, J=0.4187, MCC=0.3046, ConfusionMatrix=
[[1409  765]
 [  89  299]]
New Best AUC=0.7752. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7973, Acc=0.6274, AUC=0.7562, TPR=0.7527, TNR=0.6058, J=0.3585, MCC=0.2553, ConfusionMatrix=
[[1308  851]
 [  92  280]]
Epoch 1 complete in 36.97

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5301, Acc=0.7412, AUC=0.8136, TPR=0.6972, TNR=0.7847, J=0.4820, MCC=0.4839, ConfusionMatrix=
[[2880  790]
 [1099 2531]]
Epoch 2, Phase val, Loss=0.5207, Acc=0.7666, AUC=0.7757, TPR=0.6031, TNR=0.7958, J=0.3989, MCC=0.3241, ConfusionMatrix=
[[1730  444]
 [ 154  234]]
New Best AUC=0.7757. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5292, Acc=0.7562, AUC=0.7544, TPR=0.5806, TNR=0.7865, J=0.3671, MCC=0.2937, ConfusionMatrix=
[[1698  461]
 [ 156  216]]
Epoch 2 complete in 36.72

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5008, Acc=0.7611, AUC=0.8360, TPR=0.7215, TNR=0.8009, J=0.5224, MCC=0.5240, ConfusionMatrix=
[[2916  725]
 [1019 2640]]
Epoch 3, Phase val, Loss=0.6828, Acc=0.6823, AUC=0.7977, TPR=0.7758, TNR=0.6656, J=0.4414, MCC=0.3228, ConfusionMatrix=
[[1447  727]
 [  87  301]]
New Best AUC=0.7977. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6962, Acc=0.6689, AUC=0.7774, TPR=0.7339, TNR=0.6577, J=0.3916, MCC=0.2830, ConfusionMatrix=
[[1420  739]
 [  99  273]]
Epoch 3 complete in 37.32

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5125, Acc=0.7568, AUC=0.8300, TPR=0.7125, TNR=0.7999, J=0.5124, MCC=0.5147, ConfusionMatrix=
[[2962  741]
 [1034 2563]]
Epoch 4, Phase val, Loss=0.7837, Acc=0.6569, AUC=0.7963, TPR=0.8144, TNR=0.6288, J=0.4432, MCC=0.3202, ConfusionMatrix=
[[1367  807]
 [  72  316]]
Epoch 4, Phase test, Loss=0.8074, Acc=0.6247, AUC=0.7692, TPR=0.7742, TNR=0.5989, J=0.3731, MCC=0.2652, ConfusionMatrix=
[[1293  866]
 [  84  288]]
Epoch 4 complete in 36.04

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4827, Acc=0.7744, AUC=0.8502, TPR=0.7394, TNR=0.8086, J=0.5480, MCC=0.5495, ConfusionMatrix=
[[2986  707]
 [ 940 2667]]
Epoch 5, Phase val, Loss=0.4660, Acc=0.8142, AUC=0.7726, TPR=0.5979, TNR=0.8528, J=0.4507, MCC=0.3930, ConfusionMatrix=
[[1854  320]
 [ 156  232]]
Epoch 5, Phase test, Loss=0.4770, Acc=0.8036, AUC=0.7434, TPR=0.5672, TNR=0.8444, J=0.4116, MCC=0.3541, ConfusionMatrix=
[[1823  336]
 [ 161  211]]
Epoch 5 complete in 36.14

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4799, Acc=0.7766, AUC=0.8519, TPR=0.7490, TNR=0.8035, J=0.5525, MCC=0.5535, ConfusionMatrix=
[[2969  726]
 [ 905 2700]]
Epoch 6, Phase val, Loss=0.5384, Acc=0.7596, AUC=0.7807, TPR=0.6495, TNR=0.7792, J=0.4287, MCC=0.3402, ConfusionMatrix=
[[1694  480]
 [ 136  252]]
Epoch 6, Phase test, Loss=0.5670, Acc=0.7610, AUC=0.7631, TPR=0.6344, TNR=0.7828, J=0.4172, MCC=0.3295, ConfusionMatrix=
[[1690  469]
 [ 136  236]]
Epoch 6 complete in 36.34

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4698, Acc=0.7866, AUC=0.8587, TPR=0.7505, TNR=0.8214, J=0.5718, MCC=0.5737, ConfusionMatrix=
[[3053  664]
 [ 894 2689]]
Epoch 7, Phase val, Loss=0.9620, Acc=0.5847, AUC=0.8003, TPR=0.8763, TNR=0.5327, J=0.4089, MCC=0.2937, ConfusionMatrix=
[[1158 1016]
 [  48  340]]
New Best AUC=0.8003. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 7, Phase test, Loss=1.0106, Acc=0.5670, AUC=0.7720, TPR=0.8360, TNR=0.5206, J=0.3566, MCC=0.2531, ConfusionMatrix=
[[1124 1035]
 [  61  311]]
Epoch 7 complete in 36.53

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4543, Acc=0.7916, AUC=0.8694, TPR=0.7709, TNR=0.8128, J=0.5837, MCC=0.5841, ConfusionMatrix=
[[2936  676]
 [ 845 2843]]
Epoch 8, Phase val, Loss=0.4487, Acc=0.8189, AUC=0.8049, TPR=0.5799, TNR=0.8615, J=0.4414, MCC=0.3918, ConfusionMatrix=
[[1873  301]
 [ 163  225]]
New Best AUC=0.8049. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.4668, Acc=0.8072, AUC=0.7746, TPR=0.5753, TNR=0.8472, J=0.4224, MCC=0.3641, ConfusionMatrix=
[[1829  330]
 [ 158  214]]
Epoch 8 complete in 37.45

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4443, Acc=0.7982, AUC=0.8761, TPR=0.7771, TNR=0.8192, J=0.5963, MCC=0.5969, ConfusionMatrix=
[[2999  662]
 [ 811 2828]]
Epoch 9, Phase val, Loss=0.4047, Acc=0.8404, AUC=0.7826, TPR=0.5103, TNR=0.8993, J=0.4096, MCC=0.3977, ConfusionMatrix=
[[1955  219]
 [ 190  198]]
Epoch 9, Phase test, Loss=0.4245, Acc=0.8420, AUC=0.7502, TPR=0.4839, TNR=0.9037, J=0.3875, MCC=0.3809, ConfusionMatrix=
[[1951  208]
 [ 192  180]]
Epoch 9 complete in 36.13

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4549, Acc=0.7916, AUC=0.8690, TPR=0.7697, TNR=0.8141, J=0.5838, MCC=0.5842, ConfusionMatrix=
[[2938  671]
 [ 850 2841]]
Epoch 10, Phase val, Loss=0.6322, Acc=0.7268, AUC=0.7918, TPR=0.7397, TNR=0.7245, J=0.4642, MCC=0.3498, ConfusionMatrix=
[[1575  599]
 [ 101  287]]
Epoch 10, Phase test, Loss=0.6361, Acc=0.7218, AUC=0.7707, TPR=0.7151, TNR=0.7230, J=0.4381, MCC=0.3271, ConfusionMatrix=
[[1561  598]
 [ 106  266]]
Epoch 10 complete in 36.01

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4368, Acc=0.8056, AUC=0.8806, TPR=0.7990, TNR=0.8124, J=0.6114, MCC=0.6114, ConfusionMatrix=
[[2923  675]
 [ 744 2958]]
Epoch 11, Phase val, Loss=0.6311, Acc=0.7342, AUC=0.7863, TPR=0.7474, TNR=0.7318, J=0.4793, MCC=0.3625, ConfusionMatrix=
[[1591  583]
 [  98  290]]
Epoch 11, Phase test, Loss=0.6469, Acc=0.7159, AUC=0.7705, TPR=0.7124, TNR=0.7165, J=0.4289, MCC=0.3191, ConfusionMatrix=
[[1547  612]
 [ 107  265]]
Epoch 11 complete in 36.04

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4261, Acc=0.8168, AUC=0.8864, TPR=0.8167, TNR=0.8170, J=0.6337, MCC=0.6336, ConfusionMatrix=
[[2928  656]
 [ 681 3035]]
Epoch 12, Phase val, Loss=0.5732, Acc=0.7623, AUC=0.7814, TPR=0.6753, TNR=0.7778, J=0.4531, MCC=0.3577, ConfusionMatrix=
[[1691  483]
 [ 126  262]]
Epoch 12, Phase test, Loss=0.5811, Acc=0.7523, AUC=0.7695, TPR=0.6694, TNR=0.7666, J=0.4359, MCC=0.3376, ConfusionMatrix=
[[1655  504]
 [ 123  249]]
Epoch 12 complete in 36.12

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4170, Acc=0.8107, AUC=0.8916, TPR=0.7962, TNR=0.8249, J=0.6212, MCC=0.6215, ConfusionMatrix=
[[3034  644]
 [ 738 2884]]
Epoch 13, Phase val, Loss=0.5462, Acc=0.7646, AUC=0.7824, TPR=0.6804, TNR=0.7797, J=0.4601, MCC=0.3635, ConfusionMatrix=
[[1695  479]
 [ 124  264]]
Epoch 13, Phase test, Loss=0.5627, Acc=0.7519, AUC=0.7567, TPR=0.6505, TNR=0.7693, J=0.4199, MCC=0.3269, ConfusionMatrix=
[[1661  498]
 [ 130  242]]
Epoch 13 complete in 37.00

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.3963, Acc=0.8242, AUC=0.9024, TPR=0.8210, TNR=0.8275, J=0.6485, MCC=0.6485, ConfusionMatrix=
[[3027  631]
 [ 652 2990]]
Epoch 14, Phase val, Loss=0.5611, Acc=0.7795, AUC=0.7815, TPR=0.6314, TNR=0.8059, J=0.4373, MCC=0.3573, ConfusionMatrix=
[[1752  422]
 [ 143  245]]
Epoch 14, Phase test, Loss=0.5632, Acc=0.7736, AUC=0.7597, TPR=0.6156, TNR=0.8008, J=0.4164, MCC=0.3360, ConfusionMatrix=
[[1729  430]
 [ 143  229]]
Epoch 14 complete in 35.96

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.3935, Acc=0.8288, AUC=0.9038, TPR=0.8357, TNR=0.8215, J=0.6572, MCC=0.6573, ConfusionMatrix=
[[2928  636]
 [ 614 3122]]
Epoch 15, Phase val, Loss=0.7415, Acc=0.6760, AUC=0.7796, TPR=0.7397, TNR=0.6647, J=0.4044, MCC=0.2963, ConfusionMatrix=
[[1445  729]
 [ 101  287]]
Epoch 15, Phase test, Loss=0.7738, Acc=0.6590, AUC=0.7675, TPR=0.7392, TNR=0.6452, J=0.3845, MCC=0.2766, ConfusionMatrix=
[[1393  766]
 [  97  275]]
Epoch 15 complete in 36.09

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.3750, Acc=0.8414, AUC=0.9130, TPR=0.8367, TNR=0.8460, J=0.6828, MCC=0.6828, ConfusionMatrix=
[[3083  561]
 [ 597 3059]]
Epoch 16, Phase val, Loss=0.5478, Acc=0.7635, AUC=0.7789, TPR=0.6907, TNR=0.7764, J=0.4672, MCC=0.3675, ConfusionMatrix=
[[1688  486]
 [ 120  268]]
Epoch 16, Phase test, Loss=0.5681, Acc=0.7384, AUC=0.7520, TPR=0.6371, TNR=0.7559, J=0.3930, MCC=0.3031, ConfusionMatrix=
[[1632  527]
 [ 135  237]]
Epoch 16 complete in 35.93

Early Stop!
Training complete in 10m 19s
The best model val AUC=0.80487414524, test AUC=0.774578284451.
Finish training resnet18scratch-conv1x1-maxpool

Start training resnet18scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6001, Acc=0.6785, AUC=0.7450, TPR=0.6201, TNR=0.7376, J=0.3577, MCC=0.3601, ConfusionMatrix=
[[2676  952]
 [1395 2277]]
Epoch 0, Phase val, Loss=0.4601, Acc=0.8372, AUC=0.7479, TPR=0.3686, TNR=0.9209, J=0.2894, MCC=0.3160, ConfusionMatrix=
[[2002  172]
 [ 245  143]]
New Best AUC=0.7479. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4358, Acc=0.8514, AUC=0.7291, TPR=0.3710, TNR=0.9342, J=0.3052, MCC=0.3445, ConfusionMatrix=
[[2017  142]
 [ 234  138]]
Epoch 0 complete in 36.48

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5542, Acc=0.7258, AUC=0.7948, TPR=0.6657, TNR=0.7864, J=0.4521, MCC=0.4553, ConfusionMatrix=
[[2857  776]
 [1226 2441]]
Epoch 1, Phase val, Loss=0.5214, Acc=0.7978, AUC=0.7726, TPR=0.5309, TNR=0.8454, J=0.3764, MCC=0.3304, ConfusionMatrix=
[[1838  336]
 [ 182  206]]
New Best AUC=0.7726. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5113, Acc=0.8123, AUC=0.7459, TPR=0.5134, TNR=0.8638, J=0.3773, MCC=0.3394, ConfusionMatrix=
[[1865  294]
 [ 181  191]]
Epoch 1 complete in 37.57

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5460, Acc=0.7252, AUC=0.8001, TPR=0.6639, TNR=0.7870, J=0.4510, MCC=0.4543, ConfusionMatrix=
[[2860  774]
 [1232 2434]]
Epoch 2, Phase val, Loss=0.6861, Acc=0.6674, AUC=0.7962, TPR=0.7577, TNR=0.6513, J=0.4091, MCC=0.2981, ConfusionMatrix=
[[1416  758]
 [  94  294]]
New Best AUC=0.7962. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.7183, Acc=0.6559, AUC=0.7645, TPR=0.7204, TNR=0.6447, J=0.3652, MCC=0.2630, ConfusionMatrix=
[[1392  767]
 [ 104  268]]
Epoch 2 complete in 36.70

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5169, Acc=0.7589, AUC=0.8258, TPR=0.7172, TNR=0.8014, J=0.5186, MCC=0.5202, ConfusionMatrix=
[[2898  718]
 [1042 2642]]
Epoch 3, Phase val, Loss=0.4640, Acc=0.8177, AUC=0.7814, TPR=0.5825, TNR=0.8597, J=0.4422, MCC=0.3911, ConfusionMatrix=
[[1869  305]
 [ 162  226]]
Epoch 3, Phase test, Loss=0.4802, Acc=0.8175, AUC=0.7652, TPR=0.5618, TNR=0.8615, J=0.4233, MCC=0.3742, ConfusionMatrix=
[[1860  299]
 [ 163  209]]
Epoch 3 complete in 36.04

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4972, Acc=0.7648, AUC=0.8396, TPR=0.7517, TNR=0.7782, J=0.5299, MCC=0.5300, ConfusionMatrix=
[[2810  801]
 [ 916 2773]]
Epoch 4, Phase val, Loss=0.4544, Acc=0.8220, AUC=0.7569, TPR=0.5387, TNR=0.8726, J=0.4112, MCC=0.3760, ConfusionMatrix=
[[1897  277]
 [ 179  209]]
Epoch 4, Phase test, Loss=0.4520, Acc=0.8186, AUC=0.7597, TPR=0.5188, TNR=0.8703, J=0.3891, MCC=0.3535, ConfusionMatrix=
[[1879  280]
 [ 179  193]]
Epoch 4 complete in 36.04

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4964, Acc=0.7677, AUC=0.8402, TPR=0.7376, TNR=0.7979, J=0.5356, MCC=0.5365, ConfusionMatrix=
[[2902  735]
 [ 961 2702]]
Epoch 5, Phase val, Loss=0.5165, Acc=0.7853, AUC=0.7987, TPR=0.6366, TNR=0.8119, J=0.4485, MCC=0.3684, ConfusionMatrix=
[[1765  409]
 [ 141  247]]
New Best AUC=0.7987. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5487, Acc=0.7665, AUC=0.7720, TPR=0.6344, TNR=0.7893, J=0.4237, MCC=0.3367, ConfusionMatrix=
[[1704  455]
 [ 136  236]]
Epoch 5 complete in 37.63

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4855, Acc=0.7771, AUC=0.8479, TPR=0.7575, TNR=0.7973, J=0.5548, MCC=0.5550, ConfusionMatrix=
[[2868  729]
 [ 898 2805]]
Epoch 6, Phase val, Loss=0.5254, Acc=0.7724, AUC=0.7864, TPR=0.6418, TNR=0.7958, J=0.4375, MCC=0.3531, ConfusionMatrix=
[[1730  444]
 [ 139  249]]
Epoch 6, Phase test, Loss=0.5424, Acc=0.7772, AUC=0.7710, TPR=0.6478, TNR=0.7994, J=0.4473, MCC=0.3583, ConfusionMatrix=
[[1726  433]
 [ 131  241]]
Epoch 6 complete in 35.94

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4780, Acc=0.7803, AUC=0.8520, TPR=0.7577, TNR=0.8030, J=0.5607, MCC=0.5612, ConfusionMatrix=
[[2922  717]
 [ 887 2774]]
Epoch 7, Phase val, Loss=0.6136, Acc=0.7408, AUC=0.7737, TPR=0.7036, TNR=0.7475, J=0.4511, MCC=0.3464, ConfusionMatrix=
[[1625  549]
 [ 115  273]]
Epoch 7, Phase test, Loss=0.6049, Acc=0.7396, AUC=0.7734, TPR=0.6774, TNR=0.7503, J=0.4278, MCC=0.3268, ConfusionMatrix=
[[1620  539]
 [ 120  252]]
Epoch 7 complete in 36.14

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4624, Acc=0.7874, AUC=0.8625, TPR=0.7619, TNR=0.8133, J=0.5753, MCC=0.5759, ConfusionMatrix=
[[2941  675]
 [ 877 2807]]
Epoch 8, Phase val, Loss=0.6509, Acc=0.7279, AUC=0.7884, TPR=0.7423, TNR=0.7254, J=0.4677, MCC=0.3526, ConfusionMatrix=
[[1577  597]
 [ 100  288]]
Epoch 8, Phase test, Loss=0.6766, Acc=0.6934, AUC=0.7704, TPR=0.7043, TNR=0.6915, J=0.3958, MCC=0.2908, ConfusionMatrix=
[[1493  666]
 [ 110  262]]
Epoch 8 complete in 36.19

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4464, Acc=0.7996, AUC=0.8740, TPR=0.7764, TNR=0.8222, J=0.5986, MCC=0.5994, ConfusionMatrix=
[[3039  657]
 [ 806 2798]]
Epoch 9, Phase val, Loss=0.4891, Acc=0.7994, AUC=0.7798, TPR=0.6186, TNR=0.8316, J=0.4502, MCC=0.3798, ConfusionMatrix=
[[1808  366]
 [ 148  240]]
Epoch 9, Phase test, Loss=0.4948, Acc=0.7961, AUC=0.7592, TPR=0.6183, TNR=0.8268, J=0.4451, MCC=0.3697, ConfusionMatrix=
[[1785  374]
 [ 142  230]]
Epoch 9 complete in 37.04

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4321, Acc=0.8107, AUC=0.8814, TPR=0.7846, TNR=0.8361, J=0.6208, MCC=0.6218, ConfusionMatrix=
[[3087  605]
 [ 777 2831]]
Epoch 10, Phase val, Loss=0.3992, Acc=0.8365, AUC=0.7754, TPR=0.4665, TNR=0.9025, J=0.3690, MCC=0.3670, ConfusionMatrix=
[[1962  212]
 [ 207  181]]
Epoch 10, Phase test, Loss=0.3879, Acc=0.8372, AUC=0.7678, TPR=0.4355, TNR=0.9064, J=0.3419, MCC=0.3450, ConfusionMatrix=
[[1957  202]
 [ 210  162]]
Epoch 10 complete in 35.91

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4343, Acc=0.8075, AUC=0.8807, TPR=0.7875, TNR=0.8276, J=0.6151, MCC=0.6156, ConfusionMatrix=
[[3019  629]
 [ 776 2876]]
Epoch 11, Phase val, Loss=0.4428, Acc=0.8154, AUC=0.8015, TPR=0.5979, TNR=0.8542, J=0.4521, MCC=0.3950, ConfusionMatrix=
[[1857  317]
 [ 156  232]]
New Best AUC=0.8015. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.4473, Acc=0.8123, AUC=0.7815, TPR=0.6102, TNR=0.8472, J=0.4574, MCC=0.3909, ConfusionMatrix=
[[1829  330]
 [ 145  227]]
Epoch 11 complete in 36.47

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4331, Acc=0.8097, AUC=0.8831, TPR=0.7863, TNR=0.8322, J=0.6185, MCC=0.6194, ConfusionMatrix=
[[3100  625]
 [ 764 2811]]
Epoch 12, Phase val, Loss=0.6519, Acc=0.7229, AUC=0.7886, TPR=0.7526, TNR=0.7176, J=0.4701, MCC=0.3525, ConfusionMatrix=
[[1560  614]
 [  96  292]]
Epoch 12, Phase test, Loss=0.6589, Acc=0.7033, AUC=0.7833, TPR=0.7204, TNR=0.7003, J=0.4208, MCC=0.3101, ConfusionMatrix=
[[1512  647]
 [ 104  268]]
Epoch 12 complete in 36.14

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4309, Acc=0.8079, AUC=0.8836, TPR=0.7891, TNR=0.8265, J=0.6156, MCC=0.6161, ConfusionMatrix=
[[3043  639]
 [ 763 2855]]
Epoch 13, Phase val, Loss=0.3946, Acc=0.8462, AUC=0.7553, TPR=0.4381, TNR=0.9190, J=0.3572, MCC=0.3746, ConfusionMatrix=
[[1998  176]
 [ 218  170]]
Epoch 13, Phase test, Loss=0.3972, Acc=0.8617, AUC=0.7425, TPR=0.4812, TNR=0.9273, J=0.4085, MCC=0.4263, ConfusionMatrix=
[[2002  157]
 [ 193  179]]
Epoch 13 complete in 36.13

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4202, Acc=0.8240, AUC=0.8894, TPR=0.8093, TNR=0.8384, J=0.6477, MCC=0.6481, ConfusionMatrix=
[[3087  595]
 [ 690 2928]]
Epoch 14, Phase val, Loss=0.4217, Acc=0.8212, AUC=0.7812, TPR=0.5258, TNR=0.8740, J=0.3997, MCC=0.3678, ConfusionMatrix=
[[1900  274]
 [ 184  204]]
Epoch 14, Phase test, Loss=0.4127, Acc=0.8400, AUC=0.7716, TPR=0.5376, TNR=0.8921, J=0.4297, MCC=0.4040, ConfusionMatrix=
[[1926  233]
 [ 172  200]]
Epoch 14 complete in 36.93

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.3938, Acc=0.8314, AUC=0.9037, TPR=0.8181, TNR=0.8446, J=0.6627, MCC=0.6630, ConfusionMatrix=
[[3087  568]
 [ 663 2982]]
Epoch 15, Phase val, Loss=0.4307, Acc=0.8146, AUC=0.7776, TPR=0.5490, TNR=0.8620, J=0.4110, MCC=0.3682, ConfusionMatrix=
[[1874  300]
 [ 175  213]]
Epoch 15, Phase test, Loss=0.4406, Acc=0.8190, AUC=0.7477, TPR=0.5269, TNR=0.8694, J=0.3963, MCC=0.3585, ConfusionMatrix=
[[1877  282]
 [ 176  196]]
Epoch 15 complete in 36.15

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4023, Acc=0.8264, AUC=0.8995, TPR=0.8156, TNR=0.8370, J=0.6527, MCC=0.6529, ConfusionMatrix=
[[3087  601]
 [ 666 2946]]
Epoch 16, Phase val, Loss=0.4344, Acc=0.8267, AUC=0.7831, TPR=0.5696, TNR=0.8726, J=0.4422, MCC=0.4006, ConfusionMatrix=
[[1897  277]
 [ 167  221]]
Epoch 16, Phase test, Loss=0.4484, Acc=0.8179, AUC=0.7603, TPR=0.5591, TNR=0.8624, J=0.4216, MCC=0.3735, ConfusionMatrix=
[[1862  297]
 [ 164  208]]
Epoch 16 complete in 36.19

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.3698, Acc=0.8444, AUC=0.9158, TPR=0.8370, TNR=0.8517, J=0.6886, MCC=0.6888, ConfusionMatrix=
[[3135  546]
 [ 590 3029]]
Epoch 17, Phase val, Loss=0.4506, Acc=0.8310, AUC=0.7055, TPR=0.4046, TNR=0.9071, J=0.3117, MCC=0.3219, ConfusionMatrix=
[[1972  202]
 [ 231  157]]
Epoch 17, Phase test, Loss=0.4377, Acc=0.8400, AUC=0.7182, TPR=0.4274, TNR=0.9111, J=0.3385, MCC=0.3468, ConfusionMatrix=
[[1967  192]
 [ 213  159]]
Epoch 17 complete in 36.02

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.3699, Acc=0.8495, AUC=0.9154, TPR=0.8508, TNR=0.8480, J=0.6989, MCC=0.6989, ConfusionMatrix=
[[3058  548]
 [ 551 3143]]
Epoch 18, Phase val, Loss=0.4344, Acc=0.8302, AUC=0.7728, TPR=0.5412, TNR=0.8818, J=0.4230, MCC=0.3928, ConfusionMatrix=
[[1917  257]
 [ 178  210]]
Epoch 18, Phase test, Loss=0.4525, Acc=0.8214, AUC=0.7419, TPR=0.5000, TNR=0.8768, J=0.3768, MCC=0.3483, ConfusionMatrix=
[[1893  266]
 [ 186  186]]
Epoch 18 complete in 36.00

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.3575, Acc=0.8530, AUC=0.9209, TPR=0.8500, TNR=0.8560, J=0.7060, MCC=0.7060, ConfusionMatrix=
[[3156  531]
 [ 542 3071]]
Epoch 19, Phase val, Loss=0.5485, Acc=0.7627, AUC=0.7937, TPR=0.7036, TNR=0.7732, J=0.4768, MCC=0.3734, ConfusionMatrix=
[[1681  493]
 [ 115  273]]
Epoch 19, Phase test, Loss=0.5848, Acc=0.7380, AUC=0.7516, TPR=0.6398, TNR=0.7550, J=0.3948, MCC=0.3042, ConfusionMatrix=
[[1630  529]
 [ 134  238]]
Epoch 19 complete in 37.03

Early Stop!
Training complete in 12m 9s
The best model val AUC=0.80146577642, test AUC=0.781529680706.
Finish training resnet18scratch-conv1x1-maxpool

Start training resnet18scratch-conv1x1-maxpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6015, Acc=0.6637, AUC=0.7341, TPR=0.6279, TNR=0.6991, J=0.3270, MCC=0.3278, ConfusionMatrix=
[[2567 1105]
 [1350 2278]]
Epoch 0, Phase val, Loss=0.5233, Acc=0.8005, AUC=0.7656, TPR=0.5258, TNR=0.8496, J=0.3754, MCC=0.3320, ConfusionMatrix=
[[1847  327]
 [ 184  204]]
New Best AUC=0.7656. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5131, Acc=0.8048, AUC=0.7408, TPR=0.5000, TNR=0.8573, J=0.3573, MCC=0.3192, ConfusionMatrix=
[[1851  308]
 [ 186  186]]
Epoch 0 complete in 36.58

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5397, Acc=0.7334, AUC=0.8062, TPR=0.6774, TNR=0.7890, J=0.4664, MCC=0.4694, ConfusionMatrix=
[[2891  773]
 [1173 2463]]
Epoch 1, Phase val, Loss=0.4643, Acc=0.8134, AUC=0.7902, TPR=0.5129, TNR=0.8671, J=0.3800, MCC=0.3469, ConfusionMatrix=
[[1885  289]
 [ 189  199]]
New Best AUC=0.7902. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4601, Acc=0.8238, AUC=0.7699, TPR=0.5134, TNR=0.8773, J=0.3907, MCC=0.3600, ConfusionMatrix=
[[1894  265]
 [ 181  191]]
Epoch 1 complete in 36.57

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5261, Acc=0.7432, AUC=0.8148, TPR=0.6879, TNR=0.7982, J=0.4861, MCC=0.4891, ConfusionMatrix=
[[2919  738]
 [1137 2506]]
Epoch 2, Phase val, Loss=0.5331, Acc=0.7588, AUC=0.7887, TPR=0.6392, TNR=0.7801, J=0.4193, MCC=0.3336, ConfusionMatrix=
[[1696  478]
 [ 140  248]]
Epoch 2, Phase test, Loss=0.5483, Acc=0.7606, AUC=0.7795, TPR=0.6425, TNR=0.7809, J=0.4234, MCC=0.3334, ConfusionMatrix=
[[1686  473]
 [ 133  239]]
Epoch 2 complete in 36.10

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4999, Acc=0.7663, AUC=0.8348, TPR=0.7138, TNR=0.8181, J=0.5318, MCC=0.5350, ConfusionMatrix=
[[3008  669]
 [1037 2586]]
Epoch 3, Phase val, Loss=0.4820, Acc=0.8115, AUC=0.7890, TPR=0.5619, TNR=0.8560, J=0.4179, MCC=0.3696, ConfusionMatrix=
[[1861  313]
 [ 170  218]]
Epoch 3, Phase test, Loss=0.4757, Acc=0.8080, AUC=0.7573, TPR=0.5376, TNR=0.8546, J=0.3922, MCC=0.3452, ConfusionMatrix=
[[1845  314]
 [ 172  200]]
Epoch 3 complete in 36.13

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4895, Acc=0.7707, AUC=0.8438, TPR=0.7356, TNR=0.8055, J=0.5411, MCC=0.5425, ConfusionMatrix=
[[2952  713]
 [ 961 2674]]
Epoch 4, Phase val, Loss=0.4480, Acc=0.8048, AUC=0.7825, TPR=0.5593, TNR=0.8487, J=0.4079, MCC=0.3571, ConfusionMatrix=
[[1845  329]
 [ 171  217]]
Epoch 4, Phase test, Loss=0.4337, Acc=0.8119, AUC=0.7793, TPR=0.5672, TNR=0.8541, J=0.4213, MCC=0.3677, ConfusionMatrix=
[[1844  315]
 [ 161  211]]
Epoch 4 complete in 36.80

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4975, Acc=0.7647, AUC=0.8387, TPR=0.7437, TNR=0.7859, J=0.5296, MCC=0.5300, ConfusionMatrix=
[[2848  776]
 [ 942 2734]]
Epoch 5, Phase val, Loss=0.5500, Acc=0.7853, AUC=0.8014, TPR=0.6598, TNR=0.8077, J=0.4675, MCC=0.3806, ConfusionMatrix=
[[1756  418]
 [ 132  256]]
New Best AUC=0.8014. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5749, Acc=0.7558, AUC=0.7798, TPR=0.6478, TNR=0.7744, J=0.4223, MCC=0.3303, ConfusionMatrix=
[[1672  487]
 [ 131  241]]
Epoch 5 complete in 36.55

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4914, Acc=0.7730, AUC=0.8441, TPR=0.7462, TNR=0.8007, J=0.5469, MCC=0.5474, ConfusionMatrix=
[[2877  716]
 [ 941 2766]]
Epoch 6, Phase val, Loss=0.5383, Acc=0.7838, AUC=0.7767, TPR=0.6572, TNR=0.8063, J=0.4636, MCC=0.3771, ConfusionMatrix=
[[1753  421]
 [ 133  255]]
Epoch 6, Phase test, Loss=0.5768, Acc=0.7562, AUC=0.7654, TPR=0.6290, TNR=0.7781, J=0.4072, MCC=0.3205, ConfusionMatrix=
[[1680  479]
 [ 138  234]]
Epoch 6 complete in 36.14

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4714, Acc=0.7867, AUC=0.8555, TPR=0.7536, TNR=0.8207, J=0.5743, MCC=0.5753, ConfusionMatrix=
[[2957  646]
 [ 911 2786]]
Epoch 7, Phase val, Loss=0.6023, Acc=0.7635, AUC=0.7864, TPR=0.6753, TNR=0.7792, J=0.4545, MCC=0.3592, ConfusionMatrix=
[[1694  480]
 [ 126  262]]
Epoch 7, Phase test, Loss=0.6204, Acc=0.7388, AUC=0.7868, TPR=0.7016, TNR=0.7453, J=0.4469, MCC=0.3391, ConfusionMatrix=
[[1609  550]
 [ 111  261]]
Epoch 7 complete in 36.02

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4721, Acc=0.7859, AUC=0.8579, TPR=0.7556, TNR=0.8159, J=0.5715, MCC=0.5726, ConfusionMatrix=
[[2991  675]
 [ 888 2746]]
Epoch 8, Phase val, Loss=0.4136, Acc=0.8283, AUC=0.7724, TPR=0.4742, TNR=0.8914, J=0.3657, MCC=0.3541, ConfusionMatrix=
[[1938  236]
 [ 204  184]]
Epoch 8, Phase test, Loss=0.4189, Acc=0.8388, AUC=0.7681, TPR=0.5242, TNR=0.8930, J=0.4172, MCC=0.3948, ConfusionMatrix=
[[1928  231]
 [ 177  195]]
Epoch 8 complete in 36.18

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4543, Acc=0.7932, AUC=0.8677, TPR=0.7515, TNR=0.8328, J=0.5843, MCC=0.5868, ConfusionMatrix=
[[3113  625]
 [ 885 2677]]
Epoch 9, Phase val, Loss=0.7488, Acc=0.6788, AUC=0.7946, TPR=0.7552, TNR=0.6651, J=0.4203, MCC=0.3077, ConfusionMatrix=
[[1446  728]
 [  95  293]]
Epoch 9, Phase test, Loss=0.8129, Acc=0.6345, AUC=0.7751, TPR=0.7634, TNR=0.6123, J=0.3758, MCC=0.2679, ConfusionMatrix=
[[1322  837]
 [  88  284]]
Epoch 9 complete in 37.26

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4475, Acc=0.8041, AUC=0.8731, TPR=0.7843, TNR=0.8243, J=0.6087, MCC=0.6090, ConfusionMatrix=
[[2975  634]
 [ 796 2895]]
Epoch 10, Phase val, Loss=0.4942, Acc=0.7998, AUC=0.8004, TPR=0.6289, TNR=0.8303, J=0.4591, MCC=0.3858, ConfusionMatrix=
[[1805  369]
 [ 144  244]]
Epoch 10, Phase test, Loss=0.5217, Acc=0.7985, AUC=0.7842, TPR=0.6586, TNR=0.8226, J=0.4812, MCC=0.3945, ConfusionMatrix=
[[1776  383]
 [ 127  245]]
Epoch 10 complete in 35.90

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4437, Acc=0.8019, AUC=0.8753, TPR=0.7792, TNR=0.8247, J=0.6039, MCC=0.6045, ConfusionMatrix=
[[3006  639]
 [ 807 2848]]
Epoch 11, Phase val, Loss=0.5401, Acc=0.8076, AUC=0.7423, TPR=0.5747, TNR=0.8491, J=0.4239, MCC=0.3698, ConfusionMatrix=
[[1846  328]
 [ 165  223]]
Epoch 11, Phase test, Loss=0.5487, Acc=0.7890, AUC=0.7281, TPR=0.5726, TNR=0.8263, J=0.3989, MCC=0.3344, ConfusionMatrix=
[[1784  375]
 [ 159  213]]
Epoch 11 complete in 36.09

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4356, Acc=0.8023, AUC=0.8805, TPR=0.7753, TNR=0.8291, J=0.6045, MCC=0.6054, ConfusionMatrix=
[[3038  626]
 [ 817 2819]]
Epoch 12, Phase val, Loss=0.4615, Acc=0.8177, AUC=0.7757, TPR=0.5799, TNR=0.8602, J=0.4401, MCC=0.3897, ConfusionMatrix=
[[1870  304]
 [ 163  225]]
Epoch 12, Phase test, Loss=0.4876, Acc=0.7870, AUC=0.7548, TPR=0.5699, TNR=0.8245, J=0.3943, MCC=0.3301, ConfusionMatrix=
[[1780  379]
 [ 160  212]]
Epoch 12 complete in 36.10

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4344, Acc=0.8088, AUC=0.8819, TPR=0.7934, TNR=0.8240, J=0.6175, MCC=0.6178, ConfusionMatrix=
[[3016  644]
 [ 752 2888]]
Epoch 13, Phase val, Loss=0.4417, Acc=0.8181, AUC=0.7684, TPR=0.5464, TNR=0.8666, J=0.4130, MCC=0.3730, ConfusionMatrix=
[[1884  290]
 [ 176  212]]
Epoch 13, Phase test, Loss=0.4646, Acc=0.8214, AUC=0.7712, TPR=0.5726, TNR=0.8643, J=0.4369, MCC=0.3868, ConfusionMatrix=
[[1866  293]
 [ 159  213]]
Epoch 13 complete in 36.25

Early Stop!
Training complete in 8m 29s
The best model val AUC=0.801376269691, test AUC=0.779782804664.
Finish training resnet18scratch-conv1x1-maxpool

Start training resnet18scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5756, Acc=0.6930, AUC=0.7657, TPR=0.6909, TNR=0.6952, J=0.3861, MCC=0.3860, ConfusionMatrix=
[[2518 1104]
 [1137 2541]]
Epoch 0, Phase val, Loss=0.5861, Acc=0.7584, AUC=0.7761, TPR=0.6340, TNR=0.7806, J=0.4146, MCC=0.3302, ConfusionMatrix=
[[1697  477]
 [ 142  246]]
New Best AUC=0.7761. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5724, Acc=0.7463, AUC=0.7655, TPR=0.6398, TNR=0.7647, J=0.4045, MCC=0.3141, ConfusionMatrix=
[[1651  508]
 [ 134  238]]
Epoch 0 complete in 37.37

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5374, Acc=0.7326, AUC=0.8060, TPR=0.6775, TNR=0.7885, J=0.4659, MCC=0.4687, ConfusionMatrix=
[[2859  767]
 [1185 2489]]
Epoch 1, Phase val, Loss=0.5527, Acc=0.7771, AUC=0.7819, TPR=0.5954, TNR=0.8096, J=0.4049, MCC=0.3345, ConfusionMatrix=
[[1760  414]
 [ 157  231]]
New Best AUC=0.7819. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5513, Acc=0.7708, AUC=0.7699, TPR=0.6210, TNR=0.7967, J=0.4176, MCC=0.3352, ConfusionMatrix=
[[1720  439]
 [ 141  231]]
Epoch 1 complete in 36.58

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5252, Acc=0.7510, AUC=0.8174, TPR=0.6990, TNR=0.8034, J=0.5023, MCC=0.5050, ConfusionMatrix=
[[2921  715]
 [1103 2561]]
Epoch 2, Phase val, Loss=0.4497, Acc=0.8380, AUC=0.7909, TPR=0.4201, TNR=0.9126, J=0.3327, MCC=0.3460, ConfusionMatrix=
[[1984  190]
 [ 225  163]]
New Best AUC=0.7909. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4202, Acc=0.8487, AUC=0.7807, TPR=0.4543, TNR=0.9166, J=0.3709, MCC=0.3809, ConfusionMatrix=
[[1979  180]
 [ 203  169]]
Epoch 2 complete in 36.56

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5151, Acc=0.7503, AUC=0.8245, TPR=0.6907, TNR=0.8082, J=0.4989, MCC=0.5027, ConfusionMatrix=
[[2992  710]
 [1113 2485]]
Epoch 3, Phase val, Loss=0.5877, Acc=0.7436, AUC=0.8011, TPR=0.7010, TNR=0.7511, J=0.4522, MCC=0.3483, ConfusionMatrix=
[[1633  541]
 [ 116  272]]
New Best AUC=0.8011. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5946, Acc=0.7365, AUC=0.7798, TPR=0.6882, TNR=0.7448, J=0.4330, MCC=0.3290, ConfusionMatrix=
[[1608  551]
 [ 116  256]]
Epoch 3 complete in 36.73

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5055, Acc=0.7685, AUC=0.8366, TPR=0.7197, TNR=0.8180, J=0.5376, MCC=0.5401, ConfusionMatrix=
[[2966  660]
 [1030 2644]]
Epoch 4, Phase val, Loss=0.5053, Acc=0.8095, AUC=0.8000, TPR=0.6263, TNR=0.8422, J=0.4685, MCC=0.3999, ConfusionMatrix=
[[1831  343]
 [ 145  243]]
Epoch 4, Phase test, Loss=0.5053, Acc=0.7973, AUC=0.7848, TPR=0.5995, TNR=0.8314, J=0.4309, MCC=0.3615, ConfusionMatrix=
[[1795  364]
 [ 149  223]]
Epoch 4 complete in 37.06

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5025, Acc=0.7637, AUC=0.8349, TPR=0.7200, TNR=0.8074, J=0.5274, MCC=0.5294, ConfusionMatrix=
[[2947  703]
 [1022 2628]]
Epoch 5, Phase val, Loss=0.4527, Acc=0.8306, AUC=0.8085, TPR=0.5515, TNR=0.8804, J=0.4320, MCC=0.3988, ConfusionMatrix=
[[1914  260]
 [ 174  214]]
New Best AUC=0.8085. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.4549, Acc=0.8427, AUC=0.7871, TPR=0.5188, TNR=0.8986, J=0.4174, MCC=0.4003, ConfusionMatrix=
[[1940  219]
 [ 179  193]]
Epoch 5 complete in 36.93

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4866, Acc=0.7768, AUC=0.8470, TPR=0.7322, TNR=0.8207, J=0.5529, MCC=0.5553, ConfusionMatrix=
[[3021  660]
 [ 969 2650]]
Epoch 6, Phase val, Loss=0.5720, Acc=0.7923, AUC=0.7970, TPR=0.6418, TNR=0.8192, J=0.4610, MCC=0.3813, ConfusionMatrix=
[[1781  393]
 [ 139  249]]
Epoch 6, Phase test, Loss=0.5882, Acc=0.7732, AUC=0.7879, TPR=0.6398, TNR=0.7962, J=0.4360, MCC=0.3486, ConfusionMatrix=
[[1719  440]
 [ 134  238]]
Epoch 6 complete in 35.98

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5026, Acc=0.7570, AUC=0.8352, TPR=0.7053, TNR=0.8088, J=0.5141, MCC=0.5168, ConfusionMatrix=
[[2949  697]
 [1077 2577]]
Epoch 7, Phase val, Loss=0.4170, Acc=0.8392, AUC=0.7923, TPR=0.4923, TNR=0.9011, J=0.3934, MCC=0.3862, ConfusionMatrix=
[[1959  215]
 [ 197  191]]
Epoch 7, Phase test, Loss=0.4055, Acc=0.8400, AUC=0.7756, TPR=0.4785, TNR=0.9023, J=0.3808, MCC=0.3738, ConfusionMatrix=
[[1948  211]
 [ 194  178]]
Epoch 7 complete in 36.02

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4775, Acc=0.7790, AUC=0.8502, TPR=0.7394, TNR=0.8193, J=0.5587, MCC=0.5603, ConfusionMatrix=
[[2969  655]
 [ 958 2718]]
Epoch 8, Phase val, Loss=0.5474, Acc=0.7842, AUC=0.8012, TPR=0.6727, TNR=0.8040, J=0.4767, MCC=0.3858, ConfusionMatrix=
[[1748  426]
 [ 127  261]]
Epoch 8, Phase test, Loss=0.5531, Acc=0.7712, AUC=0.7924, TPR=0.6720, TNR=0.7883, J=0.4604, MCC=0.3633, ConfusionMatrix=
[[1702  457]
 [ 122  250]]
Epoch 8 complete in 37.15

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4656, Acc=0.7874, AUC=0.8620, TPR=0.7410, TNR=0.8337, J=0.5747, MCC=0.5772, ConfusionMatrix=
[[3047  608]
 [ 944 2701]]
Epoch 9, Phase val, Loss=0.4994, Acc=0.7939, AUC=0.8084, TPR=0.6649, TNR=0.8169, J=0.4819, MCC=0.3958, ConfusionMatrix=
[[1776  398]
 [ 130  258]]
Epoch 9, Phase test, Loss=0.5174, Acc=0.7878, AUC=0.7833, TPR=0.6559, TNR=0.8106, J=0.4665, MCC=0.3775, ConfusionMatrix=
[[1750  409]
 [ 128  244]]
Epoch 9 complete in 36.11

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4732, Acc=0.7836, AUC=0.8564, TPR=0.7396, TNR=0.8271, J=0.5667, MCC=0.5690, ConfusionMatrix=
[[3033  634]
 [ 946 2687]]
Epoch 10, Phase val, Loss=0.8765, Acc=0.6140, AUC=0.7880, TPR=0.8170, TNR=0.5777, J=0.3947, MCC=0.2832, ConfusionMatrix=
[[1256  918]
 [  71  317]]
Epoch 10, Phase test, Loss=0.8888, Acc=0.6132, AUC=0.7867, TPR=0.8065, TNR=0.5799, J=0.3863, MCC=0.2739, ConfusionMatrix=
[[1252  907]
 [  72  300]]
Epoch 10 complete in 36.11

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4631, Acc=0.7925, AUC=0.8633, TPR=0.7601, TNR=0.8259, J=0.5859, MCC=0.5868, ConfusionMatrix=
[[2969  626]
 [ 889 2816]]
Epoch 11, Phase val, Loss=0.5991, Acc=0.7642, AUC=0.7806, TPR=0.6753, TNR=0.7801, J=0.4554, MCC=0.3602, ConfusionMatrix=
[[1696  478]
 [ 126  262]]
Epoch 11, Phase test, Loss=0.5818, Acc=0.7582, AUC=0.7934, TPR=0.6989, TNR=0.7684, J=0.4673, MCC=0.3610, ConfusionMatrix=
[[1659  500]
 [ 112  260]]
Epoch 11 complete in 36.00

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4612, Acc=0.7923, AUC=0.8643, TPR=0.7417, TNR=0.8408, J=0.5825, MCC=0.5860, ConfusionMatrix=
[[3137  594]
 [ 922 2647]]
Epoch 12, Phase val, Loss=0.4920, Acc=0.7865, AUC=0.8006, TPR=0.6186, TNR=0.8165, J=0.4350, MCC=0.3604, ConfusionMatrix=
[[1775  399]
 [ 148  240]]
Epoch 12, Phase test, Loss=0.5029, Acc=0.7736, AUC=0.7901, TPR=0.6801, TNR=0.7897, J=0.4698, MCC=0.3708, ConfusionMatrix=
[[1705  454]
 [ 119  253]]
Epoch 12 complete in 36.18

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4652, Acc=0.7885, AUC=0.8617, TPR=0.7539, TNR=0.8241, J=0.5780, MCC=0.5790, ConfusionMatrix=
[[2965  633]
 [ 911 2791]]
Epoch 13, Phase val, Loss=0.5303, Acc=0.7994, AUC=0.7739, TPR=0.5954, TNR=0.8358, J=0.4311, MCC=0.3675, ConfusionMatrix=
[[1817  357]
 [ 157  231]]
Epoch 13, Phase test, Loss=0.5205, Acc=0.8036, AUC=0.7827, TPR=0.6237, TNR=0.8346, J=0.4583, MCC=0.3840, ConfusionMatrix=
[[1802  357]
 [ 140  232]]
Epoch 13 complete in 36.97

Early Stop!
Training complete in 8m 32s
The best model val AUC=0.808523767297, test AUC=0.787056681957.
Finish training resnet18scratch-conv1x1-avgpool

Start training resnet18scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5759, Acc=0.6966, AUC=0.7650, TPR=0.6590, TNR=0.7326, J=0.3916, MCC=0.3928, ConfusionMatrix=
[[2731  997]
 [1218 2354]]
Epoch 0, Phase val, Loss=0.7885, Acc=0.6421, AUC=0.7780, TPR=0.7706, TNR=0.6191, J=0.3898, MCC=0.2815, ConfusionMatrix=
[[1346  828]
 [  89  299]]
New Best AUC=0.7780. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7586, Acc=0.6096, AUC=0.7686, TPR=0.7581, TNR=0.5841, J=0.3421, MCC=0.2428, ConfusionMatrix=
[[1261  898]
 [  90  282]]
Epoch 0 complete in 36.50

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5391, Acc=0.7282, AUC=0.8034, TPR=0.6722, TNR=0.7838, J=0.4560, MCC=0.4590, ConfusionMatrix=
[[2872  792]
 [1192 2444]]
Epoch 1, Phase val, Loss=0.5646, Acc=0.7631, AUC=0.7853, TPR=0.6057, TNR=0.7912, J=0.3968, MCC=0.3208, ConfusionMatrix=
[[1720  454]
 [ 153  235]]
New Best AUC=0.7853. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5515, Acc=0.7637, AUC=0.7693, TPR=0.6263, TNR=0.7874, J=0.4137, MCC=0.3287, ConfusionMatrix=
[[1700  459]
 [ 139  233]]
Epoch 1 complete in 36.53

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5404, Acc=0.7358, AUC=0.8045, TPR=0.6701, TNR=0.7995, J=0.4696, MCC=0.4739, ConfusionMatrix=
[[2962  743]
 [1186 2409]]
Epoch 2, Phase val, Loss=0.5392, Acc=0.8068, AUC=0.7934, TPR=0.5619, TNR=0.8505, J=0.4124, MCC=0.3617, ConfusionMatrix=
[[1849  325]
 [ 170  218]]
New Best AUC=0.7934. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5293, Acc=0.8088, AUC=0.7764, TPR=0.5511, TNR=0.8532, J=0.4042, MCC=0.3538, ConfusionMatrix=
[[1842  317]
 [ 167  205]]
Epoch 2 complete in 36.46

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5129, Acc=0.7577, AUC=0.8262, TPR=0.6985, TNR=0.8153, J=0.5138, MCC=0.5177, ConfusionMatrix=
[[3015  683]
 [1086 2516]]
Epoch 3, Phase val, Loss=0.4474, Acc=0.8173, AUC=0.7996, TPR=0.5387, TNR=0.8671, J=0.4057, MCC=0.3675, ConfusionMatrix=
[[1885  289]
 [ 179  209]]
New Best AUC=0.7996. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.4467, Acc=0.8368, AUC=0.7784, TPR=0.5108, TNR=0.8930, J=0.4038, MCC=0.3839, ConfusionMatrix=
[[1928  231]
 [ 182  190]]
Epoch 3 complete in 36.54

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5189, Acc=0.7564, AUC=0.8235, TPR=0.6970, TNR=0.8149, J=0.5119, MCC=0.5158, ConfusionMatrix=
[[2999  681]
 [1097 2523]]
Epoch 4, Phase val, Loss=0.4954, Acc=0.8103, AUC=0.8017, TPR=0.6160, TNR=0.8450, J=0.4610, MCC=0.3958, ConfusionMatrix=
[[1837  337]
 [ 149  239]]
New Best AUC=0.8017. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4836, Acc=0.8107, AUC=0.7972, TPR=0.5941, TNR=0.8481, J=0.4422, MCC=0.3799, ConfusionMatrix=
[[1831  328]
 [ 151  221]]
Epoch 4 complete in 37.81

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4969, Acc=0.7618, AUC=0.8401, TPR=0.7163, TNR=0.8063, J=0.5226, MCC=0.5250, ConfusionMatrix=
[[2973  714]
 [1025 2588]]
Epoch 5, Phase val, Loss=0.4668, Acc=0.8205, AUC=0.7982, TPR=0.5644, TNR=0.8661, J=0.4306, MCC=0.3866, ConfusionMatrix=
[[1883  291]
 [ 169  219]]
Epoch 5, Phase test, Loss=0.4640, Acc=0.8277, AUC=0.7897, TPR=0.5565, TNR=0.8745, J=0.4309, MCC=0.3898, ConfusionMatrix=
[[1888  271]
 [ 165  207]]
Epoch 5 complete in 35.98

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4890, Acc=0.7699, AUC=0.8442, TPR=0.7213, TNR=0.8179, J=0.5392, MCC=0.5419, ConfusionMatrix=
[[3001  668]
 [1012 2619]]
Epoch 6, Phase val, Loss=0.4671, Acc=0.8099, AUC=0.7859, TPR=0.5696, TNR=0.8528, J=0.4224, MCC=0.3710, ConfusionMatrix=
[[1854  320]
 [ 167  221]]
Epoch 6, Phase test, Loss=0.4524, Acc=0.8194, AUC=0.7789, TPR=0.5538, TNR=0.8652, J=0.4190, MCC=0.3735, ConfusionMatrix=
[[1868  291]
 [ 166  206]]
Epoch 6 complete in 35.87

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4893, Acc=0.7716, AUC=0.8449, TPR=0.7210, TNR=0.8210, J=0.5420, MCC=0.5451, ConfusionMatrix=
[[3036  662]
 [1005 2597]]
Epoch 7, Phase val, Loss=0.3826, Acc=0.8431, AUC=0.7822, TPR=0.3273, TNR=0.9351, J=0.2625, MCC=0.3074, ConfusionMatrix=
[[2033  141]
 [ 261  127]]
Epoch 7, Phase test, Loss=0.3687, Acc=0.8625, AUC=0.7789, TPR=0.3522, TNR=0.9504, J=0.3026, MCC=0.3671, ConfusionMatrix=
[[2052  107]
 [ 241  131]]
Epoch 7 complete in 36.00

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4783, Acc=0.7796, AUC=0.8523, TPR=0.7394, TNR=0.8201, J=0.5595, MCC=0.5612, ConfusionMatrix=
[[2982  654]
 [ 955 2709]]
Epoch 8, Phase val, Loss=0.3949, Acc=0.8392, AUC=0.7729, TPR=0.3892, TNR=0.9195, J=0.3087, MCC=0.3321, ConfusionMatrix=
[[1999  175]
 [ 237  151]]
Epoch 8, Phase test, Loss=0.3737, Acc=0.8617, AUC=0.7701, TPR=0.4113, TNR=0.9393, J=0.3506, MCC=0.3933, ConfusionMatrix=
[[2028  131]
 [ 219  153]]
Epoch 8 complete in 36.10

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4650, Acc=0.7930, AUC=0.8617, TPR=0.7453, TNR=0.8390, J=0.5844, MCC=0.5875, ConfusionMatrix=
[[3117  598]
 [ 913 2672]]
Epoch 9, Phase val, Loss=0.7360, Acc=0.6866, AUC=0.7963, TPR=0.7577, TNR=0.6739, J=0.4316, MCC=0.3170, ConfusionMatrix=
[[1465  709]
 [  94  294]]
Epoch 9, Phase test, Loss=0.7330, Acc=0.6843, AUC=0.7976, TPR=0.7634, TNR=0.6707, J=0.4341, MCC=0.3147, ConfusionMatrix=
[[1448  711]
 [  88  284]]
Epoch 9 complete in 37.00

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4596, Acc=0.7951, AUC=0.8650, TPR=0.7615, TNR=0.8288, J=0.5903, MCC=0.5916, ConfusionMatrix=
[[3017  623]
 [ 873 2787]]
Epoch 10, Phase val, Loss=0.3805, Acc=0.8564, AUC=0.7464, TPR=0.2732, TNR=0.9604, J=0.2336, MCC=0.3181, ConfusionMatrix=
[[2088   86]
 [ 282  106]]
Epoch 10, Phase test, Loss=0.3634, Acc=0.8676, AUC=0.7529, TPR=0.3199, TNR=0.9620, J=0.2819, MCC=0.3692, ConfusionMatrix=
[[2077   82]
 [ 253  119]]
Epoch 10 complete in 35.99

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4604, Acc=0.7955, AUC=0.8646, TPR=0.7524, TNR=0.8384, J=0.5908, MCC=0.5930, ConfusionMatrix=
[[3066  591]
 [ 902 2741]]
Epoch 11, Phase val, Loss=0.4856, Acc=0.7900, AUC=0.7848, TPR=0.6186, TNR=0.8206, J=0.4392, MCC=0.3656, ConfusionMatrix=
[[1784  390]
 [ 148  240]]
Epoch 11, Phase test, Loss=0.4910, Acc=0.8028, AUC=0.7739, TPR=0.6263, TNR=0.8333, J=0.4596, MCC=0.3842, ConfusionMatrix=
[[1799  360]
 [ 139  233]]
Epoch 11 complete in 36.12

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4558, Acc=0.7930, AUC=0.8677, TPR=0.7668, TNR=0.8198, J=0.5866, MCC=0.5872, ConfusionMatrix=
[[2961  651]
 [ 860 2828]]
Epoch 12, Phase val, Loss=0.4782, Acc=0.8158, AUC=0.7802, TPR=0.5747, TNR=0.8588, J=0.4335, MCC=0.3837, ConfusionMatrix=
[[1867  307]
 [ 165  223]]
Epoch 12, Phase test, Loss=0.4506, Acc=0.8163, AUC=0.7915, TPR=0.5753, TNR=0.8578, J=0.4331, MCC=0.3793, ConfusionMatrix=
[[1852  307]
 [ 158  214]]
Epoch 12 complete in 36.14

Early Stop!
Training complete in 7m 53s
The best model val AUC=0.801725405211, test AUC=0.797239114086.
Finish training resnet18scratch-conv1x1-avgpool

Start training resnet18scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5762, Acc=0.6922, AUC=0.7650, TPR=0.6393, TNR=0.7451, J=0.3844, MCC=0.3866, ConfusionMatrix=
[[2719  930]
 [1317 2334]]
Epoch 0, Phase val, Loss=0.5805, Acc=0.7779, AUC=0.7699, TPR=0.5851, TNR=0.8123, J=0.3974, MCC=0.3299, ConfusionMatrix=
[[1766  408]
 [ 161  227]]
New Best AUC=0.7699. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5547, Acc=0.7736, AUC=0.7609, TPR=0.5914, TNR=0.8050, J=0.3964, MCC=0.3228, ConfusionMatrix=
[[1738  421]
 [ 152  220]]
Epoch 0 complete in 36.59

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5371, Acc=0.7305, AUC=0.8056, TPR=0.6630, TNR=0.7973, J=0.4603, MCC=0.4647, ConfusionMatrix=
[[2927  744]
 [1223 2406]]
Epoch 1, Phase val, Loss=0.6617, Acc=0.6667, AUC=0.7866, TPR=0.7603, TNR=0.6500, J=0.4103, MCC=0.2988, ConfusionMatrix=
[[1413  761]
 [  93  295]]
New Best AUC=0.7866. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6613, Acc=0.6381, AUC=0.7702, TPR=0.7500, TNR=0.6188, J=0.3688, MCC=0.2634, ConfusionMatrix=
[[1336  823]
 [  93  279]]
Epoch 1 complete in 37.45

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5261, Acc=0.7445, AUC=0.8174, TPR=0.6727, TNR=0.8144, J=0.4871, MCC=0.4925, ConfusionMatrix=
[[3014  687]
 [1178 2421]]
Epoch 2, Phase val, Loss=0.6965, Acc=0.7077, AUC=0.7928, TPR=0.7397, TNR=0.7019, J=0.4416, MCC=0.3288, ConfusionMatrix=
[[1526  648]
 [ 101  287]]
New Best AUC=0.7928. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6911, Acc=0.6839, AUC=0.7822, TPR=0.7366, TNR=0.6748, J=0.4114, MCC=0.2993, ConfusionMatrix=
[[1457  702]
 [  98  274]]
Epoch 2 complete in 36.61

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5202, Acc=0.7460, AUC=0.8203, TPR=0.6888, TNR=0.8024, J=0.4913, MCC=0.4947, ConfusionMatrix=
[[2949  726]
 [1128 2497]]
Epoch 3, Phase val, Loss=0.6096, Acc=0.7338, AUC=0.7882, TPR=0.6881, TNR=0.7420, J=0.4301, MCC=0.3297, ConfusionMatrix=
[[1613  561]
 [ 121  267]]
Epoch 3, Phase test, Loss=0.6010, Acc=0.7258, AUC=0.7820, TPR=0.6828, TNR=0.7332, J=0.4160, MCC=0.3138, ConfusionMatrix=
[[1583  576]
 [ 118  254]]
Epoch 3 complete in 36.01

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5166, Acc=0.7532, AUC=0.8263, TPR=0.6949, TNR=0.8116, J=0.5064, MCC=0.5099, ConfusionMatrix=
[[2959  687]
 [1115 2539]]
Epoch 4, Phase val, Loss=0.4818, Acc=0.7998, AUC=0.8006, TPR=0.6289, TNR=0.8303, J=0.4591, MCC=0.3858, ConfusionMatrix=
[[1805  369]
 [ 144  244]]
New Best AUC=0.8006. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4908, Acc=0.7985, AUC=0.7840, TPR=0.6398, TNR=0.8258, J=0.4656, MCC=0.3846, ConfusionMatrix=
[[1783  376]
 [ 134  238]]
Epoch 4 complete in 36.66

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4940, Acc=0.7695, AUC=0.8426, TPR=0.7160, TNR=0.8211, J=0.5371, MCC=0.5406, ConfusionMatrix=
[[3048  664]
 [1019 2569]]
Epoch 5, Phase val, Loss=0.6482, Acc=0.7369, AUC=0.8002, TPR=0.7268, TNR=0.7387, J=0.4655, MCC=0.3544, ConfusionMatrix=
[[1606  568]
 [ 106  282]]
Epoch 5, Phase test, Loss=0.6398, Acc=0.7309, AUC=0.7906, TPR=0.7124, TNR=0.7341, J=0.4465, MCC=0.3358, ConfusionMatrix=
[[1585  574]
 [ 107  265]]
Epoch 5 complete in 37.32

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5088, Acc=0.7615, AUC=0.8311, TPR=0.7019, TNR=0.8182, J=0.5201, MCC=0.5244, ConfusionMatrix=
[[3061  680]
 [1061 2498]]
Epoch 6, Phase val, Loss=0.4571, Acc=0.8341, AUC=0.7939, TPR=0.5309, TNR=0.8882, J=0.4192, MCC=0.3952, ConfusionMatrix=
[[1931  243]
 [ 182  206]]
Epoch 6, Phase test, Loss=0.4471, Acc=0.8329, AUC=0.7872, TPR=0.5376, TNR=0.8837, J=0.4214, MCC=0.3899, ConfusionMatrix=
[[1908  251]
 [ 172  200]]
Epoch 6 complete in 35.98

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5000, Acc=0.7690, AUC=0.8379, TPR=0.7246, TNR=0.8126, J=0.5372, MCC=0.5395, ConfusionMatrix=
[[2996  691]
 [ 995 2618]]
Epoch 7, Phase val, Loss=0.5099, Acc=0.8017, AUC=0.7970, TPR=0.6134, TNR=0.8353, J=0.4487, MCC=0.3807, ConfusionMatrix=
[[1816  358]
 [ 150  238]]
Epoch 7, Phase test, Loss=0.5048, Acc=0.7910, AUC=0.7815, TPR=0.6210, TNR=0.8203, J=0.4413, MCC=0.3635, ConfusionMatrix=
[[1771  388]
 [ 141  231]]
Epoch 7 complete in 36.08

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4828, Acc=0.7736, AUC=0.8499, TPR=0.7283, TNR=0.8181, J=0.5464, MCC=0.5488, ConfusionMatrix=
[[3009  669]
 [ 984 2638]]
Epoch 8, Phase val, Loss=0.4099, Acc=0.8454, AUC=0.7517, TPR=0.3840, TNR=0.9278, J=0.3118, MCC=0.3447, ConfusionMatrix=
[[2017  157]
 [ 239  149]]
Epoch 8, Phase test, Loss=0.3979, Acc=0.8613, AUC=0.7431, TPR=0.4167, TNR=0.9379, J=0.3546, MCC=0.3948, ConfusionMatrix=
[[2025  134]
 [ 217  155]]
Epoch 8 complete in 36.14

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4790, Acc=0.7822, AUC=0.8520, TPR=0.7265, TNR=0.8351, J=0.5616, MCC=0.5657, ConfusionMatrix=
[[3125  617]
 [ 973 2585]]
Epoch 9, Phase val, Loss=0.4992, Acc=0.7951, AUC=0.7906, TPR=0.6186, TNR=0.8266, J=0.4451, MCC=0.3732, ConfusionMatrix=
[[1797  377]
 [ 148  240]]
Epoch 9, Phase test, Loss=0.4637, Acc=0.8186, AUC=0.7955, TPR=0.6210, TNR=0.8527, J=0.4737, MCC=0.4070, ConfusionMatrix=
[[1841  318]
 [ 141  231]]
Epoch 9 complete in 37.24

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4733, Acc=0.7796, AUC=0.8562, TPR=0.7423, TNR=0.8172, J=0.5594, MCC=0.5609, ConfusionMatrix=
[[2972  665]
 [ 944 2719]]
Epoch 10, Phase val, Loss=0.6535, Acc=0.6920, AUC=0.8057, TPR=0.7964, TNR=0.6734, J=0.4698, MCC=0.3441, ConfusionMatrix=
[[1464  710]
 [  79  309]]
New Best AUC=0.8057. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.6575, Acc=0.6819, AUC=0.7937, TPR=0.7581, TNR=0.6688, J=0.4269, MCC=0.3094, ConfusionMatrix=
[[1444  715]
 [  90  282]]
Epoch 10 complete in 36.40

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4679, Acc=0.7858, AUC=0.8583, TPR=0.7400, TNR=0.8309, J=0.5709, MCC=0.5735, ConfusionMatrix=
[[3052  621]
 [ 943 2684]]
Epoch 11, Phase val, Loss=0.5098, Acc=0.7955, AUC=0.8069, TPR=0.6495, TNR=0.8215, J=0.4710, MCC=0.3900, ConfusionMatrix=
[[1786  388]
 [ 136  252]]
New Best AUC=0.8069. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.5087, Acc=0.7949, AUC=0.7938, TPR=0.6478, TNR=0.8203, J=0.4681, MCC=0.3836, ConfusionMatrix=
[[1771  388]
 [ 131  241]]
Epoch 11 complete in 36.46

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4606, Acc=0.7922, AUC=0.8643, TPR=0.7447, TNR=0.8387, J=0.5834, MCC=0.5863, ConfusionMatrix=
[[3093  595]
 [ 922 2690]]
Epoch 12, Phase val, Loss=0.6185, Acc=0.7623, AUC=0.7954, TPR=0.6598, TNR=0.7806, J=0.4404, MCC=0.3493, ConfusionMatrix=
[[1697  477]
 [ 132  256]]
Epoch 12, Phase test, Loss=0.5883, Acc=0.7641, AUC=0.7911, TPR=0.7016, TNR=0.7749, J=0.4765, MCC=0.3699, ConfusionMatrix=
[[1673  486]
 [ 111  261]]
Epoch 12 complete in 36.16

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4540, Acc=0.7978, AUC=0.8684, TPR=0.7692, TNR=0.8266, J=0.5958, MCC=0.5967, ConfusionMatrix=
[[3008  631]
 [ 845 2816]]
Epoch 13, Phase val, Loss=0.6758, Acc=0.7447, AUC=0.7829, TPR=0.6985, TNR=0.7530, J=0.4514, MCC=0.3483, ConfusionMatrix=
[[1637  537]
 [ 117  271]]
Epoch 13, Phase test, Loss=0.6535, Acc=0.7467, AUC=0.7978, TPR=0.7097, TNR=0.7531, J=0.4628, MCC=0.3528, ConfusionMatrix=
[[1626  533]
 [ 108  264]]
Epoch 13 complete in 35.80

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4381, Acc=0.8042, AUC=0.8777, TPR=0.7606, TNR=0.8456, J=0.6062, MCC=0.6091, ConfusionMatrix=
[[3170  579]
 [ 850 2701]]
Epoch 14, Phase val, Loss=0.4298, Acc=0.8275, AUC=0.7561, TPR=0.4459, TNR=0.8956, J=0.3415, MCC=0.3372, ConfusionMatrix=
[[1947  227]
 [ 215  173]]
Epoch 14, Phase test, Loss=0.4476, Acc=0.8183, AUC=0.7014, TPR=0.4059, TNR=0.8893, J=0.2952, MCC=0.2895, ConfusionMatrix=
[[1920  239]
 [ 221  151]]
Epoch 14 complete in 37.08

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4394, Acc=0.8029, AUC=0.8768, TPR=0.7645, TNR=0.8398, J=0.6043, MCC=0.6065, ConfusionMatrix=
[[3124  596]
 [ 843 2737]]
Epoch 15, Phase val, Loss=0.4523, Acc=0.8310, AUC=0.7702, TPR=0.5103, TNR=0.8882, J=0.3985, MCC=0.3785, ConfusionMatrix=
[[1931  243]
 [ 190  198]]
Epoch 15, Phase test, Loss=0.4362, Acc=0.8348, AUC=0.7638, TPR=0.5108, TNR=0.8907, J=0.4014, MCC=0.3799, ConfusionMatrix=
[[1923  236]
 [ 182  190]]
Epoch 15 complete in 35.99

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4191, Acc=0.8185, AUC=0.8907, TPR=0.7869, TNR=0.8505, J=0.6373, MCC=0.6385, ConfusionMatrix=
[[3088  543]
 [ 782 2887]]
Epoch 16, Phase val, Loss=0.4492, Acc=0.8197, AUC=0.7465, TPR=0.5026, TNR=0.8763, J=0.3788, MCC=0.3526, ConfusionMatrix=
[[1905  269]
 [ 193  195]]
Epoch 16, Phase test, Loss=0.4239, Acc=0.8246, AUC=0.7763, TPR=0.5027, TNR=0.8800, J=0.3827, MCC=0.3557, ConfusionMatrix=
[[1900  259]
 [ 185  187]]
Epoch 16 complete in 36.45

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4166, Acc=0.8145, AUC=0.8936, TPR=0.7852, TNR=0.8440, J=0.6292, MCC=0.6302, ConfusionMatrix=
[[3073  568]
 [ 786 2873]]
Epoch 17, Phase val, Loss=0.5240, Acc=0.7947, AUC=0.7810, TPR=0.6108, TNR=0.8275, J=0.4383, MCC=0.3685, ConfusionMatrix=
[[1799  375]
 [ 151  237]]
Epoch 17, Phase test, Loss=0.5163, Acc=0.7906, AUC=0.7824, TPR=0.6398, TNR=0.8166, J=0.4564, MCC=0.3729, ConfusionMatrix=
[[1763  396]
 [ 134  238]]
Epoch 17 complete in 36.09

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4025, Acc=0.8255, AUC=0.9012, TPR=0.8033, TNR=0.8474, J=0.6506, MCC=0.6514, ConfusionMatrix=
[[3115  561]
 [ 713 2911]]
Epoch 18, Phase val, Loss=0.8435, Acc=0.6858, AUC=0.7838, TPR=0.7758, TNR=0.6697, J=0.4455, MCC=0.3263, ConfusionMatrix=
[[1456  718]
 [  87  301]]
Epoch 18, Phase test, Loss=0.8572, Acc=0.6567, AUC=0.7880, TPR=0.7849, TNR=0.6346, J=0.4195, MCC=0.3003, ConfusionMatrix=
[[1370  789]
 [  80  292]]
Epoch 18 complete in 36.13

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.3806, Acc=0.8356, AUC=0.9115, TPR=0.8187, TNR=0.8532, J=0.6719, MCC=0.6719, ConfusionMatrix=
[[3051  525]
 [ 675 3049]]
Epoch 19, Phase val, Loss=0.6823, Acc=0.7361, AUC=0.7473, TPR=0.6598, TNR=0.7498, J=0.4096, MCC=0.3168, ConfusionMatrix=
[[1630  544]
 [ 132  256]]
Epoch 19, Phase test, Loss=0.6458, Acc=0.7262, AUC=0.7752, TPR=0.6747, TNR=0.7351, J=0.4098, MCC=0.3098, ConfusionMatrix=
[[1587  572]
 [ 121  251]]
Epoch 19 complete in 36.85

Early Stop!
Training complete in 12m 9s
The best model val AUC=0.806880637146, test AUC=0.793765283609.
Finish training resnet18scratch-conv1x1-avgpool

Start training resnet18scratch-conv1x1-avgpool
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5795, Acc=0.6847, AUC=0.7629, TPR=0.6631, TNR=0.7056, J=0.3687, MCC=0.3691, ConfusionMatrix=
[[2612 1090]
 [1212 2386]]
Epoch 0, Phase val, Loss=0.8530, Acc=0.6198, AUC=0.7669, TPR=0.7732, TNR=0.5925, J=0.3657, MCC=0.2629, ConfusionMatrix=
[[1288  886]
 [  88  300]]
New Best AUC=0.7669. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.8446, Acc=0.5816, AUC=0.7576, TPR=0.7715, TNR=0.5489, J=0.3204, MCC=0.2269, ConfusionMatrix=
[[1185  974]
 [  85  287]]
Epoch 0 complete in 36.70

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5290, Acc=0.7423, AUC=0.8142, TPR=0.6865, TNR=0.7983, J=0.4848, MCC=0.4879, ConfusionMatrix=
[[2909  735]
 [1146 2510]]
Epoch 1, Phase val, Loss=0.5611, Acc=0.7732, AUC=0.7940, TPR=0.6314, TNR=0.7985, J=0.4300, MCC=0.3486, ConfusionMatrix=
[[1736  438]
 [ 143  245]]
New Best AUC=0.7940. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5504, Acc=0.7598, AUC=0.7815, TPR=0.6532, TNR=0.7781, J=0.4314, MCC=0.3383, ConfusionMatrix=
[[1680  479]
 [ 129  243]]
Epoch 1 complete in 36.61

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5190, Acc=0.7410, AUC=0.8201, TPR=0.6712, TNR=0.8092, J=0.4804, MCC=0.4854, ConfusionMatrix=
[[2986  704]
 [1187 2423]]
Epoch 2, Phase val, Loss=0.5609, Acc=0.7560, AUC=0.7962, TPR=0.6778, TNR=0.7700, J=0.4478, MCC=0.3511, ConfusionMatrix=
[[1674  500]
 [ 125  263]]
New Best AUC=0.7962. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5504, Acc=0.7618, AUC=0.7782, TPR=0.6505, TNR=0.7809, J=0.4315, MCC=0.3393, ConfusionMatrix=
[[1686  473]
 [ 130  242]]
Epoch 2 complete in 36.91

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5116, Acc=0.7564, AUC=0.8289, TPR=0.6946, TNR=0.8165, J=0.5112, MCC=0.5154, ConfusionMatrix=
[[3022  679]
 [1099 2500]]
Epoch 3, Phase val, Loss=0.5830, Acc=0.7385, AUC=0.8030, TPR=0.7345, TNR=0.7392, J=0.4737, MCC=0.3605, ConfusionMatrix=
[[1607  567]
 [ 103  285]]
New Best AUC=0.8030. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5822, Acc=0.7254, AUC=0.7820, TPR=0.6909, TNR=0.7314, J=0.4222, MCC=0.3178, ConfusionMatrix=
[[1579  580]
 [ 115  257]]
Epoch 3 complete in 36.60

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5020, Acc=0.7571, AUC=0.8353, TPR=0.6980, TNR=0.8163, J=0.5143, MCC=0.5179, ConfusionMatrix=
[[2978  670]
 [1103 2549]]
Epoch 4, Phase val, Loss=0.5339, Acc=0.8076, AUC=0.7984, TPR=0.6057, TNR=0.8436, J=0.4493, MCC=0.3860, ConfusionMatrix=
[[1834  340]
 [ 153  235]]
Epoch 4, Phase test, Loss=0.5181, Acc=0.7989, AUC=0.7777, TPR=0.5753, TNR=0.8374, J=0.4127, MCC=0.3509, ConfusionMatrix=
[[1808  351]
 [ 158  214]]
Epoch 4 complete in 36.84

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5068, Acc=0.7560, AUC=0.8318, TPR=0.7037, TNR=0.8063, J=0.5100, MCC=0.5132, ConfusionMatrix=
[[3002  721]
 [1060 2517]]
Epoch 5, Phase val, Loss=0.5137, Acc=0.7998, AUC=0.8040, TPR=0.6289, TNR=0.8303, J=0.4591, MCC=0.3858, ConfusionMatrix=
[[1805  369]
 [ 144  244]]
New Best AUC=0.8040. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5075, Acc=0.7906, AUC=0.7869, TPR=0.6102, TNR=0.8217, J=0.4319, MCC=0.3572, ConfusionMatrix=
[[1774  385]
 [ 145  227]]
Epoch 5 complete in 36.45

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4979, Acc=0.7684, AUC=0.8387, TPR=0.7157, TNR=0.8210, J=0.5367, MCC=0.5397, ConfusionMatrix=
[[2996  653]
 [1038 2613]]
Epoch 6, Phase val, Loss=0.6398, Acc=0.7650, AUC=0.7846, TPR=0.6649, TNR=0.7829, J=0.4478, MCC=0.3557, ConfusionMatrix=
[[1702  472]
 [ 130  258]]
Epoch 6, Phase test, Loss=0.6309, Acc=0.7523, AUC=0.7666, TPR=0.6263, TNR=0.7740, J=0.4003, MCC=0.3140, ConfusionMatrix=
[[1671  488]
 [ 139  233]]
Epoch 6 complete in 36.10

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5042, Acc=0.7630, AUC=0.8355, TPR=0.7133, TNR=0.8133, J=0.5265, MCC=0.5290, ConfusionMatrix=
[[2953  678]
 [1052 2617]]
Epoch 7, Phase val, Loss=0.5934, Acc=0.7635, AUC=0.7917, TPR=0.6753, TNR=0.7792, J=0.4545, MCC=0.3592, ConfusionMatrix=
[[1694  480]
 [ 126  262]]
Epoch 7, Phase test, Loss=0.6036, Acc=0.7621, AUC=0.7844, TPR=0.6720, TNR=0.7777, J=0.4497, MCC=0.3515, ConfusionMatrix=
[[1679  480]
 [ 122  250]]
Epoch 7 complete in 36.09

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4743, Acc=0.7810, AUC=0.8574, TPR=0.7426, TNR=0.8202, J=0.5629, MCC=0.5642, ConfusionMatrix=
[[2957  648]
 [ 951 2744]]
Epoch 8, Phase val, Loss=0.5274, Acc=0.8111, AUC=0.7980, TPR=0.6314, TNR=0.8431, J=0.4746, MCC=0.4051, ConfusionMatrix=
[[1833  341]
 [ 143  245]]
Epoch 8, Phase test, Loss=0.5036, Acc=0.8013, AUC=0.7932, TPR=0.6075, TNR=0.8346, J=0.4422, MCC=0.3718, ConfusionMatrix=
[[1802  357]
 [ 146  226]]
Epoch 8 complete in 35.92

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4784, Acc=0.7774, AUC=0.8531, TPR=0.7406, TNR=0.8143, J=0.5549, MCC=0.5564, ConfusionMatrix=
[[2969  677]
 [ 948 2706]]
Epoch 9, Phase val, Loss=0.7012, Acc=0.7416, AUC=0.7981, TPR=0.7397, TNR=0.7420, J=0.4816, MCC=0.3669, ConfusionMatrix=
[[1613  561]
 [ 101  287]]
Epoch 9, Phase test, Loss=0.6992, Acc=0.7171, AUC=0.7795, TPR=0.6989, TNR=0.7202, J=0.4192, MCC=0.3130, ConfusionMatrix=
[[1555  604]
 [ 112  260]]
Epoch 9 complete in 36.88

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4657, Acc=0.7897, AUC=0.8640, TPR=0.7485, TNR=0.8295, J=0.5781, MCC=0.5804, ConfusionMatrix=
[[3080  633]
 [ 902 2685]]
Epoch 10, Phase val, Loss=0.4579, Acc=0.8205, AUC=0.8063, TPR=0.6031, TNR=0.8592, J=0.4623, MCC=0.4064, ConfusionMatrix=
[[1868  306]
 [ 154  234]]
New Best AUC=0.8063. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.4601, Acc=0.8163, AUC=0.7790, TPR=0.5753, TNR=0.8578, J=0.4331, MCC=0.3793, ConfusionMatrix=
[[1852  307]
 [ 158  214]]
Epoch 10 complete in 36.65

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4733, Acc=0.7855, AUC=0.8574, TPR=0.7448, TNR=0.8257, J=0.5705, MCC=0.5725, ConfusionMatrix=
[[3032  640]
 [ 926 2702]]
Epoch 11, Phase val, Loss=0.4428, Acc=0.8134, AUC=0.7663, TPR=0.4716, TNR=0.8744, J=0.3461, MCC=0.3243, ConfusionMatrix=
[[1901  273]
 [ 205  183]]
Epoch 11, Phase test, Loss=0.4311, Acc=0.8179, AUC=0.7504, TPR=0.4839, TNR=0.8754, J=0.3593, MCC=0.3330, ConfusionMatrix=
[[1890  269]
 [ 192  180]]
Epoch 11 complete in 36.05

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4498, Acc=0.7960, AUC=0.8726, TPR=0.7670, TNR=0.8258, J=0.5928, MCC=0.5935, ConfusionMatrix=
[[2977  628]
 [ 861 2834]]
Epoch 12, Phase val, Loss=0.5883, Acc=0.7572, AUC=0.7960, TPR=0.7088, TNR=0.7659, J=0.4746, MCC=0.3692, ConfusionMatrix=
[[1665  509]
 [ 113  275]]
Epoch 12, Phase test, Loss=0.5670, Acc=0.7566, AUC=0.7948, TPR=0.6962, TNR=0.7670, J=0.4633, MCC=0.3576, ConfusionMatrix=
[[1656  503]
 [ 113  259]]
Epoch 12 complete in 36.18

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4404, Acc=0.8015, AUC=0.8770, TPR=0.7599, TNR=0.8437, J=0.6037, MCC=0.6055, ConfusionMatrix=
[[3056  566]
 [ 883 2795]]
Epoch 13, Phase val, Loss=0.4496, Acc=0.8232, AUC=0.7530, TPR=0.5077, TNR=0.8795, J=0.3872, MCC=0.3620, ConfusionMatrix=
[[1912  262]
 [ 191  197]]
Epoch 13, Phase test, Loss=0.4729, Acc=0.8183, AUC=0.7256, TPR=0.5054, TNR=0.8722, J=0.3775, MCC=0.3455, ConfusionMatrix=
[[1883  276]
 [ 184  188]]
Epoch 13 complete in 36.11

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4368, Acc=0.8060, AUC=0.8827, TPR=0.7717, TNR=0.8413, J=0.6130, MCC=0.6141, ConfusionMatrix=
[[3028  571]
 [ 845 2856]]
Epoch 14, Phase val, Loss=1.2334, Acc=0.6163, AUC=0.7937, TPR=0.8299, TNR=0.5782, J=0.4081, MCC=0.2927, ConfusionMatrix=
[[1257  917]
 [  66  322]]
Epoch 14, Phase test, Loss=1.2422, Acc=0.5682, AUC=0.7671, TPR=0.8065, TNR=0.5271, J=0.3335, MCC=0.2364, ConfusionMatrix=
[[1138 1021]
 [  72  300]]
Epoch 14 complete in 36.94

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4513, Acc=0.7958, AUC=0.8714, TPR=0.7668, TNR=0.8244, J=0.5912, MCC=0.5923, ConfusionMatrix=
[[3024  644]
 [ 847 2785]]
Epoch 15, Phase val, Loss=0.5150, Acc=0.7666, AUC=0.7745, TPR=0.6082, TNR=0.7948, J=0.4031, MCC=0.3270, ConfusionMatrix=
[[1728  446]
 [ 152  236]]
Epoch 15, Phase test, Loss=0.4879, Acc=0.7878, AUC=0.7816, TPR=0.6344, TNR=0.8143, J=0.4487, MCC=0.3661, ConfusionMatrix=
[[1758  401]
 [ 136  236]]
Epoch 15 complete in 36.14

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4099, Acc=0.8227, AUC=0.8965, TPR=0.8015, TNR=0.8443, J=0.6459, MCC=0.6463, ConfusionMatrix=
[[3054  563]
 [ 731 2952]]
Epoch 16, Phase val, Loss=0.8524, Acc=0.6753, AUC=0.7867, TPR=0.8015, TNR=0.6527, J=0.4543, MCC=0.3304, ConfusionMatrix=
[[1419  755]
 [  77  311]]
Epoch 16, Phase test, Loss=0.8691, Acc=0.6341, AUC=0.7808, TPR=0.7796, TNR=0.6091, J=0.3886, MCC=0.2767, ConfusionMatrix=
[[1315  844]
 [  82  290]]
Epoch 16 complete in 36.13

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4100, Acc=0.8240, AUC=0.8956, TPR=0.8051, TNR=0.8428, J=0.6480, MCC=0.6484, ConfusionMatrix=
[[3073  573]
 [ 712 2942]]
Epoch 17, Phase val, Loss=0.6174, Acc=0.7377, AUC=0.7672, TPR=0.6959, TNR=0.7452, J=0.4410, MCC=0.3385, ConfusionMatrix=
[[1620  554]
 [ 118  270]]
Epoch 17, Phase test, Loss=0.6387, Acc=0.7167, AUC=0.7607, TPR=0.6720, TNR=0.7244, J=0.3965, MCC=0.2977, ConfusionMatrix=
[[1564  595]
 [ 122  250]]
Epoch 17 complete in 36.08

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.3849, Acc=0.8358, AUC=0.9102, TPR=0.8204, TNR=0.8513, J=0.6716, MCC=0.6719, ConfusionMatrix=
[[3096  541]
 [ 658 3005]]
Epoch 18, Phase val, Loss=0.4341, Acc=0.8427, AUC=0.7864, TPR=0.4948, TNR=0.9048, J=0.3996, MCC=0.3951, ConfusionMatrix=
[[1967  207]
 [ 196  192]]
Epoch 18, Phase test, Loss=0.4140, Acc=0.8507, AUC=0.7530, TPR=0.4624, TNR=0.9176, J=0.3799, MCC=0.3897, ConfusionMatrix=
[[1981  178]
 [ 200  172]]
Epoch 18 complete in 37.18

Early Stop!
Training complete in 11m 33s
The best model val AUC=0.806334112615, test AUC=0.77899776878.
Finish training resnet18scratch-conv1x1-avgpool

