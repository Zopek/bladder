Start training resnet50_conv1x1ab_maxpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6219, Acc=0.6548, AUC=0.7259, TPR=0.7758, TNR=0.5338, J=0.3097, MCC=0.3191, ConfusionMatrix=
[[1949 1702]
 [ 818 2831]]
Epoch 0, Phase val, Loss=0.4704, Acc=0.8322, AUC=0.7982, TPR=0.5206, TNR=0.8878, J=0.4084, MCC=0.3861, ConfusionMatrix=
[[1930  244]
 [ 186  202]]
New Best AUC=0.7982. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1ab_maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.4826, Acc=0.8408, AUC=0.7799, TPR=0.5645, TNR=0.8884, J=0.4529, MCC=0.4191, ConfusionMatrix=
[[1918  241]
 [ 162  210]]
Epoch 0 complete in 91.90

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.4783, Acc=0.7851, AUC=0.8534, TPR=0.7401, TNR=0.8299, J=0.5700, MCC=0.5723, ConfusionMatrix=
[[3034  622]
 [ 947 2697]]
Epoch 1, Phase val, Loss=0.5767, Acc=0.7795, AUC=0.8250, TPR=0.7423, TNR=0.7861, J=0.5284, MCC=0.4158, ConfusionMatrix=
[[1709  465]
 [ 100  288]]
New Best AUC=0.8250. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1ab_maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6271, Acc=0.7448, AUC=0.7984, TPR=0.7366, TNR=0.7462, J=0.4827, MCC=0.3650, ConfusionMatrix=
[[1611  548]
 [  98  274]]
Epoch 1 complete in 95.48

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.4570, Acc=0.7979, AUC=0.8675, TPR=0.7650, TNR=0.8299, J=0.5949, MCC=0.5965, ConfusionMatrix=
[[3074  630]
 [ 845 2751]]
Epoch 2, Phase val, Loss=0.4418, Acc=0.8208, AUC=0.8067, TPR=0.6108, TNR=0.8583, J=0.4692, MCC=0.4110, ConfusionMatrix=
[[1866  308]
 [ 151  237]]
Epoch 2, Phase test, Loss=0.4760, Acc=0.8060, AUC=0.7800, TPR=0.6452, TNR=0.8337, J=0.4789, MCC=0.3989, ConfusionMatrix=
[[1800  359]
 [ 132  240]]
Epoch 2 complete in 77.53

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.4067, Acc=0.8273, AUC=0.8962, TPR=0.8082, TNR=0.8459, J=0.6541, MCC=0.6547, ConfusionMatrix=
[[3124  569]
 [ 692 2915]]
Epoch 3, Phase val, Loss=0.4411, Acc=0.8322, AUC=0.8078, TPR=0.6314, TNR=0.8680, J=0.4994, MCC=0.4414, ConfusionMatrix=
[[1887  287]
 [ 143  245]]
Epoch 3, Phase test, Loss=0.4623, Acc=0.8258, AUC=0.7793, TPR=0.6371, TNR=0.8583, J=0.4954, MCC=0.4273, ConfusionMatrix=
[[1853  306]
 [ 135  237]]
Epoch 3 complete in 85.92

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.3777, Acc=0.8405, AUC=0.9117, TPR=0.8365, TNR=0.8445, J=0.6810, MCC=0.6810, ConfusionMatrix=
[[3127  576]
 [ 588 3009]]
Epoch 4, Phase val, Loss=0.4005, Acc=0.8415, AUC=0.8007, TPR=0.5361, TNR=0.8960, J=0.4321, MCC=0.4130, ConfusionMatrix=
[[1948  226]
 [ 180  208]]
Epoch 4, Phase test, Loss=0.4117, Acc=0.8503, AUC=0.7766, TPR=0.5806, TNR=0.8967, J=0.4774, MCC=0.4464, ConfusionMatrix=
[[1936  223]
 [ 156  216]]
Epoch 4 complete in 84.02

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.3488, Acc=0.8512, AUC=0.9250, TPR=0.8496, TNR=0.8528, J=0.7024, MCC=0.7024, ConfusionMatrix=
[[3146  543]
 [ 543 3068]]
Epoch 5, Phase val, Loss=0.4875, Acc=0.8064, AUC=0.7983, TPR=0.6082, TNR=0.8418, J=0.4500, MCC=0.3855, ConfusionMatrix=
[[1830  344]
 [ 152  236]]
Epoch 5, Phase test, Loss=0.5354, Acc=0.7977, AUC=0.7705, TPR=0.6452, TNR=0.8240, J=0.4692, MCC=0.3863, ConfusionMatrix=
[[1779  380]
 [ 132  240]]
Epoch 5 complete in 77.02

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.3206, Acc=0.8705, AUC=0.9366, TPR=0.8717, TNR=0.8694, J=0.7411, MCC=0.7411, ConfusionMatrix=
[[3161  475]
 [ 470 3194]]
Epoch 6, Phase val, Loss=0.4221, Acc=0.8286, AUC=0.8057, TPR=0.5567, TNR=0.8772, J=0.4339, MCC=0.3977, ConfusionMatrix=
[[1907  267]
 [ 172  216]]
Epoch 6, Phase test, Loss=0.4379, Acc=0.8396, AUC=0.7759, TPR=0.5833, TNR=0.8837, J=0.4671, MCC=0.4260, ConfusionMatrix=
[[1908  251]
 [ 155  217]]
Epoch 6 complete in 93.45

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.2899, Acc=0.8829, AUC=0.9482, TPR=0.8863, TNR=0.8794, J=0.7657, MCC=0.7657, ConfusionMatrix=
[[3188  437]
 [ 418 3257]]
Epoch 7, Phase val, Loss=0.4526, Acc=0.8333, AUC=0.7950, TPR=0.5284, TNR=0.8878, J=0.4161, MCC=0.3924, ConfusionMatrix=
[[1930  244]
 [ 183  205]]
Epoch 7, Phase test, Loss=0.4905, Acc=0.8372, AUC=0.7566, TPR=0.5376, TNR=0.8888, J=0.4265, MCC=0.3985, ConfusionMatrix=
[[1919  240]
 [ 172  200]]
Epoch 7 complete in 81.84

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.2703, Acc=0.8956, AUC=0.9548, TPR=0.8963, TNR=0.8949, J=0.7912, MCC=0.7912, ConfusionMatrix=
[[3305  388]
 [ 374 3233]]
Epoch 8, Phase val, Loss=0.4582, Acc=0.8333, AUC=0.7609, TPR=0.4433, TNR=0.9029, J=0.3462, MCC=0.3481, ConfusionMatrix=
[[1963  211]
 [ 216  172]]
Epoch 8, Phase test, Loss=0.4608, Acc=0.8404, AUC=0.7386, TPR=0.4785, TNR=0.9027, J=0.3812, MCC=0.3747, ConfusionMatrix=
[[1949  210]
 [ 194  178]]
Epoch 8 complete in 85.65

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.2348, Acc=0.9086, AUC=0.9655, TPR=0.9162, TNR=0.9009, J=0.8171, MCC=0.8173, ConfusionMatrix=
[[3256  358]
 [ 309 3377]]
Epoch 9, Phase val, Loss=0.4701, Acc=0.8404, AUC=0.7936, TPR=0.5103, TNR=0.8993, J=0.4096, MCC=0.3977, ConfusionMatrix=
[[1955  219]
 [ 190  198]]
Epoch 9, Phase test, Loss=0.5281, Acc=0.8305, AUC=0.7397, TPR=0.4946, TNR=0.8884, J=0.3830, MCC=0.3628, ConfusionMatrix=
[[1918  241]
 [ 188  184]]
Epoch 9 complete in 83.61

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.2208, Acc=0.9189, AUC=0.9687, TPR=0.9308, TNR=0.9068, J=0.8376, MCC=0.8380, ConfusionMatrix=
[[3279  337]
 [ 255 3429]]
Epoch 10, Phase val, Loss=0.5638, Acc=0.8236, AUC=0.7869, TPR=0.5670, TNR=0.8694, J=0.4364, MCC=0.3935, ConfusionMatrix=
[[1890  284]
 [ 168  220]]
Epoch 10, Phase test, Loss=0.6219, Acc=0.8024, AUC=0.7543, TPR=0.5833, TNR=0.8402, J=0.4235, MCC=0.3608, ConfusionMatrix=
[[1814  345]
 [ 155  217]]
Epoch 10 complete in 78.73

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.2307, Acc=0.9088, AUC=0.9669, TPR=0.9153, TNR=0.9023, J=0.8175, MCC=0.8176, ConfusionMatrix=
[[3296  357]
 [ 309 3338]]
Epoch 11, Phase val, Loss=0.4392, Acc=0.8458, AUC=0.7887, TPR=0.4665, TNR=0.9135, J=0.3800, MCC=0.3880, ConfusionMatrix=
[[1986  188]
 [ 207  181]]
Epoch 11, Phase test, Loss=0.4785, Acc=0.8487, AUC=0.7558, TPR=0.5081, TNR=0.9074, J=0.4154, MCC=0.4079, ConfusionMatrix=
[[1959  200]
 [ 183  189]]
Epoch 11 complete in 87.42

Early Stop!
Training complete in 17m 3s
The best AUC=0.825046946576
Start training resnet50_conv1x1ab_avgpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6467, Acc=0.6422, AUC=0.6921, TPR=0.7508, TNR=0.5313, J=0.2821, MCC=0.2893, ConfusionMatrix=
[[1919 1693]
 [ 919 2769]]
Epoch 0, Phase val, Loss=0.7368, Acc=0.4836, AUC=0.7422, TPR=0.8892, TNR=0.4112, J=0.3004, MCC=0.2236, ConfusionMatrix=
[[ 894 1280]
 [  43  345]]
New Best AUC=0.7422. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1ab_avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7578, Acc=0.4710, AUC=0.7290, TPR=0.8710, TNR=0.4020, J=0.2730, MCC=0.2012, ConfusionMatrix=
[[ 868 1291]
 [  48  324]]
Epoch 0 complete in 81.69

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.5079, Acc=0.7566, AUC=0.8320, TPR=0.7335, TNR=0.7786, J=0.5122, MCC=0.5128, ConfusionMatrix=
[[2905  826]
 [ 951 2618]]
Epoch 1, Phase val, Loss=0.4970, Acc=0.7943, AUC=0.8088, TPR=0.6546, TNR=0.8192, J=0.4739, MCC=0.3910, ConfusionMatrix=
[[1781  393]
 [ 134  254]]
New Best AUC=0.8088. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1ab_avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5047, Acc=0.7882, AUC=0.7946, TPR=0.6505, TNR=0.8119, J=0.4625, MCC=0.3752, ConfusionMatrix=
[[1753  406]
 [ 130  242]]
Epoch 1 complete in 93.54

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.4376, Acc=0.7960, AUC=0.8799, TPR=0.7681, TNR=0.8241, J=0.5921, MCC=0.5930, ConfusionMatrix=
[[3003  641]
 [ 848 2808]]
Epoch 2, Phase val, Loss=0.4143, Acc=0.8306, AUC=0.7742, TPR=0.4613, TNR=0.8965, J=0.3578, MCC=0.3520, ConfusionMatrix=
[[1949  225]
 [ 209  179]]
Epoch 2, Phase test, Loss=0.4037, Acc=0.8455, AUC=0.7789, TPR=0.5484, TNR=0.8967, J=0.4451, MCC=0.4208, ConfusionMatrix=
[[1936  223]
 [ 168  204]]
Epoch 2 complete in 78.36

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.3844, Acc=0.8327, AUC=0.9085, TPR=0.8161, TNR=0.8495, J=0.6656, MCC=0.6659, ConfusionMatrix=
[[3088  547]
 [ 674 2991]]
Epoch 3, Phase val, Loss=0.4466, Acc=0.8095, AUC=0.7802, TPR=0.5412, TNR=0.8574, J=0.3986, MCC=0.3553, ConfusionMatrix=
[[1864  310]
 [ 178  210]]
Epoch 3, Phase test, Loss=0.4582, Acc=0.8214, AUC=0.7713, TPR=0.5753, TNR=0.8638, J=0.4391, MCC=0.3882, ConfusionMatrix=
[[1865  294]
 [ 158  214]]
Epoch 3 complete in 75.80

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.3404, Acc=0.8590, AUC=0.9284, TPR=0.8685, TNR=0.8494, J=0.7179, MCC=0.7181, ConfusionMatrix=
[[3069  544]
 [ 485 3202]]
Epoch 4, Phase val, Loss=0.4637, Acc=0.8130, AUC=0.7788, TPR=0.5696, TNR=0.8565, J=0.4261, MCC=0.3763, ConfusionMatrix=
[[1862  312]
 [ 167  221]]
Epoch 4, Phase test, Loss=0.4714, Acc=0.8131, AUC=0.7784, TPR=0.6263, TNR=0.8453, J=0.4716, MCC=0.4005, ConfusionMatrix=
[[1825  334]
 [ 139  233]]
Epoch 4 complete in 88.57

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.3167, Acc=0.8678, AUC=0.9373, TPR=0.8812, TNR=0.8544, J=0.7357, MCC=0.7359, ConfusionMatrix=
[[3123  532]
 [ 433 3212]]
Epoch 5, Phase val, Loss=0.5006, Acc=0.7959, AUC=0.7822, TPR=0.5876, TNR=0.8330, J=0.4207, MCC=0.3580, ConfusionMatrix=
[[1811  363]
 [ 160  228]]
Epoch 5, Phase test, Loss=0.5271, Acc=0.7926, AUC=0.7704, TPR=0.6022, TNR=0.8254, J=0.4275, MCC=0.3558, ConfusionMatrix=
[[1782  377]
 [ 148  224]]
Epoch 5 complete in 82.45

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.2682, Acc=0.8908, AUC=0.9543, TPR=0.9084, TNR=0.8735, J=0.7819, MCC=0.7822, ConfusionMatrix=
[[3210  465]
 [ 332 3293]]
Epoch 6, Phase val, Loss=0.5011, Acc=0.8294, AUC=0.7420, TPR=0.4253, TNR=0.9016, J=0.3268, MCC=0.3300, ConfusionMatrix=
[[1960  214]
 [ 223  165]]
Epoch 6, Phase test, Loss=0.4778, Acc=0.8431, AUC=0.7529, TPR=0.4946, TNR=0.9032, J=0.3978, MCC=0.3889, ConfusionMatrix=
[[1950  209]
 [ 188  184]]
Epoch 6 complete in 84.79

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.2446, Acc=0.9015, AUC=0.9614, TPR=0.9177, TNR=0.8854, J=0.8031, MCC=0.8035, ConfusionMatrix=
[[3238  419]
 [ 300 3343]]
Epoch 7, Phase val, Loss=0.6306, Acc=0.7627, AUC=0.7564, TPR=0.6186, TNR=0.7884, J=0.4070, MCC=0.3274, ConfusionMatrix=
[[1714  460]
 [ 148  240]]
Epoch 7, Phase test, Loss=0.6801, Acc=0.7463, AUC=0.7469, TPR=0.6371, TNR=0.7652, J=0.4023, MCC=0.3127, ConfusionMatrix=
[[1652  507]
 [ 135  237]]
Epoch 7 complete in 89.96

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.2126, Acc=0.9179, AUC=0.9711, TPR=0.9325, TNR=0.9037, J=0.8363, MCC=0.8363, ConfusionMatrix=
[[3342  356]
 [ 243 3359]]
Epoch 8, Phase val, Loss=0.5534, Acc=0.8169, AUC=0.7931, TPR=0.5619, TNR=0.8625, J=0.4243, MCC=0.3790, ConfusionMatrix=
[[1875  299]
 [ 170  218]]
Epoch 8, Phase test, Loss=0.5607, Acc=0.8198, AUC=0.7830, TPR=0.6263, TNR=0.8532, J=0.4795, MCC=0.4117, ConfusionMatrix=
[[1842  317]
 [ 139  233]]
Epoch 8 complete in 95.51

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.1867, Acc=0.9300, AUC=0.9767, TPR=0.9426, TNR=0.9176, J=0.8602, MCC=0.8603, ConfusionMatrix=
[[3373  303]
 [ 208 3416]]
Epoch 9, Phase val, Loss=0.6221, Acc=0.8478, AUC=0.7601, TPR=0.3789, TNR=0.9315, J=0.3103, MCC=0.3480, ConfusionMatrix=
[[2025  149]
 [ 241  147]]
Epoch 9, Phase test, Loss=0.6000, Acc=0.8621, AUC=0.7578, TPR=0.4435, TNR=0.9342, J=0.3778, MCC=0.4097, ConfusionMatrix=
[[2017  142]
 [ 207  165]]
Epoch 9 complete in 80.20

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.1688, Acc=0.9348, AUC=0.9813, TPR=0.9494, TNR=0.9201, J=0.8695, MCC=0.8699, ConfusionMatrix=
[[3351  291]
 [ 185 3473]]
Epoch 10, Phase val, Loss=0.6082, Acc=0.8169, AUC=0.7733, TPR=0.5026, TNR=0.8730, J=0.3756, MCC=0.3476, ConfusionMatrix=
[[1898  276]
 [ 193  195]]
Epoch 10, Phase test, Loss=0.6244, Acc=0.8214, AUC=0.7636, TPR=0.5296, TNR=0.8717, J=0.4013, MCC=0.3642, ConfusionMatrix=
[[1882  277]
 [ 175  197]]
Epoch 10 complete in 75.98

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.1580, Acc=0.9401, AUC=0.9830, TPR=0.9542, TNR=0.9256, J=0.8798, MCC=0.8805, ConfusionMatrix=
[[3320  267]
 [ 170 3543]]
Epoch 11, Phase val, Loss=0.6473, Acc=0.7869, AUC=0.7653, TPR=0.5438, TNR=0.8303, J=0.3741, MCC=0.3204, ConfusionMatrix=
[[1805  369]
 [ 177  211]]
Epoch 11, Phase test, Loss=0.6426, Acc=0.7906, AUC=0.7630, TPR=0.5726, TNR=0.8282, J=0.4007, MCC=0.3368, ConfusionMatrix=
[[1788  371]
 [ 159  213]]
Epoch 11 complete in 87.72

Early Stop!
Training complete in 16m 55s
The best AUC=0.808787545405
Start training resnet18_conv1x1ab_maxpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6356, Acc=0.6434, AUC=0.7223, TPR=0.8543, TNR=0.4341, J=0.2883, MCC=0.3176, ConfusionMatrix=
[[1590 2073]
 [ 530 3107]]
Epoch 0, Phase val, Loss=0.6008, Acc=0.7580, AUC=0.7955, TPR=0.7216, TNR=0.7645, J=0.4861, MCC=0.3771, ConfusionMatrix=
[[1662  512]
 [ 108  280]]
New Best AUC=0.7955. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1ab_maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6243, Acc=0.7199, AUC=0.7801, TPR=0.6694, TNR=0.7286, J=0.3979, MCC=0.2997, ConfusionMatrix=
[[1573  586]
 [ 123  249]]
Epoch 0 complete in 77.61

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.5051, Acc=0.7655, AUC=0.8322, TPR=0.6926, TNR=0.8364, J=0.5290, MCC=0.5351, ConfusionMatrix=
[[3094  605]
 [1107 2494]]
Epoch 1, Phase val, Loss=0.5151, Acc=0.8146, AUC=0.8281, TPR=0.7113, TNR=0.8330, J=0.5444, MCC=0.4510, ConfusionMatrix=
[[1811  363]
 [ 112  276]]
New Best AUC=0.8281. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1ab_maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5710, Acc=0.7732, AUC=0.7952, TPR=0.6962, TNR=0.7865, J=0.4827, MCC=0.3788, ConfusionMatrix=
[[1698  461]
 [ 113  259]]
Epoch 1 complete in 70.27

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.4750, Acc=0.7826, AUC=0.8549, TPR=0.7278, TNR=0.8372, J=0.5651, MCC=0.5685, ConfusionMatrix=
[[3060  595]
 [ 992 2653]]
Epoch 2, Phase val, Loss=0.5248, Acc=0.7881, AUC=0.8237, TPR=0.6907, TNR=0.8054, J=0.4961, MCC=0.4008, ConfusionMatrix=
[[1751  423]
 [ 120  268]]
Epoch 2, Phase test, Loss=0.5609, Acc=0.7752, AUC=0.7976, TPR=0.7043, TNR=0.7874, J=0.4917, MCC=0.3857, ConfusionMatrix=
[[1700  459]
 [ 110  262]]
Epoch 2 complete in 68.82

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.4532, Acc=0.7960, AUC=0.8673, TPR=0.7441, TNR=0.8467, J=0.5908, MCC=0.5944, ConfusionMatrix=
[[3127  566]
 [ 923 2684]]
Epoch 3, Phase val, Loss=0.4002, Acc=0.8400, AUC=0.8292, TPR=0.5309, TNR=0.8951, J=0.4261, MCC=0.4072, ConfusionMatrix=
[[1946  228]
 [ 182  206]]
New Best AUC=0.8292. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1ab_maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.4420, Acc=0.8333, AUC=0.7892, TPR=0.5995, TNR=0.8736, J=0.4730, MCC=0.4219, ConfusionMatrix=
[[1886  273]
 [ 149  223]]
Epoch 3 complete in 81.67

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.4259, Acc=0.8136, AUC=0.8852, TPR=0.7750, TNR=0.8524, J=0.6274, MCC=0.6292, ConfusionMatrix=
[[3101  537]
 [ 824 2838]]
Epoch 4, Phase val, Loss=0.3884, Acc=0.8532, AUC=0.8175, TPR=0.5438, TNR=0.9085, J=0.4523, MCC=0.4422, ConfusionMatrix=
[[1975  199]
 [ 177  211]]
Epoch 4, Phase test, Loss=0.4216, Acc=0.8605, AUC=0.7769, TPR=0.5887, TNR=0.9074, J=0.4961, MCC=0.4726, ConfusionMatrix=
[[1959  200]
 [ 153  219]]
Epoch 4 complete in 76.53

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.3957, Acc=0.8314, AUC=0.9023, TPR=0.8005, TNR=0.8631, J=0.6636, MCC=0.6645, ConfusionMatrix=
[[3108  493]
 [ 738 2961]]
Epoch 5, Phase val, Loss=0.5366, Acc=0.7970, AUC=0.8176, TPR=0.7062, TNR=0.8132, J=0.5194, MCC=0.4217, ConfusionMatrix=
[[1768  406]
 [ 114  274]]
Epoch 5, Phase test, Loss=0.6086, Acc=0.7701, AUC=0.7898, TPR=0.7070, TNR=0.7809, J=0.4879, MCC=0.3804, ConfusionMatrix=
[[1686  473]
 [ 109  263]]
Epoch 5 complete in 72.69

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.3856, Acc=0.8355, AUC=0.9075, TPR=0.8112, TNR=0.8607, J=0.6719, MCC=0.6722, ConfusionMatrix=
[[3083  499]
 [ 702 3016]]
Epoch 6, Phase val, Loss=0.5688, Acc=0.7775, AUC=0.8057, TPR=0.7139, TNR=0.7889, J=0.5028, MCC=0.3983, ConfusionMatrix=
[[1715  459]
 [ 111  277]]
Epoch 6, Phase test, Loss=0.6390, Acc=0.7562, AUC=0.7870, TPR=0.7177, TNR=0.7629, J=0.4806, MCC=0.3687, ConfusionMatrix=
[[1647  512]
 [ 105  267]]
Epoch 6 complete in 80.60

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.3562, Acc=0.8485, AUC=0.9227, TPR=0.8328, TNR=0.8640, J=0.6968, MCC=0.6972, ConfusionMatrix=
[[3170  499]
 [ 607 3024]]
Epoch 7, Phase val, Loss=0.4225, Acc=0.8431, AUC=0.7991, TPR=0.5541, TNR=0.8947, J=0.4488, MCC=0.4250, ConfusionMatrix=
[[1945  229]
 [ 173  215]]
Epoch 7, Phase test, Loss=0.4693, Acc=0.8400, AUC=0.7759, TPR=0.5941, TNR=0.8824, J=0.4764, MCC=0.4321, ConfusionMatrix=
[[1905  254]
 [ 151  221]]
Epoch 7 complete in 116.53

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.3451, Acc=0.8578, AUC=0.9267, TPR=0.8443, TNR=0.8719, J=0.7162, MCC=0.7161, ConfusionMatrix=
[[3117  458]
 [ 580 3145]]
Epoch 8, Phase val, Loss=0.4419, Acc=0.8318, AUC=0.7981, TPR=0.5928, TNR=0.8744, J=0.4672, MCC=0.4216, ConfusionMatrix=
[[1901  273]
 [ 158  230]]
Epoch 8, Phase test, Loss=0.5318, Acc=0.8056, AUC=0.7639, TPR=0.6183, TNR=0.8379, J=0.4562, MCC=0.3843, ConfusionMatrix=
[[1809  350]
 [ 142  230]]
Epoch 8 complete in 110.16

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.3229, Acc=0.8667, AUC=0.9364, TPR=0.8553, TNR=0.8783, J=0.7336, MCC=0.7337, ConfusionMatrix=
[[3176  440]
 [ 533 3151]]
Epoch 9, Phase val, Loss=0.3979, Acc=0.8482, AUC=0.8043, TPR=0.5103, TNR=0.9085, J=0.4188, MCC=0.4149, ConfusionMatrix=
[[1975  199]
 [ 190  198]]
Epoch 9, Phase test, Loss=0.4228, Acc=0.8530, AUC=0.7696, TPR=0.5430, TNR=0.9064, J=0.4494, MCC=0.4345, ConfusionMatrix=
[[1957  202]
 [ 170  202]]
Epoch 9 complete in 120.32

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.3042, Acc=0.8797, AUC=0.9432, TPR=0.8725, TNR=0.8867, J=0.7593, MCC=0.7594, ConfusionMatrix=
[[3280  419]
 [ 459 3142]]
Epoch 10, Phase val, Loss=0.4771, Acc=0.8165, AUC=0.7944, TPR=0.5876, TNR=0.8574, J=0.4450, MCC=0.3917, ConfusionMatrix=
[[1864  310]
 [ 160  228]]
Epoch 10, Phase test, Loss=0.5112, Acc=0.8151, AUC=0.7599, TPR=0.6102, TNR=0.8504, J=0.4606, MCC=0.3955, ConfusionMatrix=
[[1836  323]
 [ 145  227]]
Epoch 10 complete in 117.95

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.2779, Acc=0.8866, AUC=0.9529, TPR=0.8787, TNR=0.8944, J=0.7731, MCC=0.7732, ConfusionMatrix=
[[3278  387]
 [ 441 3194]]
Epoch 11, Phase val, Loss=0.4729, Acc=0.8236, AUC=0.8009, TPR=0.5876, TNR=0.8657, J=0.4533, MCC=0.4040, ConfusionMatrix=
[[1882  292]
 [ 160  228]]
Epoch 11, Phase test, Loss=0.5391, Acc=0.8151, AUC=0.7529, TPR=0.5995, TNR=0.8522, J=0.4517, MCC=0.3899, ConfusionMatrix=
[[1840  319]
 [ 149  223]]
Epoch 11 complete in 110.24

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.2646, Acc=0.8982, AUC=0.9569, TPR=0.8931, TNR=0.9031, J=0.7962, MCC=0.7963, ConfusionMatrix=
[[3365  361]
 [ 382 3192]]
Epoch 12, Phase val, Loss=0.5108, Acc=0.7966, AUC=0.7828, TPR=0.5902, TNR=0.8335, J=0.4237, MCC=0.3605, ConfusionMatrix=
[[1812  362]
 [ 159  229]]
Epoch 12, Phase test, Loss=0.6215, Acc=0.7728, AUC=0.7407, TPR=0.6237, TNR=0.7985, J=0.4222, MCC=0.3393, ConfusionMatrix=
[[1724  435]
 [ 140  232]]
Epoch 12 complete in 113.74

Epoch 13 starting with learning_rate: [0.003]
Epoch 13, Phase train, Loss=0.2491, Acc=0.9023, AUC=0.9617, TPR=0.9015, TNR=0.9032, J=0.8046, MCC=0.8046, ConfusionMatrix=
[[3320  356]
 [ 357 3267]]
Epoch 13, Phase val, Loss=0.4373, Acc=0.8294, AUC=0.8048, TPR=0.5515, TNR=0.8790, J=0.4306, MCC=0.3965, ConfusionMatrix=
[[1911  263]
 [ 174  214]]
Epoch 13, Phase test, Loss=0.5566, Acc=0.8068, AUC=0.7470, TPR=0.5753, TNR=0.8467, J=0.4220, MCC=0.3635, ConfusionMatrix=
[[1828  331]
 [ 158  214]]
Epoch 13 complete in 112.09

Early Stop!
Training complete in 22m 9s
The best AUC=0.829150029875
Start training resnet18_conv1x1ab_avgpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6935, Acc=0.4933, AUC=0.5215, TPR=0.9665, TNR=0.0296, J=-0.0039, MCC=-0.0112, ConfusionMatrix=
[[ 109 3578]
 [ 121 3492]]
Epoch 0, Phase val, Loss=0.7136, Acc=0.1893, AUC=0.5877, TPR=0.9820, TNR=0.0478, J=0.0298, MCC=0.0525, ConfusionMatrix=
[[ 104 2070]
 [   7  381]]
New Best AUC=0.5877. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1ab_avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7150, Acc=0.1853, AUC=0.5158, TPR=0.9758, TNR=0.0491, J=0.0249, MCC=0.0423, ConfusionMatrix=
[[ 106 2053]
 [   9  363]]
Epoch 0 complete in 113.77

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.6921, Acc=0.5103, AUC=0.5342, TPR=0.9687, TNR=0.0295, J=-0.0018, MCC=-0.0054, ConfusionMatrix=
[[ 105 3458]
 [ 117 3620]]
Epoch 1, Phase val, Loss=0.7137, Acc=0.1913, AUC=0.5842, TPR=0.9820, TNR=0.0501, J=0.0321, MCC=0.0553, ConfusionMatrix=
[[ 109 2065]
 [   7  381]]
Epoch 1, Phase test, Loss=0.7150, Acc=0.1853, AUC=0.5129, TPR=0.9758, TNR=0.0491, J=0.0249, MCC=0.0423, ConfusionMatrix=
[[ 106 2053]
 [   9  363]]
Epoch 1 complete in 116.90

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.6925, Acc=0.5077, AUC=0.5349, TPR=0.9706, TNR=0.0391, J=0.0097, MCC=0.0267, ConfusionMatrix=
[[ 142 3486]
 [ 108 3564]]
Epoch 2, Phase val, Loss=0.7135, Acc=0.1920, AUC=0.5854, TPR=0.9820, TNR=0.0511, J=0.0330, MCC=0.0565, ConfusionMatrix=
[[ 111 2063]
 [   7  381]]
Epoch 2, Phase test, Loss=0.7148, Acc=0.1873, AUC=0.5147, TPR=0.9758, TNR=0.0514, J=0.0272, MCC=0.0454, ConfusionMatrix=
[[ 111 2048]
 [   9  363]]
Epoch 2 complete in 112.58

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.6931, Acc=0.5010, AUC=0.5289, TPR=0.9727, TNR=0.0349, J=0.0076, MCC=0.0218, ConfusionMatrix=
[[ 128 3544]
 [  99 3529]]
Epoch 3, Phase val, Loss=0.7141, Acc=0.1877, AUC=0.5883, TPR=0.9820, TNR=0.0460, J=0.0280, MCC=0.0501, ConfusionMatrix=
[[ 100 2074]
 [   7  381]]
New Best AUC=0.5883. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1ab_avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.7155, Acc=0.1865, AUC=0.5179, TPR=0.9839, TNR=0.0491, J=0.0330, MCC=0.0568, ConfusionMatrix=
[[ 106 2053]
 [   6  366]]
Epoch 3 complete in 116.26

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.6932, Acc=0.5003, AUC=0.5236, TPR=0.9654, TNR=0.0372, J=0.0026, MCC=0.0069, ConfusionMatrix=
[[ 136 3522]
 [ 126 3516]]
Epoch 4, Phase val, Loss=0.7131, Acc=0.1940, AUC=0.5852, TPR=0.9820, TNR=0.0534, J=0.0353, MCC=0.0592, ConfusionMatrix=
[[ 116 2058]
 [   7  381]]
Epoch 4, Phase test, Loss=0.7145, Acc=0.1873, AUC=0.5156, TPR=0.9677, TNR=0.0528, J=0.0205, MCC=0.0334, ConfusionMatrix=
[[ 114 2045]
 [  12  360]]
Epoch 4 complete in 104.36

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.6924, Acc=0.5111, AUC=0.5302, TPR=0.9672, TNR=0.0372, J=0.0044, MCC=0.0119, ConfusionMatrix=
[[ 133 3447]
 [ 122 3598]]
Epoch 5, Phase val, Loss=0.7136, Acc=0.1901, AUC=0.5845, TPR=0.9820, TNR=0.0488, J=0.0307, MCC=0.0536, ConfusionMatrix=
[[ 106 2068]
 [   7  381]]
Epoch 5, Phase test, Loss=0.7149, Acc=0.1861, AUC=0.5127, TPR=0.9785, TNR=0.0496, J=0.0281, MCC=0.0477, ConfusionMatrix=
[[ 107 2052]
 [   8  364]]
Epoch 5 complete in 112.52

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.6930, Acc=0.5012, AUC=0.5212, TPR=0.9668, TNR=0.0279, J=-0.0053, MCC=-0.0153, ConfusionMatrix=
[[ 101 3519]
 [ 122 3558]]
Epoch 6, Phase val, Loss=0.7141, Acc=0.1905, AUC=0.5864, TPR=0.9820, TNR=0.0492, J=0.0312, MCC=0.0542, ConfusionMatrix=
[[ 107 2067]
 [   7  381]]
Epoch 6, Phase test, Loss=0.7154, Acc=0.1853, AUC=0.5148, TPR=0.9758, TNR=0.0491, J=0.0249, MCC=0.0423, ConfusionMatrix=
[[ 106 2053]
 [   9  363]]
Epoch 6 complete in 121.61

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.6926, Acc=0.5085, AUC=0.5250, TPR=0.9644, TNR=0.0368, J=0.0012, MCC=0.0033, ConfusionMatrix=
[[ 132 3456]
 [ 132 3580]]
Epoch 7, Phase val, Loss=0.7131, Acc=0.1924, AUC=0.5859, TPR=0.9820, TNR=0.0515, J=0.0335, MCC=0.0570, ConfusionMatrix=
[[ 112 2062]
 [   7  381]]
Epoch 7, Phase test, Loss=0.7145, Acc=0.1900, AUC=0.5140, TPR=0.9758, TNR=0.0547, J=0.0305, MCC=0.0494, ConfusionMatrix=
[[ 118 2041]
 [   9  363]]
Epoch 7 complete in 110.46

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.6941, Acc=0.4923, AUC=0.5130, TPR=0.9640, TNR=0.0379, J=0.0019, MCC=0.0051, ConfusionMatrix=
[[ 141 3577]
 [ 129 3453]]
Epoch 8, Phase val, Loss=0.7131, Acc=0.1924, AUC=0.5857, TPR=0.9820, TNR=0.0515, J=0.0335, MCC=0.0570, ConfusionMatrix=
[[ 112 2062]
 [   7  381]]
Epoch 8, Phase test, Loss=0.7144, Acc=0.1904, AUC=0.5150, TPR=0.9758, TNR=0.0551, J=0.0309, MCC=0.0500, ConfusionMatrix=
[[ 119 2040]
 [   9  363]]
Epoch 8 complete in 106.58

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.6934, Acc=0.4990, AUC=0.5249, TPR=0.9657, TNR=0.0412, J=0.0069, MCC=0.0182, ConfusionMatrix=
[[ 152 3533]
 [ 124 3491]]
Epoch 9, Phase val, Loss=0.7139, Acc=0.1905, AUC=0.5873, TPR=0.9820, TNR=0.0492, J=0.0312, MCC=0.0542, ConfusionMatrix=
[[ 107 2067]
 [   7  381]]
Epoch 9, Phase test, Loss=0.7154, Acc=0.1853, AUC=0.5147, TPR=0.9785, TNR=0.0486, J=0.0271, MCC=0.0465, ConfusionMatrix=
[[ 105 2054]
 [   8  364]]
Epoch 9 complete in 114.23

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.6928, Acc=0.5042, AUC=0.5219, TPR=0.9661, TNR=0.0327, J=-0.0012, MCC=-0.0034, ConfusionMatrix=
[[ 118 3494]
 [ 125 3563]]
Epoch 10, Phase val, Loss=0.7135, Acc=0.1909, AUC=0.5851, TPR=0.9820, TNR=0.0497, J=0.0316, MCC=0.0548, ConfusionMatrix=
[[ 108 2066]
 [   7  381]]
Epoch 10, Phase test, Loss=0.7148, Acc=0.1873, AUC=0.5146, TPR=0.9731, TNR=0.0519, J=0.0250, MCC=0.0413, ConfusionMatrix=
[[ 112 2047]
 [  10  362]]
Epoch 10 complete in 114.09

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.6935, Acc=0.4995, AUC=0.5215, TPR=0.9685, TNR=0.0383, J=0.0068, MCC=0.0185, ConfusionMatrix=
[[ 141 3540]
 [ 114 3505]]
Epoch 11, Phase val, Loss=0.7137, Acc=0.1905, AUC=0.5880, TPR=0.9820, TNR=0.0492, J=0.0312, MCC=0.0542, ConfusionMatrix=
[[ 107 2067]
 [   7  381]]
Epoch 11, Phase test, Loss=0.7152, Acc=0.1849, AUC=0.5134, TPR=0.9785, TNR=0.0482, J=0.0267, MCC=0.0459, ConfusionMatrix=
[[ 104 2055]
 [   8  364]]
Epoch 11 complete in 123.23

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.6931, Acc=0.4992, AUC=0.5267, TPR=0.9635, TNR=0.0364, J=-0.0001, MCC=-0.0003, ConfusionMatrix=
[[ 133 3523]
 [ 133 3511]]
Epoch 12, Phase val, Loss=0.7135, Acc=0.1901, AUC=0.5871, TPR=0.9820, TNR=0.0488, J=0.0307, MCC=0.0536, ConfusionMatrix=
[[ 106 2068]
 [   7  381]]
Epoch 12, Phase test, Loss=0.7149, Acc=0.1869, AUC=0.5148, TPR=0.9785, TNR=0.0505, J=0.0290, MCC=0.0489, ConfusionMatrix=
[[ 109 2050]
 [   8  364]]
Epoch 12 complete in 115.63

Epoch 13 starting with learning_rate: [0.003]
Epoch 13, Phase train, Loss=0.6922, Acc=0.5104, AUC=0.5327, TPR=0.9683, TNR=0.0338, J=0.0021, MCC=0.0060, ConfusionMatrix=
[[ 121 3456]
 [ 118 3605]]
Epoch 13, Phase val, Loss=0.7133, Acc=0.1944, AUC=0.5830, TPR=0.9820, TNR=0.0538, J=0.0358, MCC=0.0598, ConfusionMatrix=
[[ 117 2057]
 [   7  381]]
Epoch 13, Phase test, Loss=0.7145, Acc=0.1889, AUC=0.5123, TPR=0.9677, TNR=0.0547, J=0.0224, MCC=0.0359, ConfusionMatrix=
[[ 118 2041]
 [  12  360]]
Epoch 13 complete in 108.98

Early Stop!
Training complete in 26m 31s
The best AUC=0.588259562401
Start training resnet50fixed_conv1x1ab_maxpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6696, Acc=0.6145, AUC=0.6661, TPR=0.7978, TNR=0.4423, J=0.2401, MCC=0.2560, ConfusionMatrix=
[[1665 2099]
 [ 715 2821]]
Epoch 0, Phase val, Loss=0.6364, Acc=0.6628, AUC=0.7148, TPR=0.6675, TNR=0.6619, J=0.3294, MCC=0.2424, ConfusionMatrix=
[[1439  735]
 [ 129  259]]
New Best AUC=0.7148. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6414, Acc=0.6326, AUC=0.6858, TPR=0.6505, TNR=0.6295, J=0.2800, MCC=0.2015, ConfusionMatrix=
[[1359  800]
 [ 130  242]]
Epoch 0 complete in 118.73

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.6013, Acc=0.6849, AUC=0.7496, TPR=0.7027, TNR=0.6673, J=0.3700, MCC=0.3702, ConfusionMatrix=
[[2445 1219]
 [1081 2555]]
Epoch 1, Phase val, Loss=0.6636, Acc=0.6479, AUC=0.7517, TPR=0.7526, TNR=0.6293, J=0.3818, MCC=0.2766, ConfusionMatrix=
[[1368  806]
 [  96  292]]
New Best AUC=0.7517. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7072, Acc=0.6073, AUC=0.7553, TPR=0.7742, TNR=0.5785, J=0.3527, MCC=0.2501, ConfusionMatrix=
[[1249  910]
 [  84  288]]
Epoch 1 complete in 121.13

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.5461, Acc=0.7259, AUC=0.7981, TPR=0.7151, TNR=0.7368, J=0.4520, MCC=0.4520, ConfusionMatrix=
[[2668  953]
 [1048 2631]]
Epoch 2, Phase val, Loss=0.5748, Acc=0.7381, AUC=0.7673, TPR=0.6418, TNR=0.7553, J=0.3970, MCC=0.3092, ConfusionMatrix=
[[1642  532]
 [ 139  249]]
New Best AUC=0.7673. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6068, Acc=0.7104, AUC=0.7645, TPR=0.6774, TNR=0.7161, J=0.3935, MCC=0.2938, ConfusionMatrix=
[[1546  613]
 [ 120  252]]
Epoch 2 complete in 132.60

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.5291, Acc=0.7366, AUC=0.8129, TPR=0.7022, TNR=0.7709, J=0.4730, MCC=0.4742, ConfusionMatrix=
[[2819  838]
 [1085 2558]]
Epoch 3, Phase val, Loss=0.5037, Acc=0.7802, AUC=0.7813, TPR=0.5644, TNR=0.8188, J=0.3832, MCC=0.3220, ConfusionMatrix=
[[1780  394]
 [ 169  219]]
New Best AUC=0.7813. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5429, Acc=0.7768, AUC=0.7679, TPR=0.6263, TNR=0.8027, J=0.4290, MCC=0.3462, ConfusionMatrix=
[[1733  426]
 [ 139  233]]
Epoch 3 complete in 122.98

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.5335, Acc=0.7326, AUC=0.8091, TPR=0.7089, TNR=0.7569, J=0.4657, MCC=0.4661, ConfusionMatrix=
[[2733  878]
 [1074 2615]]
Epoch 4, Phase val, Loss=0.5074, Acc=0.7912, AUC=0.7780, TPR=0.5902, TNR=0.8270, J=0.4173, MCC=0.3522, ConfusionMatrix=
[[1798  376]
 [ 159  229]]
Epoch 4, Phase test, Loss=0.5353, Acc=0.7835, AUC=0.7723, TPR=0.6129, TNR=0.8129, J=0.4258, MCC=0.3483, ConfusionMatrix=
[[1755  404]
 [ 144  228]]
Epoch 4 complete in 120.85

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.5283, Acc=0.7341, AUC=0.8133, TPR=0.6835, TNR=0.7823, J=0.4658, MCC=0.4685, ConfusionMatrix=
[[2925  814]
 [1127 2434]]
Epoch 5, Phase val, Loss=0.4744, Acc=0.8091, AUC=0.7835, TPR=0.5593, TNR=0.8537, J=0.4130, MCC=0.3642, ConfusionMatrix=
[[1856  318]
 [ 171  217]]
New Best AUC=0.7835. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5036, Acc=0.8119, AUC=0.7665, TPR=0.5806, TNR=0.8518, J=0.4324, MCC=0.3748, ConfusionMatrix=
[[1839  320]
 [ 156  216]]
Epoch 5 complete in 124.63

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.5286, Acc=0.7421, AUC=0.8150, TPR=0.7070, TNR=0.7767, J=0.4838, MCC=0.4850, ConfusionMatrix=
[[2849  819]
 [1064 2568]]
Epoch 6, Phase val, Loss=0.5652, Acc=0.7592, AUC=0.7784, TPR=0.6572, TNR=0.7774, J=0.4346, MCC=0.3439, ConfusionMatrix=
[[1690  484]
 [ 133  255]]
Epoch 6, Phase test, Loss=0.6015, Acc=0.7345, AUC=0.7697, TPR=0.6747, TNR=0.7448, J=0.4195, MCC=0.3193, ConfusionMatrix=
[[1608  551]
 [ 121  251]]
Epoch 6 complete in 122.37

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.5138, Acc=0.7553, AUC=0.8264, TPR=0.7184, TNR=0.7913, J=0.5096, MCC=0.5112, ConfusionMatrix=
[[2930  773]
 [1013 2584]]
Epoch 7, Phase val, Loss=0.4581, Acc=0.8146, AUC=0.7825, TPR=0.5258, TNR=0.8661, J=0.3919, MCC=0.3559, ConfusionMatrix=
[[1883  291]
 [ 184  204]]
Epoch 7, Phase test, Loss=0.4848, Acc=0.8147, AUC=0.7644, TPR=0.5484, TNR=0.8606, J=0.4090, MCC=0.3623, ConfusionMatrix=
[[1858  301]
 [ 168  204]]
Epoch 7 complete in 123.70

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.5155, Acc=0.7532, AUC=0.8255, TPR=0.7302, TNR=0.7767, J=0.5068, MCC=0.5072, ConfusionMatrix=
[[2803  806]
 [ 996 2695]]
Epoch 8, Phase val, Loss=0.5652, Acc=0.7393, AUC=0.7807, TPR=0.6649, TNR=0.7525, J=0.4175, MCC=0.3234, ConfusionMatrix=
[[1636  538]
 [ 130  258]]
Epoch 8, Phase test, Loss=0.5989, Acc=0.7191, AUC=0.7728, TPR=0.6774, TNR=0.7263, J=0.4037, MCC=0.3033, ConfusionMatrix=
[[1568  591]
 [ 120  252]]
Epoch 8 complete in 119.39

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.5097, Acc=0.7593, AUC=0.8284, TPR=0.7331, TNR=0.7858, J=0.5188, MCC=0.5195, ConfusionMatrix=
[[2857  779]
 [ 978 2686]]
Epoch 9, Phase val, Loss=0.5523, Acc=0.7619, AUC=0.7802, TPR=0.6340, TNR=0.7847, J=0.4187, MCC=0.3348, ConfusionMatrix=
[[1706  468]
 [ 142  246]]
Epoch 9, Phase test, Loss=0.5865, Acc=0.7349, AUC=0.7774, TPR=0.6774, TNR=0.7448, J=0.4222, MCC=0.3212, ConfusionMatrix=
[[1608  551]
 [ 120  252]]
Epoch 9 complete in 118.66

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.5144, Acc=0.7475, AUC=0.8251, TPR=0.7361, TNR=0.7595, J=0.4956, MCC=0.4955, ConfusionMatrix=
[[2713  859]
 [ 984 2744]]
Epoch 10, Phase val, Loss=0.5195, Acc=0.7795, AUC=0.7713, TPR=0.5876, TNR=0.8137, J=0.4013, MCC=0.3336, ConfusionMatrix=
[[1769  405]
 [ 160  228]]
Epoch 10, Phase test, Loss=0.5409, Acc=0.7685, AUC=0.7761, TPR=0.6263, TNR=0.7930, J=0.4193, MCC=0.3349, ConfusionMatrix=
[[1712  447]
 [ 139  233]]
Epoch 10 complete in 113.96

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.5205, Acc=0.7474, AUC=0.8200, TPR=0.7127, TNR=0.7824, J=0.4951, MCC=0.4962, ConfusionMatrix=
[[2844  791]
 [1053 2612]]
Epoch 11, Phase val, Loss=0.5433, Acc=0.7814, AUC=0.7847, TPR=0.6443, TNR=0.8059, J=0.4502, MCC=0.3669, ConfusionMatrix=
[[1752  422]
 [ 138  250]]
New Best AUC=0.7847. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.5670, Acc=0.7550, AUC=0.7765, TPR=0.6452, TNR=0.7740, J=0.4191, MCC=0.3279, ConfusionMatrix=
[[1671  488]
 [ 132  240]]
Epoch 11 complete in 118.78

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.5064, Acc=0.7585, AUC=0.8304, TPR=0.7235, TNR=0.7926, J=0.5162, MCC=0.5176, ConfusionMatrix=
[[2928  766]
 [ 997 2609]]
Epoch 12, Phase val, Loss=0.5056, Acc=0.7970, AUC=0.7824, TPR=0.5954, TNR=0.8330, J=0.4284, MCC=0.3639, ConfusionMatrix=
[[1811  363]
 [ 157  231]]
Epoch 12, Phase test, Loss=0.5318, Acc=0.7863, AUC=0.7781, TPR=0.6156, TNR=0.8157, J=0.4312, MCC=0.3537, ConfusionMatrix=
[[1761  398]
 [ 143  229]]
Epoch 12 complete in 123.39

Epoch 13 starting with learning_rate: [0.003]
Epoch 13, Phase train, Loss=0.5307, Acc=0.7436, AUC=0.8120, TPR=0.7091, TNR=0.7786, J=0.4877, MCC=0.4887, ConfusionMatrix=
[[2820  802]
 [1070 2608]]
Epoch 13, Phase val, Loss=0.6691, Acc=0.6889, AUC=0.7799, TPR=0.7526, TNR=0.6776, J=0.4301, MCC=0.3165, ConfusionMatrix=
[[1473  701]
 [  96  292]]
Epoch 13, Phase test, Loss=0.7049, Acc=0.6385, AUC=0.7858, TPR=0.7769, TNR=0.6146, J=0.3915, MCC=0.2791, ConfusionMatrix=
[[1327  832]
 [  83  289]]
Epoch 13 complete in 96.62

Epoch 14 starting with learning_rate: [0.003]
Epoch 14, Phase train, Loss=0.5082, Acc=0.7567, AUC=0.8311, TPR=0.7334, TNR=0.7810, J=0.5144, MCC=0.5146, ConfusionMatrix=
[[2792  783]
 [ 993 2732]]
Epoch 14, Phase val, Loss=0.6011, Acc=0.7272, AUC=0.7835, TPR=0.7088, TNR=0.7305, J=0.4392, MCC=0.3333, ConfusionMatrix=
[[1588  586]
 [ 113  275]]
Epoch 14, Phase test, Loss=0.6285, Acc=0.6989, AUC=0.7827, TPR=0.7204, TNR=0.6952, J=0.4157, MCC=0.3056, ConfusionMatrix=
[[1501  658]
 [ 104  268]]
Epoch 14 complete in 84.60

Epoch 15 starting with learning_rate: [0.003]
Epoch 15, Phase train, Loss=0.5178, Acc=0.7547, AUC=0.8228, TPR=0.7234, TNR=0.7858, J=0.5092, MCC=0.5102, ConfusionMatrix=
[[2873  783]
 [1008 2636]]
Epoch 15, Phase val, Loss=0.6140, Acc=0.7252, AUC=0.7849, TPR=0.7139, TNR=0.7272, J=0.4411, MCC=0.3339, ConfusionMatrix=
[[1581  593]
 [ 111  277]]
New Best AUC=0.7849. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 15, Phase test, Loss=0.6507, Acc=0.6966, AUC=0.7832, TPR=0.7258, TNR=0.6915, J=0.4173, MCC=0.3061, ConfusionMatrix=
[[1493  666]
 [ 102  270]]
Epoch 15 complete in 81.10

Epoch 16 starting with learning_rate: [0.003]
Epoch 16, Phase train, Loss=0.4974, Acc=0.7630, AUC=0.8379, TPR=0.7293, TNR=0.7970, J=0.5263, MCC=0.5274, ConfusionMatrix=
[[2897  738]
 [ 992 2673]]
Epoch 16, Phase val, Loss=0.6051, Acc=0.7361, AUC=0.7811, TPR=0.6985, TNR=0.7429, J=0.4413, MCC=0.3381, ConfusionMatrix=
[[1615  559]
 [ 117  271]]
Epoch 16, Phase test, Loss=0.6423, Acc=0.6926, AUC=0.7846, TPR=0.7339, TNR=0.6855, J=0.4194, MCC=0.3065, ConfusionMatrix=
[[1480  679]
 [  99  273]]
Epoch 16 complete in 77.77

Epoch 17 starting with learning_rate: [0.003]
Epoch 17, Phase train, Loss=0.5020, Acc=0.7590, AUC=0.8333, TPR=0.7157, TNR=0.8014, J=0.5170, MCC=0.5192, ConfusionMatrix=
[[2961  734]
 [1025 2580]]
Epoch 17, Phase val, Loss=0.5034, Acc=0.7986, AUC=0.7805, TPR=0.5902, TNR=0.8358, J=0.4260, MCC=0.3636, ConfusionMatrix=
[[1817  357]
 [ 159  229]]
Epoch 17, Phase test, Loss=0.5221, Acc=0.7945, AUC=0.7706, TPR=0.6102, TNR=0.8263, J=0.4365, MCC=0.3630, ConfusionMatrix=
[[1784  375]
 [ 145  227]]
Epoch 17 complete in 79.60

Epoch 18 starting with learning_rate: [0.003]
Epoch 18, Phase train, Loss=0.4876, Acc=0.7684, AUC=0.8454, TPR=0.7353, TNR=0.8008, J=0.5361, MCC=0.5374, ConfusionMatrix=
[[2950  734]
 [ 957 2659]]
Epoch 18, Phase val, Loss=0.5325, Acc=0.7806, AUC=0.7779, TPR=0.6211, TNR=0.8091, J=0.4302, MCC=0.3534, ConfusionMatrix=
[[1759  415]
 [ 147  241]]
Epoch 18, Phase test, Loss=0.5626, Acc=0.7594, AUC=0.7725, TPR=0.6371, TNR=0.7805, J=0.4176, MCC=0.3290, ConfusionMatrix=
[[1685  474]
 [ 135  237]]
Epoch 18 complete in 80.30

Epoch 19 starting with learning_rate: [0.003]
Epoch 19, Phase train, Loss=0.5015, Acc=0.7615, AUC=0.8364, TPR=0.7283, TNR=0.7936, J=0.5219, MCC=0.5233, ConfusionMatrix=
[[2946  766]
 [ 975 2613]]
Epoch 19, Phase val, Loss=0.6724, Acc=0.6846, AUC=0.7762, TPR=0.7371, TNR=0.6753, J=0.4124, MCC=0.3035, ConfusionMatrix=
[[1468  706]
 [ 102  286]]
Epoch 19, Phase test, Loss=0.7135, Acc=0.6480, AUC=0.7790, TPR=0.7634, TNR=0.6281, J=0.3915, MCC=0.2801, ConfusionMatrix=
[[1356  803]
 [  88  284]]
Epoch 19 complete in 70.45

Epoch 20 starting with learning_rate: [0.003]
Epoch 20, Phase train, Loss=0.5021, Acc=0.7604, AUC=0.8353, TPR=0.7160, TNR=0.8042, J=0.5202, MCC=0.5224, ConfusionMatrix=
[[2957  720]
 [1029 2594]]
Epoch 20, Phase val, Loss=0.5309, Acc=0.7830, AUC=0.7735, TPR=0.6108, TNR=0.8137, J=0.4245, MCC=0.3512, ConfusionMatrix=
[[1769  405]
 [ 151  237]]
Epoch 20, Phase test, Loss=0.5473, Acc=0.7704, AUC=0.7709, TPR=0.6183, TNR=0.7967, J=0.4149, MCC=0.3332, ConfusionMatrix=
[[1720  439]
 [ 142  230]]
Epoch 20 complete in 67.19

Epoch 21 starting with learning_rate: [0.003]
Epoch 21, Phase train, Loss=0.5001, Acc=0.7714, AUC=0.8377, TPR=0.7426, TNR=0.8003, J=0.5429, MCC=0.5438, ConfusionMatrix=
[[2913  727]
 [ 942 2718]]
Epoch 21, Phase val, Loss=0.4582, Acc=0.8142, AUC=0.7735, TPR=0.5258, TNR=0.8657, J=0.3915, MCC=0.3552, ConfusionMatrix=
[[1882  292]
 [ 184  204]]
Epoch 21, Phase test, Loss=0.4722, Acc=0.8273, AUC=0.7754, TPR=0.5565, TNR=0.8740, J=0.4305, MCC=0.3891, ConfusionMatrix=
[[1887  272]
 [ 165  207]]
Epoch 21 complete in 64.04

Epoch 22 starting with learning_rate: [0.003]
Epoch 22, Phase train, Loss=0.4930, Acc=0.7664, AUC=0.8421, TPR=0.7440, TNR=0.7890, J=0.5330, MCC=0.5335, ConfusionMatrix=
[[2872  768]
 [ 937 2723]]
Epoch 22, Phase val, Loss=0.4424, Acc=0.8279, AUC=0.7790, TPR=0.5052, TNR=0.8855, J=0.3906, MCC=0.3696, ConfusionMatrix=
[[1925  249]
 [ 192  196]]
Epoch 22, Phase test, Loss=0.4618, Acc=0.8352, AUC=0.7729, TPR=0.5376, TNR=0.8865, J=0.4242, MCC=0.3945, ConfusionMatrix=
[[1914  245]
 [ 172  200]]
Epoch 22 complete in 72.93

Epoch 23 starting with learning_rate: [0.003]
Epoch 23, Phase train, Loss=0.5038, Acc=0.7648, AUC=0.8342, TPR=0.7374, TNR=0.7921, J=0.5294, MCC=0.5303, ConfusionMatrix=
[[2899  761]
 [ 956 2684]]
Epoch 23, Phase val, Loss=0.4769, Acc=0.8091, AUC=0.7821, TPR=0.5593, TNR=0.8537, J=0.4130, MCC=0.3642, ConfusionMatrix=
[[1856  318]
 [ 171  217]]
Epoch 23, Phase test, Loss=0.5020, Acc=0.8072, AUC=0.7734, TPR=0.5780, TNR=0.8467, J=0.4246, MCC=0.3656, ConfusionMatrix=
[[1828  331]
 [ 157  215]]
Epoch 23 complete in 78.26

Epoch 24 starting with learning_rate: [0.003]
Epoch 24, Phase train, Loss=0.4998, Acc=0.7658, AUC=0.8383, TPR=0.7301, TNR=0.8018, J=0.5319, MCC=0.5331, ConfusionMatrix=
[[2912  720]
 [ 990 2678]]
Epoch 24, Phase val, Loss=0.5587, Acc=0.7639, AUC=0.7821, TPR=0.6546, TNR=0.7833, J=0.4380, MCC=0.3486, ConfusionMatrix=
[[1703  471]
 [ 134  254]]
Epoch 24, Phase test, Loss=0.5924, Acc=0.7357, AUC=0.7719, TPR=0.6640, TNR=0.7480, J=0.4120, MCC=0.3147, ConfusionMatrix=
[[1615  544]
 [ 125  247]]
Epoch 24 complete in 70.31

Epoch 25 starting with learning_rate: [0.003]
Epoch 25, Phase train, Loss=0.4912, Acc=0.7725, AUC=0.8437, TPR=0.7528, TNR=0.7926, J=0.5455, MCC=0.5457, ConfusionMatrix=
[[2855  747]
 [ 914 2784]]
Epoch 25, Phase val, Loss=0.4270, Acc=0.8279, AUC=0.7815, TPR=0.4742, TNR=0.8910, J=0.3652, MCC=0.3533, ConfusionMatrix=
[[1937  237]
 [ 204  184]]
Epoch 25, Phase test, Loss=0.4483, Acc=0.8317, AUC=0.7694, TPR=0.4946, TNR=0.8898, J=0.3844, MCC=0.3652, ConfusionMatrix=
[[1921  238]
 [ 188  184]]
Epoch 25 complete in 67.94

Early Stop!
Training complete in 42m 52s
The best AUC=0.784856646971
Start training resnet50fixed_conv1x1ab_avgpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6647, Acc=0.6166, AUC=0.6703, TPR=0.6889, TNR=0.5468, J=0.2357, MCC=0.2380, ConfusionMatrix=
[[2032 1684]
 [1115 2469]]
Epoch 0, Phase val, Loss=0.6344, Acc=0.6023, AUC=0.7077, TPR=0.7474, TNR=0.5764, J=0.3238, MCC=0.2325, ConfusionMatrix=
[[1253  921]
 [  98  290]]
New Best AUC=0.7077. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6348, Acc=0.5962, AUC=0.6812, TPR=0.7043, TNR=0.5776, J=0.2819, MCC=0.2001, ConfusionMatrix=
[[1247  912]
 [ 110  262]]
Epoch 0 complete in 66.11

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.6147, Acc=0.6716, AUC=0.7301, TPR=0.7510, TNR=0.5926, J=0.3436, MCC=0.3480, ConfusionMatrix=
[[2167 1490]
 [ 907 2736]]
Epoch 1, Phase val, Loss=0.6091, Acc=0.6284, AUC=0.7230, TPR=0.7088, TNR=0.6141, J=0.3228, MCC=0.2335, ConfusionMatrix=
[[1335  839]
 [ 113  275]]
New Best AUC=0.7230. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6211, Acc=0.6120, AUC=0.7099, TPR=0.7097, TNR=0.5952, J=0.3049, MCC=0.2170, ConfusionMatrix=
[[1285  874]
 [ 108  264]]
Epoch 1 complete in 71.87

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.5953, Acc=0.6870, AUC=0.7508, TPR=0.7518, TNR=0.6209, J=0.3727, MCC=0.3761, ConfusionMatrix=
[[2244 1370]
 [ 915 2771]]
Epoch 2, Phase val, Loss=0.5415, Acc=0.7272, AUC=0.7390, TPR=0.5851, TNR=0.7525, J=0.3376, MCC=0.2644, ConfusionMatrix=
[[1636  538]
 [ 161  227]]
New Best AUC=0.7390. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5574, Acc=0.6962, AUC=0.7246, TPR=0.6075, TNR=0.7114, J=0.3190, MCC=0.2392, ConfusionMatrix=
[[1536  623]
 [ 146  226]]
Epoch 2 complete in 78.38

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.5742, Acc=0.7068, AUC=0.7729, TPR=0.7191, TNR=0.6947, J=0.4138, MCC=0.4139, ConfusionMatrix=
[[2549 1120]
 [1020 2611]]
Epoch 3, Phase val, Loss=0.6129, Acc=0.6612, AUC=0.7463, TPR=0.7320, TNR=0.6486, J=0.3805, MCC=0.2775, ConfusionMatrix=
[[1410  764]
 [ 104  284]]
New Best AUC=0.7463. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6402, Acc=0.6254, AUC=0.7335, TPR=0.7204, TNR=0.6091, J=0.3295, MCC=0.2351, ConfusionMatrix=
[[1315  844]
 [ 104  268]]
Epoch 3 complete in 71.24

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.5608, Acc=0.7159, AUC=0.7861, TPR=0.7400, TNR=0.6914, J=0.4314, MCC=0.4320, ConfusionMatrix=
[[2505 1118]
 [ 956 2721]]
Epoch 4, Phase val, Loss=0.5278, Acc=0.7412, AUC=0.7416, TPR=0.5593, TNR=0.7737, J=0.3330, MCC=0.2668, ConfusionMatrix=
[[1682  492]
 [ 171  217]]
Epoch 4, Phase test, Loss=0.5509, Acc=0.7092, AUC=0.7318, TPR=0.5860, TNR=0.7304, J=0.3165, MCC=0.2410, ConfusionMatrix=
[[1577  582]
 [ 154  218]]
Epoch 4 complete in 64.92

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.5586, Acc=0.7170, AUC=0.7869, TPR=0.7228, TNR=0.7112, J=0.4340, MCC=0.4340, ConfusionMatrix=
[[2603 1057]
 [1009 2631]]
Epoch 5, Phase val, Loss=0.5564, Acc=0.7276, AUC=0.7478, TPR=0.6314, TNR=0.7447, J=0.3762, MCC=0.2910, ConfusionMatrix=
[[1619  555]
 [ 143  245]]
New Best AUC=0.7478. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 5, Phase test, Loss=0.5833, Acc=0.6867, AUC=0.7368, TPR=0.6532, TNR=0.6925, J=0.3457, MCC=0.2553, ConfusionMatrix=
[[1495  664]
 [ 129  243]]
Epoch 5 complete in 67.32

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.5368, Acc=0.7316, AUC=0.8071, TPR=0.7368, TNR=0.7266, J=0.4634, MCC=0.4634, ConfusionMatrix=
[[2682 1009]
 [ 950 2659]]
Epoch 6, Phase val, Loss=0.5284, Acc=0.7459, AUC=0.7540, TPR=0.6211, TNR=0.7682, J=0.3893, MCC=0.3073, ConfusionMatrix=
[[1670  504]
 [ 147  241]]
New Best AUC=0.7540. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 6, Phase test, Loss=0.5510, Acc=0.7151, AUC=0.7409, TPR=0.6290, TNR=0.7300, J=0.3590, MCC=0.2719, ConfusionMatrix=
[[1576  583]
 [ 138  234]]
Epoch 6 complete in 67.23

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.5432, Acc=0.7292, AUC=0.8007, TPR=0.7474, TNR=0.7099, J=0.4573, MCC=0.4577, ConfusionMatrix=
[[2521 1030]
 [ 947 2802]]
Epoch 7, Phase val, Loss=0.5681, Acc=0.7116, AUC=0.7556, TPR=0.6727, TNR=0.7185, J=0.3912, MCC=0.2959, ConfusionMatrix=
[[1562  612]
 [ 127  261]]
New Best AUC=0.7556. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 7, Phase test, Loss=0.5933, Acc=0.6819, AUC=0.7424, TPR=0.6720, TNR=0.6836, J=0.3557, MCC=0.2611, ConfusionMatrix=
[[1476  683]
 [ 122  250]]
Epoch 7 complete in 80.94

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.5420, Acc=0.7260, AUC=0.8020, TPR=0.7219, TNR=0.7301, J=0.4520, MCC=0.4520, ConfusionMatrix=
[[2675  989]
 [1011 2625]]
Epoch 8, Phase val, Loss=0.6164, Acc=0.6764, AUC=0.7544, TPR=0.7191, TNR=0.6688, J=0.3879, MCC=0.2851, ConfusionMatrix=
[[1454  720]
 [ 109  279]]
Epoch 8, Phase test, Loss=0.6465, Acc=0.6452, AUC=0.7418, TPR=0.7177, TNR=0.6327, J=0.3504, MCC=0.2515, ConfusionMatrix=
[[1366  793]
 [ 105  267]]
Epoch 8 complete in 75.55

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.5365, Acc=0.7300, AUC=0.8074, TPR=0.7259, TNR=0.7339, J=0.4598, MCC=0.4598, ConfusionMatrix=
[[2731  990]
 [ 981 2598]]
Epoch 9, Phase val, Loss=0.5009, Acc=0.7709, AUC=0.7485, TPR=0.5361, TNR=0.8128, J=0.3489, MCC=0.2928, ConfusionMatrix=
[[1767  407]
 [ 180  208]]
Epoch 9, Phase test, Loss=0.5186, Acc=0.7424, AUC=0.7392, TPR=0.5726, TNR=0.7717, J=0.3442, MCC=0.2718, ConfusionMatrix=
[[1666  493]
 [ 159  213]]
Epoch 9 complete in 56.67

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.5428, Acc=0.7273, AUC=0.8013, TPR=0.7338, TNR=0.7206, J=0.4543, MCC=0.4544, ConfusionMatrix=
[[2594 1006]
 [ 985 2715]]
Epoch 10, Phase val, Loss=0.5592, Acc=0.7233, AUC=0.7561, TPR=0.6521, TNR=0.7360, J=0.3880, MCC=0.2975, ConfusionMatrix=
[[1600  574]
 [ 135  253]]
New Best AUC=0.7561. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 10, Phase test, Loss=0.5839, Acc=0.6954, AUC=0.7459, TPR=0.6694, TNR=0.6999, J=0.3692, MCC=0.2733, ConfusionMatrix=
[[1511  648]
 [ 123  249]]
Epoch 10 complete in 57.78

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.5485, Acc=0.7236, AUC=0.7968, TPR=0.7176, TNR=0.7293, J=0.4469, MCC=0.4469, ConfusionMatrix=
[[2708 1005]
 [1013 2574]]
Epoch 11, Phase val, Loss=0.5053, Acc=0.7689, AUC=0.7566, TPR=0.5670, TNR=0.8050, J=0.3720, MCC=0.3074, ConfusionMatrix=
[[1750  424]
 [ 168  220]]
New Best AUC=0.7566. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 11, Phase test, Loss=0.5235, Acc=0.7380, AUC=0.7447, TPR=0.5833, TNR=0.7647, J=0.3480, MCC=0.2726, ConfusionMatrix=
[[1651  508]
 [ 155  217]]
Epoch 11 complete in 58.04

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.5216, Acc=0.7504, AUC=0.8203, TPR=0.7596, TNR=0.7407, J=0.5003, MCC=0.5004, ConfusionMatrix=
[[2628  920]
 [ 902 2850]]
Epoch 12, Phase val, Loss=0.5600, Acc=0.7268, AUC=0.7544, TPR=0.6624, TNR=0.7383, J=0.4006, MCC=0.3073, ConfusionMatrix=
[[1605  569]
 [ 131  257]]
Epoch 12, Phase test, Loss=0.5819, Acc=0.7021, AUC=0.7492, TPR=0.6720, TNR=0.7073, J=0.3793, MCC=0.2819, ConfusionMatrix=
[[1527  632]
 [ 122  250]]
Epoch 12 complete in 58.41

Epoch 13 starting with learning_rate: [0.003]
Epoch 13, Phase train, Loss=0.5451, Acc=0.7259, AUC=0.7995, TPR=0.7290, TNR=0.7227, J=0.4518, MCC=0.4518, ConfusionMatrix=
[[2638 1012]
 [ 989 2661]]
Epoch 13, Phase val, Loss=0.5316, Acc=0.7475, AUC=0.7517, TPR=0.6082, TNR=0.7723, J=0.3806, MCC=0.3021, ConfusionMatrix=
[[1679  495]
 [ 152  236]]
Epoch 13, Phase test, Loss=0.5487, Acc=0.7191, AUC=0.7462, TPR=0.6210, TNR=0.7360, J=0.3570, MCC=0.2718, ConfusionMatrix=
[[1589  570]
 [ 141  231]]
Epoch 13 complete in 63.76

Epoch 14 starting with learning_rate: [0.003]
Epoch 14, Phase train, Loss=0.5428, Acc=0.7271, AUC=0.8019, TPR=0.7380, TNR=0.7162, J=0.4542, MCC=0.4543, ConfusionMatrix=
[[2612 1035]
 [ 957 2696]]
Epoch 14, Phase val, Loss=0.5552, Acc=0.7322, AUC=0.7507, TPR=0.6598, TNR=0.7452, J=0.4050, MCC=0.3122, ConfusionMatrix=
[[1620  554]
 [ 132  256]]
Epoch 14, Phase test, Loss=0.5725, Acc=0.7025, AUC=0.7421, TPR=0.6398, TNR=0.7133, J=0.3531, MCC=0.2642, ConfusionMatrix=
[[1540  619]
 [ 134  238]]
Epoch 14 complete in 59.03

Epoch 15 starting with learning_rate: [0.003]
Epoch 15, Phase train, Loss=0.5286, Acc=0.7421, AUC=0.8133, TPR=0.7552, TNR=0.7286, J=0.4839, MCC=0.4841, ConfusionMatrix=
[[2634  981]
 [ 902 2783]]
Epoch 15, Phase val, Loss=0.7205, Acc=0.6167, AUC=0.7533, TPR=0.7912, TNR=0.5856, J=0.3768, MCC=0.2706, ConfusionMatrix=
[[1273  901]
 [  81  307]]
Epoch 15, Phase test, Loss=0.7573, Acc=0.5796, AUC=0.7453, TPR=0.7876, TNR=0.5438, J=0.3314, MCC=0.2347, ConfusionMatrix=
[[1174  985]
 [  79  293]]
Epoch 15 complete in 57.29

Epoch 16 starting with learning_rate: [0.003]
Epoch 16, Phase train, Loss=0.5223, Acc=0.7440, AUC=0.8193, TPR=0.7442, TNR=0.7437, J=0.4879, MCC=0.4879, ConfusionMatrix=
[[2722  938]
 [ 931 2709]]
Epoch 16, Phase val, Loss=0.6172, Acc=0.6850, AUC=0.7516, TPR=0.7216, TNR=0.6785, J=0.4001, MCC=0.2952, ConfusionMatrix=
[[1475  699]
 [ 108  280]]
Epoch 16, Phase test, Loss=0.6464, Acc=0.6567, AUC=0.7425, TPR=0.7124, TNR=0.6471, J=0.3594, MCC=0.2592, ConfusionMatrix=
[[1397  762]
 [ 107  265]]
Epoch 16 complete in 57.62

Epoch 17 starting with learning_rate: [0.003]
Epoch 17, Phase train, Loss=0.5310, Acc=0.7355, AUC=0.8123, TPR=0.7264, TNR=0.7443, J=0.4707, MCC=0.4708, ConfusionMatrix=
[[2754  946]
 [ 985 2615]]
Epoch 17, Phase val, Loss=0.5426, Acc=0.7381, AUC=0.7556, TPR=0.6392, TNR=0.7557, J=0.3949, MCC=0.3078, ConfusionMatrix=
[[1643  531]
 [ 140  248]]
Epoch 17, Phase test, Loss=0.5590, Acc=0.7159, AUC=0.7501, TPR=0.6398, TNR=0.7290, J=0.3688, MCC=0.2788, ConfusionMatrix=
[[1574  585]
 [ 134  238]]
Epoch 17 complete in 60.66

Epoch 18 starting with learning_rate: [0.003]
Epoch 18, Phase train, Loss=0.5266, Acc=0.7421, AUC=0.8155, TPR=0.7549, TNR=0.7289, J=0.4838, MCC=0.4840, ConfusionMatrix=
[[2624  976]
 [ 907 2793]]
Epoch 18, Phase val, Loss=0.5415, Acc=0.7365, AUC=0.7568, TPR=0.6443, TNR=0.7530, J=0.3973, MCC=0.3087, ConfusionMatrix=
[[1637  537]
 [ 138  250]]
New Best AUC=0.7568. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 18, Phase test, Loss=0.5584, Acc=0.7112, AUC=0.7490, TPR=0.6398, TNR=0.7235, J=0.3633, MCC=0.2736, ConfusionMatrix=
[[1562  597]
 [ 134  238]]
Epoch 18 complete in 63.77

Epoch 19 starting with learning_rate: [0.003]
Epoch 19, Phase train, Loss=0.5272, Acc=0.7396, AUC=0.8143, TPR=0.7295, TNR=0.7493, J=0.4788, MCC=0.4789, ConfusionMatrix=
[[2786  932]
 [ 969 2613]]
Epoch 19, Phase val, Loss=0.5387, Acc=0.7436, AUC=0.7519, TPR=0.6237, TNR=0.7649, J=0.3887, MCC=0.3058, ConfusionMatrix=
[[1663  511]
 [ 146  242]]
Epoch 19, Phase test, Loss=0.5528, Acc=0.7218, AUC=0.7491, TPR=0.6344, TNR=0.7369, J=0.3713, MCC=0.2824, ConfusionMatrix=
[[1591  568]
 [ 136  236]]
Epoch 19 complete in 56.91

Epoch 20 starting with learning_rate: [0.003]
Epoch 20, Phase train, Loss=0.5315, Acc=0.7385, AUC=0.8108, TPR=0.7472, TNR=0.7296, J=0.4768, MCC=0.4768, ConfusionMatrix=
[[2628  974]
 [ 935 2763]]
Epoch 20, Phase val, Loss=0.5530, Acc=0.7319, AUC=0.7458, TPR=0.6186, TNR=0.7521, J=0.3706, MCC=0.2888, ConfusionMatrix=
[[1635  539]
 [ 148  240]]
Epoch 20, Phase test, Loss=0.5640, Acc=0.7120, AUC=0.7450, TPR=0.6210, TNR=0.7277, J=0.3486, MCC=0.2638, ConfusionMatrix=
[[1571  588]
 [ 141  231]]
Epoch 20 complete in 63.04

Epoch 21 starting with learning_rate: [0.003]
Epoch 21, Phase train, Loss=0.5232, Acc=0.7418, AUC=0.8177, TPR=0.7418, TNR=0.7418, J=0.4836, MCC=0.4835, ConfusionMatrix=
[[2755  959]
 [ 926 2660]]
Epoch 21, Phase val, Loss=0.5358, Acc=0.7443, AUC=0.7494, TPR=0.6186, TNR=0.7668, J=0.3853, MCC=0.3039, ConfusionMatrix=
[[1667  507]
 [ 148  240]]
Epoch 21, Phase test, Loss=0.5468, Acc=0.7167, AUC=0.7483, TPR=0.6075, TNR=0.7355, J=0.3431, MCC=0.2615, ConfusionMatrix=
[[1588  571]
 [ 146  226]]
Epoch 21 complete in 62.20

Epoch 22 starting with learning_rate: [0.003]
Epoch 22, Phase train, Loss=0.5281, Acc=0.7338, AUC=0.8134, TPR=0.7515, TNR=0.7156, J=0.4671, MCC=0.4675, ConfusionMatrix=
[[2569 1021]
 [ 922 2788]]
Epoch 22, Phase val, Loss=0.5405, Acc=0.7358, AUC=0.7499, TPR=0.6134, TNR=0.7576, J=0.3710, MCC=0.2906, ConfusionMatrix=
[[1647  527]
 [ 150  238]]
Epoch 22, Phase test, Loss=0.5551, Acc=0.7143, AUC=0.7470, TPR=0.6237, TNR=0.7300, J=0.3536, MCC=0.2680, ConfusionMatrix=
[[1576  583]
 [ 140  232]]
Epoch 22 complete in 56.32

Epoch 23 starting with learning_rate: [0.003]
Epoch 23, Phase train, Loss=0.5211, Acc=0.7392, AUC=0.8191, TPR=0.7455, TNR=0.7328, J=0.4783, MCC=0.4783, ConfusionMatrix=
[[2660  970]
 [ 934 2736]]
Epoch 23, Phase val, Loss=0.6173, Acc=0.6850, AUC=0.7443, TPR=0.6985, TNR=0.6826, J=0.3811, MCC=0.2822, ConfusionMatrix=
[[1484  690]
 [ 117  271]]
Epoch 23, Phase test, Loss=0.6367, Acc=0.6614, AUC=0.7426, TPR=0.6855, TNR=0.6572, J=0.3427, MCC=0.2485, ConfusionMatrix=
[[1419  740]
 [ 117  255]]
Epoch 23 complete in 59.15

Epoch 24 starting with learning_rate: [0.003]
Epoch 24, Phase train, Loss=0.5266, Acc=0.7373, AUC=0.8156, TPR=0.7284, TNR=0.7459, J=0.4743, MCC=0.4744, ConfusionMatrix=
[[2754  938]
 [ 980 2628]]
Epoch 24, Phase val, Loss=0.4836, Acc=0.7799, AUC=0.7399, TPR=0.4845, TNR=0.8326, J=0.3171, MCC=0.2765, ConfusionMatrix=
[[1810  364]
 [ 200  188]]
Epoch 24, Phase test, Loss=0.4892, Acc=0.7653, AUC=0.7392, TPR=0.5296, TNR=0.8059, J=0.3355, MCC=0.2768, ConfusionMatrix=
[[1740  419]
 [ 175  197]]
Epoch 24 complete in 60.37

Epoch 25 starting with learning_rate: [0.003]
Epoch 25, Phase train, Loss=0.5316, Acc=0.7327, AUC=0.8101, TPR=0.7384, TNR=0.7270, J=0.4654, MCC=0.4654, ConfusionMatrix=
[[2631  988]
 [ 963 2718]]
Epoch 25, Phase val, Loss=0.5089, Acc=0.7642, AUC=0.7473, TPR=0.5644, TNR=0.7999, J=0.3643, MCC=0.2996, ConfusionMatrix=
[[1739  435]
 [ 169  219]]
Epoch 25, Phase test, Loss=0.5230, Acc=0.7373, AUC=0.7465, TPR=0.5887, TNR=0.7629, J=0.3516, MCC=0.2747, ConfusionMatrix=
[[1647  512]
 [ 153  219]]
Epoch 25 complete in 60.73

Epoch 26 starting with learning_rate: [0.003]
Epoch 26, Phase train, Loss=0.5327, Acc=0.7340, AUC=0.8104, TPR=0.7362, TNR=0.7318, J=0.4680, MCC=0.4680, ConfusionMatrix=
[[2687  985]
 [ 957 2671]]
Epoch 26, Phase val, Loss=0.5019, Acc=0.7674, AUC=0.7541, TPR=0.5593, TNR=0.8045, J=0.3638, MCC=0.3009, ConfusionMatrix=
[[1749  425]
 [ 171  217]]
Epoch 26, Phase test, Loss=0.5136, Acc=0.7475, AUC=0.7503, TPR=0.5887, TNR=0.7749, J=0.3636, MCC=0.2872, ConfusionMatrix=
[[1673  486]
 [ 153  219]]
Epoch 26 complete in 60.24

Epoch 27 starting with learning_rate: [0.003]
Epoch 27, Phase train, Loss=0.5244, Acc=0.7373, AUC=0.8164, TPR=0.7412, TNR=0.7333, J=0.4745, MCC=0.4746, ConfusionMatrix=
[[2684  976]
 [ 942 2698]]
Epoch 27, Phase val, Loss=0.5076, Acc=0.7642, AUC=0.7506, TPR=0.5670, TNR=0.7994, J=0.3665, MCC=0.3010, ConfusionMatrix=
[[1738  436]
 [ 168  220]]
Epoch 27, Phase test, Loss=0.5166, Acc=0.7416, AUC=0.7501, TPR=0.5860, TNR=0.7684, J=0.3544, MCC=0.2784, ConfusionMatrix=
[[1659  500]
 [ 154  218]]
Epoch 27 complete in 58.70

Epoch 28 starting with learning_rate: [0.003]
Epoch 28, Phase train, Loss=0.5162, Acc=0.7518, AUC=0.8250, TPR=0.7412, TNR=0.7621, J=0.5032, MCC=0.5034, ConfusionMatrix=
[[2825  882]
 [ 930 2663]]
Epoch 28, Phase val, Loss=0.5165, Acc=0.7533, AUC=0.7490, TPR=0.5593, TNR=0.7879, J=0.3472, MCC=0.2822, ConfusionMatrix=
[[1713  461]
 [ 171  217]]
Epoch 28, Phase test, Loss=0.5251, Acc=0.7373, AUC=0.7505, TPR=0.5860, TNR=0.7633, J=0.3493, MCC=0.2732, ConfusionMatrix=
[[1648  511]
 [ 154  218]]
Epoch 28 complete in 62.74

Early Stop!
Training complete in 30m 37s
The best AUC=0.756801325885
Start training resnet18fixed_conv1x1ab_maxpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6691, Acc=0.6023, AUC=0.6567, TPR=0.7703, TNR=0.4296, J=0.1999, MCC=0.2128, ConfusionMatrix=
[[1546 2053]
 [ 850 2851]]
Epoch 0, Phase val, Loss=0.6924, Acc=0.5812, AUC=0.7151, TPR=0.7577, TNR=0.5497, J=0.3074, MCC=0.2204, ConfusionMatrix=
[[1195  979]
 [  94  294]]
New Best AUC=0.7151. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7064, Acc=0.5520, AUC=0.6956, TPR=0.7419, TNR=0.5192, J=0.2612, MCC=0.1851, ConfusionMatrix=
[[1121 1038]
 [  96  276]]
Epoch 0 complete in 32.85

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.6000, Acc=0.6989, AUC=0.7601, TPR=0.7326, TNR=0.6647, J=0.3973, MCC=0.3983, ConfusionMatrix=
[[2409 1215]
 [ 983 2693]]
Epoch 1, Phase val, Loss=0.7230, Acc=0.6093, AUC=0.7483, TPR=0.8170, TNR=0.5722, J=0.3892, MCC=0.2792, ConfusionMatrix=
[[1244  930]
 [  71  317]]
New Best AUC=0.7483. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.7583, Acc=0.5622, AUC=0.7287, TPR=0.7634, TNR=0.5276, J=0.2910, MCC=0.2062, ConfusionMatrix=
[[1139 1020]
 [  88  284]]
Epoch 1 complete in 42.48

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.5744, Acc=0.7104, AUC=0.7713, TPR=0.6677, TNR=0.7515, J=0.4192, MCC=0.4209, ConfusionMatrix=
[[2795  924]
 [1190 2391]]
Epoch 2, Phase val, Loss=0.5073, Acc=0.7877, AUC=0.7547, TPR=0.4485, TNR=0.8482, J=0.2967, MCC=0.2675, ConfusionMatrix=
[[1844  330]
 [ 214  174]]
New Best AUC=0.7547. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.5239, Acc=0.7957, AUC=0.7295, TPR=0.4785, TNR=0.8504, J=0.3289, MCC=0.2923, ConfusionMatrix=
[[1836  323]
 [ 194  178]]
Epoch 2 complete in 37.84

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.5565, Acc=0.7153, AUC=0.7891, TPR=0.6762, TNR=0.7550, J=0.4312, MCC=0.4324, ConfusionMatrix=
[[2739  889]
 [1189 2483]]
Epoch 3, Phase val, Loss=0.5106, Acc=0.7849, AUC=0.7643, TPR=0.4948, TNR=0.8367, J=0.3316, MCC=0.2900, ConfusionMatrix=
[[1819  355]
 [ 196  192]]
New Best AUC=0.7643. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.5250, Acc=0.7772, AUC=0.7343, TPR=0.5134, TNR=0.8226, J=0.3360, MCC=0.2841, ConfusionMatrix=
[[1776  383]
 [ 181  191]]
Epoch 3 complete in 33.93

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.5547, Acc=0.7225, AUC=0.7918, TPR=0.6821, TNR=0.7621, J=0.4442, MCC=0.4458, ConfusionMatrix=
[[2806  876]
 [1150 2468]]
Epoch 4, Phase val, Loss=0.5163, Acc=0.7806, AUC=0.7612, TPR=0.5412, TNR=0.8234, J=0.3646, MCC=0.3097, ConfusionMatrix=
[[1790  384]
 [ 178  210]]
Epoch 4, Phase test, Loss=0.5283, Acc=0.7744, AUC=0.7361, TPR=0.5349, TNR=0.8157, J=0.3506, MCC=0.2924, ConfusionMatrix=
[[1761  398]
 [ 173  199]]
Epoch 4 complete in 35.74

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.5595, Acc=0.7227, AUC=0.7851, TPR=0.6869, TNR=0.7586, J=0.4455, MCC=0.4466, ConfusionMatrix=
[[2768  881]
 [1143 2508]]
Epoch 5, Phase val, Loss=0.7054, Acc=0.6542, AUC=0.7582, TPR=0.7629, TNR=0.6348, J=0.3977, MCC=0.2883, ConfusionMatrix=
[[1380  794]
 [  92  296]]
Epoch 5, Phase test, Loss=0.7328, Acc=0.6033, AUC=0.7404, TPR=0.7419, TNR=0.5794, J=0.3214, MCC=0.2281, ConfusionMatrix=
[[1251  908]
 [  96  276]]
Epoch 5 complete in 34.00

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.5557, Acc=0.7255, AUC=0.7910, TPR=0.6730, TNR=0.7776, J=0.4506, MCC=0.4531, ConfusionMatrix=
[[2849  815]
 [1189 2447]]
Epoch 6, Phase val, Loss=0.5741, Acc=0.7568, AUC=0.7643, TPR=0.6108, TNR=0.7829, J=0.3937, MCC=0.3155, ConfusionMatrix=
[[1702  472]
 [ 151  237]]
Epoch 6, Phase test, Loss=0.5844, Acc=0.7278, AUC=0.7417, TPR=0.5941, TNR=0.7508, J=0.3449, MCC=0.2665, ConfusionMatrix=
[[1621  538]
 [ 151  221]]
Epoch 6 complete in 35.75

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.5512, Acc=0.7262, AUC=0.7961, TPR=0.7013, TNR=0.7514, J=0.4527, MCC=0.4532, ConfusionMatrix=
[[2723  901]
 [1098 2578]]
Epoch 7, Phase val, Loss=0.5620, Acc=0.7572, AUC=0.7618, TPR=0.5928, TNR=0.7866, J=0.3794, MCC=0.3060, ConfusionMatrix=
[[1710  464]
 [ 158  230]]
Epoch 7, Phase test, Loss=0.5769, Acc=0.7365, AUC=0.7358, TPR=0.5968, TNR=0.7605, J=0.3573, MCC=0.2783, ConfusionMatrix=
[[1642  517]
 [ 150  222]]
Epoch 7 complete in 36.92

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.5618, Acc=0.7166, AUC=0.7828, TPR=0.6724, TNR=0.7600, J=0.4324, MCC=0.4342, ConfusionMatrix=
[[2799  884]
 [1185 2432]]
Epoch 8, Phase val, Loss=0.5367, Acc=0.7756, AUC=0.7705, TPR=0.5851, TNR=0.8096, J=0.3946, MCC=0.3266, ConfusionMatrix=
[[1760  414]
 [ 161  227]]
New Best AUC=0.7705. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 8, Phase test, Loss=0.5554, Acc=0.7550, AUC=0.7383, TPR=0.5699, TNR=0.7869, J=0.3568, MCC=0.2861, ConfusionMatrix=
[[1699  460]
 [ 160  212]]
Epoch 8 complete in 32.78

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.5389, Acc=0.7300, AUC=0.8037, TPR=0.6922, TNR=0.7680, J=0.4602, MCC=0.4615, ConfusionMatrix=
[[2794  844]
 [1127 2535]]
Epoch 9, Phase val, Loss=0.5670, Acc=0.7490, AUC=0.7684, TPR=0.6186, TNR=0.7723, J=0.3909, MCC=0.3098, ConfusionMatrix=
[[1679  495]
 [ 148  240]]
Epoch 9, Phase test, Loss=0.5945, Acc=0.7199, AUC=0.7351, TPR=0.5914, TNR=0.7420, J=0.3334, MCC=0.2559, ConfusionMatrix=
[[1602  557]
 [ 152  220]]
Epoch 9 complete in 35.51

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.5557, Acc=0.7211, AUC=0.7895, TPR=0.6869, TNR=0.7548, J=0.4417, MCC=0.4428, ConfusionMatrix=
[[2774  901]
 [1135 2490]]
Epoch 10, Phase val, Loss=0.6940, Acc=0.6569, AUC=0.7606, TPR=0.7216, TNR=0.6454, J=0.3670, MCC=0.2675, ConfusionMatrix=
[[1403  771]
 [ 108  280]]
Epoch 10, Phase test, Loss=0.7221, Acc=0.6239, AUC=0.7451, TPR=0.7339, TNR=0.6049, J=0.3388, MCC=0.2414, ConfusionMatrix=
[[1306  853]
 [  99  273]]
Epoch 10 complete in 31.80

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.5402, Acc=0.7425, AUC=0.8039, TPR=0.6969, TNR=0.7871, J=0.4840, MCC=0.4862, ConfusionMatrix=
[[2902  785]
 [1095 2518]]
Epoch 11, Phase val, Loss=0.6373, Acc=0.7030, AUC=0.7700, TPR=0.6830, TNR=0.7065, J=0.3895, MCC=0.2923, ConfusionMatrix=
[[1536  638]
 [ 123  265]]
Epoch 11, Phase test, Loss=0.6586, Acc=0.6772, AUC=0.7377, TPR=0.6801, TNR=0.6767, J=0.3568, MCC=0.2609, ConfusionMatrix=
[[1461  698]
 [ 119  253]]
Epoch 11 complete in 37.63

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.5629, Acc=0.7192, AUC=0.7858, TPR=0.6990, TNR=0.7398, J=0.4388, MCC=0.4391, ConfusionMatrix=
[[2670  939]
 [1111 2580]]
Epoch 12, Phase val, Loss=0.6790, Acc=0.6733, AUC=0.7588, TPR=0.7294, TNR=0.6633, J=0.3927, MCC=0.2878, ConfusionMatrix=
[[1442  732]
 [ 105  283]]
Epoch 12, Phase test, Loss=0.7004, Acc=0.6322, AUC=0.7343, TPR=0.6989, TNR=0.6207, J=0.3196, MCC=0.2288, ConfusionMatrix=
[[1340  819]
 [ 112  260]]
Epoch 12 complete in 31.70

Epoch 13 starting with learning_rate: [0.003]
Epoch 13, Phase train, Loss=0.5419, Acc=0.7290, AUC=0.8035, TPR=0.6753, TNR=0.7801, J=0.4554, MCC=0.4584, ConfusionMatrix=
[[2920  823]
 [1155 2402]]
Epoch 13, Phase val, Loss=0.5564, Acc=0.7498, AUC=0.7764, TPR=0.6160, TNR=0.7737, J=0.3897, MCC=0.3093, ConfusionMatrix=
[[1682  492]
 [ 149  239]]
New Best AUC=0.7764. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_maxpool_bestAUC.pth
Epoch 13, Phase test, Loss=0.5733, Acc=0.7305, AUC=0.7364, TPR=0.5833, TNR=0.7559, J=0.3392, MCC=0.2637, ConfusionMatrix=
[[1632  527]
 [ 155  217]]
Epoch 13 complete in 38.70

Epoch 14 starting with learning_rate: [0.003]
Epoch 14, Phase train, Loss=0.5500, Acc=0.7266, AUC=0.7947, TPR=0.7006, TNR=0.7530, J=0.4535, MCC=0.4541, ConfusionMatrix=
[[2728  895]
 [1101 2576]]
Epoch 14, Phase val, Loss=0.5644, Acc=0.7521, AUC=0.7664, TPR=0.6031, TNR=0.7787, J=0.3818, MCC=0.3052, ConfusionMatrix=
[[1693  481]
 [ 154  234]]
Epoch 14, Phase test, Loss=0.5748, Acc=0.7384, AUC=0.7428, TPR=0.6048, TNR=0.7615, J=0.3663, MCC=0.2852, ConfusionMatrix=
[[1644  515]
 [ 147  225]]
Epoch 14 complete in 38.88

Epoch 15 starting with learning_rate: [0.003]
Epoch 15, Phase train, Loss=0.5548, Acc=0.7248, AUC=0.7924, TPR=0.6946, TNR=0.7564, J=0.4509, MCC=0.4514, ConfusionMatrix=
[[2701  870]
 [1139 2590]]
Epoch 15, Phase val, Loss=0.5473, Acc=0.7678, AUC=0.7537, TPR=0.5773, TNR=0.8017, J=0.3791, MCC=0.3115, ConfusionMatrix=
[[1743  431]
 [ 164  224]]
Epoch 15, Phase test, Loss=0.5600, Acc=0.7499, AUC=0.7303, TPR=0.5726, TNR=0.7805, J=0.3530, MCC=0.2811, ConfusionMatrix=
[[1685  474]
 [ 159  213]]
Epoch 15 complete in 33.49

Epoch 16 starting with learning_rate: [0.003]
Epoch 16, Phase train, Loss=0.5524, Acc=0.7225, AUC=0.7931, TPR=0.6913, TNR=0.7541, J=0.4453, MCC=0.4461, ConfusionMatrix=
[[2735  892]
 [1134 2539]]
Epoch 16, Phase val, Loss=0.6982, Acc=0.6542, AUC=0.7621, TPR=0.7448, TNR=0.6380, J=0.3828, MCC=0.2781, ConfusionMatrix=
[[1387  787]
 [  99  289]]
Epoch 16, Phase test, Loss=0.7247, Acc=0.6085, AUC=0.7383, TPR=0.7097, TNR=0.5910, J=0.3007, MCC=0.2139, ConfusionMatrix=
[[1276  883]
 [ 108  264]]
Epoch 16 complete in 39.43

Epoch 17 starting with learning_rate: [0.003]
Epoch 17, Phase train, Loss=0.5407, Acc=0.7358, AUC=0.8042, TPR=0.7061, TNR=0.7653, J=0.4715, MCC=0.4723, ConfusionMatrix=
[[2795  857]
 [1072 2576]]
Epoch 17, Phase val, Loss=0.4995, Acc=0.7881, AUC=0.7619, TPR=0.5284, TNR=0.8344, J=0.3628, MCC=0.3137, ConfusionMatrix=
[[1814  360]
 [ 183  205]]
Epoch 17, Phase test, Loss=0.5171, Acc=0.7740, AUC=0.7300, TPR=0.5296, TNR=0.8161, J=0.3457, MCC=0.2888, ConfusionMatrix=
[[1762  397]
 [ 175  197]]
Epoch 17 complete in 37.67

Epoch 18 starting with learning_rate: [0.003]
Epoch 18, Phase train, Loss=0.5351, Acc=0.7395, AUC=0.8079, TPR=0.7125, TNR=0.7659, J=0.4784, MCC=0.4792, ConfusionMatrix=
[[2823  863]
 [1039 2575]]
Epoch 18, Phase val, Loss=0.5385, Acc=0.7685, AUC=0.7594, TPR=0.5593, TNR=0.8059, J=0.3652, MCC=0.3025, ConfusionMatrix=
[[1752  422]
 [ 171  217]]
Epoch 18, Phase test, Loss=0.5589, Acc=0.7582, AUC=0.7317, TPR=0.5699, TNR=0.7906, J=0.3605, MCC=0.2902, ConfusionMatrix=
[[1707  452]
 [ 160  212]]
Epoch 18 complete in 32.54

Epoch 19 starting with learning_rate: [0.003]
Epoch 19, Phase train, Loss=0.5489, Acc=0.7286, AUC=0.7955, TPR=0.6843, TNR=0.7730, J=0.4573, MCC=0.4591, ConfusionMatrix=
[[2820  828]
 [1153 2499]]
Epoch 19, Phase val, Loss=0.5871, Acc=0.7295, AUC=0.7607, TPR=0.6366, TNR=0.7461, J=0.3827, MCC=0.2961, ConfusionMatrix=
[[1622  552]
 [ 141  247]]
Epoch 19, Phase test, Loss=0.6217, Acc=0.6954, AUC=0.7294, TPR=0.6290, TNR=0.7068, J=0.3358, MCC=0.2506, ConfusionMatrix=
[[1526  633]
 [ 138  234]]
Epoch 19 complete in 36.24

Epoch 20 starting with learning_rate: [0.003]
Epoch 20, Phase train, Loss=0.5403, Acc=0.7378, AUC=0.8071, TPR=0.7128, TNR=0.7624, J=0.4752, MCC=0.4759, ConfusionMatrix=
[[2807  875]
 [1039 2579]]
Epoch 20, Phase val, Loss=0.4808, Acc=0.8044, AUC=0.7619, TPR=0.4948, TNR=0.8597, J=0.3546, MCC=0.3214, ConfusionMatrix=
[[1869  305]
 [ 196  192]]
Epoch 20, Phase test, Loss=0.4957, Acc=0.7949, AUC=0.7317, TPR=0.4758, TNR=0.8499, J=0.3257, MCC=0.2895, ConfusionMatrix=
[[1835  324]
 [ 195  177]]
Epoch 20 complete in 32.80

Epoch 21 starting with learning_rate: [0.003]
Epoch 21, Phase train, Loss=0.5456, Acc=0.7277, AUC=0.7980, TPR=0.6926, TNR=0.7628, J=0.4554, MCC=0.4565, ConfusionMatrix=
[[2782  865]
 [1123 2530]]
Epoch 21, Phase val, Loss=0.5268, Acc=0.7705, AUC=0.7583, TPR=0.5464, TNR=0.8105, J=0.3569, MCC=0.2981, ConfusionMatrix=
[[1762  412]
 [ 176  212]]
Epoch 21, Phase test, Loss=0.5379, Acc=0.7621, AUC=0.7370, TPR=0.5672, TNR=0.7957, J=0.3629, MCC=0.2939, ConfusionMatrix=
[[1718  441]
 [ 161  211]]
Epoch 21 complete in 37.08

Epoch 22 starting with learning_rate: [0.003]
Epoch 22, Phase train, Loss=0.5451, Acc=0.7312, AUC=0.7984, TPR=0.7046, TNR=0.7591, J=0.4637, MCC=0.4640, ConfusionMatrix=
[[2710  860]
 [1102 2628]]
Epoch 22, Phase val, Loss=0.6155, Acc=0.7155, AUC=0.7642, TPR=0.6830, TNR=0.7213, J=0.4042, MCC=0.3059, ConfusionMatrix=
[[1568  606]
 [ 123  265]]
Epoch 22, Phase test, Loss=0.6375, Acc=0.6855, AUC=0.7382, TPR=0.6667, TNR=0.6887, J=0.3554, MCC=0.2616, ConfusionMatrix=
[[1487  672]
 [ 124  248]]
Epoch 22 complete in 32.11

Epoch 23 starting with learning_rate: [0.003]
Epoch 23, Phase train, Loss=0.5352, Acc=0.7395, AUC=0.8094, TPR=0.7219, TNR=0.7573, J=0.4793, MCC=0.4795, ConfusionMatrix=
[[2737  877]
 [1025 2661]]
Epoch 23, Phase val, Loss=0.5697, Acc=0.7455, AUC=0.7672, TPR=0.6237, TNR=0.7672, J=0.3910, MCC=0.3083, ConfusionMatrix=
[[1668  506]
 [ 146  242]]
Epoch 23, Phase test, Loss=0.5870, Acc=0.7317, AUC=0.7427, TPR=0.6344, TNR=0.7485, J=0.3829, MCC=0.2937, ConfusionMatrix=
[[1616  543]
 [ 136  236]]
Epoch 23 complete in 37.65

Early Stop!
Training complete in 14m 16s
The best AUC=0.77639915022
Start training resnet18fixed_conv1x1ab_avgpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6948, Acc=0.4647, AUC=0.4574, TPR=0.2001, TNR=0.7296, J=-0.0702, MCC=-0.0828, ConfusionMatrix=
[[2661  986]
 [2922  731]]
Epoch 0, Phase val, Loss=0.6882, Acc=0.6151, AUC=0.3966, TPR=0.1881, TNR=0.6914, J=-0.1205, MCC=-0.0952, ConfusionMatrix=
[[1503  671]
 [ 315   73]]
New Best AUC=0.3966. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.6891, Acc=0.5832, AUC=0.4203, TPR=0.2527, TNR=0.6401, J=-0.1072, MCC=-0.0799, ConfusionMatrix=
[[1382  777]
 [ 278   94]]
Epoch 0 complete in 35.56

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.6952, Acc=0.4593, AUC=0.4411, TPR=0.1982, TNR=0.7194, J=-0.0824, MCC=-0.0965, ConfusionMatrix=
[[2631 1026]
 [2921  722]]
Epoch 1, Phase val, Loss=0.6879, Acc=0.6230, AUC=0.4004, TPR=0.1856, TNR=0.7010, J=-0.1134, MCC=-0.0904, ConfusionMatrix=
[[1524  650]
 [ 316   72]]
New Best AUC=0.4004. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.6889, Acc=0.5863, AUC=0.4255, TPR=0.2500, TNR=0.6443, J=-0.1057, MCC=-0.0790, ConfusionMatrix=
[[1391  768]
 [ 279   93]]
Epoch 1 complete in 33.32

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.6954, Acc=0.4537, AUC=0.4432, TPR=0.1912, TNR=0.7232, J=-0.0856, MCC=-0.1012, ConfusionMatrix=
[[2605  997]
 [2991  707]]
Epoch 2, Phase val, Loss=0.6867, Acc=0.6440, AUC=0.3982, TPR=0.1572, TNR=0.7309, J=-0.1119, MCC=-0.0924, ConfusionMatrix=
[[1589  585]
 [ 327   61]]
Epoch 2, Phase test, Loss=0.6875, Acc=0.6168, AUC=0.4216, TPR=0.2177, TNR=0.6855, J=-0.0968, MCC=-0.0747, ConfusionMatrix=
[[1480  679]
 [ 291   81]]
Epoch 2 complete in 35.44

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.6951, Acc=0.4623, AUC=0.4523, TPR=0.2075, TNR=0.7217, J=-0.0708, MCC=-0.0826, ConfusionMatrix=
[[2611 1007]
 [2918  764]]
Epoch 3, Phase val, Loss=0.6868, Acc=0.6432, AUC=0.4007, TPR=0.1675, TNR=0.7282, J=-0.1043, MCC=-0.0857, ConfusionMatrix=
[[1583  591]
 [ 323   65]]
New Best AUC=0.4007. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6877, Acc=0.6128, AUC=0.4262, TPR=0.2258, TNR=0.6795, J=-0.0947, MCC=-0.0727, ConfusionMatrix=
[[1467  692]
 [ 288   84]]
Epoch 3 complete in 33.61

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.6946, Acc=0.4671, AUC=0.4515, TPR=0.1985, TNR=0.7238, J=-0.0777, MCC=-0.0912, ConfusionMatrix=
[[2702 1031]
 [2859  708]]
Epoch 4, Phase val, Loss=0.6874, Acc=0.6351, AUC=0.4067, TPR=0.1804, TNR=0.7162, J=-0.1034, MCC=-0.0837, ConfusionMatrix=
[[1557  617]
 [ 318   70]]
New Best AUC=0.4067. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed_conv1x1ab_avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.6883, Acc=0.5998, AUC=0.4285, TPR=0.2392, TNR=0.6619, J=-0.0989, MCC=-0.0748, ConfusionMatrix=
[[1429  730]
 [ 283   89]]
Epoch 4 complete in 39.13

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.6949, Acc=0.4611, AUC=0.4474, TPR=0.1955, TNR=0.7232, J=-0.0813, MCC=-0.0956, ConfusionMatrix=
[[2657 1017]
 [2917  709]]
Epoch 5, Phase val, Loss=0.6884, Acc=0.6097, AUC=0.3993, TPR=0.1907, TNR=0.6845, J=-0.1248, MCC=-0.0980, ConfusionMatrix=
[[1488  686]
 [ 314   74]]
Epoch 5, Phase test, Loss=0.6893, Acc=0.5784, AUC=0.4233, TPR=0.2446, TNR=0.6359, J=-0.1194, MCC=-0.0889, ConfusionMatrix=
[[1373  786]
 [ 281   91]]
Epoch 5 complete in 40.81

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.6950, Acc=0.4607, AUC=0.4474, TPR=0.1933, TNR=0.7262, J=-0.0805, MCC=-0.0951, ConfusionMatrix=
[[2660 1003]
 [2934  703]]
Epoch 6, Phase val, Loss=0.6877, Acc=0.6257, AUC=0.3981, TPR=0.1753, TNR=0.7061, J=-0.1187, MCC=-0.0952, ConfusionMatrix=
[[1535  639]
 [ 320   68]]
Epoch 6, Phase test, Loss=0.6885, Acc=0.5966, AUC=0.4257, TPR=0.2392, TNR=0.6582, J=-0.1026, MCC=-0.0774, ConfusionMatrix=
[[1421  738]
 [ 283   89]]
Epoch 6 complete in 30.80

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.6947, Acc=0.4675, AUC=0.4527, TPR=0.2030, TNR=0.7265, J=-0.0705, MCC=-0.0827, ConfusionMatrix=
[[2680 1009]
 [2878  733]]
Epoch 7, Phase val, Loss=0.6866, Acc=0.6491, AUC=0.4017, TPR=0.1598, TNR=0.7364, J=-0.1038, MCC=-0.0862, ConfusionMatrix=
[[1601  573]
 [ 326   62]]
Epoch 7, Phase test, Loss=0.6874, Acc=0.6168, AUC=0.4281, TPR=0.2204, TNR=0.6850, J=-0.0945, MCC=-0.0730, ConfusionMatrix=
[[1479  680]
 [ 290   82]]
Epoch 7 complete in 36.18

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.6949, Acc=0.4641, AUC=0.4517, TPR=0.2055, TNR=0.7199, J=-0.0746, MCC=-0.0870, ConfusionMatrix=
[[2642 1028]
 [2884  746]]
Epoch 8, Phase val, Loss=0.6870, Acc=0.6390, AUC=0.3986, TPR=0.1624, TNR=0.7240, J=-0.1136, MCC=-0.0930, ConfusionMatrix=
[[1574  600]
 [ 325   63]]
Epoch 8, Phase test, Loss=0.6878, Acc=0.6100, AUC=0.4233, TPR=0.2285, TNR=0.6758, J=-0.0957, MCC=-0.0733, ConfusionMatrix=
[[1459  700]
 [ 287   85]]
Epoch 8 complete in 31.70

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.6950, Acc=0.4608, AUC=0.4418, TPR=0.1917, TNR=0.7172, J=-0.0910, MCC=-0.1068, ConfusionMatrix=
[[2681 1057]
 [2879  683]]
Epoch 9, Phase val, Loss=0.6874, Acc=0.6339, AUC=0.3985, TPR=0.1753, TNR=0.7157, J=-0.1090, MCC=-0.0883, ConfusionMatrix=
[[1556  618]
 [ 320   68]]
Epoch 9, Phase test, Loss=0.6882, Acc=0.5978, AUC=0.4239, TPR=0.2204, TNR=0.6628, J=-0.1168, MCC=-0.0886, ConfusionMatrix=
[[1431  728]
 [ 290   82]]
Epoch 9 complete in 35.74

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.6949, Acc=0.4636, AUC=0.4525, TPR=0.2007, TNR=0.7240, J=-0.0753, MCC=-0.0884, ConfusionMatrix=
[[2655 1012]
 [2904  729]]
Epoch 10, Phase val, Loss=0.6876, Acc=0.6288, AUC=0.3989, TPR=0.1804, TNR=0.7088, J=-0.1108, MCC=-0.0890, ConfusionMatrix=
[[1541  633]
 [ 318   70]]
Epoch 10, Phase test, Loss=0.6885, Acc=0.5934, AUC=0.4245, TPR=0.2392, TNR=0.6545, J=-0.1063, MCC=-0.0800, ConfusionMatrix=
[[1413  746]
 [ 283   89]]
Epoch 10 complete in 31.33

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.6951, Acc=0.4616, AUC=0.4477, TPR=0.1952, TNR=0.7285, J=-0.0763, MCC=-0.0902, ConfusionMatrix=
[[2657  990]
 [2940  713]]
Epoch 11, Phase val, Loss=0.6873, Acc=0.6358, AUC=0.3979, TPR=0.1727, TNR=0.7185, J=-0.1088, MCC=-0.0884, ConfusionMatrix=
[[1562  612]
 [ 321   67]]
Epoch 11, Phase test, Loss=0.6882, Acc=0.5998, AUC=0.4228, TPR=0.2312, TNR=0.6633, J=-0.1055, MCC=-0.0800, ConfusionMatrix=
[[1432  727]
 [ 286   86]]
Epoch 11 complete in 36.79

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.6948, Acc=0.4615, AUC=0.4544, TPR=0.1972, TNR=0.7236, J=-0.0791, MCC=-0.0931, ConfusionMatrix=
[[2652 1013]
 [2918  717]]
Epoch 12, Phase val, Loss=0.6875, Acc=0.6296, AUC=0.3962, TPR=0.1727, TNR=0.7111, J=-0.1162, MCC=-0.0937, ConfusionMatrix=
[[1546  628]
 [ 321   67]]
Epoch 12, Phase test, Loss=0.6884, Acc=0.5946, AUC=0.4216, TPR=0.2366, TNR=0.6563, J=-0.1071, MCC=-0.0808, ConfusionMatrix=
[[1417  742]
 [ 284   88]]
Epoch 12 complete in 34.97

Epoch 13 starting with learning_rate: [0.003]
Epoch 13, Phase train, Loss=0.6949, Acc=0.4642, AUC=0.4519, TPR=0.2007, TNR=0.7259, J=-0.0734, MCC=-0.0862, ConfusionMatrix=
[[2659 1004]
 [2907  730]]
Epoch 13, Phase val, Loss=0.6871, Acc=0.6378, AUC=0.3981, TPR=0.1649, TNR=0.7222, J=-0.1129, MCC=-0.0922, ConfusionMatrix=
[[1570  604]
 [ 324   64]]
Epoch 13, Phase test, Loss=0.6879, Acc=0.6045, AUC=0.4230, TPR=0.2124, TNR=0.6721, J=-0.1156, MCC=-0.0884, ConfusionMatrix=
[[1451  708]
 [ 293   79]]
Epoch 13 complete in 33.63

Epoch 14 starting with learning_rate: [0.003]
Epoch 14, Phase train, Loss=0.6949, Acc=0.4608, AUC=0.4527, TPR=0.2017, TNR=0.7210, J=-0.0772, MCC=-0.0904, ConfusionMatrix=
[[2626 1016]
 [2920  738]]
Epoch 14, Phase val, Loss=0.6875, Acc=0.6304, AUC=0.3960, TPR=0.1675, TNR=0.7130, J=-0.1195, MCC=-0.0966, ConfusionMatrix=
[[1550  624]
 [ 323   65]]
Epoch 14, Phase test, Loss=0.6883, Acc=0.6021, AUC=0.4203, TPR=0.2285, TNR=0.6665, J=-0.1050, MCC=-0.0798, ConfusionMatrix=
[[1439  720]
 [ 287   85]]
Epoch 14 complete in 34.86

Early Stop!
Training complete in 8m 44s
The best AUC=0.406665228236
Start training resnet50_conv1x1_avgpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.5745, Acc=0.6984, AUC=0.7702, TPR=0.7357, TNR=0.6611, J=0.3968, MCC=0.3979, ConfusionMatrix=
[[2417 1239]
 [ 963 2681]]
Epoch 0, Phase val, Loss=0.6649, Acc=0.6944, AUC=0.7917, TPR=0.7758, TNR=0.6799, J=0.4556, MCC=0.3350, ConfusionMatrix=
[[1478  696]
 [  87  301]]
New Best AUC=0.7917. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1_avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.7138, Acc=0.6369, AUC=0.7734, TPR=0.7446, TNR=0.6183, J=0.3630, MCC=0.2592, ConfusionMatrix=
[[1335  824]
 [  95  277]]
Epoch 0 complete in 59.47

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.4512, Acc=0.7915, AUC=0.8711, TPR=0.7768, TNR=0.8065, J=0.5833, MCC=0.5835, ConfusionMatrix=
[[2913  699]
 [ 823 2865]]
Epoch 1, Phase val, Loss=0.4199, Acc=0.8275, AUC=0.8004, TPR=0.5722, TNR=0.8730, J=0.4452, MCC=0.4033, ConfusionMatrix=
[[1898  276]
 [ 166  222]]
New Best AUC=0.8004. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1_avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4461, Acc=0.8167, AUC=0.7738, TPR=0.5806, TNR=0.8573, J=0.4380, MCC=0.3828, ConfusionMatrix=
[[1851  308]
 [ 156  216]]
Epoch 1 complete in 59.13

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.3932, Acc=0.8252, AUC=0.9037, TPR=0.8250, TNR=0.8254, J=0.6504, MCC=0.6504, ConfusionMatrix=
[[3020  639]
 [ 637 3004]]
Epoch 2, Phase val, Loss=0.5108, Acc=0.7892, AUC=0.7870, TPR=0.6443, TNR=0.8151, J=0.4594, MCC=0.3781, ConfusionMatrix=
[[1772  402]
 [ 138  250]]
Epoch 2, Phase test, Loss=0.5430, Acc=0.7602, AUC=0.7795, TPR=0.6613, TNR=0.7772, J=0.4385, MCC=0.3431, ConfusionMatrix=
[[1678  481]
 [ 126  246]]
Epoch 2 complete in 63.00

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.3691, Acc=0.8436, AUC=0.9153, TPR=0.8564, TNR=0.8304, J=0.6869, MCC=0.6872, ConfusionMatrix=
[[3002  613]
 [ 529 3156]]
Epoch 3, Phase val, Loss=0.4875, Acc=0.8060, AUC=0.7807, TPR=0.6134, TNR=0.8404, J=0.4538, MCC=0.3875, ConfusionMatrix=
[[1827  347]
 [ 150  238]]
Epoch 3, Phase test, Loss=0.5131, Acc=0.7811, AUC=0.7583, TPR=0.5726, TNR=0.8170, J=0.3896, MCC=0.3229, ConfusionMatrix=
[[1764  395]
 [ 159  213]]
Epoch 3 complete in 58.64

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.2884, Acc=0.8829, AUC=0.9476, TPR=0.8970, TNR=0.8690, J=0.7660, MCC=0.7661, ConfusionMatrix=
[[3196  482]
 [ 373 3249]]
Epoch 4, Phase val, Loss=0.5055, Acc=0.8158, AUC=0.7739, TPR=0.5206, TNR=0.8684, J=0.3891, MCC=0.3552, ConfusionMatrix=
[[1888  286]
 [ 186  202]]
Epoch 4, Phase test, Loss=0.5726, Acc=0.7855, AUC=0.7434, TPR=0.5269, TNR=0.8300, J=0.3569, MCC=0.3039, ConfusionMatrix=
[[1792  367]
 [ 176  196]]
Epoch 4 complete in 57.89

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.2557, Acc=0.8993, AUC=0.9580, TPR=0.9183, TNR=0.8803, J=0.7986, MCC=0.7992, ConfusionMatrix=
[[3214  437]
 [ 298 3351]]
Epoch 5, Phase val, Loss=0.5976, Acc=0.7525, AUC=0.7662, TPR=0.6314, TNR=0.7741, J=0.4056, MCC=0.3213, ConfusionMatrix=
[[1683  491]
 [ 143  245]]
Epoch 5, Phase test, Loss=0.6450, Acc=0.7361, AUC=0.7526, TPR=0.6640, TNR=0.7485, J=0.4125, MCC=0.3152, ConfusionMatrix=
[[1616  543]
 [ 125  247]]
Epoch 5 complete in 60.19

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.2352, Acc=0.9107, AUC=0.9642, TPR=0.9277, TNR=0.8935, J=0.8212, MCC=0.8218, ConfusionMatrix=
[[3247  387]
 [ 265 3401]]
Epoch 6, Phase val, Loss=0.6124, Acc=0.7756, AUC=0.7605, TPR=0.5773, TNR=0.8109, J=0.3883, MCC=0.3224, ConfusionMatrix=
[[1763  411]
 [ 164  224]]
Epoch 6, Phase test, Loss=0.6254, Acc=0.7748, AUC=0.7589, TPR=0.6398, TNR=0.7981, J=0.4378, MCC=0.3507, ConfusionMatrix=
[[1723  436]
 [ 134  238]]
Epoch 6 complete in 61.07

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.2105, Acc=0.9173, AUC=0.9714, TPR=0.9371, TNR=0.8968, J=0.8339, MCC=0.8350, ConfusionMatrix=
[[3224  371]
 [ 233 3472]]
Epoch 7, Phase val, Loss=0.5815, Acc=0.8294, AUC=0.7788, TPR=0.5490, TNR=0.8795, J=0.4285, MCC=0.3952, ConfusionMatrix=
[[1912  262]
 [ 175  213]]
Epoch 7, Phase test, Loss=0.5743, Acc=0.8289, AUC=0.7566, TPR=0.5618, TNR=0.8749, J=0.4368, MCC=0.3948, ConfusionMatrix=
[[1889  270]
 [ 163  209]]
Epoch 7 complete in 60.20

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.1896, Acc=0.9270, AUC=0.9761, TPR=0.9391, TNR=0.9150, J=0.8540, MCC=0.8542, ConfusionMatrix=
[[3346  311]
 [ 222 3421]]
Epoch 8, Phase val, Loss=0.5763, Acc=0.8060, AUC=0.7645, TPR=0.4845, TNR=0.8634, J=0.3479, MCC=0.3184, ConfusionMatrix=
[[1877  297]
 [ 200  188]]
Epoch 8, Phase test, Loss=0.5746, Acc=0.8115, AUC=0.7744, TPR=0.5887, TNR=0.8499, J=0.4386, MCC=0.3784, ConfusionMatrix=
[[1835  324]
 [ 153  219]]
Epoch 8 complete in 58.80

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.1757, Acc=0.9359, AUC=0.9796, TPR=0.9496, TNR=0.9221, J=0.8716, MCC=0.8721, ConfusionMatrix=
[[3348  283]
 [ 185 3484]]
Epoch 9, Phase val, Loss=0.6337, Acc=0.7740, AUC=0.7775, TPR=0.5825, TNR=0.8082, J=0.3907, MCC=0.3230, ConfusionMatrix=
[[1757  417]
 [ 162  226]]
Epoch 9, Phase test, Loss=0.6367, Acc=0.7859, AUC=0.7721, TPR=0.6102, TNR=0.8161, J=0.4263, MCC=0.3503, ConfusionMatrix=
[[1762  397]
 [ 145  227]]
Epoch 9 complete in 60.65

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.1461, Acc=0.9482, AUC=0.9851, TPR=0.9643, TNR=0.9320, J=0.8963, MCC=0.8969, ConfusionMatrix=
[[3388  247]
 [ 131 3534]]
Epoch 10, Phase val, Loss=0.6425, Acc=0.8142, AUC=0.7537, TPR=0.4871, TNR=0.8726, J=0.3597, MCC=0.3343, ConfusionMatrix=
[[1897  277]
 [ 199  189]]
Epoch 10, Phase test, Loss=0.6412, Acc=0.8036, AUC=0.7509, TPR=0.5134, TNR=0.8536, J=0.3671, MCC=0.3247, ConfusionMatrix=
[[1843  316]
 [ 181  191]]
Epoch 10 complete in 65.03

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.1347, Acc=0.9512, AUC=0.9877, TPR=0.9632, TNR=0.9392, J=0.9025, MCC=0.9027, ConfusionMatrix=
[[3432  222]
 [ 134 3512]]
Epoch 11, Phase val, Loss=0.6304, Acc=0.8130, AUC=0.7644, TPR=0.4304, TNR=0.8813, J=0.3117, MCC=0.3004, ConfusionMatrix=
[[1916  258]
 [ 221  167]]
Epoch 11, Phase test, Loss=0.6293, Acc=0.8222, AUC=0.7521, TPR=0.5430, TNR=0.8703, J=0.4133, MCC=0.3727, ConfusionMatrix=
[[1879  280]
 [ 170  202]]
Epoch 11 complete in 57.89

Early Stop!
Training complete in 12m 2s
The best AUC=0.800357315604
Start training resnet50_conv1x1_maxpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.5740, Acc=0.6988, AUC=0.7691, TPR=0.6787, TNR=0.7187, J=0.3975, MCC=0.3978, ConfusionMatrix=
[[2627 1028]
 [1171 2474]]
Epoch 0, Phase val, Loss=0.5753, Acc=0.7209, AUC=0.7814, TPR=0.7139, TNR=0.7222, J=0.4361, MCC=0.3291, ConfusionMatrix=
[[1570  604]
 [ 111  277]]
New Best AUC=0.7814. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1_maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5826, Acc=0.7056, AUC=0.7788, TPR=0.7231, TNR=0.7026, J=0.4258, MCC=0.3141, ConfusionMatrix=
[[1517  642]
 [ 103  269]]
Epoch 0 complete in 57.96

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.4759, Acc=0.7900, AUC=0.8520, TPR=0.7523, TNR=0.8273, J=0.5796, MCC=0.5813, ConfusionMatrix=
[[3037  634]
 [ 899 2730]]
Epoch 1, Phase val, Loss=0.4783, Acc=0.7923, AUC=0.8078, TPR=0.6881, TNR=0.8109, J=0.4991, MCC=0.4056, ConfusionMatrix=
[[1763  411]
 [ 121  267]]
New Best AUC=0.8078. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1_maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4911, Acc=0.7961, AUC=0.7856, TPR=0.6586, TNR=0.8198, J=0.4784, MCC=0.3910, ConfusionMatrix=
[[1770  389]
 [ 127  245]]
Epoch 1 complete in 57.50

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.4294, Acc=0.8133, AUC=0.8827, TPR=0.7882, TNR=0.8376, J=0.6258, MCC=0.6268, ConfusionMatrix=
[[3105  602]
 [ 761 2832]]
Epoch 2, Phase val, Loss=0.4677, Acc=0.7931, AUC=0.8203, TPR=0.7088, TNR=0.8082, J=0.5170, MCC=0.4174, ConfusionMatrix=
[[1757  417]
 [ 113  275]]
New Best AUC=0.8203. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50_conv1x1_maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.4817, Acc=0.7890, AUC=0.8099, TPR=0.6855, TNR=0.8069, J=0.4923, MCC=0.3948, ConfusionMatrix=
[[1742  417]
 [ 117  255]]
Epoch 2 complete in 61.75

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.4050, Acc=0.8318, AUC=0.8967, TPR=0.8276, TNR=0.8361, J=0.6637, MCC=0.6636, ConfusionMatrix=
[[2995  587]
 [ 641 3077]]
Epoch 3, Phase val, Loss=0.4910, Acc=0.7877, AUC=0.8071, TPR=0.6856, TNR=0.8059, J=0.4915, MCC=0.3975, ConfusionMatrix=
[[1752  422]
 [ 122  266]]
Epoch 3, Phase test, Loss=0.5088, Acc=0.7910, AUC=0.7962, TPR=0.6909, TNR=0.8082, J=0.4991, MCC=0.4004, ConfusionMatrix=
[[1745  414]
 [ 115  257]]
Epoch 3 complete in 58.62

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.3799, Acc=0.8395, AUC=0.9101, TPR=0.8346, TNR=0.8444, J=0.6789, MCC=0.6790, ConfusionMatrix=
[[3071  566]
 [ 606 3057]]
Epoch 4, Phase val, Loss=0.4328, Acc=0.8443, AUC=0.7560, TPR=0.5412, TNR=0.8983, J=0.4396, MCC=0.4213, ConfusionMatrix=
[[1953  221]
 [ 178  210]]
Epoch 4, Phase test, Loss=0.4085, Acc=0.8633, AUC=0.7837, TPR=0.5511, TNR=0.9171, J=0.4682, MCC=0.4621, ConfusionMatrix=
[[1980  179]
 [ 167  205]]
Epoch 4 complete in 60.88

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.3777, Acc=0.8414, AUC=0.9110, TPR=0.8467, TNR=0.8360, J=0.6827, MCC=0.6828, ConfusionMatrix=
[[3048  598]
 [ 560 3094]]
Epoch 5, Phase val, Loss=0.6036, Acc=0.7494, AUC=0.7879, TPR=0.7062, TNR=0.7571, J=0.4633, MCC=0.3582, ConfusionMatrix=
[[1646  528]
 [ 114  274]]
Epoch 5, Phase test, Loss=0.6213, Acc=0.7471, AUC=0.7956, TPR=0.7500, TNR=0.7466, J=0.4966, MCC=0.3750, ConfusionMatrix=
[[1612  547]
 [  93  279]]
Epoch 5 complete in 59.30

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.3357, Acc=0.8636, AUC=0.9296, TPR=0.8730, TNR=0.8543, J=0.7273, MCC=0.7273, ConfusionMatrix=
[[3142  536]
 [ 460 3162]]
Epoch 6, Phase val, Loss=0.4599, Acc=0.8349, AUC=0.8016, TPR=0.6366, TNR=0.8703, J=0.5069, MCC=0.4489, ConfusionMatrix=
[[1892  282]
 [ 141  247]]
Epoch 6, Phase test, Loss=0.4721, Acc=0.8392, AUC=0.7703, TPR=0.6022, TNR=0.8800, J=0.4822, MCC=0.4345, ConfusionMatrix=
[[1900  259]
 [ 148  224]]
Epoch 6 complete in 64.46

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.3108, Acc=0.8764, AUC=0.9404, TPR=0.8798, TNR=0.8730, J=0.7529, MCC=0.7529, ConfusionMatrix=
[[3184  463]
 [ 439 3214]]
Epoch 7, Phase val, Loss=0.5117, Acc=0.7931, AUC=0.7845, TPR=0.6572, TNR=0.8174, J=0.4746, MCC=0.3906, ConfusionMatrix=
[[1777  397]
 [ 133  255]]
Epoch 7, Phase test, Loss=0.5173, Acc=0.7823, AUC=0.7842, TPR=0.6478, TNR=0.8055, J=0.4533, MCC=0.3654, ConfusionMatrix=
[[1739  420]
 [ 131  241]]
Epoch 7 complete in 58.47

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.2780, Acc=0.8881, AUC=0.9512, TPR=0.9052, TNR=0.8703, J=0.7755, MCC=0.7763, ConfusionMatrix=
[[3114  464]
 [ 353 3369]]
Epoch 8, Phase val, Loss=0.5112, Acc=0.8009, AUC=0.7777, TPR=0.6289, TNR=0.8316, J=0.4605, MCC=0.3876, ConfusionMatrix=
[[1808  366]
 [ 144  244]]
Epoch 8, Phase test, Loss=0.5078, Acc=0.8096, AUC=0.8010, TPR=0.6478, TNR=0.8374, J=0.4853, MCC=0.4059, ConfusionMatrix=
[[1808  351]
 [ 131  241]]
Epoch 8 complete in 57.73

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.2633, Acc=0.8971, AUC=0.9557, TPR=0.9150, TNR=0.8784, J=0.7934, MCC=0.7944, ConfusionMatrix=
[[3128  433]
 [ 318 3421]]
Epoch 9, Phase val, Loss=0.5349, Acc=0.7927, AUC=0.7719, TPR=0.6521, TNR=0.8178, J=0.4699, MCC=0.3873, ConfusionMatrix=
[[1778  396]
 [ 135  253]]
Epoch 9, Phase test, Loss=0.5364, Acc=0.7799, AUC=0.7777, TPR=0.6532, TNR=0.8018, J=0.4550, MCC=0.3650, ConfusionMatrix=
[[1731  428]
 [ 129  243]]
Epoch 9 complete in 60.56

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.2377, Acc=0.9075, AUC=0.9638, TPR=0.9212, TNR=0.8938, J=0.8150, MCC=0.8154, ConfusionMatrix=
[[3257  387]
 [ 288 3368]]
Epoch 10, Phase val, Loss=0.5573, Acc=0.8037, AUC=0.7886, TPR=0.6211, TNR=0.8362, J=0.4574, MCC=0.3878, ConfusionMatrix=
[[1818  356]
 [ 147  241]]
Epoch 10, Phase test, Loss=0.5408, Acc=0.8198, AUC=0.7910, TPR=0.6183, TNR=0.8546, J=0.4728, MCC=0.4076, ConfusionMatrix=
[[1845  314]
 [ 142  230]]
Epoch 10 complete in 60.33

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.2203, Acc=0.9171, AUC=0.9688, TPR=0.9290, TNR=0.9058, J=0.8348, MCC=0.8346, ConfusionMatrix=
[[3386  352]
 [ 253 3309]]
Epoch 11, Phase val, Loss=0.5551, Acc=0.8119, AUC=0.7659, TPR=0.5619, TNR=0.8565, J=0.4183, MCC=0.3702, ConfusionMatrix=
[[1862  312]
 [ 170  218]]
Epoch 11, Phase test, Loss=0.5292, Acc=0.8104, AUC=0.7731, TPR=0.6048, TNR=0.8458, J=0.4506, MCC=0.3849, ConfusionMatrix=
[[1826  333]
 [ 147  225]]
Epoch 11 complete in 59.79

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.2217, Acc=0.9174, AUC=0.9671, TPR=0.9394, TNR=0.8945, J=0.8338, MCC=0.8353, ConfusionMatrix=
[[3195  377]
 [ 226 3502]]
Epoch 12, Phase val, Loss=0.5480, Acc=0.8142, AUC=0.7495, TPR=0.5258, TNR=0.8657, J=0.3915, MCC=0.3552, ConfusionMatrix=
[[1882  292]
 [ 184  204]]
Epoch 12, Phase test, Loss=0.5489, Acc=0.8159, AUC=0.7584, TPR=0.5806, TNR=0.8564, J=0.4371, MCC=0.3814, ConfusionMatrix=
[[1849  310]
 [ 156  216]]
Epoch 12 complete in 59.76

Early Stop!
Training complete in 12m 57s
The best AUC=0.820334506207
Start training resnet18_conv1x1_avgpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.5823, Acc=0.6892, AUC=0.7625, TPR=0.7074, TNR=0.6713, J=0.3787, MCC=0.3789, ConfusionMatrix=
[[2475 1212]
 [1057 2556]]
Epoch 0, Phase val, Loss=0.5217, Acc=0.7611, AUC=0.7902, TPR=0.6366, TNR=0.7833, J=0.4199, MCC=0.3352, ConfusionMatrix=
[[1703  471]
 [ 141  247]]
New Best AUC=0.7902. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1_avgpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5455, Acc=0.7408, AUC=0.7723, TPR=0.6425, TNR=0.7578, J=0.4002, MCC=0.3089, ConfusionMatrix=
[[1636  523]
 [ 133  239]]
Epoch 0 complete in 33.91

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.4853, Acc=0.7714, AUC=0.8469, TPR=0.7377, TNR=0.8050, J=0.5426, MCC=0.5439, ConfusionMatrix=
[[2943  713]
 [ 956 2688]]
Epoch 1, Phase val, Loss=0.4567, Acc=0.8165, AUC=0.8121, TPR=0.6418, TNR=0.8477, J=0.4895, MCC=0.4193, ConfusionMatrix=
[[1843  331]
 [ 139  249]]
New Best AUC=0.8121. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1_avgpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.4942, Acc=0.7902, AUC=0.8039, TPR=0.6586, TNR=0.8129, J=0.4715, MCC=0.3823, ConfusionMatrix=
[[1755  404]
 [ 127  245]]
Epoch 1 complete in 35.98

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.4416, Acc=0.7918, AUC=0.8772, TPR=0.7696, TNR=0.8140, J=0.5836, MCC=0.5842, ConfusionMatrix=
[[2968  678]
 [ 842 2812]]
Epoch 2, Phase val, Loss=0.5542, Acc=0.7545, AUC=0.8086, TPR=0.7216, TNR=0.7603, J=0.4820, MCC=0.3727, ConfusionMatrix=
[[1653  521]
 [ 108  280]]
Epoch 2, Phase test, Loss=0.6041, Acc=0.7171, AUC=0.7975, TPR=0.7446, TNR=0.7124, J=0.4570, MCC=0.3382, ConfusionMatrix=
[[1538  621]
 [  95  277]]
Epoch 2 complete in 40.32

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.4175, Acc=0.8121, AUC=0.8913, TPR=0.7953, TNR=0.8283, J=0.6237, MCC=0.6241, ConfusionMatrix=
[[3064  635]
 [ 737 2864]]
Epoch 3, Phase val, Loss=0.5725, Acc=0.7440, AUC=0.8152, TPR=0.7655, TNR=0.7401, J=0.5056, MCC=0.3836, ConfusionMatrix=
[[1609  565]
 [  91  297]]
New Best AUC=0.8152. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1_avgpool_bestAUC.pth
Epoch 3, Phase test, Loss=0.6452, Acc=0.6958, AUC=0.7919, TPR=0.7473, TNR=0.6869, J=0.4342, MCC=0.3172, ConfusionMatrix=
[[1483  676]
 [  94  278]]
Epoch 3 complete in 32.40

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.3866, Acc=0.8274, AUC=0.9078, TPR=0.8190, TNR=0.8358, J=0.6547, MCC=0.6549, ConfusionMatrix=
[[3059  601]
 [ 659 2981]]
Epoch 4, Phase val, Loss=0.4397, Acc=0.8220, AUC=0.8158, TPR=0.5979, TNR=0.8620, J=0.4599, MCC=0.4065, ConfusionMatrix=
[[1874  300]
 [ 156  232]]
New Best AUC=0.8158. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1_avgpool_bestAUC.pth
Epoch 4, Phase test, Loss=0.4693, Acc=0.8254, AUC=0.7953, TPR=0.6398, TNR=0.8573, J=0.4971, MCC=0.4279, ConfusionMatrix=
[[1851  308]
 [ 134  238]]
Epoch 4 complete in 40.40

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.3543, Acc=0.8479, AUC=0.9226, TPR=0.8521, TNR=0.8437, J=0.6958, MCC=0.6959, ConfusionMatrix=
[[3050  565]
 [ 545 3140]]
Epoch 5, Phase val, Loss=0.3970, Acc=0.8458, AUC=0.7966, TPR=0.5180, TNR=0.9043, J=0.4224, MCC=0.4134, ConfusionMatrix=
[[1966  208]
 [ 187  201]]
Epoch 5, Phase test, Loss=0.4081, Acc=0.8574, AUC=0.7833, TPR=0.5457, TNR=0.9111, J=0.4568, MCC=0.4457, ConfusionMatrix=
[[1967  192]
 [ 169  203]]
Epoch 5 complete in 31.61

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.3295, Acc=0.8589, AUC=0.9327, TPR=0.8650, TNR=0.8529, J=0.7179, MCC=0.7179, ConfusionMatrix=
[[3143  542]
 [ 488 3127]]
Epoch 6, Phase val, Loss=0.4471, Acc=0.8372, AUC=0.7928, TPR=0.5515, TNR=0.8882, J=0.4398, MCC=0.4118, ConfusionMatrix=
[[1931  243]
 [ 174  214]]
Epoch 6, Phase test, Loss=0.4701, Acc=0.8269, AUC=0.8014, TPR=0.5914, TNR=0.8675, J=0.4589, MCC=0.4063, ConfusionMatrix=
[[1873  286]
 [ 152  220]]
Epoch 6 complete in 36.22

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.2947, Acc=0.8819, AUC=0.9457, TPR=0.8983, TNR=0.8649, J=0.7632, MCC=0.7639, ConfusionMatrix=
[[3098  484]
 [ 378 3340]]
Epoch 7, Phase val, Loss=0.6285, Acc=0.7748, AUC=0.8099, TPR=0.7191, TNR=0.7847, J=0.5038, MCC=0.3974, ConfusionMatrix=
[[1706  468]
 [ 109  279]]
Epoch 7, Phase test, Loss=0.6953, Acc=0.7448, AUC=0.7871, TPR=0.7124, TNR=0.7503, J=0.4627, MCC=0.3519, ConfusionMatrix=
[[1620  539]
 [ 107  265]]
Epoch 7 complete in 34.96

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.2746, Acc=0.8915, AUC=0.9529, TPR=0.9039, TNR=0.8789, J=0.7828, MCC=0.7832, ConfusionMatrix=
[[3187  439]
 [ 353 3321]]
Epoch 8, Phase val, Loss=0.5520, Acc=0.7955, AUC=0.8009, TPR=0.6881, TNR=0.8146, J=0.5028, MCC=0.4101, ConfusionMatrix=
[[1771  403]
 [ 121  267]]
Epoch 8, Phase test, Loss=0.6088, Acc=0.7748, AUC=0.7734, TPR=0.6505, TNR=0.7962, J=0.4467, MCC=0.3565, ConfusionMatrix=
[[1719  440]
 [ 130  242]]
Epoch 8 complete in 32.07

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.2541, Acc=0.8996, AUC=0.9593, TPR=0.9202, TNR=0.8780, J=0.7982, MCC=0.7995, ConfusionMatrix=
[[3131  435]
 [ 298 3436]]
Epoch 9, Phase val, Loss=0.5205, Acc=0.8064, AUC=0.7947, TPR=0.6108, TNR=0.8413, J=0.4521, MCC=0.3868, ConfusionMatrix=
[[1829  345]
 [ 151  237]]
Epoch 9, Phase test, Loss=0.5842, Acc=0.7922, AUC=0.7755, TPR=0.6452, TNR=0.8175, J=0.4627, MCC=0.3781, ConfusionMatrix=
[[1765  394]
 [ 132  240]]
Epoch 9 complete in 35.78

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.2257, Acc=0.9100, AUC=0.9671, TPR=0.9241, TNR=0.8959, J=0.8200, MCC=0.8203, ConfusionMatrix=
[[3271  380]
 [ 277 3372]]
Epoch 10, Phase val, Loss=0.4891, Acc=0.8435, AUC=0.7841, TPR=0.4588, TNR=0.9121, J=0.3709, MCC=0.3787, ConfusionMatrix=
[[1983  191]
 [ 210  178]]
Epoch 10, Phase test, Loss=0.4901, Acc=0.8483, AUC=0.7757, TPR=0.5188, TNR=0.9050, J=0.4239, MCC=0.4123, ConfusionMatrix=
[[1954  205]
 [ 179  193]]
Epoch 10 complete in 32.65

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.2047, Acc=0.9197, AUC=0.9730, TPR=0.9338, TNR=0.9056, J=0.8393, MCC=0.8397, ConfusionMatrix=
[[3289  343]
 [ 243 3425]]
Epoch 11, Phase val, Loss=0.5415, Acc=0.7974, AUC=0.7932, TPR=0.6005, TNR=0.8326, J=0.4331, MCC=0.3672, ConfusionMatrix=
[[1810  364]
 [ 155  233]]
Epoch 11, Phase test, Loss=0.5736, Acc=0.8084, AUC=0.7731, TPR=0.6290, TNR=0.8393, J=0.4683, MCC=0.3943, ConfusionMatrix=
[[1812  347]
 [ 138  234]]
Epoch 11 complete in 35.57

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.1849, Acc=0.9297, AUC=0.9776, TPR=0.9426, TNR=0.9164, J=0.8590, MCC=0.8596, ConfusionMatrix=
[[3287  300]
 [ 213 3500]]
Epoch 12, Phase val, Loss=0.5501, Acc=0.8044, AUC=0.7858, TPR=0.5412, TNR=0.8514, J=0.3927, MCC=0.3468, ConfusionMatrix=
[[1851  323]
 [ 178  210]]
Epoch 12, Phase test, Loss=0.5840, Acc=0.8084, AUC=0.7742, TPR=0.5914, TNR=0.8458, J=0.4372, MCC=0.3746, ConfusionMatrix=
[[1826  333]
 [ 152  220]]
Epoch 12 complete in 32.67

Epoch 13 starting with learning_rate: [0.003]
Epoch 13, Phase train, Loss=0.1758, Acc=0.9321, AUC=0.9795, TPR=0.9458, TNR=0.9184, J=0.8642, MCC=0.8645, ConfusionMatrix=
[[3366  299]
 [ 197 3438]]
Epoch 13, Phase val, Loss=0.5455, Acc=0.8142, AUC=0.7873, TPR=0.5515, TNR=0.8611, J=0.4126, MCC=0.3688, ConfusionMatrix=
[[1872  302]
 [ 174  214]]
Epoch 13, Phase test, Loss=0.5654, Acc=0.8190, AUC=0.7758, TPR=0.5833, TNR=0.8597, J=0.4430, MCC=0.3882, ConfusionMatrix=
[[1856  303]
 [ 155  217]]
Epoch 13 complete in 36.10

Epoch 14 starting with learning_rate: [0.003]
Epoch 14, Phase train, Loss=0.1705, Acc=0.9358, AUC=0.9809, TPR=0.9479, TNR=0.9235, J=0.8714, MCC=0.8717, ConfusionMatrix=
[[3354  278]
 [ 191 3477]]
Epoch 14, Phase val, Loss=0.5060, Acc=0.8314, AUC=0.7941, TPR=0.4974, TNR=0.8910, J=0.3884, MCC=0.3726, ConfusionMatrix=
[[1937  237]
 [ 195  193]]
Epoch 14, Phase test, Loss=0.5474, Acc=0.8277, AUC=0.7833, TPR=0.5672, TNR=0.8726, J=0.4398, MCC=0.3954, ConfusionMatrix=
[[1884  275]
 [ 161  211]]
Epoch 14 complete in 36.18

Early Stop!
Training complete in 8m 47s
The best AUC=0.815841386963
Start training resnet18_conv1x1_maxpool
Epoch 0 starting with learning_rate: [0.003]
Epoch 0, Phase train, Loss=0.6369, Acc=0.6274, AUC=0.6763, TPR=0.6771, TNR=0.5768, J=0.2538, MCC=0.2552, ConfusionMatrix=
[[2085 1530]
 [1190 2495]]
Epoch 0, Phase val, Loss=0.5256, Acc=0.7424, AUC=0.7528, TPR=0.5387, TNR=0.7787, J=0.3174, MCC=0.2565, ConfusionMatrix=
[[1693  481]
 [ 179  209]]
New Best AUC=0.7528. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1_maxpool_bestAUC.pth
Epoch 0, Phase test, Loss=0.5525, Acc=0.7258, AUC=0.7026, TPR=0.5188, TNR=0.7615, J=0.2803, MCC=0.2211, ConfusionMatrix=
[[1644  515]
 [ 179  193]]
Epoch 0 complete in 32.13

Epoch 1 starting with learning_rate: [0.003]
Epoch 1, Phase train, Loss=0.5296, Acc=0.7388, AUC=0.8146, TPR=0.6874, TNR=0.7885, J=0.4758, MCC=0.4786, ConfusionMatrix=
[[2926  785]
 [1122 2467]]
Epoch 1, Phase val, Loss=0.4818, Acc=0.8232, AUC=0.8169, TPR=0.6289, TNR=0.8579, J=0.4867, MCC=0.4241, ConfusionMatrix=
[[1865  309]
 [ 144  244]]
New Best AUC=0.8169. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1_maxpool_bestAUC.pth
Epoch 1, Phase test, Loss=0.5118, Acc=0.8104, AUC=0.7858, TPR=0.6210, TNR=0.8430, J=0.4640, MCC=0.3933, ConfusionMatrix=
[[1820  339]
 [ 141  231]]
Epoch 1 complete in 38.12

Epoch 2 starting with learning_rate: [0.003]
Epoch 2, Phase train, Loss=0.4660, Acc=0.7823, AUC=0.8604, TPR=0.7339, TNR=0.8301, J=0.5641, MCC=0.5669, ConfusionMatrix=
[[3049  624]
 [ 965 2662]]
Epoch 2, Phase val, Loss=0.5994, Acc=0.7771, AUC=0.8221, TPR=0.7474, TNR=0.7824, J=0.5299, MCC=0.4154, ConfusionMatrix=
[[1701  473]
 [  98  290]]
New Best AUC=0.8221. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18_conv1x1_maxpool_bestAUC.pth
Epoch 2, Phase test, Loss=0.6493, Acc=0.7456, AUC=0.7967, TPR=0.7312, TNR=0.7480, J=0.4792, MCC=0.3630, ConfusionMatrix=
[[1615  544]
 [ 100  272]]
Epoch 2 complete in 32.39

Epoch 3 starting with learning_rate: [0.003]
Epoch 3, Phase train, Loss=0.4516, Acc=0.7971, AUC=0.8705, TPR=0.7748, TNR=0.8196, J=0.5944, MCC=0.5949, ConfusionMatrix=
[[2981  656]
 [ 825 2838]]
Epoch 3, Phase val, Loss=0.4452, Acc=0.8208, AUC=0.7998, TPR=0.5979, TNR=0.8606, J=0.4586, MCC=0.4044, ConfusionMatrix=
[[1871  303]
 [ 156  232]]
Epoch 3, Phase test, Loss=0.4545, Acc=0.8222, AUC=0.7880, TPR=0.6022, TNR=0.8601, J=0.4623, MCC=0.4034, ConfusionMatrix=
[[1857  302]
 [ 148  224]]
Epoch 3 complete in 39.73

Epoch 4 starting with learning_rate: [0.003]
Epoch 4, Phase train, Loss=0.4263, Acc=0.8107, AUC=0.8863, TPR=0.7821, TNR=0.8380, J=0.6202, MCC=0.6215, ConfusionMatrix=
[[3125  604]
 [ 778 2793]]
Epoch 4, Phase val, Loss=0.4460, Acc=0.8279, AUC=0.7952, TPR=0.5670, TNR=0.8744, J=0.4414, MCC=0.4014, ConfusionMatrix=
[[1901  273]
 [ 168  220]]
Epoch 4, Phase test, Loss=0.4653, Acc=0.8277, AUC=0.7735, TPR=0.6290, TNR=0.8620, J=0.4910, MCC=0.4267, ConfusionMatrix=
[[1861  298]
 [ 138  234]]
Epoch 4 complete in 31.27

Epoch 5 starting with learning_rate: [0.003]
Epoch 5, Phase train, Loss=0.3928, Acc=0.8318, AUC=0.9039, TPR=0.8187, TNR=0.8448, J=0.6635, MCC=0.6638, ConfusionMatrix=
[[3087  567]
 [ 661 2985]]
Epoch 5, Phase val, Loss=0.4207, Acc=0.8115, AUC=0.7916, TPR=0.5387, TNR=0.8602, J=0.3988, MCC=0.3573, ConfusionMatrix=
[[1870  304]
 [ 179  209]]
Epoch 5, Phase test, Loss=0.4386, Acc=0.8238, AUC=0.7797, TPR=0.5995, TNR=0.8624, J=0.4619, MCC=0.4048, ConfusionMatrix=
[[1862  297]
 [ 149  223]]
Epoch 5 complete in 37.08

Epoch 6 starting with learning_rate: [0.003]
Epoch 6, Phase train, Loss=0.3770, Acc=0.8418, AUC=0.9119, TPR=0.8410, TNR=0.8425, J=0.6836, MCC=0.6835, ConfusionMatrix=
[[3034  567]
 [ 588 3111]]
Epoch 6, Phase val, Loss=0.4393, Acc=0.8240, AUC=0.8037, TPR=0.5619, TNR=0.8707, J=0.4326, MCC=0.3916, ConfusionMatrix=
[[1893  281]
 [ 170  218]]
Epoch 6, Phase test, Loss=0.4729, Acc=0.8139, AUC=0.7877, TPR=0.5995, TNR=0.8509, J=0.4503, MCC=0.3879, ConfusionMatrix=
[[1837  322]
 [ 149  223]]
Epoch 6 complete in 34.78

Epoch 7 starting with learning_rate: [0.003]
Epoch 7, Phase train, Loss=0.3394, Acc=0.8585, AUC=0.9295, TPR=0.8505, TNR=0.8663, J=0.7168, MCC=0.7170, ConfusionMatrix=
[[3195  493]
 [ 540 3072]]
Epoch 7, Phase val, Loss=0.4228, Acc=0.8263, AUC=0.7876, TPR=0.4948, TNR=0.8855, J=0.3803, MCC=0.3612, ConfusionMatrix=
[[1925  249]
 [ 196  192]]
Epoch 7, Phase test, Loss=0.4032, Acc=0.8404, AUC=0.7802, TPR=0.5511, TNR=0.8902, J=0.4413, MCC=0.4116, ConfusionMatrix=
[[1922  237]
 [ 167  205]]
Epoch 7 complete in 32.51

Epoch 8 starting with learning_rate: [0.003]
Epoch 8, Phase train, Loss=0.3360, Acc=0.8586, AUC=0.9308, TPR=0.8629, TNR=0.8543, J=0.7172, MCC=0.7172, ConfusionMatrix=
[[3090  527]
 [ 505 3178]]
Epoch 8, Phase val, Loss=0.4805, Acc=0.7978, AUC=0.7889, TPR=0.6134, TNR=0.8307, J=0.4441, MCC=0.3747, ConfusionMatrix=
[[1806  368]
 [ 150  238]]
Epoch 8, Phase test, Loss=0.5065, Acc=0.7949, AUC=0.7676, TPR=0.6452, TNR=0.8208, J=0.4659, MCC=0.3822, ConfusionMatrix=
[[1772  387]
 [ 132  240]]
Epoch 8 complete in 34.86

Epoch 9 starting with learning_rate: [0.003]
Epoch 9, Phase train, Loss=0.2937, Acc=0.8859, AUC=0.9468, TPR=0.8864, TNR=0.8853, J=0.7718, MCC=0.7718, ConfusionMatrix=
[[3196  414]
 [ 419 3271]]
Epoch 9, Phase val, Loss=0.4693, Acc=0.8142, AUC=0.8111, TPR=0.6392, TNR=0.8454, J=0.4846, MCC=0.4141, ConfusionMatrix=
[[1838  336]
 [ 140  248]]
Epoch 9, Phase test, Loss=0.5074, Acc=0.8088, AUC=0.7802, TPR=0.6290, TNR=0.8397, J=0.4688, MCC=0.3949, ConfusionMatrix=
[[1813  346]
 [ 138  234]]
Epoch 9 complete in 32.38

Epoch 10 starting with learning_rate: [0.003]
Epoch 10, Phase train, Loss=0.2941, Acc=0.8838, AUC=0.9469, TPR=0.8919, TNR=0.8757, J=0.7676, MCC=0.7677, ConfusionMatrix=
[[3178  451]
 [ 397 3274]]
Epoch 10, Phase val, Loss=0.4473, Acc=0.8306, AUC=0.7935, TPR=0.5309, TNR=0.8841, J=0.4150, MCC=0.3883, ConfusionMatrix=
[[1922  252]
 [ 182  206]]
Epoch 10, Phase test, Loss=0.4638, Acc=0.8281, AUC=0.7706, TPR=0.5753, TNR=0.8717, J=0.4470, MCC=0.4002, ConfusionMatrix=
[[1882  277]
 [ 158  214]]
Epoch 10 complete in 34.56

Epoch 11 starting with learning_rate: [0.003]
Epoch 11, Phase train, Loss=0.2669, Acc=0.8919, AUC=0.9561, TPR=0.8944, TNR=0.8895, J=0.7839, MCC=0.7839, ConfusionMatrix=
[[3268  406]
 [ 383 3243]]
Epoch 11, Phase val, Loss=0.5266, Acc=0.7881, AUC=0.7981, TPR=0.6546, TNR=0.8119, J=0.4665, MCC=0.3818, ConfusionMatrix=
[[1765  409]
 [ 134  254]]
Epoch 11, Phase test, Loss=0.5880, Acc=0.7697, AUC=0.7656, TPR=0.6183, TNR=0.7957, J=0.4140, MCC=0.3321, ConfusionMatrix=
[[1718  441]
 [ 142  230]]
Epoch 11 complete in 32.36

Epoch 12 starting with learning_rate: [0.003]
Epoch 12, Phase train, Loss=0.2562, Acc=0.8970, AUC=0.9594, TPR=0.9074, TNR=0.8864, J=0.7938, MCC=0.7941, ConfusionMatrix=
[[3215  412]
 [ 340 3333]]
Epoch 12, Phase val, Loss=0.5016, Acc=0.8310, AUC=0.7871, TPR=0.5284, TNR=0.8850, J=0.4134, MCC=0.3877, ConfusionMatrix=
[[1924  250]
 [ 183  205]]
Epoch 12, Phase test, Loss=0.5092, Acc=0.8317, AUC=0.7706, TPR=0.5914, TNR=0.8731, J=0.4645, MCC=0.4150, ConfusionMatrix=
[[1885  274]
 [ 152  220]]
Epoch 12 complete in 35.34

Early Stop!
Training complete in 7m 28s
The best AUC=0.822106857994
