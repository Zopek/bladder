Start training resnet50-conv1x1ab-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5966, Acc=0.6710, AUC=0.7435, TPR=0.7134, TNR=0.6276, J=0.3410, MCC=0.3424, ConfusionMatrix=
[[2267 1345]
 [1057 2631]]
Epoch 0, Phase val, Loss=0.6026, Acc=0.7127, AUC=0.7759, TPR=0.6881, TNR=0.7171, J=0.4053, MCC=0.3058, ConfusionMatrix=
[[1559  615]
 [ 121  267]]
New Best AUC=0.7759. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6386, Acc=0.6902, AUC=0.7664, TPR=0.7016, TNR=0.6883, J=0.3899, MCC=0.2861, ConfusionMatrix=
[[1486  673]
 [ 111  261]]
Epoch 0 complete in 113.92

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4866, Acc=0.7803, AUC=0.8469, TPR=0.7409, TNR=0.8189, J=0.5598, MCC=0.5618, ConfusionMatrix=
[[3016  667]
 [ 937 2680]]
Epoch 1, Phase val, Loss=0.5082, Acc=0.7943, AUC=0.8050, TPR=0.7088, TNR=0.8096, J=0.5183, MCC=0.4191, ConfusionMatrix=
[[1760  414]
 [ 113  275]]
New Best AUC=0.8050. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5180, Acc=0.7819, AUC=0.7951, TPR=0.7016, TNR=0.7957, J=0.4974, MCC=0.3934, ConfusionMatrix=
[[1718  441]
 [ 111  261]]
Epoch 1 complete in 106.70

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4357, Acc=0.8037, AUC=0.8797, TPR=0.7762, TNR=0.8316, J=0.6078, MCC=0.6086, ConfusionMatrix=
[[3012  610]
 [ 823 2855]]
Epoch 2, Phase val, Loss=0.4787, Acc=0.7834, AUC=0.7860, TPR=0.6186, TNR=0.8128, J=0.4313, MCC=0.3559, ConfusionMatrix=
[[1767  407]
 [ 148  240]]
Epoch 2, Phase test, Loss=0.4775, Acc=0.7866, AUC=0.7841, TPR=0.6398, TNR=0.8119, J=0.4517, MCC=0.3672, ConfusionMatrix=
[[1753  406]
 [ 134  238]]
Epoch 2 complete in 101.93

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4055, Acc=0.8259, AUC=0.8968, TPR=0.8077, TNR=0.8442, J=0.6519, MCC=0.6523, ConfusionMatrix=
[[3068  566]
 [ 705 2961]]
Epoch 3, Phase val, Loss=0.4884, Acc=0.8115, AUC=0.7879, TPR=0.6546, TNR=0.8395, J=0.4941, MCC=0.4175, ConfusionMatrix=
[[1825  349]
 [ 134  254]]
Epoch 3, Phase test, Loss=0.4876, Acc=0.8036, AUC=0.8082, TPR=0.6720, TNR=0.8263, J=0.4984, MCC=0.4092, ConfusionMatrix=
[[1784  375]
 [ 122  250]]
Epoch 3 complete in 93.04

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3733, Acc=0.8415, AUC=0.9136, TPR=0.8257, TNR=0.8571, J=0.6828, MCC=0.6832, ConfusionMatrix=
[[3150  525]
 [ 632 2993]]
Epoch 4, Phase val, Loss=0.5107, Acc=0.7771, AUC=0.8094, TPR=0.7139, TNR=0.7884, J=0.5023, MCC=0.3978, ConfusionMatrix=
[[1714  460]
 [ 111  277]]
New Best AUC=0.8094. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.5292, Acc=0.7689, AUC=0.7996, TPR=0.7177, TNR=0.7777, J=0.4954, MCC=0.3846, ConfusionMatrix=
[[1679  480]
 [ 105  267]]
Epoch 4 complete in 101.14

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3497, Acc=0.8537, AUC=0.9242, TPR=0.8574, TNR=0.8500, J=0.7074, MCC=0.7074, ConfusionMatrix=
[[3123  551]
 [ 517 3109]]
Epoch 5, Phase val, Loss=0.5159, Acc=0.8111, AUC=0.7950, TPR=0.6314, TNR=0.8431, J=0.4746, MCC=0.4051, ConfusionMatrix=
[[1833  341]
 [ 143  245]]
Epoch 5, Phase test, Loss=0.5330, Acc=0.8044, AUC=0.7922, TPR=0.6371, TNR=0.8333, J=0.4704, MCC=0.3923, ConfusionMatrix=
[[1799  360]
 [ 135  237]]
Epoch 5 complete in 88.69

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3043, Acc=0.8812, AUC=0.9426, TPR=0.8840, TNR=0.8786, J=0.7626, MCC=0.7625, ConfusionMatrix=
[[3271  452]
 [ 415 3162]]
Epoch 6, Phase val, Loss=0.4735, Acc=0.8158, AUC=0.7983, TPR=0.6134, TNR=0.8519, J=0.4653, MCC=0.4036, ConfusionMatrix=
[[1852  322]
 [ 150  238]]
Epoch 6, Phase test, Loss=0.4955, Acc=0.8100, AUC=0.7848, TPR=0.6505, TNR=0.8374, J=0.4880, MCC=0.4079, ConfusionMatrix=
[[1808  351]
 [ 130  242]]
Epoch 6 complete in 109.12

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2979, Acc=0.8812, AUC=0.9446, TPR=0.8928, TNR=0.8698, J=0.7625, MCC=0.7627, ConfusionMatrix=
[[3186  477]
 [ 390 3247]]
Epoch 7, Phase val, Loss=0.4903, Acc=0.8205, AUC=0.7742, TPR=0.5515, TNR=0.8684, J=0.4200, MCC=0.3799, ConfusionMatrix=
[[1888  286]
 [ 174  214]]
Epoch 7, Phase test, Loss=0.4768, Acc=0.8388, AUC=0.7922, TPR=0.5995, TNR=0.8800, J=0.4795, MCC=0.4324, ConfusionMatrix=
[[1900  259]
 [ 149  223]]
Epoch 7 complete in 113.58

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2748, Acc=0.8882, AUC=0.9534, TPR=0.9036, TNR=0.8722, J=0.7758, MCC=0.7765, ConfusionMatrix=
[[3118  457]
 [ 359 3366]]
Epoch 8, Phase val, Loss=0.4450, Acc=0.8443, AUC=0.7913, TPR=0.5335, TNR=0.8997, J=0.4332, MCC=0.4175, ConfusionMatrix=
[[1956  218]
 [ 181  207]]
Epoch 8, Phase test, Loss=0.4526, Acc=0.8491, AUC=0.7857, TPR=0.5484, TNR=0.9009, J=0.4493, MCC=0.4284, ConfusionMatrix=
[[1945  214]
 [ 168  204]]
Epoch 8 complete in 104.88

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2452, Acc=0.9034, AUC=0.9624, TPR=0.9145, TNR=0.8924, J=0.8069, MCC=0.8070, ConfusionMatrix=
[[3258  393]
 [ 312 3337]]
Epoch 9, Phase val, Loss=0.5177, Acc=0.7896, AUC=0.7706, TPR=0.5954, TNR=0.8243, J=0.4196, MCC=0.3526, ConfusionMatrix=
[[1792  382]
 [ 157  231]]
Epoch 9, Phase test, Loss=0.5396, Acc=0.7866, AUC=0.7568, TPR=0.5941, TNR=0.8198, J=0.4139, MCC=0.3427, ConfusionMatrix=
[[1770  389]
 [ 151  221]]
Epoch 9 complete in 89.87

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2293, Acc=0.9105, AUC=0.9668, TPR=0.9263, TNR=0.8948, J=0.8211, MCC=0.8215, ConfusionMatrix=
[[3267  384]
 [ 269 3380]]
Epoch 10, Phase val, Loss=0.4668, Acc=0.8396, AUC=0.7983, TPR=0.5515, TNR=0.8910, J=0.4425, MCC=0.4165, ConfusionMatrix=
[[1937  237]
 [ 174  214]]
Epoch 10, Phase test, Loss=0.4733, Acc=0.8439, AUC=0.7796, TPR=0.5215, TNR=0.8995, J=0.4210, MCC=0.4042, ConfusionMatrix=
[[1942  217]
 [ 178  194]]
Epoch 10 complete in 99.80

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2062, Acc=0.9193, AUC=0.9734, TPR=0.9278, TNR=0.9111, J=0.8389, MCC=0.8388, ConfusionMatrix=
[[3370  329]
 [ 260 3341]]
Epoch 11, Phase val, Loss=0.5217, Acc=0.8357, AUC=0.7940, TPR=0.5799, TNR=0.8813, J=0.4612, MCC=0.4227, ConfusionMatrix=
[[1916  258]
 [ 163  225]]
Epoch 11, Phase test, Loss=0.4857, Acc=0.8435, AUC=0.7901, TPR=0.5887, TNR=0.8874, J=0.4762, MCC=0.4365, ConfusionMatrix=
[[1916  243]
 [ 153  219]]
Epoch 11 complete in 89.39

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.1969, Acc=0.9263, AUC=0.9745, TPR=0.9456, TNR=0.9067, J=0.8523, MCC=0.8532, ConfusionMatrix=
[[3285  338]
 [ 200 3477]]
Epoch 12, Phase val, Loss=0.5483, Acc=0.8384, AUC=0.7977, TPR=0.5747, TNR=0.8855, J=0.4602, MCC=0.4256, ConfusionMatrix=
[[1925  249]
 [ 165  223]]
Epoch 12, Phase test, Loss=0.5148, Acc=0.8514, AUC=0.7919, TPR=0.5887, TNR=0.8967, J=0.4854, MCC=0.4527, ConfusionMatrix=
[[1936  223]
 [ 153  219]]
Epoch 12 complete in 96.13

Early Stop!
Training complete in 21m 48s
The best model val AUC=0.809413499749, test AUC=0.79959982469.
Finish training resnet50-conv1x1ab-maxpool_0

Start training resnet50-conv1x1ab-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6150, Acc=0.6590, AUC=0.7307, TPR=0.7642, TNR=0.5562, J=0.3204, MCC=0.3273, ConfusionMatrix=
[[2053 1638]
 [ 851 2758]]
Epoch 0, Phase val, Loss=0.6160, Acc=0.6874, AUC=0.7811, TPR=0.7345, TNR=0.6789, J=0.4135, MCC=0.3048, ConfusionMatrix=
[[1476  698]
 [ 103  285]]
New Best AUC=0.7811. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6310, Acc=0.6614, AUC=0.7826, TPR=0.7661, TNR=0.6434, J=0.4095, MCC=0.2941, ConfusionMatrix=
[[1389  770]
 [  87  285]]
Epoch 0 complete in 104.84

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4700, Acc=0.7796, AUC=0.8582, TPR=0.7536, TNR=0.8058, J=0.5593, MCC=0.5600, ConfusionMatrix=
[[2933  707]
 [ 902 2758]]
Epoch 1, Phase val, Loss=0.5428, Acc=0.7892, AUC=0.7646, TPR=0.6134, TNR=0.8206, J=0.4340, MCC=0.3617, ConfusionMatrix=
[[1784  390]
 [ 150  238]]
Epoch 1, Phase test, Loss=0.5428, Acc=0.7823, AUC=0.7764, TPR=0.6478, TNR=0.8055, J=0.4533, MCC=0.3654, ConfusionMatrix=
[[1739  420]
 [ 131  241]]
Epoch 1 complete in 89.91

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4223, Acc=0.8062, AUC=0.8880, TPR=0.7864, TNR=0.8258, J=0.6122, MCC=0.6127, ConfusionMatrix=
[[3025  638]
 [ 777 2860]]
Epoch 2, Phase val, Loss=0.4960, Acc=0.7970, AUC=0.8195, TPR=0.7268, TNR=0.8096, J=0.5364, MCC=0.4323, ConfusionMatrix=
[[1760  414]
 [ 106  282]]
New Best AUC=0.8195. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.5353, Acc=0.7562, AUC=0.7895, TPR=0.6855, TNR=0.7684, J=0.4539, MCC=0.3513, ConfusionMatrix=
[[1659  500]
 [ 117  255]]
Epoch 2 complete in 99.17

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3559, Acc=0.8466, AUC=0.9217, TPR=0.8570, TNR=0.8361, J=0.6931, MCC=0.6933, ConfusionMatrix=
[[3045  597]
 [ 523 3135]]
Epoch 3, Phase val, Loss=0.6140, Acc=0.7467, AUC=0.7889, TPR=0.6881, TNR=0.7571, J=0.4453, MCC=0.3450, ConfusionMatrix=
[[1646  528]
 [ 121  267]]
Epoch 3, Phase test, Loss=0.6328, Acc=0.7349, AUC=0.7653, TPR=0.6667, TNR=0.7466, J=0.4133, MCC=0.3153, ConfusionMatrix=
[[1612  547]
 [ 124  248]]
Epoch 3 complete in 89.85

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3178, Acc=0.8697, AUC=0.9369, TPR=0.8814, TNR=0.8580, J=0.7394, MCC=0.7396, ConfusionMatrix=
[[3124  517]
 [ 434 3225]]
Epoch 4, Phase val, Loss=0.4948, Acc=0.8240, AUC=0.8170, TPR=0.6289, TNR=0.8588, J=0.4877, MCC=0.4255, ConfusionMatrix=
[[1867  307]
 [ 144  244]]
Epoch 4, Phase test, Loss=0.5250, Acc=0.8214, AUC=0.7877, TPR=0.6022, TNR=0.8592, J=0.4613, MCC=0.4020, ConfusionMatrix=
[[1855  304]
 [ 148  224]]
Epoch 4 complete in 89.86

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2690, Acc=0.8893, AUC=0.9544, TPR=0.9083, TNR=0.8700, J=0.7783, MCC=0.7791, ConfusionMatrix=
[[3152  471]
 [ 337 3340]]
Epoch 5, Phase val, Loss=0.5077, Acc=0.8267, AUC=0.8162, TPR=0.5954, TNR=0.8680, J=0.4633, MCC=0.4136, ConfusionMatrix=
[[1887  287]
 [ 157  231]]
Epoch 5, Phase test, Loss=0.5682, Acc=0.8242, AUC=0.7694, TPR=0.5914, TNR=0.8643, J=0.4557, MCC=0.4014, ConfusionMatrix=
[[1866  293]
 [ 152  220]]
Epoch 5 complete in 89.63

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2294, Acc=0.9075, AUC=0.9673, TPR=0.9234, TNR=0.8911, J=0.8146, MCC=0.8153, ConfusionMatrix=
[[3201  391]
 [ 284 3424]]
Epoch 6, Phase val, Loss=0.4669, Acc=0.8411, AUC=0.8028, TPR=0.5129, TNR=0.8997, J=0.4126, MCC=0.4007, ConfusionMatrix=
[[1956  218]
 [ 189  199]]
Epoch 6, Phase test, Loss=0.4852, Acc=0.8364, AUC=0.7753, TPR=0.5376, TNR=0.8879, J=0.4255, MCC=0.3969, ConfusionMatrix=
[[1917  242]
 [ 172  200]]
Epoch 6 complete in 90.00

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2113, Acc=0.9186, AUC=0.9709, TPR=0.9357, TNR=0.9008, J=0.8365, MCC=0.8375, ConfusionMatrix=
[[3213  354]
 [ 240 3493]]
Epoch 7, Phase val, Loss=0.5060, Acc=0.8497, AUC=0.7913, TPR=0.5103, TNR=0.9103, J=0.4206, MCC=0.4184, ConfusionMatrix=
[[1979  195]
 [ 190  198]]
Epoch 7, Phase test, Loss=0.5158, Acc=0.8546, AUC=0.7728, TPR=0.4919, TNR=0.9171, J=0.4090, MCC=0.4137, ConfusionMatrix=
[[1980  179]
 [ 189  183]]
Epoch 7 complete in 91.41

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1909, Acc=0.9274, AUC=0.9760, TPR=0.9427, TNR=0.9113, J=0.8539, MCC=0.8549, ConfusionMatrix=
[[3235  315]
 [ 215 3535]]
Epoch 8, Phase val, Loss=0.5557, Acc=0.8158, AUC=0.7899, TPR=0.5361, TNR=0.8657, J=0.4018, MCC=0.3634, ConfusionMatrix=
[[1882  292]
 [ 180  208]]
Epoch 8, Phase test, Loss=0.6212, Acc=0.8001, AUC=0.7609, TPR=0.5699, TNR=0.8397, J=0.4096, MCC=0.3499, ConfusionMatrix=
[[1813  346]
 [ 160  212]]
Epoch 8 complete in 95.10

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1591, Acc=0.9396, AUC=0.9831, TPR=0.9530, TNR=0.9259, J=0.8789, MCC=0.8794, ConfusionMatrix=
[[3349  268]
 [ 173 3510]]
Epoch 9, Phase val, Loss=0.5880, Acc=0.7974, AUC=0.7975, TPR=0.6082, TNR=0.8312, J=0.4394, MCC=0.3713, ConfusionMatrix=
[[1807  367]
 [ 152  236]]
Epoch 9, Phase test, Loss=0.6747, Acc=0.7882, AUC=0.7608, TPR=0.5968, TNR=0.8212, J=0.4180, MCC=0.3464, ConfusionMatrix=
[[1773  386]
 [ 150  222]]
Epoch 9 complete in 89.82

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.1639, Acc=0.9341, AUC=0.9822, TPR=0.9457, TNR=0.9224, J=0.8681, MCC=0.8684, ConfusionMatrix=
[[3350  282]
 [ 199 3469]]
Epoch 10, Phase val, Loss=0.5559, Acc=0.8259, AUC=0.7886, TPR=0.5180, TNR=0.8809, J=0.3989, MCC=0.3726, ConfusionMatrix=
[[1915  259]
 [ 187  201]]
Epoch 10, Phase test, Loss=0.6041, Acc=0.8119, AUC=0.7639, TPR=0.5565, TNR=0.8560, J=0.4124, MCC=0.3619, ConfusionMatrix=
[[1848  311]
 [ 165  207]]
Epoch 10 complete in 95.79

Early Stop!
Training complete in 17m 5s
The best model val AUC=0.819509384573, test AUC=0.789482137788.
Finish training resnet50-conv1x1ab-avgpool_0

Start training resnet50-conv1x1-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5923, Acc=0.6767, AUC=0.7468, TPR=0.6797, TNR=0.6738, J=0.3535, MCC=0.3535, ConfusionMatrix=
[[2481 1201]
 [1159 2459]]
Epoch 0, Phase val, Loss=0.5697, Acc=0.7194, AUC=0.7910, TPR=0.7629, TNR=0.7116, J=0.4745, MCC=0.3543, ConfusionMatrix=
[[1547  627]
 [  92  296]]
New Best AUC=0.7910. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.5718, Acc=0.7049, AUC=0.7850, TPR=0.7204, TNR=0.7022, J=0.4226, MCC=0.3118, ConfusionMatrix=
[[1516  643]
 [ 104  268]]
Epoch 0 complete in 101.01

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4717, Acc=0.7858, AUC=0.8581, TPR=0.7722, TNR=0.7996, J=0.5718, MCC=0.5719, ConfusionMatrix=
[[2892  725]
 [ 839 2844]]
Epoch 1, Phase val, Loss=0.5897, Acc=0.7404, AUC=0.8076, TPR=0.7603, TNR=0.7369, J=0.4972, MCC=0.3767, ConfusionMatrix=
[[1602  572]
 [  93  295]]
New Best AUC=0.8076. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.6003, Acc=0.7254, AUC=0.8041, TPR=0.7446, TNR=0.7221, J=0.4667, MCC=0.3473, ConfusionMatrix=
[[1559  600]
 [  95  277]]
Epoch 1 complete in 90.25

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4475, Acc=0.8000, AUC=0.8732, TPR=0.7862, TNR=0.8136, J=0.5999, MCC=0.6002, ConfusionMatrix=
[[2982  683]
 [ 777 2858]]
Epoch 2, Phase val, Loss=0.4095, Acc=0.8357, AUC=0.7977, TPR=0.5567, TNR=0.8855, J=0.4422, MCC=0.4112, ConfusionMatrix=
[[1925  249]
 [ 172  216]]
Epoch 2, Phase test, Loss=0.4096, Acc=0.8514, AUC=0.8020, TPR=0.5968, TNR=0.8953, J=0.4921, MCC=0.4565, ConfusionMatrix=
[[1933  226]
 [ 150  222]]
Epoch 2 complete in 99.31

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4033, Acc=0.8268, AUC=0.8979, TPR=0.8150, TNR=0.8390, J=0.6540, MCC=0.6540, ConfusionMatrix=
[[3022  580]
 [ 684 3014]]
Epoch 3, Phase val, Loss=0.4059, Acc=0.8404, AUC=0.7897, TPR=0.5284, TNR=0.8960, J=0.4244, MCC=0.4067, ConfusionMatrix=
[[1948  226]
 [ 183  205]]
Epoch 3, Phase test, Loss=0.4096, Acc=0.8483, AUC=0.7830, TPR=0.5699, TNR=0.8962, J=0.4661, MCC=0.4371, ConfusionMatrix=
[[1935  224]
 [ 160  212]]
Epoch 3 complete in 126.12

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3792, Acc=0.8423, AUC=0.9104, TPR=0.8414, TNR=0.8432, J=0.6846, MCC=0.6846, ConfusionMatrix=
[[3093  575]
 [ 576 3056]]
Epoch 4, Phase val, Loss=0.4763, Acc=0.8228, AUC=0.8037, TPR=0.6160, TNR=0.8597, J=0.4757, MCC=0.4170, ConfusionMatrix=
[[1869  305]
 [ 149  239]]
Epoch 4, Phase test, Loss=0.4966, Acc=0.8266, AUC=0.7725, TPR=0.6452, TNR=0.8578, J=0.5030, MCC=0.4327, ConfusionMatrix=
[[1852  307]
 [ 132  240]]
Epoch 4 complete in 101.06

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3686, Acc=0.8437, AUC=0.9159, TPR=0.8496, TNR=0.8379, J=0.6875, MCC=0.6875, ConfusionMatrix=
[[3075  595]
 [ 546 3084]]
Epoch 5, Phase val, Loss=0.4771, Acc=0.7869, AUC=0.7895, TPR=0.6237, TNR=0.8160, J=0.4397, MCC=0.3637, ConfusionMatrix=
[[1774  400]
 [ 146  242]]
Epoch 5, Phase test, Loss=0.4927, Acc=0.7870, AUC=0.7914, TPR=0.6667, TNR=0.8078, J=0.4744, MCC=0.3821, ConfusionMatrix=
[[1744  415]
 [ 124  248]]
Epoch 5 complete in 115.05

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3237, Acc=0.8716, AUC=0.9346, TPR=0.8826, TNR=0.8608, J=0.7434, MCC=0.7435, ConfusionMatrix=
[[3153  510]
 [ 427 3210]]
Epoch 6, Phase val, Loss=0.4731, Acc=0.8009, AUC=0.7698, TPR=0.5155, TNR=0.8519, J=0.3673, MCC=0.3269, ConfusionMatrix=
[[1852  322]
 [ 188  200]]
Epoch 6, Phase test, Loss=0.4878, Acc=0.8226, AUC=0.7512, TPR=0.6210, TNR=0.8573, J=0.4783, MCC=0.4137, ConfusionMatrix=
[[1851  308]
 [ 141  231]]
Epoch 6 complete in 117.48

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3053, Acc=0.8751, AUC=0.9422, TPR=0.8838, TNR=0.8666, J=0.7505, MCC=0.7503, ConfusionMatrix=
[[3223  496]
 [ 416 3165]]
Epoch 7, Phase val, Loss=0.4490, Acc=0.8232, AUC=0.7614, TPR=0.5180, TNR=0.8776, J=0.3957, MCC=0.3674, ConfusionMatrix=
[[1908  266]
 [ 187  201]]
Epoch 7, Phase test, Loss=0.4541, Acc=0.8329, AUC=0.7687, TPR=0.5726, TNR=0.8777, J=0.4503, MCC=0.4077, ConfusionMatrix=
[[1895  264]
 [ 159  213]]
Epoch 7 complete in 99.56

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2858, Acc=0.8814, AUC=0.9498, TPR=0.8988, TNR=0.8642, J=0.7631, MCC=0.7633, ConfusionMatrix=
[[3183  500]
 [ 366 3251]]
Epoch 8, Phase val, Loss=0.5701, Acc=0.7963, AUC=0.7829, TPR=0.6005, TNR=0.8312, J=0.4317, MCC=0.3654, ConfusionMatrix=
[[1807  367]
 [ 155  233]]
Epoch 8, Phase test, Loss=0.5422, Acc=0.8171, AUC=0.7866, TPR=0.6290, TNR=0.8495, J=0.4785, MCC=0.4084, ConfusionMatrix=
[[1834  325]
 [ 138  234]]
Epoch 8 complete in 108.52

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2660, Acc=0.8948, AUC=0.9549, TPR=0.9185, TNR=0.8706, J=0.7892, MCC=0.7903, ConfusionMatrix=
[[3149  468]
 [ 300 3383]]
Epoch 9, Phase val, Loss=0.4388, Acc=0.8411, AUC=0.7788, TPR=0.4716, TNR=0.9071, J=0.3787, MCC=0.3799, ConfusionMatrix=
[[1972  202]
 [ 205  183]]
Epoch 9, Phase test, Loss=0.4409, Acc=0.8562, AUC=0.7720, TPR=0.5269, TNR=0.9129, J=0.4398, MCC=0.4341, ConfusionMatrix=
[[1971  188]
 [ 176  196]]
Epoch 9 complete in 107.82

Early Stop!
Training complete in 17m 46s
The best model val AUC=0.807594912698, test AUC=0.804087166998.
Finish training resnet50-conv1x1-maxpool_0

Start training resnet50-conv1x1-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5557, Acc=0.7129, AUC=0.7898, TPR=0.7261, TNR=0.6994, J=0.4255, MCC=0.4257, ConfusionMatrix=
[[2527 1086]
 [1010 2677]]
Epoch 0, Phase val, Loss=0.7023, Acc=0.6456, AUC=0.7873, TPR=0.7758, TNR=0.6224, J=0.3981, MCC=0.2877, ConfusionMatrix=
[[1353  821]
 [  87  301]]
New Best AUC=0.7873. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.7289, Acc=0.6021, AUC=0.7748, TPR=0.7715, TNR=0.5730, J=0.3445, MCC=0.2442, ConfusionMatrix=
[[1237  922]
 [  85  287]]
Epoch 0 complete in 109.19

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4380, Acc=0.7999, AUC=0.8795, TPR=0.7885, TNR=0.8114, J=0.5999, MCC=0.6000, ConfusionMatrix=
[[2934  682]
 [ 779 2905]]
Epoch 1, Phase val, Loss=0.4341, Acc=0.8165, AUC=0.8015, TPR=0.6237, TNR=0.8510, J=0.4747, MCC=0.4102, ConfusionMatrix=
[[1850  324]
 [ 146  242]]
New Best AUC=0.8015. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50-conv1x1-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.4522, Acc=0.8036, AUC=0.7762, TPR=0.5968, TNR=0.8393, J=0.4361, MCC=0.3699, ConfusionMatrix=
[[1812  347]
 [ 150  222]]
Epoch 1 complete in 99.32

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.3817, Acc=0.8329, AUC=0.9096, TPR=0.8299, TNR=0.8357, J=0.6656, MCC=0.6656, ConfusionMatrix=
[[3114  612]
 [ 608 2966]]
Epoch 2, Phase val, Loss=0.4701, Acc=0.8224, AUC=0.7906, TPR=0.5799, TNR=0.8657, J=0.4456, MCC=0.3980, ConfusionMatrix=
[[1882  292]
 [ 163  225]]
Epoch 2, Phase test, Loss=0.4855, Acc=0.8198, AUC=0.7632, TPR=0.5914, TNR=0.8592, J=0.4506, MCC=0.3938, ConfusionMatrix=
[[1855  304]
 [ 152  220]]
Epoch 2 complete in 108.57

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3363, Acc=0.8589, AUC=0.9295, TPR=0.8789, TNR=0.8389, J=0.7178, MCC=0.7184, ConfusionMatrix=
[[3063  588]
 [ 442 3207]]
Epoch 3, Phase val, Loss=0.6319, Acc=0.7549, AUC=0.7456, TPR=0.6469, TNR=0.7741, J=0.4211, MCC=0.3328, ConfusionMatrix=
[[1683  491]
 [ 137  251]]
Epoch 3, Phase test, Loss=0.6351, Acc=0.7361, AUC=0.7528, TPR=0.6586, TNR=0.7494, J=0.4080, MCC=0.3122, ConfusionMatrix=
[[1618  541]
 [ 127  245]]
Epoch 3 complete in 114.48

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.2920, Acc=0.8804, AUC=0.9465, TPR=0.9009, TNR=0.8595, J=0.7603, MCC=0.7613, ConfusionMatrix=
[[3101  507]
 [ 366 3326]]
Epoch 4, Phase val, Loss=0.4913, Acc=0.8279, AUC=0.7815, TPR=0.4923, TNR=0.8878, J=0.3800, MCC=0.3629, ConfusionMatrix=
[[1930  244]
 [ 197  191]]
Epoch 4, Phase test, Loss=0.5061, Acc=0.8364, AUC=0.7569, TPR=0.4839, TNR=0.8972, J=0.3810, MCC=0.3691, ConfusionMatrix=
[[1937  222]
 [ 192  180]]
Epoch 4 complete in 117.01

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.2583, Acc=0.8952, AUC=0.9579, TPR=0.9121, TNR=0.8779, J=0.7900, MCC=0.7907, ConfusionMatrix=
[[3164  440]
 [ 325 3371]]
Epoch 5, Phase val, Loss=0.5398, Acc=0.8013, AUC=0.7558, TPR=0.5361, TNR=0.8487, J=0.3847, MCC=0.3389, ConfusionMatrix=
[[1845  329]
 [ 180  208]]
Epoch 5, Phase test, Loss=0.5730, Acc=0.7930, AUC=0.7454, TPR=0.5753, TNR=0.8305, J=0.4057, MCC=0.3418, ConfusionMatrix=
[[1793  366]
 [ 158  214]]
Epoch 5 complete in 116.19

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2111, Acc=0.9182, AUC=0.9709, TPR=0.9326, TNR=0.9038, J=0.8363, MCC=0.8368, ConfusionMatrix=
[[3288  350]
 [ 247 3415]]
Epoch 6, Phase val, Loss=0.5458, Acc=0.8283, AUC=0.7848, TPR=0.4124, TNR=0.9025, J=0.3149, MCC=0.3204, ConfusionMatrix=
[[1962  212]
 [ 228  160]]
Epoch 6, Phase test, Loss=0.5585, Acc=0.8491, AUC=0.7520, TPR=0.4624, TNR=0.9157, J=0.3781, MCC=0.3860, ConfusionMatrix=
[[1977  182]
 [ 200  172]]
Epoch 6 complete in 114.77

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2086, Acc=0.9237, AUC=0.9716, TPR=0.9393, TNR=0.9083, J=0.8476, MCC=0.8479, ConfusionMatrix=
[[3340  337]
 [ 220 3403]]
Epoch 7, Phase val, Loss=0.5807, Acc=0.8146, AUC=0.7614, TPR=0.4897, TNR=0.8726, J=0.3623, MCC=0.3364, ConfusionMatrix=
[[1897  277]
 [ 198  190]]
Epoch 7, Phase test, Loss=0.6169, Acc=0.8017, AUC=0.7528, TPR=0.5376, TNR=0.8472, J=0.3848, MCC=0.3349, ConfusionMatrix=
[[1829  330]
 [ 172  200]]
Epoch 7 complete in 110.33

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.1901, Acc=0.9288, AUC=0.9767, TPR=0.9435, TNR=0.9138, J=0.8573, MCC=0.8578, ConfusionMatrix=
[[3309  312]
 [ 208 3471]]
Epoch 8, Phase val, Loss=0.6040, Acc=0.8365, AUC=0.7497, TPR=0.3170, TNR=0.9292, J=0.2462, MCC=0.2842, ConfusionMatrix=
[[2020  154]
 [ 265  123]]
Epoch 8, Phase test, Loss=0.5658, Acc=0.8542, AUC=0.7495, TPR=0.3871, TNR=0.9347, J=0.3218, MCC=0.3604, ConfusionMatrix=
[[2018  141]
 [ 228  144]]
Epoch 8 complete in 103.94

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.1508, Acc=0.9419, AUC=0.9847, TPR=0.9515, TNR=0.9330, J=0.8845, MCC=0.8840, ConfusionMatrix=
[[3524  253]
 [ 171 3352]]
Epoch 9, Phase val, Loss=0.6465, Acc=0.8333, AUC=0.7683, TPR=0.4253, TNR=0.9062, J=0.3314, MCC=0.3384, ConfusionMatrix=
[[1970  204]
 [ 223  165]]
Epoch 9, Phase test, Loss=0.6423, Acc=0.8364, AUC=0.7492, TPR=0.4866, TNR=0.8967, J=0.3833, MCC=0.3705, ConfusionMatrix=
[[1936  223]
 [ 191  181]]
Epoch 9 complete in 103.83

Early Stop!
Training complete in 18m 18s
The best model val AUC=0.801544020713, test AUC=0.776203140642.
Finish training resnet50-conv1x1-avgpool_0

Start training resnet50fixed-conv1x1ab-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6381, Acc=0.6441, AUC=0.7078, TPR=0.7911, TNR=0.4977, J=0.2888, MCC=0.3020, ConfusionMatrix=
[[1820 1837]
 [ 761 2882]]
Epoch 0, Phase val, Loss=0.5492, Acc=0.7650, AUC=0.7592, TPR=0.5644, TNR=0.8008, J=0.3653, MCC=0.3006, ConfusionMatrix=
[[1741  433]
 [ 169  219]]
New Best AUC=0.7592. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.5782, Acc=0.7392, AUC=0.7430, TPR=0.5941, TNR=0.7642, J=0.3583, MCC=0.2801, ConfusionMatrix=
[[1650  509]
 [ 151  221]]
Epoch 0 complete in 90.06

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5358, Acc=0.7327, AUC=0.8070, TPR=0.7019, TNR=0.7637, J=0.4656, MCC=0.4665, ConfusionMatrix=
[[2782  861]
 [1090 2567]]
Epoch 1, Phase val, Loss=0.5522, Acc=0.7514, AUC=0.7745, TPR=0.6340, TNR=0.7723, J=0.4063, MCC=0.3213, ConfusionMatrix=
[[1679  495]
 [ 142  246]]
New Best AUC=0.7745. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5892, Acc=0.7321, AUC=0.7656, TPR=0.6586, TNR=0.7448, J=0.4034, MCC=0.3076, ConfusionMatrix=
[[1608  551]
 [ 127  245]]
Epoch 1 complete in 102.78

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5398, Acc=0.7319, AUC=0.8041, TPR=0.6974, TNR=0.7671, J=0.4644, MCC=0.4654, ConfusionMatrix=
[[2776  843]
 [1114 2567]]
Epoch 2, Phase val, Loss=0.5531, Acc=0.7596, AUC=0.7740, TPR=0.6211, TNR=0.7843, J=0.4054, MCC=0.3247, ConfusionMatrix=
[[1705  469]
 [ 147  241]]
Epoch 2, Phase test, Loss=0.5900, Acc=0.7428, AUC=0.7649, TPR=0.6478, TNR=0.7591, J=0.4070, MCC=0.3143, ConfusionMatrix=
[[1639  520]
 [ 131  241]]
Epoch 2 complete in 155.44

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5384, Acc=0.7344, AUC=0.8070, TPR=0.7067, TNR=0.7616, J=0.4683, MCC=0.4691, ConfusionMatrix=
[[2802  877]
 [1062 2559]]
Epoch 3, Phase val, Loss=0.5277, Acc=0.7748, AUC=0.7796, TPR=0.6263, TNR=0.8013, J=0.4276, MCC=0.3480, ConfusionMatrix=
[[1742  432]
 [ 145  243]]
New Best AUC=0.7796. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.5623, Acc=0.7582, AUC=0.7692, TPR=0.6317, TNR=0.7800, J=0.4117, MCC=0.3245, ConfusionMatrix=
[[1684  475]
 [ 137  235]]
Epoch 3 complete in 128.06

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5249, Acc=0.7466, AUC=0.8175, TPR=0.7193, TNR=0.7739, J=0.4932, MCC=0.4939, ConfusionMatrix=
[[2824  825]
 [1025 2626]]
Epoch 4, Phase val, Loss=0.5167, Acc=0.7912, AUC=0.7822, TPR=0.6108, TNR=0.8234, J=0.4342, MCC=0.3632, ConfusionMatrix=
[[1790  384]
 [ 151  237]]
New Best AUC=0.7822. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.5462, Acc=0.7760, AUC=0.7689, TPR=0.6263, TNR=0.8018, J=0.4281, MCC=0.3451, ConfusionMatrix=
[[1731  428]
 [ 139  233]]
Epoch 4 complete in 125.41

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5156, Acc=0.7511, AUC=0.8243, TPR=0.7210, TNR=0.7814, J=0.5024, MCC=0.5033, ConfusionMatrix=
[[2842  795]
 [1022 2641]]
Epoch 5, Phase val, Loss=0.5758, Acc=0.7494, AUC=0.7723, TPR=0.6546, TNR=0.7663, J=0.4210, MCC=0.3301, ConfusionMatrix=
[[1666  508]
 [ 134  254]]
Epoch 5, Phase test, Loss=0.6120, Acc=0.7258, AUC=0.7761, TPR=0.6828, TNR=0.7332, J=0.4160, MCC=0.3138, ConfusionMatrix=
[[1583  576]
 [ 118  254]]
Epoch 5 complete in 125.94

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5218, Acc=0.7445, AUC=0.8186, TPR=0.7057, TNR=0.7825, J=0.4882, MCC=0.4898, ConfusionMatrix=
[[2889  803]
 [1062 2546]]
Epoch 6, Phase val, Loss=0.4590, Acc=0.8162, AUC=0.7701, TPR=0.4742, TNR=0.8772, J=0.3514, MCC=0.3308, ConfusionMatrix=
[[1907  267]
 [ 204  184]]
Epoch 6, Phase test, Loss=0.4772, Acc=0.8190, AUC=0.7688, TPR=0.5349, TNR=0.8680, J=0.4029, MCC=0.3628, ConfusionMatrix=
[[1874  285]
 [ 173  199]]
Epoch 6 complete in 113.38

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5248, Acc=0.7444, AUC=0.8178, TPR=0.7202, TNR=0.7693, J=0.4895, MCC=0.4899, ConfusionMatrix=
[[2767  830]
 [1036 2667]]
Epoch 7, Phase val, Loss=0.5204, Acc=0.7830, AUC=0.7743, TPR=0.5954, TNR=0.8165, J=0.4118, MCC=0.3428, ConfusionMatrix=
[[1775  399]
 [ 157  231]]
Epoch 7, Phase test, Loss=0.5433, Acc=0.7772, AUC=0.7692, TPR=0.6237, TNR=0.8036, J=0.4273, MCC=0.3453, ConfusionMatrix=
[[1735  424]
 [ 140  232]]
Epoch 7 complete in 127.23

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5113, Acc=0.7518, AUC=0.8260, TPR=0.7255, TNR=0.7789, J=0.5044, MCC=0.5048, ConfusionMatrix=
[[2800  795]
 [1017 2688]]
Epoch 8, Phase val, Loss=0.4964, Acc=0.7947, AUC=0.7697, TPR=0.5567, TNR=0.8372, J=0.3939, MCC=0.3395, ConfusionMatrix=
[[1820  354]
 [ 172  216]]
Epoch 8, Phase test, Loss=0.5178, Acc=0.7918, AUC=0.7722, TPR=0.5887, TNR=0.8268, J=0.4155, MCC=0.3473, ConfusionMatrix=
[[1785  374]
 [ 153  219]]
Epoch 8 complete in 148.93

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5237, Acc=0.7486, AUC=0.8182, TPR=0.7093, TNR=0.7879, J=0.4972, MCC=0.4987, ConfusionMatrix=
[[2879  775]
 [1060 2586]]
Epoch 9, Phase val, Loss=0.5482, Acc=0.7666, AUC=0.7811, TPR=0.6418, TNR=0.7889, J=0.4306, MCC=0.3452, ConfusionMatrix=
[[1715  459]
 [ 139  249]]
Epoch 9, Phase test, Loss=0.5844, Acc=0.7270, AUC=0.7803, TPR=0.6613, TNR=0.7383, J=0.3996, MCC=0.3032, ConfusionMatrix=
[[1594  565]
 [ 126  246]]
Epoch 9 complete in 128.04

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5055, Acc=0.7562, AUC=0.8328, TPR=0.7299, TNR=0.7822, J=0.5121, MCC=0.5128, ConfusionMatrix=
[[2869  799]
 [ 981 2651]]
Epoch 10, Phase val, Loss=0.5167, Acc=0.7908, AUC=0.7870, TPR=0.6134, TNR=0.8224, J=0.4358, MCC=0.3640, ConfusionMatrix=
[[1788  386]
 [ 150  238]]
New Best AUC=0.7870. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 10, Phase test, Loss=0.5449, Acc=0.7776, AUC=0.7738, TPR=0.6290, TNR=0.8031, J=0.4322, MCC=0.3487, ConfusionMatrix=
[[1734  425]
 [ 138  234]]
Epoch 10 complete in 127.14

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5123, Acc=0.7525, AUC=0.8273, TPR=0.7167, TNR=0.7877, J=0.5044, MCC=0.5058, ConfusionMatrix=
[[2897  781]
 [1026 2596]]
Epoch 11, Phase val, Loss=0.5377, Acc=0.7736, AUC=0.7892, TPR=0.6418, TNR=0.7971, J=0.4389, MCC=0.3547, ConfusionMatrix=
[[1733  441]
 [ 139  249]]
New Best AUC=0.7892. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 11, Phase test, Loss=0.5668, Acc=0.7535, AUC=0.7784, TPR=0.6720, TNR=0.7675, J=0.4395, MCC=0.3406, ConfusionMatrix=
[[1657  502]
 [ 122  250]]
Epoch 11 complete in 129.70

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5113, Acc=0.7515, AUC=0.8281, TPR=0.7188, TNR=0.7837, J=0.5025, MCC=0.5037, ConfusionMatrix=
[[2884  796]
 [1018 2602]]
Epoch 12, Phase val, Loss=0.5948, Acc=0.7490, AUC=0.7787, TPR=0.6804, TNR=0.7613, J=0.4417, MCC=0.3437, ConfusionMatrix=
[[1655  519]
 [ 124  264]]
Epoch 12, Phase test, Loss=0.6286, Acc=0.7136, AUC=0.7770, TPR=0.7177, TNR=0.7128, J=0.4306, MCC=0.3195, ConfusionMatrix=
[[1539  620]
 [ 105  267]]
Epoch 12 complete in 129.53

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5037, Acc=0.7608, AUC=0.8346, TPR=0.7242, TNR=0.7959, J=0.5201, MCC=0.5218, ConfusionMatrix=
[[2967  761]
 [ 985 2587]]
Epoch 13, Phase val, Loss=0.4965, Acc=0.7955, AUC=0.7806, TPR=0.5747, TNR=0.8349, J=0.4096, MCC=0.3504, ConfusionMatrix=
[[1815  359]
 [ 165  223]]
Epoch 13, Phase test, Loss=0.5209, Acc=0.7886, AUC=0.7714, TPR=0.6022, TNR=0.8208, J=0.4229, MCC=0.3499, ConfusionMatrix=
[[1772  387]
 [ 148  224]]
Epoch 13 complete in 156.34

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5021, Acc=0.7578, AUC=0.8352, TPR=0.7412, TNR=0.7748, J=0.5161, MCC=0.5162, ConfusionMatrix=
[[2791  811]
 [ 957 2741]]
Epoch 14, Phase val, Loss=0.4915, Acc=0.8056, AUC=0.7768, TPR=0.5619, TNR=0.8491, J=0.4110, MCC=0.3598, ConfusionMatrix=
[[1846  328]
 [ 170  218]]
Epoch 14, Phase test, Loss=0.5110, Acc=0.7965, AUC=0.7704, TPR=0.5753, TNR=0.8346, J=0.4099, MCC=0.3473, ConfusionMatrix=
[[1802  357]
 [ 158  214]]
Epoch 14 complete in 124.57

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5140, Acc=0.7560, AUC=0.8253, TPR=0.7136, TNR=0.7973, J=0.5109, MCC=0.5130, ConfusionMatrix=
[[2950  750]
 [1031 2569]]
Epoch 15, Phase val, Loss=0.4866, Acc=0.8029, AUC=0.7781, TPR=0.5361, TNR=0.8505, J=0.3866, MCC=0.3414, ConfusionMatrix=
[[1849  325]
 [ 180  208]]
Epoch 15, Phase test, Loss=0.5121, Acc=0.7985, AUC=0.7649, TPR=0.5753, TNR=0.8370, J=0.4122, MCC=0.3503, ConfusionMatrix=
[[1807  352]
 [ 158  214]]
Epoch 15 complete in 126.53

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4926, Acc=0.7730, AUC=0.8436, TPR=0.7500, TNR=0.7957, J=0.5457, MCC=0.5464, ConfusionMatrix=
[[2925  751]
 [ 906 2718]]
Epoch 16, Phase val, Loss=0.5145, Acc=0.7869, AUC=0.7770, TPR=0.6289, TNR=0.8151, J=0.4440, MCC=0.3665, ConfusionMatrix=
[[1772  402]
 [ 144  244]]
Epoch 16, Phase test, Loss=0.5415, Acc=0.7752, AUC=0.7736, TPR=0.6290, TNR=0.8004, J=0.4294, MCC=0.3455, ConfusionMatrix=
[[1728  431]
 [ 138  234]]
Epoch 16 complete in 125.05

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4930, Acc=0.7723, AUC=0.8444, TPR=0.7321, TNR=0.8125, J=0.5446, MCC=0.5464, ConfusionMatrix=
[[2968  685]
 [ 977 2670]]
Epoch 17, Phase val, Loss=0.5516, Acc=0.7631, AUC=0.7780, TPR=0.6469, TNR=0.7838, J=0.4307, MCC=0.3434, ConfusionMatrix=
[[1704  470]
 [ 137  251]]
Epoch 17, Phase test, Loss=0.5685, Acc=0.7590, AUC=0.7755, TPR=0.6425, TNR=0.7791, J=0.4215, MCC=0.3314, ConfusionMatrix=
[[1682  477]
 [ 133  239]]
Epoch 17 complete in 127.67

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5098, Acc=0.7508, AUC=0.8268, TPR=0.7261, TNR=0.7768, J=0.5029, MCC=0.5031, ConfusionMatrix=
[[2764  794]
 [1025 2717]]
Epoch 18, Phase val, Loss=0.5830, Acc=0.7584, AUC=0.7864, TPR=0.6856, TNR=0.7714, J=0.4570, MCC=0.3582, ConfusionMatrix=
[[1677  497]
 [ 122  266]]
Epoch 18, Phase test, Loss=0.6096, Acc=0.7325, AUC=0.7760, TPR=0.6909, TNR=0.7397, J=0.4306, MCC=0.3259, ConfusionMatrix=
[[1597  562]
 [ 115  257]]
Epoch 18 complete in 130.43

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.5016, Acc=0.7604, AUC=0.8351, TPR=0.7257, TNR=0.7948, J=0.5205, MCC=0.5218, ConfusionMatrix=
[[2916  753]
 [ 996 2635]]
Epoch 19, Phase val, Loss=0.4924, Acc=0.8013, AUC=0.7776, TPR=0.5644, TNR=0.8436, J=0.4080, MCC=0.3542, ConfusionMatrix=
[[1834  340]
 [ 169  219]]
Epoch 19, Phase test, Loss=0.5111, Acc=0.8032, AUC=0.7738, TPR=0.5995, TNR=0.8384, J=0.4378, MCC=0.3707, ConfusionMatrix=
[[1810  349]
 [ 149  223]]
Epoch 19 complete in 149.48

Early Stop!
Training complete in 42m 52s
The best model val AUC=0.789180236914, test AUC=0.778358409658.
Finish training resnet50fixed-conv1x1ab-maxpool_0

Start training resnet50fixed-conv1x1ab-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6545, Acc=0.6232, AUC=0.6750, TPR=0.7339, TNR=0.5109, J=0.2448, MCC=0.2512, ConfusionMatrix=
[[1852 1773]
 [ 978 2697]]
Epoch 0, Phase val, Loss=0.5889, Acc=0.6632, AUC=0.7083, TPR=0.6392, TNR=0.6674, J=0.3066, MCC=0.2266, ConfusionMatrix=
[[1451  723]
 [ 140  248]]
New Best AUC=0.7083. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.5943, Acc=0.6428, AUC=0.6946, TPR=0.6532, TNR=0.6410, J=0.2943, MCC=0.2125, ConfusionMatrix=
[[1384  775]
 [ 129  243]]
Epoch 0 complete in 127.37

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5927, Acc=0.6919, AUC=0.7547, TPR=0.7257, TNR=0.6586, J=0.3843, MCC=0.3851, ConfusionMatrix=
[[2419 1254]
 [ 995 2632]]
Epoch 1, Phase val, Loss=0.7020, Acc=0.5761, AUC=0.7400, TPR=0.8196, TNR=0.5327, J=0.3522, MCC=0.2528, ConfusionMatrix=
[[1158 1016]
 [  70  318]]
New Best AUC=0.7400. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.7324, Acc=0.5571, AUC=0.7289, TPR=0.8172, TNR=0.5123, J=0.3295, MCC=0.2339, ConfusionMatrix=
[[1106 1053]
 [  68  304]]
Epoch 1 complete in 125.84

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5717, Acc=0.7099, AUC=0.7736, TPR=0.7165, TNR=0.7033, J=0.4198, MCC=0.4198, ConfusionMatrix=
[[2589 1092]
 [1026 2593]]
Epoch 2, Phase val, Loss=0.5225, Acc=0.7521, AUC=0.7455, TPR=0.5722, TNR=0.7843, J=0.3564, MCC=0.2879, ConfusionMatrix=
[[1705  469]
 [ 166  222]]
New Best AUC=0.7455. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.5440, Acc=0.7230, AUC=0.7342, TPR=0.6022, TNR=0.7439, J=0.3460, MCC=0.2656, ConfusionMatrix=
[[1606  553]
 [ 148  224]]
Epoch 2 complete in 130.13

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5524, Acc=0.7179, AUC=0.7932, TPR=0.7271, TNR=0.7089, J=0.4360, MCC=0.4361, ConfusionMatrix=
[[2606 1070]
 [ 989 2635]]
Epoch 3, Phase val, Loss=0.5124, Acc=0.7529, AUC=0.7511, TPR=0.5747, TNR=0.7847, J=0.3595, MCC=0.2904, ConfusionMatrix=
[[1706  468]
 [ 165  223]]
New Best AUC=0.7511. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.5300, Acc=0.7258, AUC=0.7442, TPR=0.5995, TNR=0.7476, J=0.3470, MCC=0.2673, ConfusionMatrix=
[[1614  545]
 [ 149  223]]
Epoch 3 complete in 141.39

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5435, Acc=0.7329, AUC=0.8016, TPR=0.7346, TNR=0.7311, J=0.4658, MCC=0.4658, ConfusionMatrix=
[[2673  983]
 [ 967 2677]]
Epoch 4, Phase val, Loss=0.6434, Acc=0.6530, AUC=0.7553, TPR=0.7655, TNR=0.6329, J=0.3984, MCC=0.2887, ConfusionMatrix=
[[1376  798]
 [  91  297]]
New Best AUC=0.7553. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.6739, Acc=0.6270, AUC=0.7477, TPR=0.7661, TNR=0.6031, J=0.3692, MCC=0.2627, ConfusionMatrix=
[[1302  857]
 [  87  285]]
Epoch 4 complete in 144.45

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5431, Acc=0.7267, AUC=0.8001, TPR=0.7277, TNR=0.7258, J=0.4535, MCC=0.4534, ConfusionMatrix=
[[2689 1016]
 [ 979 2616]]
Epoch 5, Phase val, Loss=0.4707, Acc=0.7881, AUC=0.7502, TPR=0.4948, TNR=0.8404, J=0.3352, MCC=0.2948, ConfusionMatrix=
[[1827  347]
 [ 196  192]]
Epoch 5, Phase test, Loss=0.4822, Acc=0.7724, AUC=0.7447, TPR=0.5403, TNR=0.8124, J=0.3527, MCC=0.2927, ConfusionMatrix=
[[1754  405]
 [ 171  201]]
Epoch 5 complete in 124.30

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5406, Acc=0.7281, AUC=0.8037, TPR=0.7392, TNR=0.7165, J=0.4558, MCC=0.4559, ConfusionMatrix=
[[2568 1016]
 [ 969 2747]]
Epoch 6, Phase val, Loss=0.4965, Acc=0.7697, AUC=0.7516, TPR=0.5515, TNR=0.8086, J=0.3602, MCC=0.2999, ConfusionMatrix=
[[1758  416]
 [ 174  214]]
Epoch 6, Phase test, Loss=0.5088, Acc=0.7432, AUC=0.7467, TPR=0.5833, TNR=0.7707, J=0.3541, MCC=0.2788, ConfusionMatrix=
[[1664  495]
 [ 155  217]]
Epoch 6 complete in 123.88

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5361, Acc=0.7310, AUC=0.8079, TPR=0.7305, TNR=0.7315, J=0.4619, MCC=0.4619, ConfusionMatrix=
[[2653  974]
 [ 990 2683]]
Epoch 7, Phase val, Loss=0.7490, Acc=0.5843, AUC=0.7539, TPR=0.8144, TNR=0.5432, J=0.3577, MCC=0.2565, ConfusionMatrix=
[[1181  993]
 [  72  316]]
Epoch 7, Phase test, Loss=0.7903, Acc=0.5433, AUC=0.7461, TPR=0.8226, TNR=0.4951, J=0.3177, MCC=0.2262, ConfusionMatrix=
[[1069 1090]
 [  66  306]]
Epoch 7 complete in 124.87

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5361, Acc=0.7356, AUC=0.8079, TPR=0.7424, TNR=0.7289, J=0.4713, MCC=0.4713, ConfusionMatrix=
[[2678  996]
 [ 934 2692]]
Epoch 8, Phase val, Loss=0.5260, Acc=0.7432, AUC=0.7573, TPR=0.6237, TNR=0.7645, J=0.3882, MCC=0.3054, ConfusionMatrix=
[[1662  512]
 [ 146  242]]
New Best AUC=0.7573. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 8, Phase test, Loss=0.5408, Acc=0.7226, AUC=0.7541, TPR=0.6317, TNR=0.7383, J=0.3700, MCC=0.2818, ConfusionMatrix=
[[1594  565]
 [ 137  235]]
Epoch 8 complete in 127.72

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5305, Acc=0.7366, AUC=0.8120, TPR=0.7378, TNR=0.7354, J=0.4732, MCC=0.4732, ConfusionMatrix=
[[2698  971]
 [ 952 2679]]
Epoch 9, Phase val, Loss=0.6152, Acc=0.6753, AUC=0.7567, TPR=0.7371, TNR=0.6642, J=0.4013, MCC=0.2941, ConfusionMatrix=
[[1444  730]
 [ 102  286]]
Epoch 9, Phase test, Loss=0.6325, Acc=0.6606, AUC=0.7535, TPR=0.7231, TNR=0.6498, J=0.3730, MCC=0.2690, ConfusionMatrix=
[[1403  756]
 [ 103  269]]
Epoch 9 complete in 140.55

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5331, Acc=0.7351, AUC=0.8101, TPR=0.7495, TNR=0.7205, J=0.4700, MCC=0.4702, ConfusionMatrix=
[[2616 1015]
 [ 919 2750]]
Epoch 10, Phase val, Loss=0.5559, Acc=0.7186, AUC=0.7522, TPR=0.6366, TNR=0.7332, J=0.3698, MCC=0.2835, ConfusionMatrix=
[[1594  580]
 [ 141  247]]
Epoch 10, Phase test, Loss=0.5644, Acc=0.7056, AUC=0.7510, TPR=0.6344, TNR=0.7179, J=0.3523, MCC=0.2645, ConfusionMatrix=
[[1550  609]
 [ 136  236]]
Epoch 10 complete in 142.55

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5341, Acc=0.7329, AUC=0.8085, TPR=0.7411, TNR=0.7246, J=0.4657, MCC=0.4658, ConfusionMatrix=
[[2639 1003]
 [ 947 2711]]
Epoch 11, Phase val, Loss=0.4513, Acc=0.7998, AUC=0.7456, TPR=0.4330, TNR=0.8652, J=0.2982, MCC=0.2783, ConfusionMatrix=
[[1881  293]
 [ 220  168]]
Epoch 11, Phase test, Loss=0.4527, Acc=0.7973, AUC=0.7451, TPR=0.4839, TNR=0.8513, J=0.3352, MCC=0.2979, ConfusionMatrix=
[[1838  321]
 [ 192  180]]
Epoch 11 complete in 121.66

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5274, Acc=0.7410, AUC=0.8156, TPR=0.7279, TNR=0.7540, J=0.4818, MCC=0.4820, ConfusionMatrix=
[[2761  901]
 [ 990 2648]]
Epoch 12, Phase val, Loss=0.5744, Acc=0.7155, AUC=0.7474, TPR=0.6624, TNR=0.7249, J=0.3873, MCC=0.2944, ConfusionMatrix=
[[1576  598]
 [ 131  257]]
Epoch 12, Phase test, Loss=0.5845, Acc=0.6922, AUC=0.7477, TPR=0.6425, TNR=0.7008, J=0.3433, MCC=0.2549, ConfusionMatrix=
[[1513  646]
 [ 133  239]]
Epoch 12 complete in 124.99

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5325, Acc=0.7326, AUC=0.8097, TPR=0.7427, TNR=0.7225, J=0.4652, MCC=0.4653, ConfusionMatrix=
[[2643 1015]
 [ 937 2705]]
Epoch 13, Phase val, Loss=0.6113, Acc=0.6823, AUC=0.7473, TPR=0.7036, TNR=0.6785, J=0.3821, MCC=0.2823, ConfusionMatrix=
[[1475  699]
 [ 115  273]]
Epoch 13, Phase test, Loss=0.6249, Acc=0.6563, AUC=0.7482, TPR=0.6801, TNR=0.6522, J=0.3323, MCC=0.2405, ConfusionMatrix=
[[1408  751]
 [ 119  253]]
Epoch 13 complete in 131.01

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5377, Acc=0.7297, AUC=0.8067, TPR=0.7275, TNR=0.7319, J=0.4594, MCC=0.4594, ConfusionMatrix=
[[2695  987]
 [ 986 2632]]
Epoch 14, Phase val, Loss=0.6261, Acc=0.6788, AUC=0.7490, TPR=0.7165, TNR=0.6720, J=0.3885, MCC=0.2860, ConfusionMatrix=
[[1461  713]
 [ 110  278]]
Epoch 14, Phase test, Loss=0.6434, Acc=0.6622, AUC=0.7496, TPR=0.7177, TNR=0.6526, J=0.3704, MCC=0.2675, ConfusionMatrix=
[[1409  750]
 [ 105  267]]
Epoch 14 complete in 141.77

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5309, Acc=0.7423, AUC=0.8123, TPR=0.7397, TNR=0.7449, J=0.4847, MCC=0.4847, ConfusionMatrix=
[[2716  930]
 [ 951 2703]]
Epoch 15, Phase val, Loss=0.4267, Acc=0.8181, AUC=0.7429, TPR=0.3840, TNR=0.8956, J=0.2796, MCC=0.2833, ConfusionMatrix=
[[1947  227]
 [ 239  149]]
Epoch 15, Phase test, Loss=0.4207, Acc=0.8222, AUC=0.7469, TPR=0.4194, TNR=0.8916, J=0.3110, MCC=0.3050, ConfusionMatrix=
[[1925  234]
 [ 216  156]]
Epoch 15 complete in 131.99

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5232, Acc=0.7430, AUC=0.8188, TPR=0.7501, TNR=0.7359, J=0.4860, MCC=0.4860, ConfusionMatrix=
[[2672  959]
 [ 917 2752]]
Epoch 16, Phase val, Loss=0.5317, Acc=0.7549, AUC=0.7470, TPR=0.5954, TNR=0.7833, J=0.3787, MCC=0.3044, ConfusionMatrix=
[[1703  471]
 [ 157  231]]
Epoch 16, Phase test, Loss=0.5409, Acc=0.7238, AUC=0.7444, TPR=0.5995, TNR=0.7453, J=0.3447, MCC=0.2650, ConfusionMatrix=
[[1609  550]
 [ 149  223]]
Epoch 16 complete in 135.00

Early Stop!
Training complete in 37m 19s
The best model val AUC=0.757294502034, test AUC=0.754106341546.
Finish training resnet50fixed-conv1x1ab-avgpool_0

Start training resnet50fixed-conv1x1-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6563, Acc=0.6063, AUC=0.6526, TPR=0.6328, TNR=0.5800, J=0.2128, MCC=0.2131, ConfusionMatrix=
[[2125 1539]
 [1335 2301]]
Epoch 0, Phase val, Loss=0.5912, Acc=0.6600, AUC=0.7269, TPR=0.6881, TNR=0.6550, J=0.3432, MCC=0.2514, ConfusionMatrix=
[[1424  750]
 [ 121  267]]
New Best AUC=0.7269. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6115, Acc=0.6381, AUC=0.6741, TPR=0.5968, TNR=0.6452, J=0.2420, MCC=0.1756, ConfusionMatrix=
[[1393  766]
 [ 150  222]]
Epoch 0 complete in 108.78

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5759, Acc=0.6981, AUC=0.7676, TPR=0.6632, TNR=0.7332, J=0.3964, MCC=0.3974, ConfusionMatrix=
[[2666  970]
 [1234 2430]]
Epoch 1, Phase val, Loss=0.6854, Acc=0.6764, AUC=0.7419, TPR=0.6649, TNR=0.6785, J=0.3434, MCC=0.2545, ConfusionMatrix=
[[1475  699]
 [ 130  258]]
New Best AUC=0.7419. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.7192, Acc=0.6547, AUC=0.7427, TPR=0.6747, TNR=0.6512, J=0.3260, MCC=0.2359, ConfusionMatrix=
[[1406  753]
 [ 121  251]]
Epoch 1 complete in 122.16

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5559, Acc=0.7193, AUC=0.7927, TPR=0.6814, TNR=0.7581, J=0.4395, MCC=0.4406, ConfusionMatrix=
[[2736  873]
 [1176 2515]]
Epoch 2, Phase val, Loss=0.5902, Acc=0.7471, AUC=0.7724, TPR=0.6263, TNR=0.7686, J=0.3949, MCC=0.3116, ConfusionMatrix=
[[1671  503]
 [ 145  243]]
New Best AUC=0.7724. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.6325, Acc=0.7270, AUC=0.7537, TPR=0.6237, TNR=0.7448, J=0.3684, MCC=0.2822, ConfusionMatrix=
[[1608  551]
 [ 140  232]]
Epoch 2 complete in 125.33

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5463, Acc=0.7315, AUC=0.8005, TPR=0.6860, TNR=0.7770, J=0.4629, MCC=0.4649, ConfusionMatrix=
[[2839  815]
 [1145 2501]]
Epoch 3, Phase val, Loss=0.5850, Acc=0.7416, AUC=0.7631, TPR=0.6186, TNR=0.7636, J=0.3821, MCC=0.3006, ConfusionMatrix=
[[1660  514]
 [ 148  240]]
Epoch 3, Phase test, Loss=0.6082, Acc=0.7479, AUC=0.7644, TPR=0.6586, TNR=0.7633, J=0.4219, MCC=0.3264, ConfusionMatrix=
[[1648  511]
 [ 127  245]]
Epoch 3 complete in 123.00

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5412, Acc=0.7296, AUC=0.8044, TPR=0.6865, TNR=0.7732, J=0.4598, MCC=0.4614, ConfusionMatrix=
[[2803  822]
 [1152 2523]]
Epoch 4, Phase val, Loss=0.6476, Acc=0.7049, AUC=0.7618, TPR=0.6727, TNR=0.7107, J=0.3834, MCC=0.2886, ConfusionMatrix=
[[1545  629]
 [ 127  261]]
Epoch 4, Phase test, Loss=0.6925, Acc=0.6760, AUC=0.7584, TPR=0.6855, TNR=0.6744, J=0.3599, MCC=0.2627, ConfusionMatrix=
[[1456  703]
 [ 117  255]]
Epoch 4 complete in 128.28

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5281, Acc=0.7395, AUC=0.8168, TPR=0.7049, TNR=0.7747, J=0.4795, MCC=0.4805, ConfusionMatrix=
[[2802  815]
 [1087 2596]]
Epoch 5, Phase val, Loss=0.6272, Acc=0.7077, AUC=0.7656, TPR=0.6856, TNR=0.7116, J=0.3972, MCC=0.2988, ConfusionMatrix=
[[1547  627]
 [ 122  266]]
Epoch 5, Phase test, Loss=0.6714, Acc=0.6910, AUC=0.7703, TPR=0.7097, TNR=0.6878, J=0.3975, MCC=0.2914, ConfusionMatrix=
[[1485  674]
 [ 108  264]]
Epoch 5 complete in 145.90

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5219, Acc=0.7421, AUC=0.8215, TPR=0.7065, TNR=0.7763, J=0.4828, MCC=0.4842, ConfusionMatrix=
[[2887  832]
 [1051 2530]]
Epoch 6, Phase val, Loss=0.5203, Acc=0.7775, AUC=0.7739, TPR=0.5902, TNR=0.8109, J=0.4012, MCC=0.3322, ConfusionMatrix=
[[1763  411]
 [ 159  229]]
New Best AUC=0.7739. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 6, Phase test, Loss=0.5593, Acc=0.7760, AUC=0.7768, TPR=0.6452, TNR=0.7985, J=0.4437, MCC=0.3552, ConfusionMatrix=
[[1724  435]
 [ 132  240]]
Epoch 6 complete in 125.95

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5412, Acc=0.7375, AUC=0.8085, TPR=0.6923, TNR=0.7830, J=0.4753, MCC=0.4772, ConfusionMatrix=
[[2850  790]
 [1126 2534]]
Epoch 7, Phase val, Loss=0.6044, Acc=0.7385, AUC=0.7636, TPR=0.6340, TNR=0.7571, J=0.3912, MCC=0.3054, ConfusionMatrix=
[[1646  528]
 [ 142  246]]
Epoch 7, Phase test, Loss=0.6285, Acc=0.7301, AUC=0.7750, TPR=0.6667, TNR=0.7411, J=0.4078, MCC=0.3098, ConfusionMatrix=
[[1600  559]
 [ 124  248]]
Epoch 7 complete in 127.53

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5190, Acc=0.7508, AUC=0.8219, TPR=0.7045, TNR=0.7974, J=0.5018, MCC=0.5040, ConfusionMatrix=
[[2904  738]
 [1081 2577]]
Epoch 8, Phase val, Loss=0.5626, Acc=0.7709, AUC=0.7699, TPR=0.6108, TNR=0.7994, J=0.4103, MCC=0.3342, ConfusionMatrix=
[[1738  436]
 [ 151  237]]
Epoch 8, Phase test, Loss=0.6044, Acc=0.7558, AUC=0.7683, TPR=0.6263, TNR=0.7781, J=0.4045, MCC=0.3185, ConfusionMatrix=
[[1680  479]
 [ 139  233]]
Epoch 8 complete in 108.73

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5280, Acc=0.7464, AUC=0.8163, TPR=0.7124, TNR=0.7820, J=0.4945, MCC=0.4952, ConfusionMatrix=
[[2788  777]
 [1074 2661]]
Epoch 9, Phase val, Loss=0.6453, Acc=0.7080, AUC=0.7651, TPR=0.6624, TNR=0.7162, J=0.3786, MCC=0.2862, ConfusionMatrix=
[[1557  617]
 [ 131  257]]
Epoch 9, Phase test, Loss=0.6838, Acc=0.6910, AUC=0.7632, TPR=0.6962, TNR=0.6901, J=0.3864, MCC=0.2839, ConfusionMatrix=
[[1490  669]
 [ 113  259]]
Epoch 9 complete in 97.79

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5295, Acc=0.7441, AUC=0.8162, TPR=0.7090, TNR=0.7798, J=0.4888, MCC=0.4899, ConfusionMatrix=
[[2823  797]
 [1071 2609]]
Epoch 10, Phase val, Loss=0.4693, Acc=0.8099, AUC=0.7674, TPR=0.5077, TNR=0.8638, J=0.3716, MCC=0.3379, ConfusionMatrix=
[[1878  296]
 [ 191  197]]
Epoch 10, Phase test, Loss=0.5035, Acc=0.8123, AUC=0.7603, TPR=0.5215, TNR=0.8624, J=0.3839, MCC=0.3438, ConfusionMatrix=
[[1862  297]
 [ 178  194]]
Epoch 10 complete in 113.64

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5292, Acc=0.7447, AUC=0.8176, TPR=0.7093, TNR=0.7803, J=0.4896, MCC=0.4908, ConfusionMatrix=
[[2835  798]
 [1066 2601]]
Epoch 11, Phase val, Loss=0.5071, Acc=0.7873, AUC=0.7711, TPR=0.5593, TNR=0.8280, J=0.3872, MCC=0.3295, ConfusionMatrix=
[[1800  374]
 [ 171  217]]
Epoch 11, Phase test, Loss=0.5407, Acc=0.7866, AUC=0.7654, TPR=0.5618, TNR=0.8254, J=0.3872, MCC=0.3250, ConfusionMatrix=
[[1782  377]
 [ 163  209]]
Epoch 11 complete in 153.32

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5103, Acc=0.7577, AUC=0.8299, TPR=0.7164, TNR=0.7978, J=0.5142, MCC=0.5162, ConfusionMatrix=
[[2952  748]
 [1021 2579]]
Epoch 12, Phase val, Loss=0.5916, Acc=0.7525, AUC=0.7768, TPR=0.6495, TNR=0.7709, J=0.4204, MCC=0.3312, ConfusionMatrix=
[[1676  498]
 [ 136  252]]
New Best AUC=0.7768. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 12, Phase test, Loss=0.6222, Acc=0.7444, AUC=0.7642, TPR=0.6505, TNR=0.7605, J=0.4111, MCC=0.3177, ConfusionMatrix=
[[1642  517]
 [ 130  242]]
Epoch 12 complete in 129.00

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5268, Acc=0.7444, AUC=0.8184, TPR=0.6963, TNR=0.7925, J=0.4888, MCC=0.4911, ConfusionMatrix=
[[2891  757]
 [1109 2543]]
Epoch 13, Phase val, Loss=0.4765, Acc=0.8123, AUC=0.7723, TPR=0.5284, TNR=0.8629, J=0.3913, MCC=0.3531, ConfusionMatrix=
[[1876  298]
 [ 183  205]]
Epoch 13, Phase test, Loss=0.5043, Acc=0.8171, AUC=0.7688, TPR=0.5457, TNR=0.8638, J=0.4095, MCC=0.3650, ConfusionMatrix=
[[1865  294]
 [ 169  203]]
Epoch 13 complete in 125.30

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5125, Acc=0.7552, AUC=0.8311, TPR=0.7116, TNR=0.7986, J=0.5102, MCC=0.5122, ConfusionMatrix=
[[2922  737]
 [1050 2591]]
Epoch 14, Phase val, Loss=0.6686, Acc=0.7147, AUC=0.7707, TPR=0.7010, TNR=0.7171, J=0.4181, MCC=0.3151, ConfusionMatrix=
[[1559  615]
 [ 116  272]]
Epoch 14, Phase test, Loss=0.7317, Acc=0.6808, AUC=0.7657, TPR=0.7151, TNR=0.6748, J=0.3899, MCC=0.2841, ConfusionMatrix=
[[1457  702]
 [ 106  266]]
Epoch 14 complete in 125.41

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5238, Acc=0.7484, AUC=0.8210, TPR=0.7007, TNR=0.7951, J=0.4958, MCC=0.4982, ConfusionMatrix=
[[2930  755]
 [1082 2533]]
Epoch 15, Phase val, Loss=0.5945, Acc=0.7557, AUC=0.7744, TPR=0.6495, TNR=0.7746, J=0.4241, MCC=0.3352, ConfusionMatrix=
[[1684  490]
 [ 136  252]]
Epoch 15, Phase test, Loss=0.6401, Acc=0.7361, AUC=0.7646, TPR=0.6425, TNR=0.7522, J=0.3947, MCC=0.3033, ConfusionMatrix=
[[1624  535]
 [ 133  239]]
Epoch 15 complete in 125.20

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5212, Acc=0.7532, AUC=0.8275, TPR=0.7080, TNR=0.7977, J=0.5056, MCC=0.5078, ConfusionMatrix=
[[2933  744]
 [1058 2565]]
Epoch 16, Phase val, Loss=0.5570, Acc=0.7783, AUC=0.7707, TPR=0.6211, TNR=0.8063, J=0.4275, MCC=0.3501, ConfusionMatrix=
[[1753  421]
 [ 147  241]]
Epoch 16, Phase test, Loss=0.6086, Acc=0.7661, AUC=0.7641, TPR=0.6398, TNR=0.7879, J=0.4276, MCC=0.3391, ConfusionMatrix=
[[1701  458]
 [ 134  238]]
Epoch 16 complete in 128.71

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5044, Acc=0.7564, AUC=0.8338, TPR=0.7295, TNR=0.7838, J=0.5132, MCC=0.5139, ConfusionMatrix=
[[2842  784]
 [ 994 2680]]
Epoch 17, Phase val, Loss=0.5629, Acc=0.7685, AUC=0.7694, TPR=0.6237, TNR=0.7944, J=0.4181, MCC=0.3380, ConfusionMatrix=
[[1727  447]
 [ 146  242]]
Epoch 17, Phase test, Loss=0.6094, Acc=0.7491, AUC=0.7607, TPR=0.6075, TNR=0.7735, J=0.3810, MCC=0.2997, ConfusionMatrix=
[[1670  489]
 [ 146  226]]
Epoch 17 complete in 145.95

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4954, Acc=0.7629, AUC=0.8423, TPR=0.7286, TNR=0.7981, J=0.5266, MCC=0.5276, ConfusionMatrix=
[[2877  728]
 [1003 2692]]
Epoch 18, Phase val, Loss=0.6249, Acc=0.7334, AUC=0.7711, TPR=0.6727, TNR=0.7443, J=0.4169, MCC=0.3207, ConfusionMatrix=
[[1618  556]
 [ 127  261]]
Epoch 18, Phase test, Loss=0.6776, Acc=0.7187, AUC=0.7771, TPR=0.7043, TNR=0.7212, J=0.4255, MCC=0.3177, ConfusionMatrix=
[[1557  602]
 [ 110  262]]
Epoch 18 complete in 133.59

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4960, Acc=0.7640, AUC=0.8415, TPR=0.7340, TNR=0.7946, J=0.5286, MCC=0.5294, ConfusionMatrix=
[[2867  741]
 [ 982 2710]]
Epoch 19, Phase val, Loss=0.6119, Acc=0.7576, AUC=0.7809, TPR=0.6701, TNR=0.7732, J=0.4433, MCC=0.3489, ConfusionMatrix=
[[1681  493]
 [ 128  260]]
New Best AUC=0.7809. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 19, Phase test, Loss=0.6700, Acc=0.7309, AUC=0.7720, TPR=0.6640, TNR=0.7425, J=0.4065, MCC=0.3092, ConfusionMatrix=
[[1603  556]
 [ 125  247]]
Epoch 19 complete in 126.58

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4906, Acc=0.7671, AUC=0.8441, TPR=0.7343, TNR=0.8009, J=0.5352, MCC=0.5361, ConfusionMatrix=
[[2880  716]
 [ 984 2720]]
Epoch 20, Phase val, Loss=0.5574, Acc=0.7674, AUC=0.7792, TPR=0.6186, TNR=0.7939, J=0.4125, MCC=0.3336, ConfusionMatrix=
[[1726  448]
 [ 148  240]]
Epoch 20, Phase test, Loss=0.5999, Acc=0.7633, AUC=0.7743, TPR=0.6398, TNR=0.7846, J=0.4244, MCC=0.3355, ConfusionMatrix=
[[1694  465]
 [ 134  238]]
Epoch 20 complete in 125.38

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.5099, Acc=0.7621, AUC=0.8305, TPR=0.7164, TNR=0.8079, J=0.5243, MCC=0.5264, ConfusionMatrix=
[[2944  700]
 [1037 2619]]
Epoch 21, Phase val, Loss=0.5316, Acc=0.7959, AUC=0.7716, TPR=0.5335, TNR=0.8427, J=0.3762, MCC=0.3287, ConfusionMatrix=
[[1832  342]
 [ 181  207]]
Epoch 21, Phase test, Loss=0.5549, Acc=0.7902, AUC=0.7495, TPR=0.5806, TNR=0.8263, J=0.4070, MCC=0.3406, ConfusionMatrix=
[[1784  375]
 [ 156  216]]
Epoch 21 complete in 126.25

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4890, Acc=0.7752, AUC=0.8473, TPR=0.7378, TNR=0.8116, J=0.5493, MCC=0.5511, ConfusionMatrix=
[[3006  698]
 [ 943 2653]]
Epoch 22, Phase val, Loss=0.5240, Acc=0.7826, AUC=0.7721, TPR=0.5747, TNR=0.8197, J=0.3944, MCC=0.3311, ConfusionMatrix=
[[1782  392]
 [ 165  223]]
Epoch 22, Phase test, Loss=0.5606, Acc=0.7728, AUC=0.7612, TPR=0.6075, TNR=0.8013, J=0.4088, MCC=0.3305, ConfusionMatrix=
[[1730  429]
 [ 146  226]]
Epoch 22 complete in 130.73

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.4887, Acc=0.7682, AUC=0.8457, TPR=0.7261, TNR=0.8091, J=0.5352, MCC=0.5374, ConfusionMatrix=
[[2997  707]
 [ 985 2611]]
Epoch 23, Phase val, Loss=0.5788, Acc=0.7623, AUC=0.7725, TPR=0.6160, TNR=0.7884, J=0.4044, MCC=0.3255, ConfusionMatrix=
[[1714  460]
 [ 149  239]]
Epoch 23, Phase test, Loss=0.6340, Acc=0.7424, AUC=0.7624, TPR=0.6559, TNR=0.7573, J=0.4132, MCC=0.3182, ConfusionMatrix=
[[1635  524]
 [ 128  244]]
Epoch 23 complete in 143.64

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.4801, Acc=0.7744, AUC=0.8517, TPR=0.7388, TNR=0.8095, J=0.5483, MCC=0.5498, ConfusionMatrix=
[[2974  700]
 [ 947 2679]]
Epoch 24, Phase val, Loss=0.4868, Acc=0.8115, AUC=0.7684, TPR=0.5206, TNR=0.8634, J=0.3840, MCC=0.3476, ConfusionMatrix=
[[1877  297]
 [ 186  202]]
Epoch 24, Phase test, Loss=0.5168, Acc=0.8088, AUC=0.7619, TPR=0.5457, TNR=0.8541, J=0.3998, MCC=0.3509, ConfusionMatrix=
[[1844  315]
 [ 169  203]]
Epoch 24 complete in 126.48

Epoch 25 starting with learning_rate: [0.005]
Epoch 25, Phase train, Loss=0.5043, Acc=0.7627, AUC=0.8371, TPR=0.7328, TNR=0.7932, J=0.5260, MCC=0.5268, ConfusionMatrix=
[[2869  748]
 [ 984 2699]]
Epoch 25, Phase val, Loss=0.6374, Acc=0.7369, AUC=0.7731, TPR=0.6675, TNR=0.7493, J=0.4168, MCC=0.3220, ConfusionMatrix=
[[1629  545]
 [ 129  259]]
Epoch 25, Phase test, Loss=0.6746, Acc=0.7234, AUC=0.7657, TPR=0.6801, TNR=0.7309, J=0.4110, MCC=0.3096, ConfusionMatrix=
[[1578  581]
 [ 119  253]]
Epoch 25 complete in 126.19

Epoch 26 starting with learning_rate: [0.005]
Epoch 26, Phase train, Loss=0.5058, Acc=0.7679, AUC=0.8372, TPR=0.7362, TNR=0.7999, J=0.5362, MCC=0.5372, ConfusionMatrix=
[[2907  727]
 [ 967 2699]]
Epoch 26, Phase val, Loss=0.4755, Acc=0.8080, AUC=0.7781, TPR=0.5000, TNR=0.8629, J=0.3629, MCC=0.3303, ConfusionMatrix=
[[1876  298]
 [ 194  194]]
Epoch 26, Phase test, Loss=0.4977, Acc=0.8163, AUC=0.7661, TPR=0.5484, TNR=0.8624, J=0.4108, MCC=0.3651, ConfusionMatrix=
[[1862  297]
 [ 168  204]]
Epoch 26 complete in 125.84

Epoch 27 starting with learning_rate: [0.005]
Epoch 27, Phase train, Loss=0.5267, Acc=0.7482, AUC=0.8243, TPR=0.7060, TNR=0.7908, J=0.4967, MCC=0.4985, ConfusionMatrix=
[[2876  761]
 [1077 2586]]
Epoch 27, Phase val, Loss=0.4632, Acc=0.8173, AUC=0.7643, TPR=0.4588, TNR=0.8813, J=0.3401, MCC=0.3244, ConfusionMatrix=
[[1916  258]
 [ 210  178]]
Epoch 27, Phase test, Loss=0.4815, Acc=0.8289, AUC=0.7508, TPR=0.5000, TNR=0.8856, J=0.3856, MCC=0.3626, ConfusionMatrix=
[[1912  247]
 [ 186  186]]
Epoch 27 complete in 124.73

Early Stop!
Training complete in 59m 9s
The best model val AUC=0.780889898425, test AUC=0.772044504873.
Finish training resnet50fixed-conv1x1-maxpool_0

Start training resnet50fixed-conv1x1-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6064, Acc=0.6656, AUC=0.7308, TPR=0.7125, TNR=0.6181, J=0.3306, MCC=0.3322, ConfusionMatrix=
[[2242 1385]
 [1056 2617]]
Epoch 0, Phase val, Loss=0.6530, Acc=0.6202, AUC=0.7464, TPR=0.7784, TNR=0.5920, J=0.3703, MCC=0.2662, ConfusionMatrix=
[[1287  887]
 [  86  302]]
New Best AUC=0.7464. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6888, Acc=0.5915, AUC=0.7276, TPR=0.7661, TNR=0.5614, J=0.3275, MCC=0.2320, ConfusionMatrix=
[[1212  947]
 [  87  285]]
Epoch 0 complete in 151.48

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5754, Acc=0.6963, AUC=0.7682, TPR=0.7098, TNR=0.6822, J=0.3920, MCC=0.3921, ConfusionMatrix=
[[2434 1134]
 [1083 2649]]
Epoch 1, Phase val, Loss=0.5815, Acc=0.7026, AUC=0.7490, TPR=0.6753, TNR=0.7075, J=0.3827, MCC=0.2875, ConfusionMatrix=
[[1538  636]
 [ 126  262]]
New Best AUC=0.7490. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.6095, Acc=0.6733, AUC=0.7364, TPR=0.6882, TNR=0.6707, J=0.3589, MCC=0.2615, ConfusionMatrix=
[[1448  711]
 [ 116  256]]
Epoch 1 complete in 129.68

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5491, Acc=0.7286, AUC=0.7965, TPR=0.7435, TNR=0.7135, J=0.4570, MCC=0.4573, ConfusionMatrix=
[[2585 1038]
 [ 943 2734]]
Epoch 2, Phase val, Loss=0.5734, Acc=0.7135, AUC=0.7610, TPR=0.6985, TNR=0.7162, J=0.4146, MCC=0.3123, ConfusionMatrix=
[[1557  617]
 [ 117  271]]
New Best AUC=0.7610. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50fixed-conv1x1-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.5992, Acc=0.6815, AUC=0.7481, TPR=0.6882, TNR=0.6804, J=0.3686, MCC=0.2698, ConfusionMatrix=
[[1469  690]
 [ 116  256]]
Epoch 2 complete in 126.26

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5501, Acc=0.7177, AUC=0.7944, TPR=0.7356, TNR=0.6989, J=0.4344, MCC=0.4348, ConfusionMatrix=
[[2488 1072]
 [ 989 2751]]
Epoch 3, Phase val, Loss=0.4958, Acc=0.7681, AUC=0.7489, TPR=0.5206, TNR=0.8123, J=0.3329, MCC=0.2802, ConfusionMatrix=
[[1766  408]
 [ 186  202]]
Epoch 3, Phase test, Loss=0.5149, Acc=0.7475, AUC=0.7417, TPR=0.5780, TNR=0.7767, J=0.3547, MCC=0.2812, ConfusionMatrix=
[[1677  482]
 [ 157  215]]
Epoch 3 complete in 125.90

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5473, Acc=0.7230, AUC=0.7965, TPR=0.7246, TNR=0.7214, J=0.4460, MCC=0.4460, ConfusionMatrix=
[[2647 1022]
 [1000 2631]]
Epoch 4, Phase val, Loss=0.4947, Acc=0.7674, AUC=0.7477, TPR=0.5284, TNR=0.8100, J=0.3384, MCC=0.2835, ConfusionMatrix=
[[1761  413]
 [ 183  205]]
Epoch 4, Phase test, Loss=0.4996, Acc=0.7614, AUC=0.7452, TPR=0.5645, TNR=0.7953, J=0.3598, MCC=0.2913, ConfusionMatrix=
[[1717  442]
 [ 162  210]]
Epoch 4 complete in 126.71

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5386, Acc=0.7330, AUC=0.8049, TPR=0.7268, TNR=0.7391, J=0.4658, MCC=0.4659, ConfusionMatrix=
[[2739  967]
 [ 982 2612]]
Epoch 5, Phase val, Loss=0.4806, Acc=0.7818, AUC=0.7482, TPR=0.5206, TNR=0.8284, J=0.3490, MCC=0.2999, ConfusionMatrix=
[[1801  373]
 [ 186  202]]
Epoch 5, Phase test, Loss=0.4820, Acc=0.7744, AUC=0.7481, TPR=0.5376, TNR=0.8152, J=0.3528, MCC=0.2939, ConfusionMatrix=
[[1760  399]
 [ 172  200]]
Epoch 5 complete in 120.34

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5304, Acc=0.7371, AUC=0.8130, TPR=0.7394, TNR=0.7349, J=0.4743, MCC=0.4743, ConfusionMatrix=
[[2703  975]
 [ 944 2678]]
Epoch 6, Phase val, Loss=0.5351, Acc=0.7494, AUC=0.7466, TPR=0.6057, TNR=0.7751, J=0.3807, MCC=0.3031, ConfusionMatrix=
[[1685  489]
 [ 153  235]]
Epoch 6, Phase test, Loss=0.5474, Acc=0.7266, AUC=0.7466, TPR=0.6263, TNR=0.7439, J=0.3702, MCC=0.2833, ConfusionMatrix=
[[1606  553]
 [ 139  233]]
Epoch 6 complete in 146.31

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5340, Acc=0.7334, AUC=0.8079, TPR=0.7381, TNR=0.7288, J=0.4669, MCC=0.4669, ConfusionMatrix=
[[2679  997]
 [ 949 2675]]
Epoch 7, Phase val, Loss=0.5757, Acc=0.7069, AUC=0.7519, TPR=0.6778, TNR=0.7121, J=0.3899, MCC=0.2936, ConfusionMatrix=
[[1548  626]
 [ 125  263]]
Epoch 7, Phase test, Loss=0.5905, Acc=0.6891, AUC=0.7457, TPR=0.6559, TNR=0.6948, J=0.3507, MCC=0.2592, ConfusionMatrix=
[[1500  659]
 [ 128  244]]
Epoch 7 complete in 129.02

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5493, Acc=0.7293, AUC=0.7991, TPR=0.7243, TNR=0.7341, J=0.4584, MCC=0.4584, ConfusionMatrix=
[[2739  992]
 [ 984 2585]]
Epoch 8, Phase val, Loss=0.4514, Acc=0.8021, AUC=0.7380, TPR=0.4253, TNR=0.8694, J=0.2946, MCC=0.2778, ConfusionMatrix=
[[1890  284]
 [ 223  165]]
Epoch 8, Phase test, Loss=0.4558, Acc=0.7993, AUC=0.7385, TPR=0.4624, TNR=0.8573, J=0.3197, MCC=0.2888, ConfusionMatrix=
[[1851  308]
 [ 200  172]]
Epoch 8 complete in 127.92

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5281, Acc=0.7358, AUC=0.8126, TPR=0.7312, TNR=0.7403, J=0.4715, MCC=0.4715, ConfusionMatrix=
[[2702  948]
 [ 981 2669]]
Epoch 9, Phase val, Loss=0.5808, Acc=0.7182, AUC=0.7417, TPR=0.6701, TNR=0.7268, J=0.3969, MCC=0.3018, ConfusionMatrix=
[[1580  594]
 [ 128  260]]
Epoch 9, Phase test, Loss=0.5951, Acc=0.6883, AUC=0.7426, TPR=0.6586, TNR=0.6934, J=0.3520, MCC=0.2599, ConfusionMatrix=
[[1497  662]
 [ 127  245]]
Epoch 9 complete in 125.22

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5221, Acc=0.7427, AUC=0.8204, TPR=0.7475, TNR=0.7380, J=0.4855, MCC=0.4855, ConfusionMatrix=
[[2699  958]
 [ 920 2723]]
Epoch 10, Phase val, Loss=0.5139, Acc=0.7670, AUC=0.7519, TPR=0.5799, TNR=0.8004, J=0.3803, MCC=0.3119, ConfusionMatrix=
[[1740  434]
 [ 163  225]]
Epoch 10, Phase test, Loss=0.5265, Acc=0.7456, AUC=0.7455, TPR=0.6048, TNR=0.7698, J=0.3746, MCC=0.2938, ConfusionMatrix=
[[1662  497]
 [ 147  225]]
Epoch 10 complete in 127.02

Early Stop!
Training complete in 23m 56s
The best model val AUC=0.761037187378, test AUC=0.748081300084.
Finish training resnet50fixed-conv1x1-avgpool_0

Start training resnet50scratch-conv1x1ab-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6347, Acc=0.6295, AUC=0.6877, TPR=0.5370, TNR=0.7204, J=0.2574, MCC=0.2619, ConfusionMatrix=
[[2651 1029]
 [1676 1944]]
Epoch 0, Phase val, Loss=0.5015, Acc=0.8361, AUC=0.6876, TPR=0.1727, TNR=0.9545, J=0.1271, MCC=0.1852, ConfusionMatrix=
[[2075   99]
 [ 321   67]]
New Best AUC=0.6876. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.4963, Acc=0.8491, AUC=0.6428, TPR=0.1344, TNR=0.9722, J=0.1066, MCC=0.1852, ConfusionMatrix=
[[2099   60]
 [ 322   50]]
Epoch 0 complete in 130.00

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5804, Acc=0.6925, AUC=0.7663, TPR=0.5688, TNR=0.8192, J=0.3880, MCC=0.4002, ConfusionMatrix=
[[2954  652]
 [1593 2101]]
Epoch 1, Phase val, Loss=0.6645, Acc=0.6831, AUC=0.7411, TPR=0.6366, TNR=0.6914, J=0.3280, MCC=0.2452, ConfusionMatrix=
[[1503  671]
 [ 141  247]]
New Best AUC=0.7411. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.6488, Acc=0.7084, AUC=0.7392, TPR=0.6129, TNR=0.7249, J=0.3378, MCC=0.2554, ConfusionMatrix=
[[1565  594]
 [ 144  228]]
Epoch 1 complete in 127.21

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5568, Acc=0.7079, AUC=0.7855, TPR=0.5954, TNR=0.8199, J=0.4153, MCC=0.4263, ConfusionMatrix=
[[3000  659]
 [1473 2168]]
Epoch 2, Phase val, Loss=0.7723, Acc=0.6721, AUC=0.7627, TPR=0.6804, TNR=0.6707, J=0.3511, MCC=0.2590, ConfusionMatrix=
[[1458  716]
 [ 124  264]]
New Best AUC=0.7627. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.7832, Acc=0.6673, AUC=0.7514, TPR=0.7016, TNR=0.6614, J=0.3630, MCC=0.2633, ConfusionMatrix=
[[1428  731]
 [ 111  261]]
Epoch 2 complete in 116.54

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5659, Acc=0.7179, AUC=0.7838, TPR=0.6381, TNR=0.7962, J=0.4342, MCC=0.4400, ConfusionMatrix=
[[2937  752]
 [1307 2304]]
Epoch 3, Phase val, Loss=0.5738, Acc=0.7350, AUC=0.7682, TPR=0.6057, TNR=0.7580, J=0.3637, MCC=0.2853, ConfusionMatrix=
[[1648  526]
 [ 153  235]]
New Best AUC=0.7682. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.5654, Acc=0.7487, AUC=0.7559, TPR=0.6344, TNR=0.7684, J=0.4028, MCC=0.3141, ConfusionMatrix=
[[1659  500]
 [ 136  236]]
Epoch 3 complete in 108.16

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5469, Acc=0.7219, AUC=0.7955, TPR=0.6568, TNR=0.7861, J=0.4430, MCC=0.4469, ConfusionMatrix=
[[2889  786]
 [1244 2381]]
Epoch 4, Phase val, Loss=0.5546, Acc=0.7728, AUC=0.7731, TPR=0.5747, TNR=0.8082, J=0.3829, MCC=0.3171, ConfusionMatrix=
[[1757  417]
 [ 165  223]]
New Best AUC=0.7731. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.5476, Acc=0.7693, AUC=0.7591, TPR=0.5753, TNR=0.8027, J=0.3780, MCC=0.3079, ConfusionMatrix=
[[1733  426]
 [ 158  214]]
Epoch 4 complete in 120.54

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5203, Acc=0.7433, AUC=0.8188, TPR=0.6926, TNR=0.7949, J=0.4875, MCC=0.4898, ConfusionMatrix=
[[2876  742]
 [1132 2550]]
Epoch 5, Phase val, Loss=0.5718, Acc=0.7744, AUC=0.7947, TPR=0.6443, TNR=0.7976, J=0.4419, MCC=0.3571, ConfusionMatrix=
[[1734  440]
 [ 138  250]]
New Best AUC=0.7947. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 5, Phase test, Loss=0.5512, Acc=0.7768, AUC=0.7869, TPR=0.6532, TNR=0.7981, J=0.4513, MCC=0.3607, ConfusionMatrix=
[[1723  436]
 [ 129  243]]
Epoch 5 complete in 120.50

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5141, Acc=0.7503, AUC=0.8235, TPR=0.6963, TNR=0.8055, J=0.5018, MCC=0.5045, ConfusionMatrix=
[[2907  702]
 [1121 2570]]
Epoch 6, Phase val, Loss=0.5448, Acc=0.7600, AUC=0.8001, TPR=0.6546, TNR=0.7787, J=0.4334, MCC=0.3435, ConfusionMatrix=
[[1693  481]
 [ 134  254]]
New Best AUC=0.8001. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 6, Phase test, Loss=0.5301, Acc=0.7752, AUC=0.7781, TPR=0.6317, TNR=0.7999, J=0.4316, MCC=0.3469, ConfusionMatrix=
[[1727  432]
 [ 137  235]]
Epoch 6 complete in 113.78

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5153, Acc=0.7553, AUC=0.8252, TPR=0.7012, TNR=0.8091, J=0.5102, MCC=0.5133, ConfusionMatrix=
[[2966  700]
 [1086 2548]]
Epoch 7, Phase val, Loss=0.5325, Acc=0.7697, AUC=0.7831, TPR=0.6134, TNR=0.7976, J=0.4110, MCC=0.3340, ConfusionMatrix=
[[1734  440]
 [ 150  238]]
Epoch 7, Phase test, Loss=0.5494, Acc=0.7562, AUC=0.7548, TPR=0.5806, TNR=0.7865, J=0.3671, MCC=0.2937, ConfusionMatrix=
[[1698  461]
 [ 156  216]]
Epoch 7 complete in 129.50

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5050, Acc=0.7625, AUC=0.8330, TPR=0.6962, TNR=0.8275, J=0.5238, MCC=0.5287, ConfusionMatrix=
[[3047  635]
 [1099 2519]]
Epoch 8, Phase val, Loss=0.6823, Acc=0.7198, AUC=0.8050, TPR=0.7242, TNR=0.7190, J=0.4432, MCC=0.3335, ConfusionMatrix=
[[1563  611]
 [ 107  281]]
New Best AUC=0.8050. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 8, Phase test, Loss=0.6977, Acc=0.7080, AUC=0.7896, TPR=0.7231, TNR=0.7054, J=0.4285, MCC=0.3166, ConfusionMatrix=
[[1523  636]
 [ 103  269]]
Epoch 8 complete in 115.26

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4918, Acc=0.7777, AUC=0.8428, TPR=0.7398, TNR=0.8158, J=0.5556, MCC=0.5571, ConfusionMatrix=
[[2968  670]
 [ 953 2709]]
Epoch 9, Phase val, Loss=0.4265, Acc=0.8454, AUC=0.7919, TPR=0.5412, TNR=0.8997, J=0.4410, MCC=0.4238, ConfusionMatrix=
[[1956  218]
 [ 178  210]]
Epoch 9, Phase test, Loss=0.4413, Acc=0.8285, AUC=0.7691, TPR=0.4758, TNR=0.8893, J=0.3651, MCC=0.3488, ConfusionMatrix=
[[1920  239]
 [ 195  177]]
Epoch 9 complete in 110.67

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5012, Acc=0.7712, AUC=0.8340, TPR=0.7091, TNR=0.8303, J=0.5394, MCC=0.5442, ConfusionMatrix=
[[3107  635]
 [1035 2523]]
Epoch 10, Phase val, Loss=0.4150, Acc=0.8513, AUC=0.7926, TPR=0.4974, TNR=0.9144, J=0.4119, MCC=0.4159, ConfusionMatrix=
[[1988  186]
 [ 195  193]]
Epoch 10, Phase test, Loss=0.4177, Acc=0.8503, AUC=0.7745, TPR=0.5027, TNR=0.9101, J=0.4128, MCC=0.4088, ConfusionMatrix=
[[1965  194]
 [ 185  187]]
Epoch 10 complete in 112.75

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4850, Acc=0.7800, AUC=0.8479, TPR=0.7321, TNR=0.8290, J=0.5611, MCC=0.5634, ConfusionMatrix=
[[2991  617]
 [ 989 2703]]
Epoch 11, Phase val, Loss=0.5169, Acc=0.7963, AUC=0.8014, TPR=0.6572, TNR=0.8211, J=0.4783, MCC=0.3952, ConfusionMatrix=
[[1785  389]
 [ 133  255]]
Epoch 11, Phase test, Loss=0.5199, Acc=0.7720, AUC=0.7843, TPR=0.6210, TNR=0.7981, J=0.4190, MCC=0.3368, ConfusionMatrix=
[[1723  436]
 [ 141  231]]
Epoch 11 complete in 94.67

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4867, Acc=0.7755, AUC=0.8450, TPR=0.7461, TNR=0.8058, J=0.5519, MCC=0.5525, ConfusionMatrix=
[[2896  698]
 [ 941 2765]]
Epoch 12, Phase val, Loss=0.5671, Acc=0.7440, AUC=0.8064, TPR=0.7655, TNR=0.7401, J=0.5056, MCC=0.3836, ConfusionMatrix=
[[1609  565]
 [  91  297]]
New Best AUC=0.8064. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 12, Phase test, Loss=0.5739, Acc=0.7124, AUC=0.7930, TPR=0.7339, TNR=0.7087, J=0.4425, MCC=0.3272, ConfusionMatrix=
[[1530  629]
 [  99  273]]
Epoch 12 complete in 142.21

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4711, Acc=0.7882, AUC=0.8576, TPR=0.7577, TNR=0.8192, J=0.5770, MCC=0.5779, ConfusionMatrix=
[[2964  654]
 [ 892 2790]]
Epoch 13, Phase val, Loss=0.5517, Acc=0.7459, AUC=0.7984, TPR=0.7216, TNR=0.7502, J=0.4719, MCC=0.3623, ConfusionMatrix=
[[1631  543]
 [ 108  280]]
Epoch 13, Phase test, Loss=0.5640, Acc=0.7096, AUC=0.7774, TPR=0.6882, TNR=0.7133, J=0.4015, MCC=0.2989, ConfusionMatrix=
[[1540  619]
 [ 116  256]]
Epoch 13 complete in 119.78

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4696, Acc=0.7882, AUC=0.8586, TPR=0.7514, TNR=0.8253, J=0.5767, MCC=0.5782, ConfusionMatrix=
[[3000  635]
 [ 911 2754]]
Epoch 14, Phase val, Loss=0.4688, Acc=0.8087, AUC=0.8062, TPR=0.6263, TNR=0.8413, J=0.4676, MCC=0.3986, ConfusionMatrix=
[[1829  345]
 [ 145  243]]
Epoch 14, Phase test, Loss=0.4880, Acc=0.8032, AUC=0.7891, TPR=0.6210, TNR=0.8346, J=0.4556, MCC=0.3820, ConfusionMatrix=
[[1802  357]
 [ 141  231]]
Epoch 14 complete in 99.06

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4765, Acc=0.7873, AUC=0.8539, TPR=0.7485, TNR=0.8265, J=0.5750, MCC=0.5766, ConfusionMatrix=
[[2997  629]
 [ 924 2750]]
Epoch 15, Phase val, Loss=0.5000, Acc=0.7963, AUC=0.7870, TPR=0.6366, TNR=0.8247, J=0.4613, MCC=0.3845, ConfusionMatrix=
[[1793  381]
 [ 141  247]]
Epoch 15, Phase test, Loss=0.5318, Acc=0.7736, AUC=0.7681, TPR=0.6102, TNR=0.8018, J=0.4120, MCC=0.3331, ConfusionMatrix=
[[1731  428]
 [ 145  227]]
Epoch 15 complete in 113.27

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4644, Acc=0.7907, AUC=0.8620, TPR=0.7612, TNR=0.8204, J=0.5816, MCC=0.5825, ConfusionMatrix=
[[2983  653]
 [ 875 2789]]
Epoch 16, Phase val, Loss=0.6158, Acc=0.7705, AUC=0.7936, TPR=0.6933, TNR=0.7843, J=0.4776, MCC=0.3780, ConfusionMatrix=
[[1705  469]
 [ 119  269]]
Epoch 16, Phase test, Loss=0.6247, Acc=0.7329, AUC=0.7846, TPR=0.6774, TNR=0.7425, J=0.4199, MCC=0.3189, ConfusionMatrix=
[[1603  556]
 [ 120  252]]
Epoch 16 complete in 112.88

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4402, Acc=0.8008, AUC=0.8764, TPR=0.7676, TNR=0.8344, J=0.6020, MCC=0.6032, ConfusionMatrix=
[[3029  601]
 [ 853 2817]]
Epoch 17, Phase val, Loss=0.4619, Acc=0.8193, AUC=0.7901, TPR=0.5799, TNR=0.8620, J=0.4419, MCC=0.3925, ConfusionMatrix=
[[1874  300]
 [ 163  225]]
Epoch 17, Phase test, Loss=0.4577, Acc=0.8167, AUC=0.7782, TPR=0.5618, TNR=0.8606, J=0.4224, MCC=0.3729, ConfusionMatrix=
[[1858  301]
 [ 163  209]]
Epoch 17 complete in 116.73

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4598, Acc=0.7910, AUC=0.8659, TPR=0.7674, TNR=0.8144, J=0.5818, MCC=0.5825, ConfusionMatrix=
[[2980  679]
 [ 847 2794]]
Epoch 18, Phase val, Loss=0.5186, Acc=0.7939, AUC=0.7956, TPR=0.6675, TNR=0.8165, J=0.4840, MCC=0.3971, ConfusionMatrix=
[[1775  399]
 [ 129  259]]
Epoch 18, Phase test, Loss=0.5047, Acc=0.7914, AUC=0.7799, TPR=0.6371, TNR=0.8180, J=0.4551, MCC=0.3727, ConfusionMatrix=
[[1766  393]
 [ 135  237]]
Epoch 18 complete in 117.08

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4508, Acc=0.7995, AUC=0.8702, TPR=0.7574, TNR=0.8395, J=0.5969, MCC=0.5995, ConfusionMatrix=
[[3138  600]
 [ 864 2698]]
Epoch 19, Phase val, Loss=0.5142, Acc=0.8123, AUC=0.7990, TPR=0.6495, TNR=0.8413, J=0.4908, MCC=0.4162, ConfusionMatrix=
[[1829  345]
 [ 136  252]]
Epoch 19, Phase test, Loss=0.5394, Acc=0.7902, AUC=0.7771, TPR=0.6102, TNR=0.8212, J=0.4314, MCC=0.3566, ConfusionMatrix=
[[1773  386]
 [ 145  227]]
Epoch 19 complete in 109.81

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4440, Acc=0.8034, AUC=0.8761, TPR=0.7835, TNR=0.8238, J=0.6074, MCC=0.6076, ConfusionMatrix=
[[2969  635]
 [ 800 2896]]
Epoch 20, Phase val, Loss=0.4809, Acc=0.7767, AUC=0.7905, TPR=0.6701, TNR=0.7958, J=0.4659, MCC=0.3741, ConfusionMatrix=
[[1730  444]
 [ 128  260]]
Epoch 20, Phase test, Loss=0.4967, Acc=0.7697, AUC=0.7745, TPR=0.6344, TNR=0.7930, J=0.4274, MCC=0.3409, ConfusionMatrix=
[[1712  447]
 [ 136  236]]
Epoch 20 complete in 126.27

Early Stop!
Training complete in 40m 57s
The best model val AUC=0.806439623858, test AUC=0.793046860604.
Finish training resnet50scratch-conv1x1ab-maxpool_0

Start training resnet50scratch-conv1x1ab-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6090, Acc=0.6477, AUC=0.7233, TPR=0.6274, TNR=0.6679, J=0.2953, MCC=0.2956, ConfusionMatrix=
[[2440 1213]
 [1359 2288]]
Epoch 0, Phase val, Loss=0.8036, Acc=0.6308, AUC=0.7490, TPR=0.7500, TNR=0.6095, J=0.3595, MCC=0.2593, ConfusionMatrix=
[[1325  849]
 [  97  291]]
New Best AUC=0.7490. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.8261, Acc=0.5994, AUC=0.7433, TPR=0.7473, TNR=0.5739, J=0.3212, MCC=0.2278, ConfusionMatrix=
[[1239  920]
 [  94  278]]
Epoch 0 complete in 137.48

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5539, Acc=0.7149, AUC=0.7920, TPR=0.6517, TNR=0.7781, J=0.4298, MCC=0.4333, ConfusionMatrix=
[[2841  810]
 [1271 2378]]
Epoch 1, Phase val, Loss=0.6024, Acc=0.7467, AUC=0.7689, TPR=0.6186, TNR=0.7695, J=0.3881, MCC=0.3069, ConfusionMatrix=
[[1673  501]
 [ 148  240]]
New Best AUC=0.7689. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5963, Acc=0.7199, AUC=0.7551, TPR=0.6452, TNR=0.7327, J=0.3779, MCC=0.2862, ConfusionMatrix=
[[1582  577]
 [ 132  240]]
Epoch 1 complete in 141.92

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5401, Acc=0.7299, AUC=0.8057, TPR=0.6741, TNR=0.7868, J=0.4609, MCC=0.4636, ConfusionMatrix=
[[2842  770]
 [1202 2486]]
Epoch 2, Phase val, Loss=0.5058, Acc=0.8162, AUC=0.7714, TPR=0.5129, TNR=0.8703, J=0.3832, MCC=0.3517, ConfusionMatrix=
[[1892  282]
 [ 189  199]]
New Best AUC=0.7714. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.4915, Acc=0.8143, AUC=0.7620, TPR=0.5027, TNR=0.8680, J=0.3707, MCC=0.3370, ConfusionMatrix=
[[1874  285]
 [ 185  187]]
Epoch 2 complete in 145.55

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5295, Acc=0.7425, AUC=0.8145, TPR=0.6940, TNR=0.7925, J=0.4865, MCC=0.4885, ConfusionMatrix=
[[2846  745]
 [1135 2574]]
Epoch 3, Phase val, Loss=0.6804, Acc=0.7229, AUC=0.7803, TPR=0.7062, TNR=0.7259, J=0.4320, MCC=0.3270, ConfusionMatrix=
[[1578  596]
 [ 114  274]]
New Best AUC=0.7803. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.6675, Acc=0.6981, AUC=0.7795, TPR=0.7392, TNR=0.6911, J=0.4303, MCC=0.3152, ConfusionMatrix=
[[1492  667]
 [  97  275]]
Epoch 3 complete in 138.45

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5228, Acc=0.7460, AUC=0.8202, TPR=0.6847, TNR=0.8072, J=0.4919, MCC=0.4956, ConfusionMatrix=
[[2951  705]
 [1149 2495]]
Epoch 4, Phase val, Loss=0.4902, Acc=0.8341, AUC=0.7892, TPR=0.5026, TNR=0.8933, J=0.3959, MCC=0.3808, ConfusionMatrix=
[[1942  232]
 [ 193  195]]
New Best AUC=0.7892. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.4831, Acc=0.8372, AUC=0.7808, TPR=0.5054, TNR=0.8944, J=0.3998, MCC=0.3820, ConfusionMatrix=
[[1931  228]
 [ 184  188]]
Epoch 4 complete in 144.61

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5154, Acc=0.7536, AUC=0.8240, TPR=0.6766, TNR=0.8282, J=0.5048, MCC=0.5112, ConfusionMatrix=
[[3070  637]
 [1162 2431]]
Epoch 5, Phase val, Loss=0.5909, Acc=0.7955, AUC=0.7930, TPR=0.6289, TNR=0.8252, J=0.4541, MCC=0.3792, ConfusionMatrix=
[[1794  380]
 [ 144  244]]
New Best AUC=0.7930. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 5, Phase test, Loss=0.5828, Acc=0.7866, AUC=0.7827, TPR=0.6371, TNR=0.8124, J=0.4495, MCC=0.3658, ConfusionMatrix=
[[1754  405]
 [ 135  237]]
Epoch 5 complete in 148.64

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5207, Acc=0.7575, AUC=0.8213, TPR=0.6973, TNR=0.8175, J=0.5147, MCC=0.5186, ConfusionMatrix=
[[2992  668]
 [1102 2538]]
Epoch 6, Phase val, Loss=0.6178, Acc=0.7802, AUC=0.7995, TPR=0.6443, TNR=0.8045, J=0.4488, MCC=0.3653, ConfusionMatrix=
[[1749  425]
 [ 138  250]]
New Best AUC=0.7995. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 6, Phase test, Loss=0.5979, Acc=0.7716, AUC=0.7819, TPR=0.6425, TNR=0.7939, J=0.4364, MCC=0.3479, ConfusionMatrix=
[[1714  445]
 [ 133  239]]
Epoch 6 complete in 153.22

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5063, Acc=0.7660, AUC=0.8331, TPR=0.6944, TNR=0.8362, J=0.5306, MCC=0.5364, ConfusionMatrix=
[[3084  604]
 [1104 2508]]
Epoch 7, Phase val, Loss=0.4609, Acc=0.8279, AUC=0.7990, TPR=0.5438, TNR=0.8786, J=0.4224, MCC=0.3896, ConfusionMatrix=
[[1910  264]
 [ 177  211]]
Epoch 7, Phase test, Loss=0.4508, Acc=0.8309, AUC=0.7875, TPR=0.5780, TNR=0.8745, J=0.4524, MCC=0.4067, ConfusionMatrix=
[[1888  271]
 [ 157  215]]
Epoch 7 complete in 137.13

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5055, Acc=0.7608, AUC=0.8322, TPR=0.7001, TNR=0.8208, J=0.5209, MCC=0.5249, ConfusionMatrix=
[[3014  658]
 [1088 2540]]
Epoch 8, Phase val, Loss=0.4863, Acc=0.8208, AUC=0.7948, TPR=0.5000, TNR=0.8781, J=0.3781, MCC=0.3535, ConfusionMatrix=
[[1909  265]
 [ 194  194]]
Epoch 8, Phase test, Loss=0.4805, Acc=0.8317, AUC=0.7730, TPR=0.4919, TNR=0.8902, J=0.3822, MCC=0.3637, ConfusionMatrix=
[[1922  237]
 [ 189  183]]
Epoch 8 complete in 129.88

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5056, Acc=0.7689, AUC=0.8319, TPR=0.7138, TNR=0.8245, J=0.5383, MCC=0.5415, ConfusionMatrix=
[[2997  638]
 [1049 2616]]
Epoch 9, Phase val, Loss=0.6371, Acc=0.7834, AUC=0.8047, TPR=0.6624, TNR=0.8050, J=0.4673, MCC=0.3792, ConfusionMatrix=
[[1750  424]
 [ 131  257]]
New Best AUC=0.8047. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 9, Phase test, Loss=0.6424, Acc=0.7625, AUC=0.7782, TPR=0.6478, TNR=0.7823, J=0.4302, MCC=0.3389, ConfusionMatrix=
[[1689  470]
 [ 131  241]]
Epoch 9 complete in 145.65

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5010, Acc=0.7692, AUC=0.8349, TPR=0.7076, TNR=0.8319, J=0.5395, MCC=0.5433, ConfusionMatrix=
[[3009  608]
 [1077 2606]]
Epoch 10, Phase val, Loss=0.5203, Acc=0.8111, AUC=0.8105, TPR=0.6237, TNR=0.8445, J=0.4682, MCC=0.4011, ConfusionMatrix=
[[1836  338]
 [ 146  242]]
New Best AUC=0.8105. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 10, Phase test, Loss=0.5010, Acc=0.8064, AUC=0.7944, TPR=0.6317, TNR=0.8365, J=0.4682, MCC=0.3926, ConfusionMatrix=
[[1806  353]
 [ 137  235]]
Epoch 10 complete in 142.36

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4913, Acc=0.7730, AUC=0.8420, TPR=0.7206, TNR=0.8256, J=0.5463, MCC=0.5492, ConfusionMatrix=
[[3007  635]
 [1022 2636]]
Epoch 11, Phase val, Loss=0.5407, Acc=0.7877, AUC=0.8125, TPR=0.6804, TNR=0.8068, J=0.4872, MCC=0.3948, ConfusionMatrix=
[[1754  420]
 [ 124  264]]
New Best AUC=0.8125. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 11, Phase test, Loss=0.5484, Acc=0.7645, AUC=0.7833, TPR=0.6183, TNR=0.7897, J=0.4080, MCC=0.3253, ConfusionMatrix=
[[1705  454]
 [ 142  230]]
Epoch 11 complete in 163.02

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4996, Acc=0.7690, AUC=0.8369, TPR=0.7195, TNR=0.8197, J=0.5393, MCC=0.5416, ConfusionMatrix=
[[2956  650]
 [1036 2658]]
Epoch 12, Phase val, Loss=0.4989, Acc=0.8084, AUC=0.7978, TPR=0.6237, TNR=0.8413, J=0.4650, MCC=0.3967, ConfusionMatrix=
[[1829  345]
 [ 146  242]]
Epoch 12, Phase test, Loss=0.5093, Acc=0.7922, AUC=0.7903, TPR=0.6398, TNR=0.8184, J=0.4582, MCC=0.3752, ConfusionMatrix=
[[1767  392]
 [ 134  238]]
Epoch 12 complete in 140.95

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4887, Acc=0.7736, AUC=0.8438, TPR=0.7195, TNR=0.8261, J=0.5456, MCC=0.5491, ConfusionMatrix=
[[3059  644]
 [1009 2588]]
Epoch 13, Phase val, Loss=0.4464, Acc=0.8181, AUC=0.7843, TPR=0.4562, TNR=0.8827, J=0.3389, MCC=0.3245, ConfusionMatrix=
[[1919  255]
 [ 211  177]]
Epoch 13, Phase test, Loss=0.4198, Acc=0.8305, AUC=0.7880, TPR=0.4839, TNR=0.8902, J=0.3741, MCC=0.3571, ConfusionMatrix=
[[1922  237]
 [ 192  180]]
Epoch 13 complete in 136.17

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4833, Acc=0.7759, AUC=0.8490, TPR=0.7285, TNR=0.8231, J=0.5516, MCC=0.5541, ConfusionMatrix=
[[3010  647]
 [ 989 2654]]
Epoch 14, Phase val, Loss=0.5301, Acc=0.7923, AUC=0.7962, TPR=0.6546, TNR=0.8169, J=0.4716, MCC=0.3881, ConfusionMatrix=
[[1776  398]
 [ 134  254]]
Epoch 14, Phase test, Loss=0.5352, Acc=0.7732, AUC=0.7875, TPR=0.6801, TNR=0.7893, J=0.4694, MCC=0.3703, ConfusionMatrix=
[[1704  455]
 [ 119  253]]
Epoch 14 complete in 154.47

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4858, Acc=0.7745, AUC=0.8465, TPR=0.7313, TNR=0.8186, J=0.5499, MCC=0.5517, ConfusionMatrix=
[[2960  656]
 [ 990 2694]]
Epoch 15, Phase val, Loss=0.5631, Acc=0.7830, AUC=0.8003, TPR=0.6701, TNR=0.8031, J=0.4732, MCC=0.3828, ConfusionMatrix=
[[1746  428]
 [ 128  260]]
Epoch 15, Phase test, Loss=0.5677, Acc=0.7542, AUC=0.7912, TPR=0.6962, TNR=0.7642, J=0.4605, MCC=0.3547, ConfusionMatrix=
[[1650  509]
 [ 113  259]]
Epoch 15 complete in 148.32

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4793, Acc=0.7838, AUC=0.8511, TPR=0.7524, TNR=0.8165, J=0.5688, MCC=0.5696, ConfusionMatrix=
[[2927  658]
 [ 920 2795]]
Epoch 16, Phase val, Loss=0.4426, Acc=0.8208, AUC=0.8098, TPR=0.6160, TNR=0.8574, J=0.4734, MCC=0.4136, ConfusionMatrix=
[[1864  310]
 [ 149  239]]
Epoch 16, Phase test, Loss=0.4409, Acc=0.8242, AUC=0.7910, TPR=0.5887, TNR=0.8648, J=0.4535, MCC=0.4000, ConfusionMatrix=
[[1867  292]
 [ 153  219]]
Epoch 16 complete in 160.08

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4651, Acc=0.7855, AUC=0.8595, TPR=0.7449, TNR=0.8260, J=0.5710, MCC=0.5728, ConfusionMatrix=
[[3015  635]
 [ 931 2719]]
Epoch 17, Phase val, Loss=0.6190, Acc=0.7194, AUC=0.7879, TPR=0.7062, TNR=0.7217, J=0.4279, MCC=0.3231, ConfusionMatrix=
[[1569  605]
 [ 114  274]]
Epoch 17, Phase test, Loss=0.6452, Acc=0.6989, AUC=0.7791, TPR=0.7285, TNR=0.6938, J=0.4223, MCC=0.3100, ConfusionMatrix=
[[1498  661]
 [ 101  271]]
Epoch 17 complete in 157.13

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4587, Acc=0.7955, AUC=0.8624, TPR=0.7469, TNR=0.8416, J=0.5885, MCC=0.5919, ConfusionMatrix=
[[3151  593]
 [ 900 2656]]
Epoch 18, Phase val, Loss=0.4606, Acc=0.8099, AUC=0.7977, TPR=0.5696, TNR=0.8528, J=0.4224, MCC=0.3710, ConfusionMatrix=
[[1854  320]
 [ 167  221]]
Epoch 18, Phase test, Loss=0.4356, Acc=0.8167, AUC=0.8014, TPR=0.6102, TNR=0.8522, J=0.4625, MCC=0.3981, ConfusionMatrix=
[[1840  319]
 [ 145  227]]
Epoch 18 complete in 146.95

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4643, Acc=0.7847, AUC=0.8597, TPR=0.7540, TNR=0.8167, J=0.5706, MCC=0.5712, ConfusionMatrix=
[[2918  655]
 [ 917 2810]]
Epoch 19, Phase val, Loss=0.4577, Acc=0.8345, AUC=0.8000, TPR=0.5799, TNR=0.8799, J=0.4598, MCC=0.4205, ConfusionMatrix=
[[1913  261]
 [ 163  225]]
Epoch 19, Phase test, Loss=0.4526, Acc=0.8313, AUC=0.8052, TPR=0.5645, TNR=0.8773, J=0.4418, MCC=0.4006, ConfusionMatrix=
[[1894  265]
 [ 162  210]]
Epoch 19 complete in 143.07

Early Stop!
Training complete in 48m 35s
The best model val AUC=0.812498221721, test AUC=0.783333831374.
Finish training resnet50scratch-conv1x1ab-avgpool_0

Start training resnet50scratch-conv1x1-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.7172, Acc=0.5592, AUC=0.5815, TPR=0.5387, TNR=0.5794, J=0.1181, MCC=0.1182, ConfusionMatrix=
[[2128 1545]
 [1673 1954]]
Epoch 0, Phase val, Loss=1.0998, Acc=0.1756, AUC=0.6266, TPR=0.9974, TNR=0.0290, J=0.0264, MCC=0.0606, ConfusionMatrix=
[[  63 2111]
 [   1  387]]
New Best AUC=0.6266. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=1.1228, Acc=0.1671, AUC=0.6247, TPR=0.9812, TNR=0.0269, J=0.0080, MCC=0.0180, ConfusionMatrix=
[[  58 2101]
 [   7  365]]
Epoch 0 complete in 151.84

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.6038, Acc=0.6668, AUC=0.7338, TPR=0.6520, TNR=0.6818, J=0.3337, MCC=0.3339, ConfusionMatrix=
[[2485 1160]
 [1272 2383]]
Epoch 1, Phase val, Loss=0.5795, Acc=0.7518, AUC=0.7217, TPR=0.4871, TNR=0.7990, J=0.2861, MCC=0.2387, ConfusionMatrix=
[[1737  437]
 [ 199  189]]
New Best AUC=0.7217. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5507, Acc=0.7582, AUC=0.7323, TPR=0.5296, TNR=0.7976, J=0.3272, MCC=0.2674, ConfusionMatrix=
[[1722  437]
 [ 175  197]]
Epoch 1 complete in 166.05

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5805, Acc=0.6984, AUC=0.7654, TPR=0.6392, TNR=0.7564, J=0.3957, MCC=0.3986, ConfusionMatrix=
[[2786  897]
 [1305 2312]]
Epoch 2, Phase val, Loss=0.4805, Acc=0.7966, AUC=0.7311, TPR=0.4098, TNR=0.8657, J=0.2755, MCC=0.2593, ConfusionMatrix=
[[1882  292]
 [ 229  159]]
New Best AUC=0.7311. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.4715, Acc=0.8155, AUC=0.7311, TPR=0.4301, TNR=0.8819, J=0.3120, MCC=0.2984, ConfusionMatrix=
[[1904  255]
 [ 212  160]]
Epoch 2 complete in 143.12

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5630, Acc=0.7116, AUC=0.7847, TPR=0.6593, TNR=0.7623, J=0.4216, MCC=0.4241, ConfusionMatrix=
[[2828  882]
 [1223 2367]]
Epoch 3, Phase val, Loss=0.5726, Acc=0.7623, AUC=0.7589, TPR=0.5412, TNR=0.8017, J=0.3430, MCC=0.2839, ConfusionMatrix=
[[1743  431]
 [ 178  210]]
New Best AUC=0.7589. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.5644, Acc=0.7704, AUC=0.7634, TPR=0.5833, TNR=0.8027, J=0.3860, MCC=0.3140, ConfusionMatrix=
[[1733  426]
 [ 155  217]]
Epoch 3 complete in 152.12

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5475, Acc=0.7240, AUC=0.7949, TPR=0.6668, TNR=0.7821, J=0.4489, MCC=0.4517, ConfusionMatrix=
[[2832  789]
 [1226 2453]]
Epoch 4, Phase val, Loss=0.6666, Acc=0.6874, AUC=0.7550, TPR=0.6804, TNR=0.6886, J=0.3690, MCC=0.2744, ConfusionMatrix=
[[1497  677]
 [ 124  264]]
Epoch 4, Phase test, Loss=0.6662, Acc=0.6819, AUC=0.7559, TPR=0.7016, TNR=0.6786, J=0.3802, MCC=0.2777, ConfusionMatrix=
[[1465  694]
 [ 111  261]]
Epoch 4 complete in 142.43

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5276, Acc=0.7407, AUC=0.8124, TPR=0.6915, TNR=0.7903, J=0.4818, MCC=0.4841, ConfusionMatrix=
[[2872  762]
 [1131 2535]]
Epoch 5, Phase val, Loss=0.4648, Acc=0.8025, AUC=0.7521, TPR=0.5052, TNR=0.8556, J=0.3607, MCC=0.3238, ConfusionMatrix=
[[1860  314]
 [ 192  196]]
Epoch 5, Phase test, Loss=0.4436, Acc=0.8159, AUC=0.7696, TPR=0.5376, TNR=0.8638, J=0.4015, MCC=0.3587, ConfusionMatrix=
[[1865  294]
 [ 172  200]]
Epoch 5 complete in 159.89

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5091, Acc=0.7530, AUC=0.8296, TPR=0.6993, TNR=0.8045, J=0.5038, MCC=0.5071, ConfusionMatrix=
[[2999  729]
 [1074 2498]]
Epoch 6, Phase val, Loss=0.5092, Acc=0.7865, AUC=0.7526, TPR=0.5026, TNR=0.8372, J=0.3397, MCC=0.2968, ConfusionMatrix=
[[1820  354]
 [ 193  195]]
Epoch 6, Phase test, Loss=0.5031, Acc=0.7949, AUC=0.7681, TPR=0.5833, TNR=0.8314, J=0.4147, MCC=0.3492, ConfusionMatrix=
[[1795  364]
 [ 155  217]]
Epoch 6 complete in 155.70

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5257, Acc=0.7397, AUC=0.8143, TPR=0.6997, TNR=0.7799, J=0.4796, MCC=0.4811, ConfusionMatrix=
[[2842  802]
 [1098 2558]]
Epoch 7, Phase val, Loss=0.4775, Acc=0.8177, AUC=0.7748, TPR=0.5077, TNR=0.8730, J=0.3808, MCC=0.3518, ConfusionMatrix=
[[1898  276]
 [ 191  197]]
New Best AUC=0.7748. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 7, Phase test, Loss=0.4670, Acc=0.8258, AUC=0.7706, TPR=0.5054, TNR=0.8810, J=0.3863, MCC=0.3594, ConfusionMatrix=
[[1902  257]
 [ 184  188]]
Epoch 7 complete in 160.84

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5154, Acc=0.7526, AUC=0.8246, TPR=0.7090, TNR=0.7970, J=0.5059, MCC=0.5077, ConfusionMatrix=
[[2885  735]
 [1071 2609]]
Epoch 8, Phase val, Loss=0.5877, Acc=0.7240, AUC=0.7733, TPR=0.6804, TNR=0.7318, J=0.4122, MCC=0.3141, ConfusionMatrix=
[[1591  583]
 [ 124  264]]
Epoch 8, Phase test, Loss=0.5984, Acc=0.7088, AUC=0.7696, TPR=0.6747, TNR=0.7147, J=0.3894, MCC=0.2906, ConfusionMatrix=
[[1543  616]
 [ 121  251]]
Epoch 8 complete in 164.72

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5091, Acc=0.7527, AUC=0.8296, TPR=0.7109, TNR=0.7943, J=0.5051, MCC=0.5070, ConfusionMatrix=
[[2911  754]
 [1051 2584]]
Epoch 9, Phase val, Loss=0.5361, Acc=0.7873, AUC=0.7809, TPR=0.6005, TNR=0.8206, J=0.4211, MCC=0.3519, ConfusionMatrix=
[[1784  390]
 [ 155  233]]
New Best AUC=0.7809. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 9, Phase test, Loss=0.5365, Acc=0.7878, AUC=0.7679, TPR=0.6183, TNR=0.8170, J=0.4353, MCC=0.3574, ConfusionMatrix=
[[1764  395]
 [ 142  230]]
Epoch 9 complete in 157.89

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4868, Acc=0.7734, AUC=0.8465, TPR=0.7425, TNR=0.8045, J=0.5470, MCC=0.5480, ConfusionMatrix=
[[2930  712]
 [ 942 2716]]
Epoch 10, Phase val, Loss=0.5803, Acc=0.7611, AUC=0.7746, TPR=0.6495, TNR=0.7810, J=0.4305, MCC=0.3422, ConfusionMatrix=
[[1698  476]
 [ 136  252]]
Epoch 10, Phase test, Loss=0.5775, Acc=0.7625, AUC=0.7595, TPR=0.6263, TNR=0.7860, J=0.4124, MCC=0.3271, ConfusionMatrix=
[[1697  462]
 [ 139  233]]
Epoch 10 complete in 166.97

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4850, Acc=0.7675, AUC=0.8480, TPR=0.7499, TNR=0.7860, J=0.5359, MCC=0.5359, ConfusionMatrix=
[[2799  762]
 [ 935 2804]]
Epoch 11, Phase val, Loss=0.5445, Acc=0.7775, AUC=0.7751, TPR=0.6701, TNR=0.7967, J=0.4668, MCC=0.3752, ConfusionMatrix=
[[1732  442]
 [ 128  260]]
Epoch 11, Phase test, Loss=0.5518, Acc=0.7535, AUC=0.7667, TPR=0.6290, TNR=0.7749, J=0.4039, MCC=0.3170, ConfusionMatrix=
[[1673  486]
 [ 138  234]]
Epoch 11 complete in 155.19

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4972, Acc=0.7659, AUC=0.8426, TPR=0.7402, TNR=0.7920, J=0.5323, MCC=0.5328, ConfusionMatrix=
[[2864  752]
 [ 957 2727]]
Epoch 12, Phase val, Loss=0.4642, Acc=0.7982, AUC=0.7890, TPR=0.6005, TNR=0.8335, J=0.4340, MCC=0.3684, ConfusionMatrix=
[[1812  362]
 [ 155  233]]
New Best AUC=0.7890. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 12, Phase test, Loss=0.4710, Acc=0.8013, AUC=0.7610, TPR=0.5914, TNR=0.8374, J=0.4288, MCC=0.3633, ConfusionMatrix=
[[1808  351]
 [ 152  220]]
Epoch 12 complete in 146.80

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4778, Acc=0.7800, AUC=0.8530, TPR=0.7536, TNR=0.8066, J=0.5602, MCC=0.5609, ConfusionMatrix=
[[2932  703]
 [ 903 2762]]
Epoch 13, Phase val, Loss=0.4333, Acc=0.8224, AUC=0.7895, TPR=0.5155, TNR=0.8772, J=0.3926, MCC=0.3646, ConfusionMatrix=
[[1907  267]
 [ 188  200]]
New Best AUC=0.7895. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 13, Phase test, Loss=0.4381, Acc=0.8281, AUC=0.7609, TPR=0.5403, TNR=0.8777, J=0.4180, MCC=0.3822, ConfusionMatrix=
[[1895  264]
 [ 171  201]]
Epoch 13 complete in 158.77

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4761, Acc=0.7789, AUC=0.8550, TPR=0.7522, TNR=0.8058, J=0.5580, MCC=0.5588, ConfusionMatrix=
[[2930  706]
 [ 908 2756]]
Epoch 14, Phase val, Loss=0.6244, Acc=0.7319, AUC=0.7693, TPR=0.6881, TNR=0.7397, J=0.4278, MCC=0.3274, ConfusionMatrix=
[[1608  566]
 [ 121  267]]
Epoch 14, Phase test, Loss=0.6250, Acc=0.7215, AUC=0.7508, TPR=0.6640, TNR=0.7314, J=0.3953, MCC=0.2985, ConfusionMatrix=
[[1579  580]
 [ 125  247]]
Epoch 14 complete in 147.30

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4780, Acc=0.7788, AUC=0.8551, TPR=0.7650, TNR=0.7925, J=0.5575, MCC=0.5577, ConfusionMatrix=
[[2895  758]
 [ 857 2790]]
Epoch 15, Phase val, Loss=0.4753, Acc=0.8048, AUC=0.7941, TPR=0.6186, TNR=0.8381, J=0.4566, MCC=0.3884, ConfusionMatrix=
[[1822  352]
 [ 148  240]]
New Best AUC=0.7941. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 15, Phase test, Loss=0.4782, Acc=0.7977, AUC=0.7688, TPR=0.6290, TNR=0.8268, J=0.4558, MCC=0.3778, ConfusionMatrix=
[[1785  374]
 [ 138  234]]
Epoch 15 complete in 160.67

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4471, Acc=0.8001, AUC=0.8740, TPR=0.7870, TNR=0.8139, J=0.6009, MCC=0.6008, ConfusionMatrix=
[[2904  664]
 [ 795 2937]]
Epoch 16, Phase val, Loss=0.4600, Acc=0.8044, AUC=0.7866, TPR=0.5928, TNR=0.8422, J=0.4350, MCC=0.3742, ConfusionMatrix=
[[1831  343]
 [ 158  230]]
Epoch 16, Phase test, Loss=0.4608, Acc=0.8127, AUC=0.7579, TPR=0.5806, TNR=0.8527, J=0.4334, MCC=0.3761, ConfusionMatrix=
[[1841  318]
 [ 156  216]]
Epoch 16 complete in 132.57

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4553, Acc=0.7964, AUC=0.8680, TPR=0.7714, TNR=0.8209, J=0.5923, MCC=0.5932, ConfusionMatrix=
[[3030  661]
 [ 825 2784]]
Epoch 17, Phase val, Loss=0.5050, Acc=0.7884, AUC=0.7811, TPR=0.6057, TNR=0.8211, J=0.4267, MCC=0.3564, ConfusionMatrix=
[[1785  389]
 [ 153  235]]
Epoch 17, Phase test, Loss=0.5083, Acc=0.7969, AUC=0.7788, TPR=0.6532, TNR=0.8217, J=0.4749, MCC=0.3893, ConfusionMatrix=
[[1774  385]
 [ 129  243]]
Epoch 17 complete in 126.94

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4384, Acc=0.8014, AUC=0.8791, TPR=0.7868, TNR=0.8161, J=0.6028, MCC=0.6031, ConfusionMatrix=
[[2968  669]
 [ 781 2882]]
Epoch 18, Phase val, Loss=0.5184, Acc=0.7869, AUC=0.7796, TPR=0.6546, TNR=0.8105, J=0.4651, MCC=0.3802, ConfusionMatrix=
[[1762  412]
 [ 134  254]]
Epoch 18, Phase test, Loss=0.5073, Acc=0.7843, AUC=0.7654, TPR=0.6075, TNR=0.8147, J=0.4223, MCC=0.3465, ConfusionMatrix=
[[1759  400]
 [ 146  226]]
Epoch 18 complete in 115.40

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.4412, Acc=0.7959, AUC=0.8780, TPR=0.7757, TNR=0.8153, J=0.5910, MCC=0.5916, ConfusionMatrix=
[[3036  688]
 [ 802 2774]]
Epoch 19, Phase val, Loss=0.5659, Acc=0.7607, AUC=0.8022, TPR=0.6856, TNR=0.7741, J=0.4597, MCC=0.3612, ConfusionMatrix=
[[1683  491]
 [ 122  266]]
New Best AUC=0.8022. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 19, Phase test, Loss=0.5934, Acc=0.7400, AUC=0.7659, TPR=0.6747, TNR=0.7513, J=0.4260, MCC=0.3258, ConfusionMatrix=
[[1622  537]
 [ 121  251]]
Epoch 19 complete in 161.60

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.4518, Acc=0.7915, AUC=0.8704, TPR=0.7878, TNR=0.7953, J=0.5832, MCC=0.5831, ConfusionMatrix=
[[2848  733]
 [ 789 2930]]
Epoch 20, Phase val, Loss=0.6051, Acc=0.7471, AUC=0.7924, TPR=0.6985, TNR=0.7557, J=0.4542, MCC=0.3511, ConfusionMatrix=
[[1643  531]
 [ 117  271]]
Epoch 20, Phase test, Loss=0.6367, Acc=0.7361, AUC=0.7698, TPR=0.6882, TNR=0.7443, J=0.4325, MCC=0.3285, ConfusionMatrix=
[[1607  552]
 [ 116  256]]
Epoch 20 complete in 122.95

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.4365, Acc=0.8085, AUC=0.8807, TPR=0.7948, TNR=0.8218, J=0.6166, MCC=0.6169, ConfusionMatrix=
[[3044  660]
 [ 738 2858]]
Epoch 21, Phase val, Loss=0.4764, Acc=0.7869, AUC=0.7815, TPR=0.5902, TNR=0.8220, J=0.4122, MCC=0.3458, ConfusionMatrix=
[[1787  387]
 [ 159  229]]
Epoch 21, Phase test, Loss=0.4730, Acc=0.7961, AUC=0.7643, TPR=0.6102, TNR=0.8282, J=0.4384, MCC=0.3654, ConfusionMatrix=
[[1788  371]
 [ 145  227]]
Epoch 21 complete in 124.40

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.4231, Acc=0.8078, AUC=0.8876, TPR=0.8039, TNR=0.8119, J=0.6158, MCC=0.6157, ConfusionMatrix=
[[2900  672]
 [ 731 2997]]
Epoch 22, Phase val, Loss=0.4775, Acc=0.7873, AUC=0.7999, TPR=0.6469, TNR=0.8123, J=0.4592, MCC=0.3766, ConfusionMatrix=
[[1766  408]
 [ 137  251]]
Epoch 22, Phase test, Loss=0.5063, Acc=0.7878, AUC=0.7644, TPR=0.5941, TNR=0.8212, J=0.4153, MCC=0.3444, ConfusionMatrix=
[[1773  386]
 [ 151  221]]
Epoch 22 complete in 108.03

Epoch 23 starting with learning_rate: [0.005]
Epoch 23, Phase train, Loss=0.4230, Acc=0.8104, AUC=0.8889, TPR=0.8045, TNR=0.8163, J=0.6208, MCC=0.6208, ConfusionMatrix=
[[2995  674]
 [ 710 2921]]
Epoch 23, Phase val, Loss=0.4534, Acc=0.8181, AUC=0.7740, TPR=0.5490, TNR=0.8661, J=0.4151, MCC=0.3743, ConfusionMatrix=
[[1883  291]
 [ 175  213]]
Epoch 23, Phase test, Loss=0.4416, Acc=0.8246, AUC=0.7624, TPR=0.5591, TNR=0.8703, J=0.4295, MCC=0.3854, ConfusionMatrix=
[[1879  280]
 [ 164  208]]
Epoch 23 complete in 104.38

Epoch 24 starting with learning_rate: [0.005]
Epoch 24, Phase train, Loss=0.4106, Acc=0.8170, AUC=0.8955, TPR=0.8143, TNR=0.8197, J=0.6340, MCC=0.6340, ConfusionMatrix=
[[2969  653]
 [ 683 2995]]
Epoch 24, Phase val, Loss=0.4521, Acc=0.7908, AUC=0.7851, TPR=0.5773, TNR=0.8289, J=0.4062, MCC=0.3446, ConfusionMatrix=
[[1802  372]
 [ 164  224]]
Epoch 24, Phase test, Loss=0.4537, Acc=0.8036, AUC=0.7721, TPR=0.5968, TNR=0.8393, J=0.4361, MCC=0.3699, ConfusionMatrix=
[[1812  347]
 [ 150  222]]
Epoch 24 complete in 161.35

Epoch 25 starting with learning_rate: [0.005]
Epoch 25, Phase train, Loss=0.3931, Acc=0.8314, AUC=0.9040, TPR=0.8271, TNR=0.8357, J=0.6628, MCC=0.6628, ConfusionMatrix=
[[3046  599]
 [ 632 3023]]
Epoch 25, Phase val, Loss=0.4747, Acc=0.8033, AUC=0.7802, TPR=0.6263, TNR=0.8349, J=0.4612, MCC=0.3899, ConfusionMatrix=
[[1815  359]
 [ 145  243]]
Epoch 25, Phase test, Loss=0.5136, Acc=0.7851, AUC=0.7398, TPR=0.5860, TNR=0.8194, J=0.4054, MCC=0.3360, ConfusionMatrix=
[[1769  390]
 [ 154  218]]
Epoch 25 complete in 119.65

Epoch 26 starting with learning_rate: [0.005]
Epoch 26, Phase train, Loss=0.4026, Acc=0.8214, AUC=0.8989, TPR=0.8214, TNR=0.8214, J=0.6427, MCC=0.6427, ConfusionMatrix=
[[3030  659]
 [ 645 2966]]
Epoch 26, Phase val, Loss=0.4817, Acc=0.7920, AUC=0.7896, TPR=0.6186, TNR=0.8229, J=0.4415, MCC=0.3685, ConfusionMatrix=
[[1789  385]
 [ 148  240]]
Epoch 26, Phase test, Loss=0.5050, Acc=0.7953, AUC=0.7574, TPR=0.6048, TNR=0.8282, J=0.4330, MCC=0.3613, ConfusionMatrix=
[[1788  371]
 [ 147  225]]
Epoch 26 complete in 111.37

Epoch 27 starting with learning_rate: [0.005]
Epoch 27, Phase train, Loss=0.4040, Acc=0.8230, AUC=0.8990, TPR=0.8251, TNR=0.8209, J=0.6460, MCC=0.6460, ConfusionMatrix=
[[2980  650]
 [ 642 3028]]
Epoch 27, Phase val, Loss=0.4850, Acc=0.7963, AUC=0.7870, TPR=0.6082, TNR=0.8298, J=0.4381, MCC=0.3695, ConfusionMatrix=
[[1804  370]
 [ 152  236]]
Epoch 27, Phase test, Loss=0.5032, Acc=0.7965, AUC=0.7663, TPR=0.6156, TNR=0.8277, J=0.4433, MCC=0.3689, ConfusionMatrix=
[[1787  372]
 [ 143  229]]
Epoch 27 complete in 118.98

Early Stop!
Training complete in 66m 38s
The best model val AUC=0.802181830253, test AUC=0.76592110047.
Finish training resnet50scratch-conv1x1-maxpool_0

Start training resnet50scratch-conv1x1-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6466, Acc=0.6345, AUC=0.6985, TPR=0.6043, TNR=0.6638, J=0.2681, MCC=0.2686, ConfusionMatrix=
[[2462 1247]
 [1421 2170]]
Epoch 0, Phase val, Loss=1.0491, Acc=0.5601, AUC=0.7651, TPR=0.8402, TNR=0.5101, J=0.3503, MCC=0.2521, ConfusionMatrix=
[[1109 1065]
 [  62  326]]
New Best AUC=0.7651. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=1.0096, Acc=0.5207, AUC=0.7566, TPR=0.8387, TNR=0.4660, J=0.3047, MCC=0.2185, ConfusionMatrix=
[[1006 1153]
 [  60  312]]
Epoch 0 complete in 110.49

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5771, Acc=0.7045, AUC=0.7760, TPR=0.6500, TNR=0.7579, J=0.4079, MCC=0.4105, ConfusionMatrix=
[[2796  893]
 [1264 2347]]
Epoch 1, Phase val, Loss=0.5314, Acc=0.8009, AUC=0.7653, TPR=0.5258, TNR=0.8500, J=0.3758, MCC=0.3326, ConfusionMatrix=
[[1848  326]
 [ 184  204]]
New Best AUC=0.7653. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5037, Acc=0.8036, AUC=0.7524, TPR=0.5269, TNR=0.8513, J=0.3782, MCC=0.3322, ConfusionMatrix=
[[1838  321]
 [ 176  196]]
Epoch 1 complete in 131.95

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5482, Acc=0.7185, AUC=0.7979, TPR=0.6543, TNR=0.7815, J=0.4358, MCC=0.4396, ConfusionMatrix=
[[2879  805]
 [1250 2366]]
Epoch 2, Phase val, Loss=0.8063, Acc=0.6534, AUC=0.7738, TPR=0.7526, TNR=0.6357, J=0.3883, MCC=0.2817, ConfusionMatrix=
[[1382  792]
 [  96  292]]
New Best AUC=0.7738. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.7921, Acc=0.6191, AUC=0.7663, TPR=0.7554, TNR=0.5956, J=0.3510, MCC=0.2496, ConfusionMatrix=
[[1286  873]
 [  91  281]]
Epoch 2 complete in 113.34

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5441, Acc=0.7286, AUC=0.8019, TPR=0.6655, TNR=0.7909, J=0.4563, MCC=0.4602, ConfusionMatrix=
[[2908  769]
 [1212 2411]]
Epoch 3, Phase val, Loss=0.5345, Acc=0.7861, AUC=0.7809, TPR=0.5773, TNR=0.8234, J=0.4007, MCC=0.3376, ConfusionMatrix=
[[1790  384]
 [ 164  224]]
New Best AUC=0.7809. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.5136, Acc=0.7942, AUC=0.7788, TPR=0.6102, TNR=0.8258, J=0.4361, MCC=0.3624, ConfusionMatrix=
[[1783  376]
 [ 145  227]]
Epoch 3 complete in 112.81

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5487, Acc=0.7279, AUC=0.8033, TPR=0.6726, TNR=0.7822, J=0.4548, MCC=0.4578, ConfusionMatrix=
[[2884  803]
 [1183 2430]]
Epoch 4, Phase val, Loss=0.4322, Acc=0.8435, AUC=0.7704, TPR=0.3557, TNR=0.9305, J=0.2862, MCC=0.3243, ConfusionMatrix=
[[2023  151]
 [ 250  138]]
Epoch 4, Phase test, Loss=0.4121, Acc=0.8546, AUC=0.7620, TPR=0.3737, TNR=0.9375, J=0.3111, MCC=0.3546, ConfusionMatrix=
[[2024  135]
 [ 233  139]]
Epoch 4 complete in 100.57

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5365, Acc=0.7425, AUC=0.8096, TPR=0.6903, TNR=0.7946, J=0.4849, MCC=0.4876, ConfusionMatrix=
[[2901  750]
 [1130 2519]]
Epoch 5, Phase val, Loss=0.5207, Acc=0.8165, AUC=0.7963, TPR=0.5773, TNR=0.8592, J=0.4366, MCC=0.3864, ConfusionMatrix=
[[1868  306]
 [ 164  224]]
New Best AUC=0.7963. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 5, Phase test, Loss=0.5029, Acc=0.8147, AUC=0.7834, TPR=0.5833, TNR=0.8546, J=0.4379, MCC=0.3808, ConfusionMatrix=
[[1845  314]
 [ 155  217]]
Epoch 5 complete in 155.83

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5122, Acc=0.7552, AUC=0.8253, TPR=0.6923, TNR=0.8197, J=0.5120, MCC=0.5157, ConfusionMatrix=
[[2955  650]
 [1137 2558]]
Epoch 6, Phase val, Loss=0.6023, Acc=0.7705, AUC=0.7912, TPR=0.6649, TNR=0.7893, J=0.4543, MCC=0.3629, ConfusionMatrix=
[[1716  458]
 [ 130  258]]
Epoch 6, Phase test, Loss=0.6029, Acc=0.7618, AUC=0.7832, TPR=0.6640, TNR=0.7786, J=0.4426, MCC=0.3466, ConfusionMatrix=
[[1681  478]
 [ 125  247]]
Epoch 6 complete in 311.53

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5304, Acc=0.7540, AUC=0.8233, TPR=0.7063, TNR=0.8035, J=0.5099, MCC=0.5117, ConfusionMatrix=
[[2875  703]
 [1093 2629]]
Epoch 7, Phase val, Loss=0.6034, Acc=0.7838, AUC=0.7955, TPR=0.6572, TNR=0.8063, J=0.4636, MCC=0.3771, ConfusionMatrix=
[[1753  421]
 [ 133  255]]
Epoch 7, Phase test, Loss=0.5895, Acc=0.7748, AUC=0.7848, TPR=0.6667, TNR=0.7934, J=0.4601, MCC=0.3652, ConfusionMatrix=
[[1713  446]
 [ 124  248]]
Epoch 7 complete in 304.55

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5121, Acc=0.7553, AUC=0.8288, TPR=0.6956, TNR=0.8137, J=0.5093, MCC=0.5132, ConfusionMatrix=
[[3005  688]
 [1098 2509]]
Epoch 8, Phase val, Loss=0.5018, Acc=0.8244, AUC=0.7989, TPR=0.6134, TNR=0.8620, J=0.4754, MCC=0.4184, ConfusionMatrix=
[[1874  300]
 [ 150  238]]
New Best AUC=0.7989. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet50scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 8, Phase test, Loss=0.4748, Acc=0.8127, AUC=0.7891, TPR=0.6022, TNR=0.8490, J=0.4512, MCC=0.3873, ConfusionMatrix=
[[1833  326]
 [ 148  224]]
Epoch 8 complete in 176.93

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4920, Acc=0.7727, AUC=0.8456, TPR=0.7178, TNR=0.8277, J=0.5455, MCC=0.5488, ConfusionMatrix=
[[3021  629]
 [1030 2620]]
Epoch 9, Phase val, Loss=0.4529, Acc=0.8400, AUC=0.7836, TPR=0.5309, TNR=0.8951, J=0.4261, MCC=0.4072, ConfusionMatrix=
[[1946  228]
 [ 182  206]]
Epoch 9, Phase test, Loss=0.4435, Acc=0.8412, AUC=0.7809, TPR=0.5161, TNR=0.8972, J=0.4133, MCC=0.3956, ConfusionMatrix=
[[1937  222]
 [ 180  192]]
Epoch 9 complete in 132.57

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5002, Acc=0.7656, AUC=0.8372, TPR=0.7103, TNR=0.8201, J=0.5304, MCC=0.5338, ConfusionMatrix=
[[3017  662]
 [1049 2572]]
Epoch 10, Phase val, Loss=0.6905, Acc=0.7701, AUC=0.7923, TPR=0.6753, TNR=0.7870, J=0.4623, MCC=0.3679, ConfusionMatrix=
[[1711  463]
 [ 126  262]]
Epoch 10, Phase test, Loss=0.7071, Acc=0.7558, AUC=0.7850, TPR=0.6935, TNR=0.7666, J=0.4601, MCC=0.3552, ConfusionMatrix=
[[1655  504]
 [ 114  258]]
Epoch 10 complete in 115.68

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5116, Acc=0.7618, AUC=0.8360, TPR=0.7220, TNR=0.8008, J=0.5228, MCC=0.5246, ConfusionMatrix=
[[2951  734]
 [1005 2610]]
Epoch 11, Phase val, Loss=0.4037, Acc=0.8493, AUC=0.7981, TPR=0.4639, TNR=0.9181, J=0.3820, MCC=0.3950, ConfusionMatrix=
[[1996  178]
 [ 208  180]]
Epoch 11, Phase test, Loss=0.3849, Acc=0.8621, AUC=0.7872, TPR=0.4812, TNR=0.9277, J=0.4089, MCC=0.4273, ConfusionMatrix=
[[2003  156]
 [ 193  179]]
Epoch 11 complete in 124.83

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5005, Acc=0.7722, AUC=0.8403, TPR=0.7175, TNR=0.8249, J=0.5424, MCC=0.5461, ConfusionMatrix=
[[3067  651]
 [1012 2570]]
Epoch 12, Phase val, Loss=0.5977, Acc=0.7900, AUC=0.7900, TPR=0.6598, TNR=0.8132, J=0.4730, MCC=0.3874, ConfusionMatrix=
[[1768  406]
 [ 132  256]]
Epoch 12, Phase test, Loss=0.5695, Acc=0.7752, AUC=0.7911, TPR=0.6452, TNR=0.7976, J=0.4428, MCC=0.3542, ConfusionMatrix=
[[1722  437]
 [ 132  240]]
Epoch 12 complete in 119.41

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4760, Acc=0.7859, AUC=0.8565, TPR=0.7359, TNR=0.8362, J=0.5721, MCC=0.5749, ConfusionMatrix=
[[3043  596]
 [ 967 2694]]
Epoch 13, Phase val, Loss=0.5586, Acc=0.7935, AUC=0.7949, TPR=0.6778, TNR=0.8142, J=0.4920, MCC=0.4019, ConfusionMatrix=
[[1770  404]
 [ 125  263]]
Epoch 13, Phase test, Loss=0.5362, Acc=0.7811, AUC=0.7959, TPR=0.6371, TNR=0.8059, J=0.4430, MCC=0.3580, ConfusionMatrix=
[[1740  419]
 [ 135  237]]
Epoch 13 complete in 116.10

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4946, Acc=0.7808, AUC=0.8449, TPR=0.7435, TNR=0.8184, J=0.5619, MCC=0.5634, ConfusionMatrix=
[[2978  661]
 [ 939 2722]]
Epoch 14, Phase val, Loss=0.5319, Acc=0.8068, AUC=0.7942, TPR=0.6263, TNR=0.8390, J=0.4653, MCC=0.3955, ConfusionMatrix=
[[1824  350]
 [ 145  243]]
Epoch 14, Phase test, Loss=0.5015, Acc=0.8096, AUC=0.7986, TPR=0.6425, TNR=0.8384, J=0.4808, MCC=0.4031, ConfusionMatrix=
[[1810  349]
 [ 133  239]]
Epoch 14 complete in 137.45

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4596, Acc=0.7967, AUC=0.8651, TPR=0.7522, TNR=0.8398, J=0.5920, MCC=0.5947, ConfusionMatrix=
[[3115  594]
 [ 890 2701]]
Epoch 15, Phase val, Loss=0.5607, Acc=0.7373, AUC=0.7525, TPR=0.6469, TNR=0.7534, J=0.4004, MCC=0.3111, ConfusionMatrix=
[[1638  536]
 [ 137  251]]
Epoch 15, Phase test, Loss=0.5521, Acc=0.7499, AUC=0.7608, TPR=0.6532, TNR=0.7666, J=0.4198, MCC=0.3259, ConfusionMatrix=
[[1655  504]
 [ 129  243]]
Epoch 15 complete in 108.47

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4773, Acc=0.7878, AUC=0.8547, TPR=0.7462, TNR=0.8292, J=0.5754, MCC=0.5775, ConfusionMatrix=
[[3034  625]
 [ 924 2717]]
Epoch 16, Phase val, Loss=0.5120, Acc=0.8357, AUC=0.7802, TPR=0.5541, TNR=0.8859, J=0.4400, MCC=0.4100, ConfusionMatrix=
[[1926  248]
 [ 173  215]]
Epoch 16, Phase test, Loss=0.4570, Acc=0.8424, AUC=0.7898, TPR=0.5806, TNR=0.8874, J=0.4681, MCC=0.4302, ConfusionMatrix=
[[1916  243]
 [ 156  216]]
Epoch 16 complete in 118.50

Early Stop!
Training complete in 41m 31s
The best model val AUC=0.798909796185, test AUC=0.789067519312.
Finish training resnet50scratch-conv1x1-avgpool_0

Start training resnet18-conv1x1ab-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6207, Acc=0.6462, AUC=0.7186, TPR=0.7201, TNR=0.5726, J=0.2927, MCC=0.2959, ConfusionMatrix=
[[2095 1564]
 [1019 2622]]
Epoch 0, Phase val, Loss=0.5400, Acc=0.7920, AUC=0.8025, TPR=0.6392, TNR=0.8192, J=0.4584, MCC=0.3794, ConfusionMatrix=
[[1781  393]
 [ 140  248]]
New Best AUC=0.8025. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.5910, Acc=0.7732, AUC=0.7859, TPR=0.6640, TNR=0.7920, J=0.4560, MCC=0.3616, ConfusionMatrix=
[[1710  449]
 [ 125  247]]
Epoch 0 complete in 113.39

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4917, Acc=0.7692, AUC=0.8449, TPR=0.7314, TNR=0.8075, J=0.5390, MCC=0.5403, ConfusionMatrix=
[[2924  697]
 [ 988 2691]]
Epoch 1, Phase val, Loss=0.5137, Acc=0.7881, AUC=0.8119, TPR=0.6675, TNR=0.8096, J=0.4771, MCC=0.3886, ConfusionMatrix=
[[1760  414]
 [ 129  259]]
New Best AUC=0.8119. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5727, Acc=0.7531, AUC=0.7917, TPR=0.6855, TNR=0.7647, J=0.4502, MCC=0.3474, ConfusionMatrix=
[[1651  508]
 [ 117  255]]
Epoch 1 complete in 142.45

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4536, Acc=0.7973, AUC=0.8684, TPR=0.7556, TNR=0.8389, J=0.5945, MCC=0.5966, ConfusionMatrix=
[[3062  588]
 [ 892 2758]]
Epoch 2, Phase val, Loss=0.5366, Acc=0.7697, AUC=0.8023, TPR=0.7062, TNR=0.7810, J=0.4872, MCC=0.3839, ConfusionMatrix=
[[1698  476]
 [ 114  274]]
Epoch 2, Phase test, Loss=0.5994, Acc=0.7463, AUC=0.7903, TPR=0.7312, TNR=0.7490, J=0.4801, MCC=0.3640, ConfusionMatrix=
[[1617  542]
 [ 100  272]]
Epoch 2 complete in 141.60

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4328, Acc=0.8093, AUC=0.8821, TPR=0.7865, TNR=0.8320, J=0.6185, MCC=0.6192, ConfusionMatrix=
[[3045  615]
 [ 777 2863]]
Epoch 3, Phase val, Loss=0.5121, Acc=0.7869, AUC=0.7956, TPR=0.6804, TNR=0.8059, J=0.4863, MCC=0.3937, ConfusionMatrix=
[[1752  422]
 [ 124  264]]
Epoch 3, Phase test, Loss=0.5566, Acc=0.7740, AUC=0.7895, TPR=0.6909, TNR=0.7883, J=0.4792, MCC=0.3770, ConfusionMatrix=
[[1702  457]
 [ 115  257]]
Epoch 3 complete in 169.93

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3897, Acc=0.8323, AUC=0.9060, TPR=0.8198, TNR=0.8447, J=0.6646, MCC=0.6648, ConfusionMatrix=
[[3096  569]
 [ 655 2980]]
Epoch 4, Phase val, Loss=0.5326, Acc=0.7842, AUC=0.8173, TPR=0.7216, TNR=0.7953, J=0.5170, MCC=0.4114, ConfusionMatrix=
[[1729  445]
 [ 108  280]]
New Best AUC=0.8173. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.6222, Acc=0.7404, AUC=0.7926, TPR=0.7419, TNR=0.7402, J=0.4821, MCC=0.3628, ConfusionMatrix=
[[1598  561]
 [  96  276]]
Epoch 4 complete in 213.33

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3760, Acc=0.8399, AUC=0.9120, TPR=0.8300, TNR=0.8498, J=0.6798, MCC=0.6799, ConfusionMatrix=
[[3089  546]
 [ 623 3042]]
Epoch 5, Phase val, Loss=0.3987, Acc=0.8263, AUC=0.7967, TPR=0.4768, TNR=0.8887, J=0.3655, MCC=0.3516, ConfusionMatrix=
[[1932  242]
 [ 203  185]]
Epoch 5, Phase test, Loss=0.4200, Acc=0.8439, AUC=0.7673, TPR=0.5753, TNR=0.8902, J=0.4655, MCC=0.4307, ConfusionMatrix=
[[1922  237]
 [ 158  214]]
Epoch 5 complete in 170.93

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3500, Acc=0.8523, AUC=0.9247, TPR=0.8544, TNR=0.8502, J=0.7047, MCC=0.7047, ConfusionMatrix=
[[3111  548]
 [ 530 3111]]
Epoch 6, Phase val, Loss=0.4683, Acc=0.8286, AUC=0.7876, TPR=0.5515, TNR=0.8781, J=0.4297, MCC=0.3950, ConfusionMatrix=
[[1909  265]
 [ 174  214]]
Epoch 6, Phase test, Loss=0.5252, Acc=0.8396, AUC=0.7593, TPR=0.6129, TNR=0.8786, J=0.4916, MCC=0.4405, ConfusionMatrix=
[[1897  262]
 [ 144  228]]
Epoch 6 complete in 160.22

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3339, Acc=0.8619, AUC=0.9314, TPR=0.8592, TNR=0.8647, J=0.7239, MCC=0.7239, ConfusionMatrix=
[[3138  491]
 [ 517 3154]]
Epoch 7, Phase val, Loss=0.4746, Acc=0.8189, AUC=0.7927, TPR=0.5876, TNR=0.8602, J=0.4478, MCC=0.3957, ConfusionMatrix=
[[1870  304]
 [ 160  228]]
Epoch 7, Phase test, Loss=0.5001, Acc=0.8238, AUC=0.7751, TPR=0.6667, TNR=0.8509, J=0.5175, MCC=0.4387, ConfusionMatrix=
[[1837  322]
 [ 124  248]]
Epoch 7 complete in 126.24

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3057, Acc=0.8712, AUC=0.9426, TPR=0.8687, TNR=0.8737, J=0.7424, MCC=0.7424, ConfusionMatrix=
[[3224  466]
 [ 474 3136]]
Epoch 8, Phase val, Loss=0.4752, Acc=0.8130, AUC=0.7865, TPR=0.5464, TNR=0.8606, J=0.4070, MCC=0.3641, ConfusionMatrix=
[[1871  303]
 [ 176  212]]
Epoch 8, Phase test, Loss=0.5213, Acc=0.8024, AUC=0.7567, TPR=0.5941, TNR=0.8384, J=0.4324, MCC=0.3666, ConfusionMatrix=
[[1810  349]
 [ 151  221]]
Epoch 8 complete in 130.82

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2824, Acc=0.8863, AUC=0.9510, TPR=0.8948, TNR=0.8776, J=0.7725, MCC=0.7726, ConfusionMatrix=
[[3177  443]
 [ 387 3293]]
Epoch 9, Phase val, Loss=0.4449, Acc=0.8247, AUC=0.7935, TPR=0.5103, TNR=0.8809, J=0.3912, MCC=0.3663, ConfusionMatrix=
[[1915  259]
 [ 190  198]]
Epoch 9, Phase test, Loss=0.4869, Acc=0.8309, AUC=0.7679, TPR=0.5645, TNR=0.8768, J=0.4413, MCC=0.3999, ConfusionMatrix=
[[1893  266]
 [ 162  210]]
Epoch 9 complete in 128.45

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.2713, Acc=0.8914, AUC=0.9543, TPR=0.8979, TNR=0.8849, J=0.7828, MCC=0.7828, ConfusionMatrix=
[[3253  423]
 [ 370 3254]]
Epoch 10, Phase val, Loss=0.4834, Acc=0.8392, AUC=0.7780, TPR=0.4794, TNR=0.9034, J=0.3828, MCC=0.3796, ConfusionMatrix=
[[1964  210]
 [ 202  186]]
Epoch 10, Phase test, Loss=0.4959, Acc=0.8424, AUC=0.7642, TPR=0.5538, TNR=0.8921, J=0.4458, MCC=0.4169, ConfusionMatrix=
[[1926  233]
 [ 166  206]]
Epoch 10 complete in 127.78

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.2475, Acc=0.9004, AUC=0.9620, TPR=0.9097, TNR=0.8911, J=0.8008, MCC=0.8010, ConfusionMatrix=
[[3250  397]
 [ 330 3323]]
Epoch 11, Phase val, Loss=0.5515, Acc=0.8095, AUC=0.7837, TPR=0.5825, TNR=0.8500, J=0.4325, MCC=0.3771, ConfusionMatrix=
[[1848  326]
 [ 162  226]]
Epoch 11, Phase test, Loss=0.6052, Acc=0.8155, AUC=0.7766, TPR=0.6290, TNR=0.8476, J=0.4766, MCC=0.4058, ConfusionMatrix=
[[1830  329]
 [ 138  234]]
Epoch 11 complete in 149.10

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.2455, Acc=0.9027, AUC=0.9619, TPR=0.9194, TNR=0.8857, J=0.8051, MCC=0.8058, ConfusionMatrix=
[[3201  413]
 [ 297 3389]]
Epoch 12, Phase val, Loss=0.5247, Acc=0.8279, AUC=0.7809, TPR=0.5052, TNR=0.8855, J=0.3906, MCC=0.3696, ConfusionMatrix=
[[1925  249]
 [ 192  196]]
Epoch 12, Phase test, Loss=0.5793, Acc=0.8198, AUC=0.7571, TPR=0.5699, TNR=0.8629, J=0.4328, MCC=0.3826, ConfusionMatrix=
[[1863  296]
 [ 160  212]]
Epoch 12 complete in 134.72

Early Stop!
Training complete in 31m 49s
The best model val AUC=0.817319729891, test AUC=0.792579947905.
Finish training resnet18-conv1x1ab-maxpool_0

Start training resnet18-conv1x1ab-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6097, Acc=0.6677, AUC=0.7387, TPR=0.7376, TNR=0.5987, J=0.3363, MCC=0.3395, ConfusionMatrix=
[[2201 1475]
 [ 951 2673]]
Epoch 0, Phase val, Loss=0.6291, Acc=0.7268, AUC=0.7859, TPR=0.7113, TNR=0.7295, J=0.4409, MCC=0.3343, ConfusionMatrix=
[[1586  588]
 [ 112  276]]
New Best AUC=0.7859. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6669, Acc=0.6736, AUC=0.7764, TPR=0.7151, TNR=0.6665, J=0.3816, MCC=0.2771, ConfusionMatrix=
[[1439  720]
 [ 106  266]]
Epoch 0 complete in 128.20

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4716, Acc=0.7753, AUC=0.8561, TPR=0.7417, TNR=0.8096, J=0.5514, MCC=0.5524, ConfusionMatrix=
[[2926  688]
 [ 952 2734]]
Epoch 1, Phase val, Loss=0.4153, Acc=0.8384, AUC=0.8099, TPR=0.5619, TNR=0.8878, J=0.4496, MCC=0.4192, ConfusionMatrix=
[[1930  244]
 [ 170  218]]
New Best AUC=0.8099. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.4359, Acc=0.8388, AUC=0.7934, TPR=0.5806, TNR=0.8833, J=0.4639, MCC=0.4231, ConfusionMatrix=
[[1907  252]
 [ 156  216]]
Epoch 1 complete in 144.71

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4540, Acc=0.7904, AUC=0.8696, TPR=0.7512, TNR=0.8294, J=0.5805, MCC=0.5824, ConfusionMatrix=
[[3038  625]
 [ 905 2732]]
Epoch 2, Phase val, Loss=0.6050, Acc=0.7424, AUC=0.8095, TPR=0.7577, TNR=0.7397, J=0.4974, MCC=0.3776, ConfusionMatrix=
[[1608  566]
 [  94  294]]
Epoch 2, Phase test, Loss=0.6509, Acc=0.7116, AUC=0.7980, TPR=0.7392, TNR=0.7068, J=0.4461, MCC=0.3293, ConfusionMatrix=
[[1526  633]
 [  97  275]]
Epoch 2 complete in 136.87

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4073, Acc=0.8107, AUC=0.8961, TPR=0.7967, TNR=0.8250, J=0.6217, MCC=0.6218, ConfusionMatrix=
[[2979  632]
 [ 750 2939]]
Epoch 3, Phase val, Loss=0.3956, Acc=0.8361, AUC=0.8032, TPR=0.5232, TNR=0.8919, J=0.4151, MCC=0.3953, ConfusionMatrix=
[[1939  235]
 [ 185  203]]
Epoch 3, Phase test, Loss=0.4068, Acc=0.8384, AUC=0.7921, TPR=0.6022, TNR=0.8791, J=0.4813, MCC=0.4330, ConfusionMatrix=
[[1898  261]
 [ 148  224]]
Epoch 3 complete in 143.47

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3754, Acc=0.8366, AUC=0.9126, TPR=0.8333, TNR=0.8398, J=0.6731, MCC=0.6732, ConfusionMatrix=
[[3067  585]
 [ 608 3040]]
Epoch 4, Phase val, Loss=0.5185, Acc=0.8005, AUC=0.7991, TPR=0.6675, TNR=0.8243, J=0.4918, MCC=0.4071, ConfusionMatrix=
[[1792  382]
 [ 129  259]]
Epoch 4, Phase test, Loss=0.5200, Acc=0.7902, AUC=0.7940, TPR=0.6640, TNR=0.8119, J=0.4759, MCC=0.3852, ConfusionMatrix=
[[1753  406]
 [ 125  247]]
Epoch 4 complete in 141.29

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3407, Acc=0.8578, AUC=0.9284, TPR=0.8654, TNR=0.8499, J=0.7154, MCC=0.7155, ConfusionMatrix=
[[3053  539]
 [ 499 3209]]
Epoch 5, Phase val, Loss=0.4551, Acc=0.8142, AUC=0.7706, TPR=0.5335, TNR=0.8643, J=0.3978, MCC=0.3593, ConfusionMatrix=
[[1879  295]
 [ 181  207]]
Epoch 5, Phase test, Loss=0.4475, Acc=0.8198, AUC=0.7731, TPR=0.5860, TNR=0.8601, J=0.4461, MCC=0.3910, ConfusionMatrix=
[[1857  302]
 [ 154  218]]
Epoch 5 complete in 131.48

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2949, Acc=0.8779, AUC=0.9460, TPR=0.8816, TNR=0.8743, J=0.7558, MCC=0.7559, ConfusionMatrix=
[[3171  456]
 [ 435 3238]]
Epoch 6, Phase val, Loss=0.4830, Acc=0.8154, AUC=0.7847, TPR=0.5825, TNR=0.8569, J=0.4394, MCC=0.3870, ConfusionMatrix=
[[1863  311]
 [ 162  226]]
Epoch 6, Phase test, Loss=0.5122, Acc=0.8072, AUC=0.7661, TPR=0.5618, TNR=0.8495, J=0.4113, MCC=0.3569, ConfusionMatrix=
[[1834  325]
 [ 163  209]]
Epoch 6 complete in 132.98

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2725, Acc=0.8907, AUC=0.9532, TPR=0.9041, TNR=0.8769, J=0.7810, MCC=0.7815, ConfusionMatrix=
[[3156  443]
 [ 355 3346]]
Epoch 7, Phase val, Loss=0.6607, Acc=0.7326, AUC=0.7682, TPR=0.6881, TNR=0.7406, J=0.4287, MCC=0.3283, ConfusionMatrix=
[[1610  564]
 [ 121  267]]
Epoch 7, Phase test, Loss=0.7034, Acc=0.7088, AUC=0.7585, TPR=0.6909, TNR=0.7119, J=0.4028, MCC=0.2995, ConfusionMatrix=
[[1537  622]
 [ 115  257]]
Epoch 7 complete in 165.76

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2553, Acc=0.8981, AUC=0.9589, TPR=0.9115, TNR=0.8846, J=0.7961, MCC=0.7964, ConfusionMatrix=
[[3218  420]
 [ 324 3338]]
Epoch 8, Phase val, Loss=0.5448, Acc=0.8501, AUC=0.7645, TPR=0.3505, TNR=0.9393, J=0.2898, MCC=0.3395, ConfusionMatrix=
[[2042  132]
 [ 252  136]]
Epoch 8, Phase test, Loss=0.5148, Acc=0.8641, AUC=0.7601, TPR=0.4274, TNR=0.9393, J=0.3667, MCC=0.4077, ConfusionMatrix=
[[2028  131]
 [ 213  159]]
Epoch 8 complete in 128.65

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2312, Acc=0.9121, AUC=0.9658, TPR=0.9272, TNR=0.8973, J=0.8245, MCC=0.8246, ConfusionMatrix=
[[3319  380]
 [ 262 3339]]
Epoch 9, Phase val, Loss=0.5823, Acc=0.7951, AUC=0.7666, TPR=0.5103, TNR=0.8459, J=0.3562, MCC=0.3146, ConfusionMatrix=
[[1839  335]
 [ 190  198]]
Epoch 9, Phase test, Loss=0.5461, Acc=0.8119, AUC=0.7808, TPR=0.5565, TNR=0.8560, J=0.4124, MCC=0.3619, ConfusionMatrix=
[[1848  311]
 [ 165  207]]
Epoch 9 complete in 139.01

Early Stop!
Training complete in 23m 12s
The best model val AUC=0.809943427005, test AUC=0.793447782974.
Finish training resnet18-conv1x1ab-avgpool_0

Start training resnet18-conv1x1-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6397, Acc=0.6332, AUC=0.6800, TPR=0.6508, TNR=0.6154, J=0.2662, MCC=0.2663, ConfusionMatrix=
[[2237 1398]
 [1280 2385]]
Epoch 0, Phase val, Loss=0.7549, Acc=0.5948, AUC=0.7695, TPR=0.8454, TNR=0.5501, J=0.3955, MCC=0.2836, ConfusionMatrix=
[[1196  978]
 [  60  328]]
New Best AUC=0.7695. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.7436, Acc=0.5804, AUC=0.7473, TPR=0.7688, TNR=0.5479, J=0.3168, MCC=0.2243, ConfusionMatrix=
[[1183  976]
 [  86  286]]
Epoch 0 complete in 119.69

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5146, Acc=0.7497, AUC=0.8288, TPR=0.7059, TNR=0.7929, J=0.4989, MCC=0.5009, ConfusionMatrix=
[[2914  761]
 [1066 2559]]
Epoch 1, Phase val, Loss=0.3996, Acc=0.8513, AUC=0.7932, TPR=0.4485, TNR=0.9232, J=0.3716, MCC=0.3922, ConfusionMatrix=
[[2007  167]
 [ 214  174]]
New Best AUC=0.7932. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.3954, Acc=0.8665, AUC=0.7930, TPR=0.4597, TNR=0.9365, J=0.3962, MCC=0.4291, ConfusionMatrix=
[[2022  137]
 [ 201  171]]
Epoch 1 complete in 124.80

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4704, Acc=0.7860, AUC=0.8578, TPR=0.7570, TNR=0.8160, J=0.5729, MCC=0.5736, ConfusionMatrix=
[[2935  662]
 [ 900 2803]]
Epoch 2, Phase val, Loss=0.4755, Acc=0.8013, AUC=0.8198, TPR=0.6598, TNR=0.8266, J=0.4864, MCC=0.4043, ConfusionMatrix=
[[1797  377]
 [ 132  256]]
New Best AUC=0.8198. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-maxpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.4852, Acc=0.8009, AUC=0.7942, TPR=0.6559, TNR=0.8258, J=0.4818, MCC=0.3966, ConfusionMatrix=
[[1783  376]
 [ 128  244]]
Epoch 2 complete in 148.92

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.4578, Acc=0.7927, AUC=0.8660, TPR=0.7497, TNR=0.8343, J=0.5839, MCC=0.5865, ConfusionMatrix=
[[3101  616]
 [ 897 2686]]
Epoch 3, Phase val, Loss=0.4133, Acc=0.8337, AUC=0.8079, TPR=0.5722, TNR=0.8804, J=0.4526, MCC=0.4151, ConfusionMatrix=
[[1914  260]
 [ 166  222]]
Epoch 3, Phase test, Loss=0.4188, Acc=0.8384, AUC=0.7926, TPR=0.5914, TNR=0.8810, J=0.4724, MCC=0.4277, ConfusionMatrix=
[[1902  257]
 [ 152  220]]
Epoch 3 complete in 125.59

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.4250, Acc=0.8118, AUC=0.8866, TPR=0.7873, TNR=0.8372, J=0.6246, MCC=0.6249, ConfusionMatrix=
[[2994  582]
 [ 792 2932]]
Epoch 4, Phase val, Loss=0.4815, Acc=0.8005, AUC=0.8078, TPR=0.6649, TNR=0.8247, J=0.4897, MCC=0.4057, ConfusionMatrix=
[[1793  381]
 [ 130  258]]
Epoch 4, Phase test, Loss=0.5213, Acc=0.7823, AUC=0.7920, TPR=0.6935, TNR=0.7976, J=0.4911, MCC=0.3896, ConfusionMatrix=
[[1722  437]
 [ 114  258]]
Epoch 4 complete in 86.74

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4174, Acc=0.8208, AUC=0.8909, TPR=0.8072, TNR=0.8346, J=0.6417, MCC=0.6419, ConfusionMatrix=
[[3037  602]
 [ 706 2955]]
Epoch 5, Phase val, Loss=0.4903, Acc=0.7982, AUC=0.8009, TPR=0.6392, TNR=0.8266, J=0.4658, MCC=0.3888, ConfusionMatrix=
[[1797  377]
 [ 140  248]]
Epoch 5, Phase test, Loss=0.5126, Acc=0.7981, AUC=0.7748, TPR=0.6720, TNR=0.8198, J=0.4919, MCC=0.4009, ConfusionMatrix=
[[1770  389]
 [ 122  250]]
Epoch 5 complete in 62.07

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.3787, Acc=0.8374, AUC=0.9113, TPR=0.8335, TNR=0.8415, J=0.6749, MCC=0.6748, ConfusionMatrix=
[[3020  569]
 [ 618 3093]]
Epoch 6, Phase val, Loss=0.5826, Acc=0.7681, AUC=0.8048, TPR=0.7113, TNR=0.7783, J=0.4896, MCC=0.3846, ConfusionMatrix=
[[1692  482]
 [ 112  276]]
Epoch 6, Phase test, Loss=0.5948, Acc=0.7629, AUC=0.7865, TPR=0.6909, TNR=0.7754, J=0.4662, MCC=0.3626, ConfusionMatrix=
[[1674  485]
 [ 115  257]]
Epoch 6 complete in 97.03

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.3711, Acc=0.8405, AUC=0.9147, TPR=0.8400, TNR=0.8411, J=0.6811, MCC=0.6811, ConfusionMatrix=
[[3069  580]
 [ 584 3067]]
Epoch 7, Phase val, Loss=0.5457, Acc=0.7904, AUC=0.7863, TPR=0.6598, TNR=0.8137, J=0.4735, MCC=0.3879, ConfusionMatrix=
[[1769  405]
 [ 132  256]]
Epoch 7, Phase test, Loss=0.5770, Acc=0.7811, AUC=0.7776, TPR=0.6882, TNR=0.7971, J=0.4853, MCC=0.3852, ConfusionMatrix=
[[1721  438]
 [ 116  256]]
Epoch 7 complete in 77.87

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.3553, Acc=0.8541, AUC=0.9219, TPR=0.8516, TNR=0.8566, J=0.7082, MCC=0.7082, ConfusionMatrix=
[[3154  528]
 [ 537 3081]]
Epoch 8, Phase val, Loss=0.4058, Acc=0.8302, AUC=0.8129, TPR=0.6134, TNR=0.8689, J=0.4823, MCC=0.4290, ConfusionMatrix=
[[1889  285]
 [ 150  238]]
Epoch 8, Phase test, Loss=0.4612, Acc=0.8262, AUC=0.7645, TPR=0.6156, TNR=0.8624, J=0.4780, MCC=0.4172, ConfusionMatrix=
[[1862  297]
 [ 143  229]]
Epoch 8 complete in 65.62

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.3361, Acc=0.8566, AUC=0.9307, TPR=0.8636, TNR=0.8499, J=0.7135, MCC=0.7133, ConfusionMatrix=
[[3176  561]
 [ 486 3077]]
Epoch 9, Phase val, Loss=0.4190, Acc=0.8208, AUC=0.7862, TPR=0.5206, TNR=0.8744, J=0.3950, MCC=0.3644, ConfusionMatrix=
[[1901  273]
 [ 186  202]]
Epoch 9, Phase test, Loss=0.4512, Acc=0.8258, AUC=0.7541, TPR=0.5887, TNR=0.8666, J=0.4553, MCC=0.4028, ConfusionMatrix=
[[1871  288]
 [ 153  219]]
Epoch 9 complete in 94.63

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.3149, Acc=0.8742, AUC=0.9382, TPR=0.8864, TNR=0.8617, J=0.7482, MCC=0.7486, ConfusionMatrix=
[[3104  498]
 [ 420 3278]]
Epoch 10, Phase val, Loss=0.5606, Acc=0.8205, AUC=0.8048, TPR=0.6366, TNR=0.8533, J=0.4899, MCC=0.4233, ConfusionMatrix=
[[1855  319]
 [ 141  247]]
Epoch 10, Phase test, Loss=0.5759, Acc=0.8100, AUC=0.7929, TPR=0.6478, TNR=0.8379, J=0.4857, MCC=0.4065, ConfusionMatrix=
[[1809  350]
 [ 131  241]]
Epoch 10 complete in 80.95

Early Stop!
Training complete in 18m 4s
The best model val AUC=0.819830067622, test AUC=0.794203558995.
Finish training resnet18-conv1x1-maxpool_0

Start training resnet18-conv1x1-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5546, Acc=0.7116, AUC=0.7901, TPR=0.7233, TNR=0.6997, J=0.4230, MCC=0.4231, ConfusionMatrix=
[[2523 1083]
 [1022 2672]]
Epoch 0, Phase val, Loss=0.5113, Acc=0.8037, AUC=0.8045, TPR=0.6649, TNR=0.8284, J=0.4934, MCC=0.4105, ConfusionMatrix=
[[1801  373]
 [ 130  258]]
New Best AUC=0.8045. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.5172, Acc=0.7859, AUC=0.7869, TPR=0.6828, TNR=0.8036, J=0.4864, MCC=0.3889, ConfusionMatrix=
[[1735  424]
 [ 118  254]]
Epoch 0 complete in 63.00

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.4650, Acc=0.7870, AUC=0.8624, TPR=0.7644, TNR=0.8098, J=0.5742, MCC=0.5747, ConfusionMatrix=
[[2938  690]
 [ 865 2807]]
Epoch 1, Phase val, Loss=0.5393, Acc=0.7674, AUC=0.8066, TPR=0.6933, TNR=0.7806, J=0.4739, MCC=0.3739, ConfusionMatrix=
[[1697  477]
 [ 119  269]]
New Best AUC=0.8066. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18-conv1x1-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5812, Acc=0.7357, AUC=0.7780, TPR=0.7097, TNR=0.7402, J=0.4498, MCC=0.3398, ConfusionMatrix=
[[1598  561]
 [ 108  264]]
Epoch 1 complete in 96.48

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.4189, Acc=0.8101, AUC=0.8901, TPR=0.7911, TNR=0.8287, J=0.6198, MCC=0.6204, ConfusionMatrix=
[[3062  633]
 [ 753 2852]]
Epoch 2, Phase val, Loss=0.5020, Acc=0.7974, AUC=0.7514, TPR=0.5876, TNR=0.8349, J=0.4225, MCC=0.3604, ConfusionMatrix=
[[1815  359]
 [ 160  228]]
Epoch 2, Phase test, Loss=0.5030, Acc=0.8009, AUC=0.7560, TPR=0.5995, TNR=0.8356, J=0.4350, MCC=0.3669, ConfusionMatrix=
[[1804  355]
 [ 149  223]]
Epoch 2 complete in 80.72

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.3850, Acc=0.8326, AUC=0.9087, TPR=0.8235, TNR=0.8417, J=0.6651, MCC=0.6653, ConfusionMatrix=
[[3083  580]
 [ 642 2995]]
Epoch 3, Phase val, Loss=0.5515, Acc=0.7748, AUC=0.7926, TPR=0.6701, TNR=0.7935, J=0.4636, MCC=0.3715, ConfusionMatrix=
[[1725  449]
 [ 128  260]]
Epoch 3, Phase test, Loss=0.5557, Acc=0.7689, AUC=0.7692, TPR=0.6505, TNR=0.7893, J=0.4398, MCC=0.3486, ConfusionMatrix=
[[1704  455]
 [ 130  242]]
Epoch 3 complete in 61.59

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.3492, Acc=0.8547, AUC=0.9248, TPR=0.8578, TNR=0.8516, J=0.7094, MCC=0.7093, ConfusionMatrix=
[[3139  547]
 [ 514 3100]]
Epoch 4, Phase val, Loss=0.4551, Acc=0.8298, AUC=0.7878, TPR=0.5593, TNR=0.8781, J=0.4374, MCC=0.4012, ConfusionMatrix=
[[1909  265]
 [ 171  217]]
Epoch 4, Phase test, Loss=0.4794, Acc=0.8242, AUC=0.7630, TPR=0.5349, TNR=0.8740, J=0.4090, MCC=0.3721, ConfusionMatrix=
[[1887  272]
 [ 173  199]]
Epoch 4 complete in 93.86

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.3210, Acc=0.8681, AUC=0.9359, TPR=0.8742, TNR=0.8620, J=0.7363, MCC=0.7363, ConfusionMatrix=
[[3174  508]
 [ 455 3163]]
Epoch 5, Phase val, Loss=0.4475, Acc=0.8368, AUC=0.7978, TPR=0.5258, TNR=0.8924, J=0.4181, MCC=0.3982, ConfusionMatrix=
[[1940  234]
 [ 184  204]]
Epoch 5, Phase test, Loss=0.4390, Acc=0.8400, AUC=0.7812, TPR=0.5403, TNR=0.8916, J=0.4319, MCC=0.4054, ConfusionMatrix=
[[1925  234]
 [ 171  201]]
Epoch 5 complete in 75.45

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.2902, Acc=0.8855, AUC=0.9476, TPR=0.9014, TNR=0.8693, J=0.7707, MCC=0.7712, ConfusionMatrix=
[[3146  473]
 [ 363 3318]]
Epoch 6, Phase val, Loss=0.4530, Acc=0.8376, AUC=0.7837, TPR=0.5206, TNR=0.8942, J=0.4148, MCC=0.3972, ConfusionMatrix=
[[1944  230]
 [ 186  202]]
Epoch 6, Phase test, Loss=0.4890, Acc=0.8230, AUC=0.7513, TPR=0.5081, TNR=0.8773, J=0.3853, MCC=0.3556, ConfusionMatrix=
[[1894  265]
 [ 183  189]]
Epoch 6 complete in 57.64

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.2541, Acc=0.9001, AUC=0.9591, TPR=0.9148, TNR=0.8854, J=0.8002, MCC=0.8006, ConfusionMatrix=
[[3221  417]
 [ 312 3350]]
Epoch 7, Phase val, Loss=0.5217, Acc=0.8411, AUC=0.7860, TPR=0.4562, TNR=0.9098, J=0.3660, MCC=0.3720, ConfusionMatrix=
[[1978  196]
 [ 211  177]]
Epoch 7, Phase test, Loss=0.5277, Acc=0.8483, AUC=0.7699, TPR=0.5161, TNR=0.9055, J=0.4216, MCC=0.4110, ConfusionMatrix=
[[1955  204]
 [ 180  192]]
Epoch 7 complete in 41.17

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.2304, Acc=0.9105, AUC=0.9663, TPR=0.9163, TNR=0.9049, J=0.8211, MCC=0.8212, ConfusionMatrix=
[[3310  348]
 [ 305 3337]]
Epoch 8, Phase val, Loss=0.5470, Acc=0.8333, AUC=0.7679, TPR=0.4253, TNR=0.9062, J=0.3314, MCC=0.3384, ConfusionMatrix=
[[1970  204]
 [ 223  165]]
Epoch 8, Phase test, Loss=0.5254, Acc=0.8514, AUC=0.7548, TPR=0.5027, TNR=0.9115, J=0.4142, MCC=0.4115, ConfusionMatrix=
[[1968  191]
 [ 185  187]]
Epoch 8 complete in 78.19

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.2181, Acc=0.9160, AUC=0.9697, TPR=0.9310, TNR=0.9003, J=0.8313, MCC=0.8321, ConfusionMatrix=
[[3206  355]
 [ 258 3481]]
Epoch 9, Phase val, Loss=0.6343, Acc=0.8232, AUC=0.7789, TPR=0.5335, TNR=0.8749, J=0.4084, MCC=0.3755, ConfusionMatrix=
[[1902  272]
 [ 181  207]]
Epoch 9, Phase test, Loss=0.6315, Acc=0.8214, AUC=0.7663, TPR=0.5457, TNR=0.8689, J=0.4146, MCC=0.3727, ConfusionMatrix=
[[1876  283]
 [ 169  203]]
Epoch 9 complete in 39.54

Early Stop!
Training complete in 11m 28s
The best model val AUC=0.8066085604, test AUC=0.778014139362.
Finish training resnet18-conv1x1-avgpool_0

Start training resnet18fixed-conv1x1ab-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6544, Acc=0.6226, AUC=0.6812, TPR=0.7280, TNR=0.5161, J=0.2441, MCC=0.2498, ConfusionMatrix=
[[1874 1757]
 [ 998 2671]]
Epoch 0, Phase val, Loss=0.6476, Acc=0.6764, AUC=0.7309, TPR=0.6418, TNR=0.6826, J=0.3244, MCC=0.2413, ConfusionMatrix=
[[1484  690]
 [ 139  249]]
New Best AUC=0.7309. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6624, Acc=0.6503, AUC=0.7285, TPR=0.6640, TNR=0.6480, J=0.3120, MCC=0.2257, ConfusionMatrix=
[[1399  760]
 [ 125  247]]
Epoch 0 complete in 87.24

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5801, Acc=0.7027, AUC=0.7672, TPR=0.6666, TNR=0.7381, J=0.4047, MCC=0.4058, ConfusionMatrix=
[[2725  967]
 [1203 2405]]
Epoch 1, Phase val, Loss=0.6175, Acc=0.7151, AUC=0.7504, TPR=0.6469, TNR=0.7272, J=0.3741, MCC=0.2854, ConfusionMatrix=
[[1581  593]
 [ 137  251]]
New Best AUC=0.7504. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.6359, Acc=0.6938, AUC=0.7365, TPR=0.6425, TNR=0.7026, J=0.3451, MCC=0.2565, ConfusionMatrix=
[[1517  642]
 [ 133  239]]
Epoch 1 complete in 33.03

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5674, Acc=0.7074, AUC=0.7801, TPR=0.6678, TNR=0.7465, J=0.4143, MCC=0.4157, ConfusionMatrix=
[[2742  931]
 [1205 2422]]
Epoch 2, Phase val, Loss=0.6514, Acc=0.6850, AUC=0.7569, TPR=0.6907, TNR=0.6840, J=0.3747, MCC=0.2778, ConfusionMatrix=
[[1487  687]
 [ 120  268]]
New Best AUC=0.7569. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.6663, Acc=0.6665, AUC=0.7446, TPR=0.6962, TNR=0.6614, J=0.3577, MCC=0.2595, ConfusionMatrix=
[[1428  731]
 [ 113  259]]
Epoch 2 complete in 48.48

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5562, Acc=0.7175, AUC=0.7870, TPR=0.6725, TNR=0.7616, J=0.4341, MCC=0.4360, ConfusionMatrix=
[[2811  880]
 [1182 2427]]
Epoch 3, Phase val, Loss=0.6204, Acc=0.7194, AUC=0.7578, TPR=0.6649, TNR=0.7291, J=0.3940, MCC=0.3003, ConfusionMatrix=
[[1585  589]
 [ 130  258]]
New Best AUC=0.7578. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.6223, Acc=0.6946, AUC=0.7530, TPR=0.6478, TNR=0.7026, J=0.3505, MCC=0.2604, ConfusionMatrix=
[[1517  642]
 [ 131  241]]
Epoch 3 complete in 85.21

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5496, Acc=0.7290, AUC=0.7943, TPR=0.6816, TNR=0.7761, J=0.4577, MCC=0.4598, ConfusionMatrix=
[[2845  821]
 [1157 2477]]
Epoch 4, Phase val, Loss=0.5626, Acc=0.7615, AUC=0.7626, TPR=0.6057, TNR=0.7893, J=0.3950, MCC=0.3188, ConfusionMatrix=
[[1716  458]
 [ 153  235]]
New Best AUC=0.7626. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.5622, Acc=0.7440, AUC=0.7454, TPR=0.5887, TNR=0.7707, J=0.3594, MCC=0.2828, ConfusionMatrix=
[[1664  495]
 [ 153  219]]
Epoch 4 complete in 45.00

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5669, Acc=0.7164, AUC=0.7805, TPR=0.6681, TNR=0.7641, J=0.4322, MCC=0.4343, ConfusionMatrix=
[[2808  867]
 [1203 2422]]
Epoch 5, Phase val, Loss=0.6629, Acc=0.6799, AUC=0.7559, TPR=0.6907, TNR=0.6780, J=0.3687, MCC=0.2726, ConfusionMatrix=
[[1474  700]
 [ 120  268]]
Epoch 5, Phase test, Loss=0.6733, Acc=0.6480, AUC=0.7407, TPR=0.6774, TNR=0.6429, J=0.3203, MCC=0.2311, ConfusionMatrix=
[[1388  771]
 [ 120  252]]
Epoch 5 complete in 71.14

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5477, Acc=0.7308, AUC=0.7962, TPR=0.6882, TNR=0.7727, J=0.4609, MCC=0.4627, ConfusionMatrix=
[[2845  837]
 [1128 2490]]
Epoch 6, Phase val, Loss=0.5670, Acc=0.7596, AUC=0.7616, TPR=0.6031, TNR=0.7875, J=0.3906, MCC=0.3148, ConfusionMatrix=
[[1712  462]
 [ 154  234]]
Epoch 6, Phase test, Loss=0.5695, Acc=0.7388, AUC=0.7469, TPR=0.5941, TNR=0.7638, J=0.3579, MCC=0.2796, ConfusionMatrix=
[[1649  510]
 [ 151  221]]
Epoch 6 complete in 36.33

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5473, Acc=0.7279, AUC=0.7986, TPR=0.6974, TNR=0.7588, J=0.4562, MCC=0.4570, ConfusionMatrix=
[[2756  876]
 [1110 2558]]
Epoch 7, Phase val, Loss=0.6096, Acc=0.7233, AUC=0.7655, TPR=0.6418, TNR=0.7378, J=0.3796, MCC=0.2918, ConfusionMatrix=
[[1604  570]
 [ 139  249]]
New Best AUC=0.7655. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 7, Phase test, Loss=0.6114, Acc=0.6985, AUC=0.7488, TPR=0.6505, TNR=0.7068, J=0.3573, MCC=0.2660, ConfusionMatrix=
[[1526  633]
 [ 130  242]]
Epoch 7 complete in 33.53

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5526, Acc=0.7186, AUC=0.7932, TPR=0.6762, TNR=0.7596, J=0.4358, MCC=0.4375, ConfusionMatrix=
[[2821  893]
 [1161 2425]]
Epoch 8, Phase val, Loss=0.6738, Acc=0.6686, AUC=0.7603, TPR=0.7320, TNR=0.6573, J=0.3893, MCC=0.2847, ConfusionMatrix=
[[1429  745]
 [ 104  284]]
Epoch 8, Phase test, Loss=0.6794, Acc=0.6440, AUC=0.7456, TPR=0.7177, TNR=0.6313, J=0.3491, MCC=0.2504, ConfusionMatrix=
[[1363  796]
 [ 105  267]]
Epoch 8 complete in 79.11

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5440, Acc=0.7319, AUC=0.8021, TPR=0.7005, TNR=0.7636, J=0.4641, MCC=0.4650, ConfusionMatrix=
[[2775  859]
 [1098 2568]]
Epoch 9, Phase val, Loss=0.5607, Acc=0.7588, AUC=0.7503, TPR=0.5747, TNR=0.7916, J=0.3664, MCC=0.2980, ConfusionMatrix=
[[1721  453]
 [ 165  223]]
Epoch 9, Phase test, Loss=0.5595, Acc=0.7460, AUC=0.7474, TPR=0.5995, TNR=0.7712, J=0.3707, MCC=0.2913, ConfusionMatrix=
[[1665  494]
 [ 149  223]]
Epoch 9 complete in 32.38

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5434, Acc=0.7315, AUC=0.8019, TPR=0.6778, TNR=0.7829, J=0.4607, MCC=0.4637, ConfusionMatrix=
[[2921  810]
 [1150 2419]]
Epoch 10, Phase val, Loss=0.4952, Acc=0.8021, AUC=0.7490, TPR=0.4871, TNR=0.8583, J=0.3454, MCC=0.3132, ConfusionMatrix=
[[1866  308]
 [ 199  189]]
Epoch 10, Phase test, Loss=0.4935, Acc=0.8060, AUC=0.7463, TPR=0.5161, TNR=0.8560, J=0.3721, MCC=0.3302, ConfusionMatrix=
[[1848  311]
 [ 180  192]]
Epoch 10 complete in 61.12

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5437, Acc=0.7304, AUC=0.7996, TPR=0.6754, TNR=0.7831, J=0.4586, MCC=0.4617, ConfusionMatrix=
[[2918  808]
 [1160 2414]]
Epoch 11, Phase val, Loss=0.5087, Acc=0.7896, AUC=0.7605, TPR=0.5206, TNR=0.8376, J=0.3582, MCC=0.3117, ConfusionMatrix=
[[1821  353]
 [ 186  202]]
Epoch 11, Phase test, Loss=0.5172, Acc=0.7811, AUC=0.7432, TPR=0.5323, TNR=0.8240, J=0.3563, MCC=0.3005, ConfusionMatrix=
[[1779  380]
 [ 174  198]]
Epoch 11 complete in 59.48

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5466, Acc=0.7311, AUC=0.8007, TPR=0.7093, TNR=0.7539, J=0.4632, MCC=0.4633, ConfusionMatrix=
[[2690  878]
 [1085 2647]]
Epoch 12, Phase val, Loss=0.5520, Acc=0.7592, AUC=0.7647, TPR=0.6005, TNR=0.7875, J=0.3880, MCC=0.3128, ConfusionMatrix=
[[1712  462]
 [ 155  233]]
Epoch 12, Phase test, Loss=0.5573, Acc=0.7471, AUC=0.7482, TPR=0.6048, TNR=0.7717, J=0.3765, MCC=0.2957, ConfusionMatrix=
[[1666  493]
 [ 147  225]]
Epoch 12 complete in 37.19

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5454, Acc=0.7329, AUC=0.7989, TPR=0.6870, TNR=0.7776, J=0.4646, MCC=0.4668, ConfusionMatrix=
[[2874  822]
 [1128 2476]]
Epoch 13, Phase val, Loss=0.5721, Acc=0.7482, AUC=0.7606, TPR=0.6031, TNR=0.7741, J=0.3772, MCC=0.3002, ConfusionMatrix=
[[1683  491]
 [ 154  234]]
Epoch 13, Phase test, Loss=0.5767, Acc=0.7377, AUC=0.7424, TPR=0.6102, TNR=0.7596, J=0.3698, MCC=0.2872, ConfusionMatrix=
[[1640  519]
 [ 145  227]]
Epoch 13 complete in 86.50

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5472, Acc=0.7262, AUC=0.7998, TPR=0.7046, TNR=0.7481, J=0.4527, MCC=0.4531, ConfusionMatrix=
[[2706  911]
 [1088 2595]]
Epoch 14, Phase val, Loss=0.5938, Acc=0.7338, AUC=0.7683, TPR=0.6572, TNR=0.7475, J=0.4047, MCC=0.3126, ConfusionMatrix=
[[1625  549]
 [ 133  255]]
New Best AUC=0.7683. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 14, Phase test, Loss=0.6108, Acc=0.7136, AUC=0.7402, TPR=0.6344, TNR=0.7272, J=0.3616, MCC=0.2732, ConfusionMatrix=
[[1570  589]
 [ 136  236]]
Epoch 14 complete in 45.18

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5511, Acc=0.7264, AUC=0.7936, TPR=0.6768, TNR=0.7744, J=0.4512, MCC=0.4536, ConfusionMatrix=
[[2876  838]
 [1159 2427]]
Epoch 15, Phase val, Loss=0.6395, Acc=0.6936, AUC=0.7568, TPR=0.6804, TNR=0.6960, J=0.3764, MCC=0.2809, ConfusionMatrix=
[[1513  661]
 [ 124  264]]
Epoch 15, Phase test, Loss=0.6590, Acc=0.6673, AUC=0.7366, TPR=0.6801, TNR=0.6651, J=0.3452, MCC=0.2511, ConfusionMatrix=
[[1436  723]
 [ 119  253]]
Epoch 15 complete in 53.19

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.5546, Acc=0.7222, AUC=0.7907, TPR=0.6787, TNR=0.7648, J=0.4434, MCC=0.4453, ConfusionMatrix=
[[2822  868]
 [1160 2450]]
Epoch 16, Phase val, Loss=0.5363, Acc=0.7728, AUC=0.7676, TPR=0.5799, TNR=0.8073, J=0.3872, MCC=0.3199, ConfusionMatrix=
[[1755  419]
 [ 163  225]]
Epoch 16, Phase test, Loss=0.5494, Acc=0.7574, AUC=0.7366, TPR=0.5672, TNR=0.7902, J=0.3574, MCC=0.2877, ConfusionMatrix=
[[1706  453]
 [ 161  211]]
Epoch 16 complete in 62.27

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.5305, Acc=0.7441, AUC=0.8130, TPR=0.7104, TNR=0.7785, J=0.4889, MCC=0.4899, ConfusionMatrix=
[[2812  800]
 [1068 2620]]
Epoch 17, Phase val, Loss=0.5379, Acc=0.7724, AUC=0.7669, TPR=0.5747, TNR=0.8077, J=0.3825, MCC=0.3166, ConfusionMatrix=
[[1756  418]
 [ 165  223]]
Epoch 17, Phase test, Loss=0.5493, Acc=0.7594, AUC=0.7420, TPR=0.5806, TNR=0.7902, J=0.3708, MCC=0.2978, ConfusionMatrix=
[[1706  453]
 [ 156  216]]
Epoch 17 complete in 33.19

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.5422, Acc=0.7359, AUC=0.8028, TPR=0.6880, TNR=0.7826, J=0.4705, MCC=0.4729, ConfusionMatrix=
[[2894  804]
 [1124 2478]]
Epoch 18, Phase val, Loss=0.5434, Acc=0.7658, AUC=0.7564, TPR=0.5412, TNR=0.8059, J=0.3471, MCC=0.2887, ConfusionMatrix=
[[1752  422]
 [ 178  210]]
Epoch 18, Phase test, Loss=0.5539, Acc=0.7590, AUC=0.7365, TPR=0.5645, TNR=0.7925, J=0.3570, MCC=0.2882, ConfusionMatrix=
[[1711  448]
 [ 162  210]]
Epoch 18 complete in 71.18

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.5419, Acc=0.7290, AUC=0.8022, TPR=0.7035, TNR=0.7555, J=0.4590, MCC=0.4594, ConfusionMatrix=
[[2710  877]
 [1101 2612]]
Epoch 19, Phase val, Loss=0.5360, Acc=0.7724, AUC=0.7610, TPR=0.5464, TNR=0.8128, J=0.3592, MCC=0.3008, ConfusionMatrix=
[[1767  407]
 [ 176  212]]
Epoch 19, Phase test, Loss=0.5455, Acc=0.7590, AUC=0.7365, TPR=0.5484, TNR=0.7953, J=0.3437, MCC=0.2791, ConfusionMatrix=
[[1717  442]
 [ 168  204]]
Epoch 19 complete in 36.81

Epoch 20 starting with learning_rate: [0.005]
Epoch 20, Phase train, Loss=0.5443, Acc=0.7326, AUC=0.8011, TPR=0.6840, TNR=0.7808, J=0.4648, MCC=0.4671, ConfusionMatrix=
[[2861  803]
 [1149 2487]]
Epoch 20, Phase val, Loss=0.6092, Acc=0.7221, AUC=0.7652, TPR=0.6314, TNR=0.7383, J=0.3697, MCC=0.2847, ConfusionMatrix=
[[1605  569]
 [ 143  245]]
Epoch 20, Phase test, Loss=0.6250, Acc=0.6966, AUC=0.7381, TPR=0.6505, TNR=0.7045, J=0.3550, MCC=0.2640, ConfusionMatrix=
[[1521  638]
 [ 130  242]]
Epoch 20 complete in 32.76

Epoch 21 starting with learning_rate: [0.005]
Epoch 21, Phase train, Loss=0.5433, Acc=0.7364, AUC=0.8036, TPR=0.7046, TNR=0.7676, J=0.4722, MCC=0.4733, ConfusionMatrix=
[[2831  857]
 [1067 2545]]
Epoch 21, Phase val, Loss=0.5214, Acc=0.7760, AUC=0.7646, TPR=0.5387, TNR=0.8183, J=0.3570, MCC=0.3015, ConfusionMatrix=
[[1779  395]
 [ 179  209]]
Epoch 21, Phase test, Loss=0.5374, Acc=0.7618, AUC=0.7358, TPR=0.5672, TNR=0.7953, J=0.3625, MCC=0.2933, ConfusionMatrix=
[[1717  442]
 [ 161  211]]
Epoch 21 complete in 85.79

Epoch 22 starting with learning_rate: [0.005]
Epoch 22, Phase train, Loss=0.5386, Acc=0.7375, AUC=0.8061, TPR=0.7007, TNR=0.7743, J=0.4750, MCC=0.4763, ConfusionMatrix=
[[2830  825]
 [1091 2554]]
Epoch 22, Phase val, Loss=0.5178, Acc=0.7799, AUC=0.7586, TPR=0.5206, TNR=0.8261, J=0.3467, MCC=0.2970, ConfusionMatrix=
[[1796  378]
 [ 186  202]]
Epoch 22, Phase test, Loss=0.5324, Acc=0.7708, AUC=0.7343, TPR=0.5511, TNR=0.8087, J=0.3598, MCC=0.2965, ConfusionMatrix=
[[1746  413]
 [ 167  205]]
Epoch 22 complete in 32.96

Early Stop!
Training complete in 20m 49s
The best model val AUC=0.768265300316, test AUC=0.740249617754.
Finish training resnet18fixed-conv1x1ab-maxpool_0

Start training resnet18fixed-conv1x1ab-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6485, Acc=0.6437, AUC=0.6996, TPR=0.8282, TNR=0.4539, J=0.2821, MCC=0.3047, ConfusionMatrix=
[[1633 1965]
 [ 636 3066]]
Epoch 0, Phase val, Loss=0.6561, Acc=0.5816, AUC=0.7138, TPR=0.7990, TNR=0.5428, J=0.3417, MCC=0.2451, ConfusionMatrix=
[[1180  994]
 [  78  310]]
New Best AUC=0.7138. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6694, Acc=0.5606, AUC=0.6858, TPR=0.7500, TNR=0.5280, J=0.2780, MCC=0.1970, ConfusionMatrix=
[[1140 1019]
 [  93  279]]
Epoch 0 complete in 58.80

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5838, Acc=0.7014, AUC=0.7666, TPR=0.7443, TNR=0.6593, J=0.4037, MCC=0.4050, ConfusionMatrix=
[[2433 1257]
 [ 923 2687]]
Epoch 1, Phase val, Loss=0.5351, Acc=0.7201, AUC=0.7247, TPR=0.5232, TNR=0.7553, J=0.2785, MCC=0.2207, ConfusionMatrix=
[[1642  532]
 [ 185  203]]
New Best AUC=0.7247. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5487, Acc=0.7088, AUC=0.7168, TPR=0.5565, TNR=0.7351, J=0.2915, MCC=0.2236, ConfusionMatrix=
[[1587  572]
 [ 165  207]]
Epoch 1 complete in 77.20

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5616, Acc=0.7152, AUC=0.7845, TPR=0.7331, TNR=0.6975, J=0.4306, MCC=0.4308, ConfusionMatrix=
[[2560 1110]
 [ 969 2661]]
Epoch 2, Phase val, Loss=0.5258, Acc=0.7268, AUC=0.7429, TPR=0.5644, TNR=0.7557, J=0.3202, MCC=0.2523, ConfusionMatrix=
[[1643  531]
 [ 169  219]]
New Best AUC=0.7429. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.5483, Acc=0.7112, AUC=0.7282, TPR=0.5753, TNR=0.7346, J=0.3099, MCC=0.2370, ConfusionMatrix=
[[1586  573]
 [ 158  214]]
Epoch 2 complete in 41.48

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5662, Acc=0.7018, AUC=0.7785, TPR=0.7139, TNR=0.6898, J=0.4036, MCC=0.4037, ConfusionMatrix=
[[2526 1136]
 [1041 2597]]
Epoch 3, Phase val, Loss=0.5692, Acc=0.6854, AUC=0.7437, TPR=0.6237, TNR=0.6964, J=0.3201, MCC=0.2403, ConfusionMatrix=
[[1514  660]
 [ 146  242]]
New Best AUC=0.7437. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.5946, Acc=0.6681, AUC=0.7297, TPR=0.6371, TNR=0.6735, J=0.3106, MCC=0.2275, ConfusionMatrix=
[[1454  705]
 [ 135  237]]
Epoch 3 complete in 82.36

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5544, Acc=0.7216, AUC=0.7917, TPR=0.7323, TNR=0.7111, J=0.4434, MCC=0.4435, ConfusionMatrix=
[[2609 1060]
 [ 972 2659]]
Epoch 4, Phase val, Loss=0.5116, Acc=0.7393, AUC=0.7451, TPR=0.5387, TNR=0.7751, J=0.3137, MCC=0.2526, ConfusionMatrix=
[[1685  489]
 [ 179  209]]
New Best AUC=0.7451. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.5354, Acc=0.7341, AUC=0.7319, TPR=0.5726, TNR=0.7619, J=0.3345, MCC=0.2618, ConfusionMatrix=
[[1645  514]
 [ 159  213]]
Epoch 4 complete in 38.61

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5496, Acc=0.7237, AUC=0.7954, TPR=0.7275, TNR=0.7200, J=0.4474, MCC=0.4474, ConfusionMatrix=
[[2643 1028]
 [ 989 2640]]
Epoch 5, Phase val, Loss=0.5107, Acc=0.7416, AUC=0.7394, TPR=0.5103, TNR=0.7829, J=0.2932, MCC=0.2392, ConfusionMatrix=
[[1702  472]
 [ 190  198]]
Epoch 5, Phase test, Loss=0.5310, Acc=0.7345, AUC=0.7269, TPR=0.5430, TNR=0.7675, J=0.3105, MCC=0.2454, ConfusionMatrix=
[[1657  502]
 [ 170  202]]
Epoch 5 complete in 59.21

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5597, Acc=0.7177, AUC=0.7856, TPR=0.7336, TNR=0.7016, J=0.4353, MCC=0.4355, ConfusionMatrix=
[[2554 1086]
 [ 975 2685]]
Epoch 6, Phase val, Loss=0.5236, Acc=0.7307, AUC=0.7400, TPR=0.5335, TNR=0.7659, J=0.2994, MCC=0.2392, ConfusionMatrix=
[[1665  509]
 [ 181  207]]
Epoch 6, Phase test, Loss=0.5439, Acc=0.7136, AUC=0.7296, TPR=0.5565, TNR=0.7406, J=0.2971, MCC=0.2289, ConfusionMatrix=
[[1599  560]
 [ 165  207]]
Epoch 6 complete in 56.06

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5416, Acc=0.7323, AUC=0.8035, TPR=0.7418, TNR=0.7231, J=0.4649, MCC=0.4649, ConfusionMatrix=
[[2674 1024]
 [ 930 2672]]
Epoch 7, Phase val, Loss=0.5188, Acc=0.7338, AUC=0.7475, TPR=0.5644, TNR=0.7640, J=0.3285, MCC=0.2606, ConfusionMatrix=
[[1661  513]
 [ 169  219]]
New Best AUC=0.7475. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 7, Phase test, Loss=0.5366, Acc=0.7301, AUC=0.7360, TPR=0.5645, TNR=0.7587, J=0.3232, MCC=0.2525, ConfusionMatrix=
[[1638  521]
 [ 162  210]]
Epoch 7 complete in 35.07

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5683, Acc=0.7029, AUC=0.7761, TPR=0.6990, TNR=0.7068, J=0.4058, MCC=0.4058, ConfusionMatrix=
[[2579 1070]
 [1099 2552]]
Epoch 8, Phase val, Loss=0.4976, Acc=0.7553, AUC=0.7406, TPR=0.5000, TNR=0.8008, J=0.3008, MCC=0.2508, ConfusionMatrix=
[[1741  433]
 [ 194  194]]
Epoch 8, Phase test, Loss=0.5092, Acc=0.7554, AUC=0.7326, TPR=0.5188, TNR=0.7962, J=0.3150, MCC=0.2576, ConfusionMatrix=
[[1719  440]
 [ 179  193]]
Epoch 8 complete in 82.06

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5600, Acc=0.7160, AUC=0.7876, TPR=0.7338, TNR=0.6980, J=0.4319, MCC=0.4322, ConfusionMatrix=
[[2536 1097]
 [ 976 2691]]
Epoch 9, Phase val, Loss=0.5813, Acc=0.6893, AUC=0.7297, TPR=0.6186, TNR=0.7019, J=0.3205, MCC=0.2414, ConfusionMatrix=
[[1526  648]
 [ 148  240]]
Epoch 9, Phase test, Loss=0.6019, Acc=0.6725, AUC=0.7281, TPR=0.6344, TNR=0.6790, J=0.3134, MCC=0.2302, ConfusionMatrix=
[[1466  693]
 [ 136  236]]
Epoch 9 complete in 33.57

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5559, Acc=0.7174, AUC=0.7886, TPR=0.7336, TNR=0.7013, J=0.4348, MCC=0.4350, ConfusionMatrix=
[[2561 1091]
 [ 972 2676]]
Epoch 10, Phase val, Loss=0.5079, Acc=0.7479, AUC=0.7416, TPR=0.5129, TNR=0.7898, J=0.3027, MCC=0.2486, ConfusionMatrix=
[[1717  457]
 [ 189  199]]
Epoch 10, Phase test, Loss=0.5239, Acc=0.7408, AUC=0.7312, TPR=0.5323, TNR=0.7767, J=0.3090, MCC=0.2468, ConfusionMatrix=
[[1677  482]
 [ 174  198]]
Epoch 10 complete in 46.86

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5423, Acc=0.7296, AUC=0.8023, TPR=0.7343, TNR=0.7248, J=0.4591, MCC=0.4592, ConfusionMatrix=
[[2634 1000]
 [ 974 2692]]
Epoch 11, Phase val, Loss=0.4683, Acc=0.7775, AUC=0.7329, TPR=0.4175, TNR=0.8418, J=0.2593, MCC=0.2335, ConfusionMatrix=
[[1830  344]
 [ 226  162]]
Epoch 11, Phase test, Loss=0.4807, Acc=0.7843, AUC=0.7249, TPR=0.4839, TNR=0.8360, J=0.3199, MCC=0.2776, ConfusionMatrix=
[[1805  354]
 [ 192  180]]
Epoch 11 complete in 81.32

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5382, Acc=0.7297, AUC=0.8055, TPR=0.7506, TNR=0.7077, J=0.4583, MCC=0.4588, ConfusionMatrix=
[[2513 1038]
 [ 935 2814]]
Epoch 12, Phase val, Loss=0.5898, Acc=0.6874, AUC=0.7378, TPR=0.6160, TNR=0.7001, J=0.3161, MCC=0.2379, ConfusionMatrix=
[[1522  652]
 [ 149  239]]
Epoch 12, Phase test, Loss=0.6137, Acc=0.6677, AUC=0.7263, TPR=0.6317, TNR=0.6739, J=0.3056, MCC=0.2240, ConfusionMatrix=
[[1455  704]
 [ 137  235]]
Epoch 12 complete in 45.72

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.5596, Acc=0.7184, AUC=0.7873, TPR=0.7200, TNR=0.7167, J=0.4367, MCC=0.4367, ConfusionMatrix=
[[2598 1027]
 [1029 2646]]
Epoch 13, Phase val, Loss=0.6781, Acc=0.6230, AUC=0.7298, TPR=0.7294, TNR=0.6040, J=0.3333, MCC=0.2404, ConfusionMatrix=
[[1313  861]
 [ 105  283]]
Epoch 13, Phase test, Loss=0.7060, Acc=0.5871, AUC=0.7262, TPR=0.7392, TNR=0.5609, J=0.3002, MCC=0.2127, ConfusionMatrix=
[[1211  948]
 [  97  275]]
Epoch 13 complete in 60.31

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.5365, Acc=0.7275, AUC=0.8061, TPR=0.7288, TNR=0.7263, J=0.4551, MCC=0.4551, ConfusionMatrix=
[[2659 1002]
 [ 987 2652]]
Epoch 14, Phase val, Loss=0.5762, Acc=0.6913, AUC=0.7434, TPR=0.6057, TNR=0.7065, J=0.3122, MCC=0.2361, ConfusionMatrix=
[[1536  638]
 [ 153  235]]
Epoch 14, Phase test, Loss=0.6017, Acc=0.6733, AUC=0.7299, TPR=0.6210, TNR=0.6823, J=0.3032, MCC=0.2234, ConfusionMatrix=
[[1473  686]
 [ 141  231]]
Epoch 14 complete in 48.75

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.5531, Acc=0.7174, AUC=0.7920, TPR=0.7381, TNR=0.6959, J=0.4341, MCC=0.4345, ConfusionMatrix=
[[2497 1091]
 [ 972 2740]]
Epoch 15, Phase val, Loss=0.5190, Acc=0.7365, AUC=0.7407, TPR=0.5155, TNR=0.7760, J=0.2915, MCC=0.2358, ConfusionMatrix=
[[1687  487]
 [ 188  200]]
Epoch 15, Phase test, Loss=0.5377, Acc=0.7218, AUC=0.7290, TPR=0.5565, TNR=0.7503, J=0.3068, MCC=0.2383, ConfusionMatrix=
[[1620  539]
 [ 165  207]]
Epoch 15 complete in 36.59

Early Stop!
Training complete in 14m 44s
The best model val AUC=0.747466544637, test AUC=0.736012540653.
Finish training resnet18fixed-conv1x1ab-avgpool_0

Start training resnet18fixed-conv1x1-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6526, Acc=0.6199, AUC=0.6628, TPR=0.5846, TNR=0.6545, J=0.2390, MCC=0.2396, ConfusionMatrix=
[[2413 1274]
 [1501 2112]]
Epoch 0, Phase val, Loss=0.6446, Acc=0.6585, AUC=0.7016, TPR=0.6546, TNR=0.6592, J=0.3138, MCC=0.2308, ConfusionMatrix=
[[1433  741]
 [ 134  254]]
New Best AUC=0.7016. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6533, Acc=0.6278, AUC=0.6927, TPR=0.6290, TNR=0.6276, J=0.2566, MCC=0.1848, ConfusionMatrix=
[[1355  804]
 [ 138  234]]
Epoch 0 complete in 74.69

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.6054, Acc=0.6773, AUC=0.7382, TPR=0.6174, TNR=0.7338, J=0.3511, MCC=0.3538, ConfusionMatrix=
[[2756 1000]
 [1356 2188]]
Epoch 1, Phase val, Loss=0.5683, Acc=0.7560, AUC=0.7374, TPR=0.5361, TNR=0.7953, J=0.3314, MCC=0.2726, ConfusionMatrix=
[[1729  445]
 [ 180  208]]
New Best AUC=0.7374. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.5735, Acc=0.7424, AUC=0.7356, TPR=0.5591, TNR=0.7740, J=0.3331, MCC=0.2642, ConfusionMatrix=
[[1671  488]
 [ 164  208]]
Epoch 1 complete in 32.39

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5750, Acc=0.7074, AUC=0.7735, TPR=0.6446, TNR=0.7694, J=0.4140, MCC=0.4174, ConfusionMatrix=
[[2826  847]
 [1289 2338]]
Epoch 2, Phase val, Loss=0.5107, Acc=0.7838, AUC=0.7384, TPR=0.4381, TNR=0.8454, J=0.2836, MCC=0.2554, ConfusionMatrix=
[[1838  336]
 [ 218  170]]
New Best AUC=0.7384. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.5241, Acc=0.7724, AUC=0.7217, TPR=0.4866, TNR=0.8217, J=0.3082, MCC=0.2619, ConfusionMatrix=
[[1774  385]
 [ 191  181]]
Epoch 2 complete in 36.48

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5766, Acc=0.7051, AUC=0.7735, TPR=0.6284, TNR=0.7784, J=0.4068, MCC=0.4119, ConfusionMatrix=
[[2905  827]
 [1326 2242]]
Epoch 3, Phase val, Loss=0.7567, Acc=0.6311, AUC=0.7632, TPR=0.7912, TNR=0.6026, J=0.3938, MCC=0.2834, ConfusionMatrix=
[[1310  864]
 [  81  307]]
New Best AUC=0.7632. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-maxpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.8086, Acc=0.5927, AUC=0.7221, TPR=0.7204, TNR=0.5706, J=0.2911, MCC=0.2064, ConfusionMatrix=
[[1232  927]
 [ 104  268]]
Epoch 3 complete in 80.03

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5724, Acc=0.7051, AUC=0.7728, TPR=0.6533, TNR=0.7583, J=0.4116, MCC=0.4136, ConfusionMatrix=
[[2729  870]
 [1283 2418]]
Epoch 4, Phase val, Loss=0.5684, Acc=0.7564, AUC=0.7375, TPR=0.5284, TNR=0.7971, J=0.3255, MCC=0.2687, ConfusionMatrix=
[[1733  441]
 [ 183  205]]
Epoch 4, Phase test, Loss=0.5825, Acc=0.7602, AUC=0.7270, TPR=0.5860, TNR=0.7902, J=0.3762, MCC=0.3018, ConfusionMatrix=
[[1706  453]
 [ 154  218]]
Epoch 4 complete in 30.85

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5633, Acc=0.7147, AUC=0.7844, TPR=0.6585, TNR=0.7712, J=0.4296, MCC=0.4323, ConfusionMatrix=
[[2807  833]
 [1250 2410]]
Epoch 5, Phase val, Loss=0.5525, Acc=0.7744, AUC=0.7455, TPR=0.5077, TNR=0.8220, J=0.3297, MCC=0.2818, ConfusionMatrix=
[[1787  387]
 [ 191  197]]
Epoch 5, Phase test, Loss=0.5580, Acc=0.7681, AUC=0.7252, TPR=0.5403, TNR=0.8073, J=0.3476, MCC=0.2867, ConfusionMatrix=
[[1743  416]
 [ 171  201]]
Epoch 5 complete in 90.57

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5683, Acc=0.7138, AUC=0.7801, TPR=0.6467, TNR=0.7790, J=0.4258, MCC=0.4299, ConfusionMatrix=
[[2884  818]
 [1271 2327]]
Epoch 6, Phase val, Loss=0.5367, Acc=0.7826, AUC=0.7305, TPR=0.4768, TNR=0.8372, J=0.3140, MCC=0.2761, ConfusionMatrix=
[[1820  354]
 [ 203  185]]
Epoch 6, Phase test, Loss=0.5338, Acc=0.7843, AUC=0.7119, TPR=0.4946, TNR=0.8342, J=0.3288, MCC=0.2838, ConfusionMatrix=
[[1801  358]
 [ 188  184]]
Epoch 6 complete in 36.52

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5850, Acc=0.7066, AUC=0.7686, TPR=0.6537, TNR=0.7604, J=0.4141, MCC=0.4163, ConfusionMatrix=
[[2751  867]
 [1275 2407]]
Epoch 7, Phase val, Loss=0.6107, Acc=0.7393, AUC=0.7407, TPR=0.5438, TNR=0.7741, J=0.3180, MCC=0.2556, ConfusionMatrix=
[[1683  491]
 [ 177  211]]
Epoch 7, Phase test, Loss=0.6244, Acc=0.7345, AUC=0.7233, TPR=0.5806, TNR=0.7610, J=0.3416, MCC=0.2668, ConfusionMatrix=
[[1643  516]
 [ 156  216]]
Epoch 7 complete in 41.68

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5594, Acc=0.7185, AUC=0.7890, TPR=0.6629, TNR=0.7741, J=0.4370, MCC=0.4398, ConfusionMatrix=
[[2824  824]
 [1231 2421]]
Epoch 8, Phase val, Loss=0.6562, Acc=0.7139, AUC=0.7521, TPR=0.6263, TNR=0.7295, J=0.3558, MCC=0.2725, ConfusionMatrix=
[[1586  588]
 [ 145  243]]
Epoch 8, Phase test, Loss=0.6611, Acc=0.6985, AUC=0.7366, TPR=0.6290, TNR=0.7105, J=0.3395, MCC=0.2539, ConfusionMatrix=
[[1534  625]
 [ 138  234]]
Epoch 8 complete in 80.24

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5696, Acc=0.7130, AUC=0.7787, TPR=0.6576, TNR=0.7686, J=0.4262, MCC=0.4288, ConfusionMatrix=
[[2800  843]
 [1252 2405]]
Epoch 9, Phase val, Loss=0.7643, Acc=0.6444, AUC=0.7573, TPR=0.7448, TNR=0.6265, J=0.3713, MCC=0.2689, ConfusionMatrix=
[[1362  812]
 [  99  289]]
Epoch 9, Phase test, Loss=0.7582, Acc=0.6337, AUC=0.7360, TPR=0.7392, TNR=0.6156, J=0.3548, MCC=0.2533, ConfusionMatrix=
[[1329  830]
 [  97  275]]
Epoch 9 complete in 36.18

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5638, Acc=0.7199, AUC=0.7893, TPR=0.6544, TNR=0.7851, J=0.4395, MCC=0.4433, ConfusionMatrix=
[[2871  786]
 [1259 2384]]
Epoch 10, Phase val, Loss=0.4730, Acc=0.8087, AUC=0.7393, TPR=0.3943, TNR=0.8827, J=0.2770, MCC=0.2714, ConfusionMatrix=
[[1919  255]
 [ 235  153]]
Epoch 10, Phase test, Loss=0.4843, Acc=0.8186, AUC=0.7108, TPR=0.4247, TNR=0.8865, J=0.3113, MCC=0.3012, ConfusionMatrix=
[[1914  245]
 [ 214  158]]
Epoch 10 complete in 43.74

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5600, Acc=0.7173, AUC=0.7882, TPR=0.6738, TNR=0.7615, J=0.4353, MCC=0.4368, ConfusionMatrix=
[[2755  863]
 [1201 2481]]
Epoch 11, Phase val, Loss=0.5594, Acc=0.7603, AUC=0.7475, TPR=0.5619, TNR=0.7958, J=0.3576, MCC=0.2929, ConfusionMatrix=
[[1730  444]
 [ 170  218]]
Epoch 11, Phase test, Loss=0.5743, Acc=0.7578, AUC=0.7288, TPR=0.5591, TNR=0.7920, J=0.3512, MCC=0.2836, ConfusionMatrix=
[[1710  449]
 [ 164  208]]
Epoch 11 complete in 71.16

Early Stop!
Training complete in 10m 55s
The best model val AUC=0.763222099982, test AUC=0.722101032437.
Finish training resnet18fixed-conv1x1-maxpool_0

Start training resnet18fixed-conv1x1-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6264, Acc=0.6477, AUC=0.7085, TPR=0.6819, TNR=0.6138, J=0.2957, MCC=0.2964, ConfusionMatrix=
[[2252 1417]
 [1155 2476]]
Epoch 0, Phase val, Loss=0.5821, Acc=0.6827, AUC=0.7216, TPR=0.6211, TNR=0.6937, J=0.3148, MCC=0.2360, ConfusionMatrix=
[[1508  666]
 [ 147  241]]
New Best AUC=0.7216. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.5990, Acc=0.6602, AUC=0.7258, TPR=0.6478, TNR=0.6623, J=0.3102, MCC=0.2259, ConfusionMatrix=
[[1430  729]
 [ 131  241]]
Epoch 0 complete in 32.13

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5631, Acc=0.7141, AUC=0.7824, TPR=0.7252, TNR=0.7032, J=0.4284, MCC=0.4285, ConfusionMatrix=
[[2590 1093]
 [ 994 2623]]
Epoch 1, Phase val, Loss=0.6096, Acc=0.6596, AUC=0.7355, TPR=0.7036, TNR=0.6518, J=0.3554, MCC=0.2598, ConfusionMatrix=
[[1417  757]
 [ 115  273]]
New Best AUC=0.7355. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.6275, Acc=0.6472, AUC=0.7381, TPR=0.7231, TNR=0.6341, J=0.3572, MCC=0.2564, ConfusionMatrix=
[[1369  790]
 [ 103  269]]
Epoch 1 complete in 72.80

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5656, Acc=0.7058, AUC=0.7786, TPR=0.7162, TNR=0.6955, J=0.4116, MCC=0.4117, ConfusionMatrix=
[[2553 1118]
 [1030 2599]]
Epoch 2, Phase val, Loss=0.5172, Acc=0.7330, AUC=0.7229, TPR=0.4948, TNR=0.7755, J=0.2704, MCC=0.2195, ConfusionMatrix=
[[1686  488]
 [ 196  192]]
Epoch 2, Phase test, Loss=0.5345, Acc=0.7286, AUC=0.7240, TPR=0.5242, TNR=0.7638, J=0.2880, MCC=0.2275, ConfusionMatrix=
[[1649  510]
 [ 177  195]]
Epoch 2 complete in 46.34

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5613, Acc=0.7138, AUC=0.7851, TPR=0.7417, TNR=0.6853, J=0.4270, MCC=0.4278, ConfusionMatrix=
[[2472 1135]
 [ 954 2739]]
Epoch 3, Phase val, Loss=0.4464, Acc=0.8037, AUC=0.7275, TPR=0.3711, TNR=0.8809, J=0.2520, MCC=0.2481, ConfusionMatrix=
[[1915  259]
 [ 244  144]]
Epoch 3, Phase test, Loss=0.4503, Acc=0.8151, AUC=0.7279, TPR=0.4194, TNR=0.8833, J=0.3026, MCC=0.2914, ConfusionMatrix=
[[1907  252]
 [ 216  156]]
Epoch 3 complete in 43.04

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5657, Acc=0.7078, AUC=0.7797, TPR=0.7079, TNR=0.7077, J=0.4156, MCC=0.4156, ConfusionMatrix=
[[2603 1075]
 [1058 2564]]
Epoch 4, Phase val, Loss=0.5198, Acc=0.7303, AUC=0.7405, TPR=0.5361, TNR=0.7649, J=0.3010, MCC=0.2402, ConfusionMatrix=
[[1663  511]
 [ 180  208]]
New Best AUC=0.7405. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18fixed-conv1x1-avgpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.5352, Acc=0.7211, AUC=0.7322, TPR=0.5618, TNR=0.7485, J=0.3103, MCC=0.2404, ConfusionMatrix=
[[1616  543]
 [ 163  209]]
Epoch 4 complete in 101.68

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5389, Acc=0.7286, AUC=0.8044, TPR=0.7258, TNR=0.7313, J=0.4571, MCC=0.4571, ConfusionMatrix=
[[2727 1002]
 [ 979 2592]]
Epoch 5, Phase val, Loss=0.6386, Acc=0.6538, AUC=0.7380, TPR=0.6985, TNR=0.6458, J=0.3443, MCC=0.2513, ConfusionMatrix=
[[1404  770]
 [ 117  271]]
Epoch 5, Phase test, Loss=0.6619, Acc=0.6183, AUC=0.7303, TPR=0.7016, TNR=0.6040, J=0.3056, MCC=0.2179, ConfusionMatrix=
[[1304  855]
 [ 111  261]]
Epoch 5 complete in 43.40

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5685, Acc=0.7103, AUC=0.7787, TPR=0.7184, TNR=0.7020, J=0.4204, MCC=0.4205, ConfusionMatrix=
[[2540 1078]
 [1037 2645]]
Epoch 6, Phase val, Loss=0.5978, Acc=0.6741, AUC=0.7303, TPR=0.6263, TNR=0.6826, J=0.3089, MCC=0.2301, ConfusionMatrix=
[[1484  690]
 [ 145  243]]
Epoch 6, Phase test, Loss=0.6243, Acc=0.6527, AUC=0.7257, TPR=0.6398, TNR=0.6549, J=0.2947, MCC=0.2141, ConfusionMatrix=
[[1414  745]
 [ 134  238]]
Epoch 6 complete in 69.81

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5503, Acc=0.7255, AUC=0.7957, TPR=0.7391, TNR=0.7118, J=0.4509, MCC=0.4511, ConfusionMatrix=
[[2596 1051]
 [ 953 2700]]
Epoch 7, Phase val, Loss=0.4555, Acc=0.7998, AUC=0.7164, TPR=0.3918, TNR=0.8726, J=0.2643, MCC=0.2538, ConfusionMatrix=
[[1897  277]
 [ 236  152]]
Epoch 7, Phase test, Loss=0.4602, Acc=0.7926, AUC=0.7213, TPR=0.4167, TNR=0.8573, J=0.2740, MCC=0.2510, ConfusionMatrix=
[[1851  308]
 [ 217  155]]
Epoch 7 complete in 35.51

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.5516, Acc=0.7151, AUC=0.7922, TPR=0.7255, TNR=0.7046, J=0.4300, MCC=0.4301, ConfusionMatrix=
[[2559 1073]
 [1007 2661]]
Epoch 8, Phase val, Loss=0.4368, Acc=0.8044, AUC=0.7389, TPR=0.3608, TNR=0.8836, J=0.2444, MCC=0.2432, ConfusionMatrix=
[[1921  253]
 [ 248  140]]
Epoch 8, Phase test, Loss=0.4424, Acc=0.8151, AUC=0.7337, TPR=0.4167, TNR=0.8837, J=0.3004, MCC=0.2898, ConfusionMatrix=
[[1908  251]
 [ 217  155]]
Epoch 8 complete in 34.02

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.5419, Acc=0.7237, AUC=0.8027, TPR=0.7335, TNR=0.7137, J=0.4471, MCC=0.4473, ConfusionMatrix=
[[2572 1032]
 [ 985 2711]]
Epoch 9, Phase val, Loss=0.4672, Acc=0.7767, AUC=0.7340, TPR=0.4149, TNR=0.8413, J=0.2563, MCC=0.2307, ConfusionMatrix=
[[1829  345]
 [ 227  161]]
Epoch 9, Phase test, Loss=0.4783, Acc=0.7878, AUC=0.7285, TPR=0.4839, TNR=0.8402, J=0.3241, MCC=0.2830, ConfusionMatrix=
[[1814  345]
 [ 192  180]]
Epoch 9 complete in 82.16

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.5393, Acc=0.7255, AUC=0.8031, TPR=0.7313, TNR=0.7197, J=0.4509, MCC=0.4510, ConfusionMatrix=
[[2624 1022]
 [ 982 2672]]
Epoch 10, Phase val, Loss=0.7079, Acc=0.6132, AUC=0.7398, TPR=0.7603, TNR=0.5869, J=0.3472, MCC=0.2496, ConfusionMatrix=
[[1276  898]
 [  93  295]]
Epoch 10, Phase test, Loss=0.7469, Acc=0.5709, AUC=0.7347, TPR=0.7554, TNR=0.5391, J=0.2945, MCC=0.2086, ConfusionMatrix=
[[1164  995]
 [  91  281]]
Epoch 10 complete in 31.46

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.5497, Acc=0.7155, AUC=0.7954, TPR=0.7392, TNR=0.6901, J=0.4292, MCC=0.4298, ConfusionMatrix=
[[2429 1091]
 [ 986 2794]]
Epoch 11, Phase val, Loss=0.6638, Acc=0.6366, AUC=0.7246, TPR=0.6830, TNR=0.6283, J=0.3113, MCC=0.2262, ConfusionMatrix=
[[1366  808]
 [ 123  265]]
Epoch 11, Phase test, Loss=0.6914, Acc=0.6057, AUC=0.7299, TPR=0.7043, TNR=0.5887, J=0.2930, MCC=0.2084, ConfusionMatrix=
[[1271  888]
 [ 110  262]]
Epoch 11 complete in 77.21

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.5518, Acc=0.7152, AUC=0.7912, TPR=0.7145, TNR=0.7159, J=0.4304, MCC=0.4302, ConfusionMatrix=
[[2686 1066]
 [1013 2535]]
Epoch 12, Phase val, Loss=0.4143, Acc=0.8197, AUC=0.7359, TPR=0.3041, TNR=0.9117, J=0.2158, MCC=0.2372, ConfusionMatrix=
[[1982  192]
 [ 270  118]]
Epoch 12, Phase test, Loss=0.4144, Acc=0.8348, AUC=0.7297, TPR=0.3710, TNR=0.9148, J=0.2857, MCC=0.3036, ConfusionMatrix=
[[1975  184]
 [ 234  138]]
Epoch 12 complete in 46.80

Early Stop!
Training complete in 11m 56s
The best model val AUC=0.740473164579, test AUC=0.732188836927.
Finish training resnet18fixed-conv1x1-avgpool_0

Start training resnet18scratch-conv1x1ab-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5912, Acc=0.6755, AUC=0.7466, TPR=0.6823, TNR=0.6687, J=0.3510, MCC=0.3510, ConfusionMatrix=
[[2448 1213]
 [1156 2483]]
Epoch 0, Phase val, Loss=0.6065, Acc=0.7721, AUC=0.7898, TPR=0.6057, TNR=0.8017, J=0.4074, MCC=0.3330, ConfusionMatrix=
[[1743  431]
 [ 153  235]]
New Best AUC=0.7898. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6395, Acc=0.7677, AUC=0.7606, TPR=0.6102, TNR=0.7948, J=0.4050, MCC=0.3251, ConfusionMatrix=
[[1716  443]
 [ 145  227]]
Epoch 0 complete in 49.48

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5505, Acc=0.7144, AUC=0.7914, TPR=0.6115, TNR=0.8155, J=0.4270, MCC=0.4365, ConfusionMatrix=
[[3002  679]
 [1406 2213]]
Epoch 1, Phase val, Loss=0.5225, Acc=0.8025, AUC=0.7873, TPR=0.5541, TNR=0.8468, J=0.4009, MCC=0.3505, ConfusionMatrix=
[[1841  333]
 [ 173  215]]
Epoch 1, Phase test, Loss=0.5315, Acc=0.8111, AUC=0.7672, TPR=0.5457, TNR=0.8569, J=0.4026, MCC=0.3548, ConfusionMatrix=
[[1850  309]
 [ 169  203]]
Epoch 1 complete in 73.10

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5277, Acc=0.7425, AUC=0.8175, TPR=0.6921, TNR=0.7935, J=0.4856, MCC=0.4879, ConfusionMatrix=
[[2878  749]
 [1131 2542]]
Epoch 2, Phase val, Loss=0.4380, Acc=0.8326, AUC=0.7839, TPR=0.4691, TNR=0.8974, J=0.3665, MCC=0.3601, ConfusionMatrix=
[[1951  223]
 [ 206  182]]
Epoch 2, Phase test, Loss=0.4463, Acc=0.8451, AUC=0.7604, TPR=0.4839, TNR=0.9074, J=0.3912, MCC=0.3878, ConfusionMatrix=
[[1959  200]
 [ 192  180]]
Epoch 2 complete in 42.93

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5074, Acc=0.7593, AUC=0.8292, TPR=0.7112, TNR=0.8079, J=0.5191, MCC=0.5214, ConfusionMatrix=
[[2935  698]
 [1059 2608]]
Epoch 3, Phase val, Loss=0.6190, Acc=0.7506, AUC=0.8008, TPR=0.7036, TNR=0.7590, J=0.4626, MCC=0.3582, ConfusionMatrix=
[[1650  524]
 [ 115  273]]
New Best AUC=0.8008. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.6503, Acc=0.7333, AUC=0.7794, TPR=0.6828, TNR=0.7420, J=0.4248, MCC=0.3223, ConfusionMatrix=
[[1602  557]
 [ 118  254]]
Epoch 3 complete in 82.91

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5192, Acc=0.7526, AUC=0.8234, TPR=0.6954, TNR=0.8081, J=0.5035, MCC=0.5071, ConfusionMatrix=
[[2994  711]
 [1095 2500]]
Epoch 4, Phase val, Loss=0.5006, Acc=0.7978, AUC=0.8030, TPR=0.6289, TNR=0.8280, J=0.4568, MCC=0.3828, ConfusionMatrix=
[[1800  374]
 [ 144  244]]
New Best AUC=0.8030. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.5067, Acc=0.8068, AUC=0.7784, TPR=0.6210, TNR=0.8388, J=0.4598, MCC=0.3876, ConfusionMatrix=
[[1811  348]
 [ 141  231]]
Epoch 4 complete in 45.19

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4919, Acc=0.7692, AUC=0.8427, TPR=0.7202, TNR=0.8179, J=0.5380, MCC=0.5407, ConfusionMatrix=
[[2995  667]
 [1018 2620]]
Epoch 5, Phase val, Loss=0.3932, Acc=0.8404, AUC=0.8047, TPR=0.4691, TNR=0.9066, J=0.3757, MCC=0.3769, ConfusionMatrix=
[[1971  203]
 [ 206  182]]
New Best AUC=0.8047. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 5, Phase test, Loss=0.3948, Acc=0.8542, AUC=0.7810, TPR=0.4651, TNR=0.9213, J=0.3863, MCC=0.3996, ConfusionMatrix=
[[1989  170]
 [ 199  173]]
Epoch 5 complete in 63.89

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5001, Acc=0.7627, AUC=0.8371, TPR=0.7145, TNR=0.8093, J=0.5238, MCC=0.5266, ConfusionMatrix=
[[3005  708]
 [1024 2563]]
Epoch 6, Phase val, Loss=0.5146, Acc=0.7970, AUC=0.8039, TPR=0.6340, TNR=0.8261, J=0.4601, MCC=0.3843, ConfusionMatrix=
[[1796  378]
 [ 142  246]]
Epoch 6, Phase test, Loss=0.5349, Acc=0.7957, AUC=0.7791, TPR=0.6344, TNR=0.8235, J=0.4579, MCC=0.3777, ConfusionMatrix=
[[1778  381]
 [ 136  236]]
Epoch 6 complete in 76.68

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4736, Acc=0.7832, AUC=0.8555, TPR=0.7478, TNR=0.8191, J=0.5669, MCC=0.5681, ConfusionMatrix=
[[2965  655]
 [ 928 2752]]
Epoch 7, Phase val, Loss=0.4652, Acc=0.8130, AUC=0.7955, TPR=0.5464, TNR=0.8606, J=0.4070, MCC=0.3641, ConfusionMatrix=
[[1871  303]
 [ 176  212]]
Epoch 7, Phase test, Loss=0.4844, Acc=0.8210, AUC=0.7836, TPR=0.5806, TNR=0.8624, J=0.4431, MCC=0.3903, ConfusionMatrix=
[[1862  297]
 [ 156  216]]
Epoch 7 complete in 52.94

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4813, Acc=0.7826, AUC=0.8504, TPR=0.7580, TNR=0.8081, J=0.5660, MCC=0.5664, ConfusionMatrix=
[[2901  689]
 [ 898 2812]]
Epoch 8, Phase val, Loss=0.6176, Acc=0.7459, AUC=0.8021, TPR=0.7371, TNR=0.7475, J=0.4846, MCC=0.3706, ConfusionMatrix=
[[1625  549]
 [ 102  286]]
Epoch 8, Phase test, Loss=0.6191, Acc=0.7226, AUC=0.7898, TPR=0.7177, TNR=0.7235, J=0.4412, MCC=0.3295, ConfusionMatrix=
[[1562  597]
 [ 105  267]]
Epoch 8 complete in 77.96

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4688, Acc=0.7884, AUC=0.8593, TPR=0.7653, TNR=0.8118, J=0.5771, MCC=0.5776, ConfusionMatrix=
[[2941  682]
 [ 863 2814]]
Epoch 9, Phase val, Loss=0.4330, Acc=0.8232, AUC=0.7991, TPR=0.5361, TNR=0.8744, J=0.4105, MCC=0.3768, ConfusionMatrix=
[[1901  273]
 [ 180  208]]
Epoch 9, Phase test, Loss=0.4400, Acc=0.8412, AUC=0.7833, TPR=0.5591, TNR=0.8898, J=0.4489, MCC=0.4172, ConfusionMatrix=
[[1921  238]
 [ 164  208]]
Epoch 9 complete in 40.44

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4602, Acc=0.7951, AUC=0.8650, TPR=0.7640, TNR=0.8269, J=0.5909, MCC=0.5918, ConfusionMatrix=
[[2981  624]
 [ 872 2823]]
Epoch 10, Phase val, Loss=0.6072, Acc=0.7350, AUC=0.8025, TPR=0.7113, TNR=0.7392, J=0.4505, MCC=0.3437, ConfusionMatrix=
[[1607  567]
 [ 112  276]]
Epoch 10, Phase test, Loss=0.6277, Acc=0.7238, AUC=0.7821, TPR=0.7097, TNR=0.7263, J=0.4359, MCC=0.3264, ConfusionMatrix=
[[1568  591]
 [ 108  264]]
Epoch 10 complete in 70.69

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4596, Acc=0.7964, AUC=0.8664, TPR=0.7652, TNR=0.8281, J=0.5932, MCC=0.5943, ConfusionMatrix=
[[3005  624]
 [ 862 2809]]
Epoch 11, Phase val, Loss=0.7518, Acc=0.6811, AUC=0.8107, TPR=0.7938, TNR=0.6610, J=0.4548, MCC=0.3318, ConfusionMatrix=
[[1437  737]
 [  80  308]]
New Best AUC=0.8107. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-maxpool_0_bestAUC.pth
Epoch 11, Phase test, Loss=0.7790, Acc=0.6661, AUC=0.7925, TPR=0.7823, TNR=0.6461, J=0.4284, MCC=0.3077, ConfusionMatrix=
[[1395  764]
 [  81  291]]
Epoch 11 complete in 50.36

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4439, Acc=0.8037, AUC=0.8759, TPR=0.7749, TNR=0.8320, J=0.6069, MCC=0.6080, ConfusionMatrix=
[[3065  619]
 [ 814 2802]]
Epoch 12, Phase val, Loss=0.4430, Acc=0.8283, AUC=0.7876, TPR=0.5747, TNR=0.8735, J=0.4482, MCC=0.4061, ConfusionMatrix=
[[1899  275]
 [ 165  223]]
Epoch 12, Phase test, Loss=0.4433, Acc=0.8309, AUC=0.7695, TPR=0.5296, TNR=0.8828, J=0.4124, MCC=0.3819, ConfusionMatrix=
[[1906  253]
 [ 175  197]]
Epoch 12 complete in 66.53

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4423, Acc=0.8059, AUC=0.8775, TPR=0.7786, TNR=0.8326, J=0.6112, MCC=0.6123, ConfusionMatrix=
[[3069  617]
 [ 800 2814]]
Epoch 13, Phase val, Loss=0.5639, Acc=0.7826, AUC=0.8016, TPR=0.6598, TNR=0.8045, J=0.4643, MCC=0.3768, ConfusionMatrix=
[[1749  425]
 [ 132  256]]
Epoch 13, Phase test, Loss=0.5752, Acc=0.7681, AUC=0.7848, TPR=0.6667, TNR=0.7855, J=0.4522, MCC=0.3563, ConfusionMatrix=
[[1696  463]
 [ 124  248]]
Epoch 13 complete in 72.71

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4343, Acc=0.8115, AUC=0.8815, TPR=0.7899, TNR=0.8345, J=0.6244, MCC=0.6243, ConfusionMatrix=
[[2954  586]
 [ 790 2970]]
Epoch 14, Phase val, Loss=0.4090, Acc=0.8255, AUC=0.8016, TPR=0.5155, TNR=0.8809, J=0.3963, MCC=0.3705, ConfusionMatrix=
[[1915  259]
 [ 188  200]]
Epoch 14, Phase test, Loss=0.4139, Acc=0.8281, AUC=0.7777, TPR=0.5672, TNR=0.8731, J=0.4403, MCC=0.3961, ConfusionMatrix=
[[1885  274]
 [ 161  211]]
Epoch 14 complete in 46.32

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4236, Acc=0.8178, AUC=0.8886, TPR=0.7964, TNR=0.8392, J=0.6356, MCC=0.6362, ConfusionMatrix=
[[3064  587]
 [ 743 2906]]
Epoch 15, Phase val, Loss=0.6917, Acc=0.7084, AUC=0.8058, TPR=0.7629, TNR=0.6987, J=0.4616, MCC=0.3425, ConfusionMatrix=
[[1519  655]
 [  92  296]]
Epoch 15, Phase test, Loss=0.7170, Acc=0.6808, AUC=0.7869, TPR=0.7527, TNR=0.6684, J=0.4211, MCC=0.3052, ConfusionMatrix=
[[1443  716]
 [  92  280]]
Epoch 15 complete in 72.15

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4324, Acc=0.8168, AUC=0.8841, TPR=0.7877, TNR=0.8446, J=0.6323, MCC=0.6338, ConfusionMatrix=
[[3158  581]
 [ 756 2805]]
Epoch 16, Phase val, Loss=0.4067, Acc=0.8396, AUC=0.7816, TPR=0.4794, TNR=0.9039, J=0.3832, MCC=0.3804, ConfusionMatrix=
[[1965  209]
 [ 202  186]]
Epoch 16, Phase test, Loss=0.4219, Acc=0.8526, AUC=0.7613, TPR=0.5511, TNR=0.9046, J=0.4557, MCC=0.4375, ConfusionMatrix=
[[1953  206]
 [ 167  205]]
Epoch 16 complete in 39.86

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4044, Acc=0.8259, AUC=0.8986, TPR=0.7966, TNR=0.8541, J=0.6507, MCC=0.6521, ConfusionMatrix=
[[3178  543]
 [ 728 2851]]
Epoch 17, Phase val, Loss=0.4725, Acc=0.8087, AUC=0.7781, TPR=0.5902, TNR=0.8477, J=0.4380, MCC=0.3799, ConfusionMatrix=
[[1843  331]
 [ 159  229]]
Epoch 17, Phase test, Loss=0.5019, Acc=0.7942, AUC=0.7840, TPR=0.6156, TNR=0.8249, J=0.4405, MCC=0.3653, ConfusionMatrix=
[[1781  378]
 [ 143  229]]
Epoch 17 complete in 67.45

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.3779, Acc=0.8423, AUC=0.9122, TPR=0.8216, TNR=0.8622, J=0.6838, MCC=0.6847, ConfusionMatrix=
[[3215  514]
 [ 637 2934]]
Epoch 18, Phase val, Loss=0.4034, Acc=0.8454, AUC=0.7776, TPR=0.4716, TNR=0.9121, J=0.3838, MCC=0.3897, ConfusionMatrix=
[[1983  191]
 [ 205  183]]
Epoch 18, Phase test, Loss=0.4229, Acc=0.8507, AUC=0.7339, TPR=0.4543, TNR=0.9189, J=0.3732, MCC=0.3856, ConfusionMatrix=
[[1984  175]
 [ 203  169]]
Epoch 18 complete in 38.84

Epoch 19 starting with learning_rate: [0.005]
Epoch 19, Phase train, Loss=0.3932, Acc=0.8340, AUC=0.9049, TPR=0.8238, TNR=0.8444, J=0.6682, MCC=0.6682, ConfusionMatrix=
[[3050  562]
 [ 650 3038]]
Epoch 19, Phase val, Loss=0.5075, Acc=0.7959, AUC=0.7782, TPR=0.6134, TNR=0.8284, J=0.4418, MCC=0.3717, ConfusionMatrix=
[[1801  373]
 [ 150  238]]
Epoch 19, Phase test, Loss=0.5134, Acc=0.7870, AUC=0.7631, TPR=0.6129, TNR=0.8170, J=0.4299, MCC=0.3534, ConfusionMatrix=
[[1764  395]
 [ 144  228]]
Epoch 19 complete in 60.06

Early Stop!
Training complete in 19m 50s
The best model val AUC=0.810730612013, test AUC=0.792516447778.
Finish training resnet18scratch-conv1x1ab-maxpool_0

Start training resnet18scratch-conv1x1ab-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6079, Acc=0.6563, AUC=0.7344, TPR=0.7617, TNR=0.5500, J=0.3116, MCC=0.3189, ConfusionMatrix=
[[1998 1635]
 [ 874 2793]]
Epoch 0, Phase val, Loss=0.6767, Acc=0.6877, AUC=0.7690, TPR=0.7113, TNR=0.6835, J=0.3949, MCC=0.2922, ConfusionMatrix=
[[1486  688]
 [ 112  276]]
New Best AUC=0.7690. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.6644, Acc=0.6523, AUC=0.7557, TPR=0.7204, TNR=0.6406, J=0.3610, MCC=0.2597, ConfusionMatrix=
[[1383  776]
 [ 104  268]]
Epoch 0 complete in 41.25

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5435, Acc=0.7315, AUC=0.8022, TPR=0.6743, TNR=0.7872, J=0.4615, MCC=0.4648, ConfusionMatrix=
[[2912  787]
 [1173 2428]]
Epoch 1, Phase val, Loss=0.6326, Acc=0.6854, AUC=0.7675, TPR=0.7010, TNR=0.6826, J=0.3836, MCC=0.2840, ConfusionMatrix=
[[1484  690]
 [ 116  272]]
Epoch 1, Phase test, Loss=0.6213, Acc=0.6650, AUC=0.7629, TPR=0.7097, TNR=0.6572, J=0.3669, MCC=0.2656, ConfusionMatrix=
[[1419  740]
 [ 108  264]]
Epoch 1 complete in 37.95

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5208, Acc=0.7458, AUC=0.8234, TPR=0.6849, TNR=0.8061, J=0.4910, MCC=0.4947, ConfusionMatrix=
[[2955  711]
 [1145 2489]]
Epoch 2, Phase val, Loss=0.4812, Acc=0.8255, AUC=0.7876, TPR=0.5206, TNR=0.8799, J=0.4006, MCC=0.3732, ConfusionMatrix=
[[1913  261]
 [ 186  202]]
New Best AUC=0.7876. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.4815, Acc=0.8127, AUC=0.7712, TPR=0.5349, TNR=0.8606, J=0.3955, MCC=0.3518, ConfusionMatrix=
[[1858  301]
 [ 173  199]]
Epoch 2 complete in 39.74

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5168, Acc=0.7482, AUC=0.8217, TPR=0.6890, TNR=0.8075, J=0.4964, MCC=0.4999, ConfusionMatrix=
[[2948  703]
 [1135 2514]]
Epoch 3, Phase val, Loss=0.6726, Acc=0.7116, AUC=0.7980, TPR=0.7500, TNR=0.7047, J=0.4547, MCC=0.3387, ConfusionMatrix=
[[1532  642]
 [  97  291]]
New Best AUC=0.7980. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.6778, Acc=0.6855, AUC=0.7823, TPR=0.7392, TNR=0.6762, J=0.4155, MCC=0.3024, ConfusionMatrix=
[[1460  699]
 [  97  275]]
Epoch 3 complete in 38.38

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5141, Acc=0.7558, AUC=0.8283, TPR=0.7133, TNR=0.8008, J=0.5141, MCC=0.5153, ConfusionMatrix=
[[2835  705]
 [1078 2682]]
Epoch 4, Phase val, Loss=0.4241, Acc=0.8458, AUC=0.7996, TPR=0.4768, TNR=0.9117, J=0.3885, MCC=0.3931, ConfusionMatrix=
[[1982  192]
 [ 203  185]]
New Best AUC=0.7996. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 4, Phase test, Loss=0.4250, Acc=0.8467, AUC=0.7837, TPR=0.4570, TNR=0.9138, J=0.3708, MCC=0.3777, ConfusionMatrix=
[[1973  186]
 [ 202  170]]
Epoch 4 complete in 39.12

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5002, Acc=0.7693, AUC=0.8387, TPR=0.7106, TNR=0.8268, J=0.5374, MCC=0.5414, ConfusionMatrix=
[[3050  639]
 [1045 2566]]
Epoch 5, Phase val, Loss=0.6339, Acc=0.7369, AUC=0.8065, TPR=0.7242, TNR=0.7392, J=0.4634, MCC=0.3530, ConfusionMatrix=
[[1607  567]
 [ 107  281]]
New Best AUC=0.8065. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 5, Phase test, Loss=0.6265, Acc=0.7262, AUC=0.7872, TPR=0.7016, TNR=0.7304, J=0.4320, MCC=0.3246, ConfusionMatrix=
[[1577  582]
 [ 111  261]]
Epoch 5 complete in 38.44

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5101, Acc=0.7612, AUC=0.8296, TPR=0.7082, TNR=0.8142, J=0.5225, MCC=0.5254, ConfusionMatrix=
[[2972  678]
 [1065 2585]]
Epoch 6, Phase val, Loss=0.5917, Acc=0.7607, AUC=0.8051, TPR=0.6985, TNR=0.7718, J=0.4703, MCC=0.3681, ConfusionMatrix=
[[1678  496]
 [ 117  271]]
Epoch 6, Phase test, Loss=0.6023, Acc=0.7460, AUC=0.7878, TPR=0.6989, TNR=0.7541, J=0.4530, MCC=0.3460, ConfusionMatrix=
[[1628  531]
 [ 112  260]]
Epoch 6 complete in 39.55

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.5061, Acc=0.7626, AUC=0.8323, TPR=0.7048, TNR=0.8199, J=0.5247, MCC=0.5284, ConfusionMatrix=
[[3005  660]
 [1073 2562]]
Epoch 7, Phase val, Loss=0.5107, Acc=0.8115, AUC=0.8001, TPR=0.5773, TNR=0.8533, J=0.4306, MCC=0.3777, ConfusionMatrix=
[[1855  319]
 [ 164  224]]
Epoch 7, Phase test, Loss=0.4963, Acc=0.8107, AUC=0.7874, TPR=0.5753, TNR=0.8513, J=0.4266, MCC=0.3700, ConfusionMatrix=
[[1838  321]
 [ 158  214]]
Epoch 7 complete in 39.03

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4880, Acc=0.7725, AUC=0.8472, TPR=0.7454, TNR=0.8006, J=0.5460, MCC=0.5464, ConfusionMatrix=
[[2866  714]
 [ 947 2773]]
Epoch 8, Phase val, Loss=0.5429, Acc=0.7685, AUC=0.7839, TPR=0.6108, TNR=0.7967, J=0.4075, MCC=0.3310, ConfusionMatrix=
[[1732  442]
 [ 151  237]]
Epoch 8, Phase test, Loss=0.5478, Acc=0.7756, AUC=0.7707, TPR=0.6263, TNR=0.8013, J=0.4276, MCC=0.3445, ConfusionMatrix=
[[1730  429]
 [ 139  233]]
Epoch 8 complete in 39.64

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4797, Acc=0.7823, AUC=0.8495, TPR=0.7325, TNR=0.8326, J=0.5650, MCC=0.5677, ConfusionMatrix=
[[3028  609]
 [ 980 2683]]
Epoch 9, Phase val, Loss=0.4377, Acc=0.8208, AUC=0.7849, TPR=0.4613, TNR=0.8850, J=0.3463, MCC=0.3325, ConfusionMatrix=
[[1924  250]
 [ 209  179]]
Epoch 9, Phase test, Loss=0.4245, Acc=0.8400, AUC=0.7838, TPR=0.5027, TNR=0.8981, J=0.4008, MCC=0.3863, ConfusionMatrix=
[[1939  220]
 [ 185  187]]
Epoch 9 complete in 38.43

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4780, Acc=0.7811, AUC=0.8530, TPR=0.7412, TNR=0.8222, J=0.5633, MCC=0.5648, ConfusionMatrix=
[[2959  640]
 [ 958 2743]]
Epoch 10, Phase val, Loss=0.5991, Acc=0.7869, AUC=0.8066, TPR=0.6727, TNR=0.8073, J=0.4799, MCC=0.3897, ConfusionMatrix=
[[1755  419]
 [ 127  261]]
New Best AUC=0.8066. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1ab-avgpool_0_bestAUC.pth
Epoch 10, Phase test, Loss=0.6005, Acc=0.7511, AUC=0.7768, TPR=0.6452, TNR=0.7693, J=0.4145, MCC=0.3229, ConfusionMatrix=
[[1661  498]
 [ 132  240]]
Epoch 10 complete in 37.39

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4735, Acc=0.7844, AUC=0.8552, TPR=0.7306, TNR=0.8366, J=0.5672, MCC=0.5709, ConfusionMatrix=
[[3098  605]
 [ 969 2628]]
Epoch 11, Phase val, Loss=0.3962, Acc=0.8509, AUC=0.7875, TPR=0.3918, TNR=0.9328, J=0.3246, MCC=0.3629, ConfusionMatrix=
[[2028  146]
 [ 236  152]]
Epoch 11, Phase test, Loss=0.3891, Acc=0.8566, AUC=0.7840, TPR=0.4301, TNR=0.9301, J=0.3602, MCC=0.3885, ConfusionMatrix=
[[2008  151]
 [ 212  160]]
Epoch 11 complete in 39.59

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4672, Acc=0.7878, AUC=0.8595, TPR=0.7330, TNR=0.8428, J=0.5758, MCC=0.5792, ConfusionMatrix=
[[3071  573]
 [ 976 2680]]
Epoch 12, Phase val, Loss=0.5619, Acc=0.7553, AUC=0.7987, TPR=0.6675, TNR=0.7709, J=0.4385, MCC=0.3445, ConfusionMatrix=
[[1676  498]
 [ 129  259]]
Epoch 12, Phase test, Loss=0.5761, Acc=0.7515, AUC=0.7842, TPR=0.6801, TNR=0.7638, J=0.4439, MCC=0.3425, ConfusionMatrix=
[[1649  510]
 [ 119  253]]
Epoch 12 complete in 37.85

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4761, Acc=0.7795, AUC=0.8517, TPR=0.7418, TNR=0.8174, J=0.5592, MCC=0.5607, ConfusionMatrix=
[[2972  664]
 [ 946 2718]]
Epoch 13, Phase val, Loss=0.4474, Acc=0.8150, AUC=0.7871, TPR=0.6031, TNR=0.8528, J=0.4559, MCC=0.3970, ConfusionMatrix=
[[1854  320]
 [ 154  234]]
Epoch 13, Phase test, Loss=0.4407, Acc=0.8135, AUC=0.7825, TPR=0.5323, TNR=0.8620, J=0.3942, MCC=0.3517, ConfusionMatrix=
[[1861  298]
 [ 174  198]]
Epoch 13 complete in 38.16

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4708, Acc=0.7868, AUC=0.8582, TPR=0.7589, TNR=0.8161, J=0.5749, MCC=0.5754, ConfusionMatrix=
[[2915  657]
 [ 899 2829]]
Epoch 14, Phase val, Loss=0.5657, Acc=0.7760, AUC=0.7723, TPR=0.6418, TNR=0.7999, J=0.4417, MCC=0.3579, ConfusionMatrix=
[[1739  435]
 [ 139  249]]
Epoch 14, Phase test, Loss=0.5725, Acc=0.7574, AUC=0.7728, TPR=0.6452, TNR=0.7767, J=0.4219, MCC=0.3308, ConfusionMatrix=
[[1677  482]
 [ 132  240]]
Epoch 14 complete in 38.59

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4500, Acc=0.7984, AUC=0.8718, TPR=0.7596, TNR=0.8380, J=0.5976, MCC=0.5991, ConfusionMatrix=
[[3026  585]
 [ 887 2802]]
Epoch 15, Phase val, Loss=0.4709, Acc=0.8259, AUC=0.7869, TPR=0.5747, TNR=0.8707, J=0.4455, MCC=0.4017, ConfusionMatrix=
[[1893  281]
 [ 165  223]]
Epoch 15, Phase test, Loss=0.4799, Acc=0.8202, AUC=0.7784, TPR=0.5968, TNR=0.8587, J=0.4555, MCC=0.3972, ConfusionMatrix=
[[1854  305]
 [ 150  222]]
Epoch 15 complete in 38.65

Epoch 16 starting with learning_rate: [0.005]
Epoch 16, Phase train, Loss=0.4608, Acc=0.7926, AUC=0.8656, TPR=0.7433, TNR=0.8397, J=0.5829, MCC=0.5863, ConfusionMatrix=
[[3137  599]
 [ 915 2649]]
Epoch 16, Phase val, Loss=0.7045, Acc=0.6956, AUC=0.8049, TPR=0.7577, TNR=0.6845, J=0.4422, MCC=0.3262, ConfusionMatrix=
[[1488  686]
 [  94  294]]
Epoch 16, Phase test, Loss=0.6941, Acc=0.6883, AUC=0.7839, TPR=0.7473, TNR=0.6781, J=0.4254, MCC=0.3096, ConfusionMatrix=
[[1464  695]
 [  94  278]]
Epoch 16 complete in 38.35

Epoch 17 starting with learning_rate: [0.005]
Epoch 17, Phase train, Loss=0.4433, Acc=0.7986, AUC=0.8766, TPR=0.7685, TNR=0.8297, J=0.5982, MCC=0.5989, ConfusionMatrix=
[[2981  612]
 [ 858 2849]]
Epoch 17, Phase val, Loss=0.4493, Acc=0.8310, AUC=0.7632, TPR=0.4716, TNR=0.8951, J=0.3668, MCC=0.3583, ConfusionMatrix=
[[1946  228]
 [ 205  183]]
Epoch 17, Phase test, Loss=0.4353, Acc=0.8289, AUC=0.7621, TPR=0.5403, TNR=0.8786, J=0.4190, MCC=0.3837, ConfusionMatrix=
[[1897  262]
 [ 171  201]]
Epoch 17 complete in 37.78

Epoch 18 starting with learning_rate: [0.005]
Epoch 18, Phase train, Loss=0.4261, Acc=0.8127, AUC=0.8855, TPR=0.7845, TNR=0.8418, J=0.6263, MCC=0.6270, ConfusionMatrix=
[[3028  569]
 [ 798 2905]]
Epoch 18, Phase val, Loss=0.7161, Acc=0.7596, AUC=0.7984, TPR=0.7036, TNR=0.7695, J=0.4732, MCC=0.3694, ConfusionMatrix=
[[1673  501]
 [ 115  273]]
Epoch 18, Phase test, Loss=0.7155, Acc=0.7325, AUC=0.7726, TPR=0.6989, TNR=0.7383, J=0.4372, MCC=0.3303, ConfusionMatrix=
[[1594  565]
 [ 112  260]]
Epoch 18 complete in 38.53

Early Stop!
Training complete in 12m 16s
The best model val AUC=0.806634049071, test AUC=0.776782112388.
Finish training resnet18scratch-conv1x1ab-avgpool_0

Start training resnet18scratch-conv1x1-maxpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.6029, Acc=0.6577, AUC=0.7311, TPR=0.5974, TNR=0.7174, J=0.3148, MCC=0.3172, ConfusionMatrix=
[[2630 1036]
 [1463 2171]]
Epoch 0, Phase val, Loss=0.4875, Acc=0.8072, AUC=0.7627, TPR=0.4588, TNR=0.8694, J=0.3281, MCC=0.3060, ConfusionMatrix=
[[1890  284]
 [ 210  178]]
New Best AUC=0.7627. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.4798, Acc=0.8198, AUC=0.7537, TPR=0.4624, TNR=0.8814, J=0.3438, MCC=0.3248, ConfusionMatrix=
[[1903  256]
 [ 200  172]]
Epoch 0 complete in 37.96

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5391, Acc=0.7308, AUC=0.8032, TPR=0.6703, TNR=0.7916, J=0.4619, MCC=0.4653, ConfusionMatrix=
[[2883  759]
 [1206 2452]]
Epoch 1, Phase val, Loss=0.6346, Acc=0.7549, AUC=0.7869, TPR=0.6418, TNR=0.7751, J=0.4168, MCC=0.3300, ConfusionMatrix=
[[1685  489]
 [ 139  249]]
New Best AUC=0.7869. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.6404, Acc=0.7452, AUC=0.7596, TPR=0.6398, TNR=0.7633, J=0.4031, MCC=0.3127, ConfusionMatrix=
[[1648  511]
 [ 134  238]]
Epoch 1 complete in 39.53

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5364, Acc=0.7353, AUC=0.8119, TPR=0.6852, TNR=0.7867, J=0.4719, MCC=0.4741, ConfusionMatrix=
[[2837  769]
 [1163 2531]]
Epoch 2, Phase val, Loss=0.7905, Acc=0.6440, AUC=0.7919, TPR=0.7861, TNR=0.6187, J=0.4048, MCC=0.2921, ConfusionMatrix=
[[1345  829]
 [  83  305]]
New Best AUC=0.7919. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.8139, Acc=0.6278, AUC=0.7731, TPR=0.7661, TNR=0.6040, J=0.3701, MCC=0.2634, ConfusionMatrix=
[[1304  855]
 [  87  285]]
Epoch 2 complete in 39.19

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5350, Acc=0.7370, AUC=0.8098, TPR=0.7013, TNR=0.7729, J=0.4741, MCC=0.4753, ConfusionMatrix=
[[2814  827]
 [1093 2566]]
Epoch 3, Phase val, Loss=0.6564, Acc=0.7182, AUC=0.7891, TPR=0.7242, TNR=0.7171, J=0.4413, MCC=0.3318, ConfusionMatrix=
[[1559  615]
 [ 107  281]]
Epoch 3, Phase test, Loss=0.6616, Acc=0.6902, AUC=0.7739, TPR=0.7070, TNR=0.6874, J=0.3943, MCC=0.2891, ConfusionMatrix=
[[1484  675]
 [ 109  263]]
Epoch 3 complete in 38.22

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5120, Acc=0.7551, AUC=0.8282, TPR=0.7181, TNR=0.7918, J=0.5099, MCC=0.5113, ConfusionMatrix=
[[2901  763]
 [1025 2611]]
Epoch 4, Phase val, Loss=0.5104, Acc=0.7873, AUC=0.7911, TPR=0.6289, TNR=0.8155, J=0.4444, MCC=0.3671, ConfusionMatrix=
[[1773  401]
 [ 144  244]]
Epoch 4, Phase test, Loss=0.5262, Acc=0.7898, AUC=0.7784, TPR=0.6156, TNR=0.8198, J=0.4354, MCC=0.3589, ConfusionMatrix=
[[1770  389]
 [ 143  229]]
Epoch 4 complete in 38.09

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.4721, Acc=0.7862, AUC=0.8578, TPR=0.7616, TNR=0.8107, J=0.5723, MCC=0.5730, ConfusionMatrix=
[[2959  691]
 [ 870 2780]]
Epoch 5, Phase val, Loss=0.4974, Acc=0.8068, AUC=0.7956, TPR=0.6289, TNR=0.8385, J=0.4674, MCC=0.3968, ConfusionMatrix=
[[1823  351]
 [ 144  244]]
New Best AUC=0.7956. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-maxpool_0_bestAUC.pth
Epoch 5, Phase test, Loss=0.5028, Acc=0.8032, AUC=0.7715, TPR=0.5806, TNR=0.8416, J=0.4222, MCC=0.3606, ConfusionMatrix=
[[1817  342]
 [ 156  216]]
Epoch 5 complete in 38.23

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.4805, Acc=0.7800, AUC=0.8517, TPR=0.7440, TNR=0.8154, J=0.5594, MCC=0.5610, ConfusionMatrix=
[[3000  679]
 [ 927 2694]]
Epoch 6, Phase val, Loss=0.4178, Acc=0.8247, AUC=0.7715, TPR=0.5541, TNR=0.8730, J=0.4272, MCC=0.3891, ConfusionMatrix=
[[1898  276]
 [ 173  215]]
Epoch 6, Phase test, Loss=0.4289, Acc=0.8345, AUC=0.7566, TPR=0.5296, TNR=0.8870, J=0.4166, MCC=0.3888, ConfusionMatrix=
[[1915  244]
 [ 175  197]]
Epoch 6 complete in 38.89

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4728, Acc=0.7851, AUC=0.8554, TPR=0.7663, TNR=0.8037, J=0.5701, MCC=0.5705, ConfusionMatrix=
[[2940  718]
 [ 851 2791]]
Epoch 7, Phase val, Loss=0.4823, Acc=0.7931, AUC=0.7522, TPR=0.5438, TNR=0.8376, J=0.3814, MCC=0.3300, ConfusionMatrix=
[[1821  353]
 [ 177  211]]
Epoch 7, Phase test, Loss=0.4951, Acc=0.7874, AUC=0.7545, TPR=0.5699, TNR=0.8249, J=0.3948, MCC=0.3306, ConfusionMatrix=
[[1781  378]
 [ 160  212]]
Epoch 7 complete in 37.60

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4694, Acc=0.7832, AUC=0.8579, TPR=0.7611, TNR=0.8052, J=0.5664, MCC=0.5669, ConfusionMatrix=
[[2935  710]
 [ 873 2782]]
Epoch 8, Phase val, Loss=0.4679, Acc=0.8037, AUC=0.7835, TPR=0.5954, TNR=0.8408, J=0.4362, MCC=0.3743, ConfusionMatrix=
[[1828  346]
 [ 157  231]]
Epoch 8, Phase test, Loss=0.4714, Acc=0.8040, AUC=0.7786, TPR=0.5914, TNR=0.8407, J=0.4321, MCC=0.3676, ConfusionMatrix=
[[1815  344]
 [ 152  220]]
Epoch 8 complete in 38.27

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4621, Acc=0.7949, AUC=0.8639, TPR=0.7707, TNR=0.8187, J=0.5895, MCC=0.5903, ConfusionMatrix=
[[3013  667]
 [ 830 2790]]
Epoch 9, Phase val, Loss=0.4165, Acc=0.8333, AUC=0.7732, TPR=0.5000, TNR=0.8928, J=0.3928, MCC=0.3779, ConfusionMatrix=
[[1941  233]
 [ 194  194]]
Epoch 9, Phase test, Loss=0.4265, Acc=0.8285, AUC=0.7713, TPR=0.4946, TNR=0.8861, J=0.3807, MCC=0.3589, ConfusionMatrix=
[[1913  246]
 [ 188  184]]
Epoch 9 complete in 38.33

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4544, Acc=0.7997, AUC=0.8689, TPR=0.7786, TNR=0.8213, J=0.5999, MCC=0.6002, ConfusionMatrix=
[[2968  646]
 [ 816 2870]]
Epoch 10, Phase val, Loss=0.5673, Acc=0.7412, AUC=0.7786, TPR=0.6753, TNR=0.7530, J=0.4282, MCC=0.3314, ConfusionMatrix=
[[1637  537]
 [ 126  262]]
Epoch 10, Phase test, Loss=0.5793, Acc=0.7337, AUC=0.7812, TPR=0.6935, TNR=0.7406, J=0.4342, MCC=0.3287, ConfusionMatrix=
[[1599  560]
 [ 114  258]]
Epoch 10 complete in 37.47

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4373, Acc=0.8053, AUC=0.8796, TPR=0.7940, TNR=0.8168, J=0.6108, MCC=0.6109, ConfusionMatrix=
[[2961  664]
 [ 757 2918]]
Epoch 11, Phase val, Loss=0.4960, Acc=0.8150, AUC=0.7621, TPR=0.6314, TNR=0.8477, J=0.4792, MCC=0.4115, ConfusionMatrix=
[[1843  331]
 [ 143  245]]
Epoch 11, Phase test, Loss=0.4963, Acc=0.8064, AUC=0.7657, TPR=0.6129, TNR=0.8397, J=0.4526, MCC=0.3827, ConfusionMatrix=
[[1813  346]
 [ 144  228]]
Epoch 11 complete in 38.27

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4345, Acc=0.8062, AUC=0.8813, TPR=0.7880, TNR=0.8244, J=0.6124, MCC=0.6128, ConfusionMatrix=
[[3000  639]
 [ 776 2885]]
Epoch 12, Phase val, Loss=0.7135, Acc=0.6846, AUC=0.7863, TPR=0.7448, TNR=0.6739, J=0.4187, MCC=0.3078, ConfusionMatrix=
[[1465  709]
 [  99  289]]
Epoch 12, Phase test, Loss=0.7289, Acc=0.6713, AUC=0.7677, TPR=0.7177, TNR=0.6633, J=0.3810, MCC=0.2763, ConfusionMatrix=
[[1432  727]
 [ 105  267]]
Epoch 12 complete in 36.71

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4037, Acc=0.8232, AUC=0.8987, TPR=0.8113, TNR=0.8348, J=0.6461, MCC=0.6464, ConfusionMatrix=
[[3072  608]
 [ 683 2937]]
Epoch 13, Phase val, Loss=0.4236, Acc=0.8345, AUC=0.7596, TPR=0.5155, TNR=0.8914, J=0.4069, MCC=0.3882, ConfusionMatrix=
[[1938  236]
 [ 188  200]]
Epoch 13, Phase test, Loss=0.4179, Acc=0.8392, AUC=0.7569, TPR=0.5161, TNR=0.8949, J=0.4110, MCC=0.3915, ConfusionMatrix=
[[1932  227]
 [ 180  192]]
Epoch 13 complete in 38.54

Early Stop!
Training complete in 8m 55s
The best model val AUC=0.795551219188, test AUC=0.771521562651.
Finish training resnet18scratch-conv1x1-maxpool_0

Start training resnet18scratch-conv1x1-avgpool_0
Epoch 0 starting with learning_rate: [0.005]
Epoch 0, Phase train, Loss=0.5736, Acc=0.6956, AUC=0.7718, TPR=0.6946, TNR=0.6967, J=0.3912, MCC=0.3912, ConfusionMatrix=
[[2524 1099]
 [1123 2554]]
Epoch 0, Phase val, Loss=0.5714, Acc=0.7635, AUC=0.7750, TPR=0.6082, TNR=0.7912, J=0.3994, MCC=0.3228, ConfusionMatrix=
[[1720  454]
 [ 152  236]]
New Best AUC=0.7750. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 0, Phase test, Loss=0.5433, Acc=0.7708, AUC=0.7718, TPR=0.6237, TNR=0.7962, J=0.4199, MCC=0.3366, ConfusionMatrix=
[[1719  440]
 [ 140  232]]
Epoch 0 complete in 37.78

Epoch 1 starting with learning_rate: [0.005]
Epoch 1, Phase train, Loss=0.5159, Acc=0.7455, AUC=0.8213, TPR=0.7091, TNR=0.7819, J=0.4910, MCC=0.4923, ConfusionMatrix=
[[2853  796]
 [1062 2589]]
Epoch 1, Phase val, Loss=0.7820, Acc=0.6612, AUC=0.7896, TPR=0.7655, TNR=0.6426, J=0.4081, MCC=0.2965, ConfusionMatrix=
[[1397  777]
 [  91  297]]
New Best AUC=0.7896. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 1, Phase test, Loss=0.7641, Acc=0.6428, AUC=0.7749, TPR=0.7527, TNR=0.6239, J=0.3766, MCC=0.2692, ConfusionMatrix=
[[1347  812]
 [  92  280]]
Epoch 1 complete in 39.68

Epoch 2 starting with learning_rate: [0.005]
Epoch 2, Phase train, Loss=0.5269, Acc=0.7411, AUC=0.8166, TPR=0.6869, TNR=0.7967, J=0.4837, MCC=0.4862, ConfusionMatrix=
[[2869  732]
 [1158 2541]]
Epoch 2, Phase val, Loss=0.6917, Acc=0.6522, AUC=0.7946, TPR=0.7680, TNR=0.6316, J=0.3996, MCC=0.2894, ConfusionMatrix=
[[1373  801]
 [  90  298]]
New Best AUC=0.7946. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 2, Phase test, Loss=0.6960, Acc=0.6393, AUC=0.7644, TPR=0.7339, TNR=0.6230, J=0.3568, MCC=0.2553, ConfusionMatrix=
[[1345  814]
 [  99  273]]
Epoch 2 complete in 38.83

Epoch 3 starting with learning_rate: [0.005]
Epoch 3, Phase train, Loss=0.5177, Acc=0.7548, AUC=0.8264, TPR=0.6963, TNR=0.8130, J=0.5093, MCC=0.5129, ConfusionMatrix=
[[2974  684]
 [1106 2536]]
Epoch 3, Phase val, Loss=0.3947, Acc=0.8474, AUC=0.8047, TPR=0.3660, TNR=0.9333, J=0.2993, MCC=0.3402, ConfusionMatrix=
[[2029  145]
 [ 246  142]]
New Best AUC=0.8047. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 3, Phase test, Loss=0.3890, Acc=0.8633, AUC=0.7883, TPR=0.4113, TNR=0.9412, J=0.3525, MCC=0.3979, ConfusionMatrix=
[[2032  127]
 [ 219  153]]
Epoch 3 complete in 40.53

Epoch 4 starting with learning_rate: [0.005]
Epoch 4, Phase train, Loss=0.5077, Acc=0.7637, AUC=0.8326, TPR=0.6964, TNR=0.8286, J=0.5250, MCC=0.5303, ConfusionMatrix=
[[3079  637]
 [1088 2496]]
Epoch 4, Phase val, Loss=0.4953, Acc=0.8138, AUC=0.7951, TPR=0.6031, TNR=0.8514, J=0.4545, MCC=0.3950, ConfusionMatrix=
[[1851  323]
 [ 154  234]]
Epoch 4, Phase test, Loss=0.4938, Acc=0.8123, AUC=0.7774, TPR=0.5833, TNR=0.8518, J=0.4351, MCC=0.3768, ConfusionMatrix=
[[1839  320]
 [ 155  217]]
Epoch 4 complete in 38.80

Epoch 5 starting with learning_rate: [0.005]
Epoch 5, Phase train, Loss=0.5143, Acc=0.7492, AUC=0.8245, TPR=0.6897, TNR=0.8085, J=0.4982, MCC=0.5018, ConfusionMatrix=
[[2955  700]
 [1131 2514]]
Epoch 5, Phase val, Loss=0.6290, Acc=0.7377, AUC=0.8048, TPR=0.7165, TNR=0.7415, J=0.4580, MCC=0.3497, ConfusionMatrix=
[[1612  562]
 [ 110  278]]
New Best AUC=0.8048. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 5, Phase test, Loss=0.6507, Acc=0.7100, AUC=0.7770, TPR=0.7016, TNR=0.7114, J=0.4131, MCC=0.3068, ConfusionMatrix=
[[1536  623]
 [ 111  261]]
Epoch 5 complete in 37.54

Epoch 6 starting with learning_rate: [0.005]
Epoch 6, Phase train, Loss=0.5104, Acc=0.7568, AUC=0.8283, TPR=0.7141, TNR=0.7996, J=0.5137, MCC=0.5156, ConfusionMatrix=
[[2917  731]
 [1044 2608]]
Epoch 6, Phase val, Loss=0.4912, Acc=0.8119, AUC=0.8055, TPR=0.6134, TNR=0.8473, J=0.4607, MCC=0.3971, ConfusionMatrix=
[[1842  332]
 [ 150  238]]
New Best AUC=0.8055. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 6, Phase test, Loss=0.4853, Acc=0.8139, AUC=0.7958, TPR=0.6129, TNR=0.8485, J=0.4614, MCC=0.3949, ConfusionMatrix=
[[1832  327]
 [ 144  228]]
Epoch 6 complete in 40.26

Epoch 7 starting with learning_rate: [0.005]
Epoch 7, Phase train, Loss=0.4843, Acc=0.7736, AUC=0.8501, TPR=0.7331, TNR=0.8145, J=0.5476, MCC=0.5493, ConfusionMatrix=
[[2955  673]
 [ 980 2692]]
Epoch 7, Phase val, Loss=0.5211, Acc=0.7978, AUC=0.8113, TPR=0.6572, TNR=0.8229, J=0.4801, MCC=0.3976, ConfusionMatrix=
[[1789  385]
 [ 133  255]]
New Best AUC=0.8113. The model weights are stored in /DATA/data/yjgu/bladder/model_weights/resnet18scratch-conv1x1-avgpool_0_bestAUC.pth
Epoch 7, Phase test, Loss=0.5377, Acc=0.7878, AUC=0.7818, TPR=0.6237, TNR=0.8161, J=0.4398, MCC=0.3603, ConfusionMatrix=
[[1762  397]
 [ 140  232]]
Epoch 7 complete in 37.79

Epoch 8 starting with learning_rate: [0.005]
Epoch 8, Phase train, Loss=0.4918, Acc=0.7760, AUC=0.8445, TPR=0.7248, TNR=0.8274, J=0.5522, MCC=0.5551, ConfusionMatrix=
[[3015  629]
 [1006 2650]]
Epoch 8, Phase val, Loss=0.4227, Acc=0.8435, AUC=0.7997, TPR=0.5155, TNR=0.9020, J=0.4175, MCC=0.4070, ConfusionMatrix=
[[1961  213]
 [ 188  200]]
Epoch 8, Phase test, Loss=0.4122, Acc=0.8542, AUC=0.7921, TPR=0.5565, TNR=0.9055, J=0.4620, MCC=0.4435, ConfusionMatrix=
[[1955  204]
 [ 165  207]]
Epoch 8 complete in 38.18

Epoch 9 starting with learning_rate: [0.005]
Epoch 9, Phase train, Loss=0.4610, Acc=0.7890, AUC=0.8643, TPR=0.7550, TNR=0.8231, J=0.5781, MCC=0.5794, ConfusionMatrix=
[[3005  646]
 [ 894 2755]]
Epoch 9, Phase val, Loss=0.5238, Acc=0.7787, AUC=0.7591, TPR=0.5232, TNR=0.8243, J=0.3475, MCC=0.2968, ConfusionMatrix=
[[1792  382]
 [ 185  203]]
Epoch 9, Phase test, Loss=0.5026, Acc=0.7863, AUC=0.7853, TPR=0.5995, TNR=0.8184, J=0.4179, MCC=0.3450, ConfusionMatrix=
[[1767  392]
 [ 149  223]]
Epoch 9 complete in 39.01

Epoch 10 starting with learning_rate: [0.005]
Epoch 10, Phase train, Loss=0.4577, Acc=0.7933, AUC=0.8668, TPR=0.7555, TNR=0.8306, J=0.5861, MCC=0.5879, ConfusionMatrix=
[[3050  622]
 [ 887 2741]]
Epoch 10, Phase val, Loss=0.4205, Acc=0.8341, AUC=0.7747, TPR=0.4639, TNR=0.9002, J=0.3641, MCC=0.3607, ConfusionMatrix=
[[1957  217]
 [ 208  180]]
Epoch 10, Phase test, Loss=0.4037, Acc=0.8431, AUC=0.7705, TPR=0.4624, TNR=0.9088, J=0.3711, MCC=0.3724, ConfusionMatrix=
[[1962  197]
 [ 200  172]]
Epoch 10 complete in 38.00

Epoch 11 starting with learning_rate: [0.005]
Epoch 11, Phase train, Loss=0.4707, Acc=0.7832, AUC=0.8592, TPR=0.7474, TNR=0.8182, J=0.5656, MCC=0.5672, ConfusionMatrix=
[[3016  670]
 [ 913 2701]]
Epoch 11, Phase val, Loss=0.3770, Acc=0.8501, AUC=0.7218, TPR=0.0979, TNR=0.9844, J=0.0823, MCC=0.1785, ConfusionMatrix=
[[2140   34]
 [ 350   38]]
Epoch 11, Phase test, Loss=0.3559, Acc=0.8645, AUC=0.7372, TPR=0.1102, TNR=0.9944, J=0.1047, MCC=0.2588, ConfusionMatrix=
[[2147   12]
 [ 331   41]]
Epoch 11 complete in 38.58

Epoch 12 starting with learning_rate: [0.005]
Epoch 12, Phase train, Loss=0.4602, Acc=0.7923, AUC=0.8654, TPR=0.7612, TNR=0.8240, J=0.5852, MCC=0.5861, ConfusionMatrix=
[[2982  637]
 [ 879 2802]]
Epoch 12, Phase val, Loss=1.0039, Acc=0.6179, AUC=0.7954, TPR=0.8608, TNR=0.5745, J=0.4353, MCC=0.3122, ConfusionMatrix=
[[1249  925]
 [  54  334]]
Epoch 12, Phase test, Loss=1.0304, Acc=0.5721, AUC=0.7862, TPR=0.8226, TNR=0.5289, J=0.3515, MCC=0.2492, ConfusionMatrix=
[[1142 1017]
 [  66  306]]
Epoch 12 complete in 36.74

Epoch 13 starting with learning_rate: [0.005]
Epoch 13, Phase train, Loss=0.4483, Acc=0.8014, AUC=0.8740, TPR=0.7637, TNR=0.8394, J=0.6031, MCC=0.6047, ConfusionMatrix=
[[3048  583]
 [ 867 2802]]
Epoch 13, Phase val, Loss=0.4867, Acc=0.8201, AUC=0.8009, TPR=0.6134, TNR=0.8569, J=0.4703, MCC=0.4109, ConfusionMatrix=
[[1863  311]
 [ 150  238]]
Epoch 13, Phase test, Loss=0.4770, Acc=0.8131, AUC=0.7890, TPR=0.6210, TNR=0.8462, J=0.4672, MCC=0.3978, ConfusionMatrix=
[[1827  332]
 [ 141  231]]
Epoch 13 complete in 38.57

Epoch 14 starting with learning_rate: [0.005]
Epoch 14, Phase train, Loss=0.4239, Acc=0.8144, AUC=0.8875, TPR=0.7805, TNR=0.8477, J=0.6282, MCC=0.6298, ConfusionMatrix=
[[3122  561]
 [ 794 2823]]
Epoch 14, Phase val, Loss=0.6446, Acc=0.7728, AUC=0.7967, TPR=0.6598, TNR=0.7930, J=0.4528, MCC=0.3633, ConfusionMatrix=
[[1724  450]
 [ 132  256]]
Epoch 14, Phase test, Loss=0.5910, Acc=0.7795, AUC=0.7736, TPR=0.6425, TNR=0.8031, J=0.4456, MCC=0.3587, ConfusionMatrix=
[[1734  425]
 [ 133  239]]
Epoch 14 complete in 38.95

Epoch 15 starting with learning_rate: [0.005]
Epoch 15, Phase train, Loss=0.4244, Acc=0.8086, AUC=0.8877, TPR=0.7812, TNR=0.8362, J=0.6174, MCC=0.6183, ConfusionMatrix=
[[3043  596]
 [ 801 2860]]
Epoch 15, Phase val, Loss=0.9375, Acc=0.6694, AUC=0.8012, TPR=0.8222, TNR=0.6421, J=0.4643, MCC=0.3364, ConfusionMatrix=
[[1396  778]
 [  69  319]]
Epoch 15, Phase test, Loss=0.9771, Acc=0.6310, AUC=0.7792, TPR=0.7823, TNR=0.6049, J=0.3872, MCC=0.2755, ConfusionMatrix=
[[1306  853]
 [  81  291]]
Epoch 15 complete in 39.17

Early Stop!
Training complete in 10m 18s
The best model val AUC=0.81128780622, test AUC=0.781781191013.
Finish training resnet18scratch-conv1x1-avgpool_0

